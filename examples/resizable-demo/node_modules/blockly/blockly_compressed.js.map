{"version":3,"sources":["core/registry.ts","core/common.ts","core/utils/idgenerator.ts","core/events/utils.ts","core/interfaces/i_serializable.ts","core/utils/xml.ts","core/utils/deprecation.ts","core/utils/dom.ts","core/dialog.ts","core/interfaces/i_variable_backed_parameter_model.ts","core/interfaces/i_legacy_procedure_blocks.ts","core/variables.ts","core/touch.ts","core/browser_events.ts","core/css.ts","core/utils/style.ts","core/utils/svg_math.ts","core/xml.ts","core/serialization/registry.ts","core/serialization/blocks.ts","core/interfaces/i_has_bubble.ts","core/connection.ts","core/utils/math.ts","core/dropdowndiv.ts","core/utils/string.ts","core/tooltip.ts","core/utils/colour.ts","core/utils/parsing.ts","core/widgetdiv.ts","core/field_registry.ts","core/utils/aria.ts","core/field_dropdown.ts","core/utils/object.ts","core/utils/toolbox.ts","core/extensions.ts","core/utils/array.ts","core/utils/svg_paths.ts","core/icons/registry.ts","core/block_animations.ts","core/bump_objects.ts","core/render_management.ts","core/block_dragger.ts","core/clipboard.ts","core/contextmenu.ts","core/keyboard_nav/ast_node.ts","core/renderers/common/constants.ts","core/renderers/common/block_rendering.ts","core/contextmenu_items.ts","core/interfaces/i_procedure_block.ts","core/interfaces/i_observable.ts","core/procedures.ts","core/variables_dynamic.ts","core/positionable_helpers.ts","core/workspace_svg.ts","core/inject.ts","core/serialization/procedures.ts","core/serialization/workspaces.ts","core/shortcut_items.ts","core/interfaces/i_selectable_toolbox_item.ts","core/blockly.ts","src/com/google/javascript/jscomp/js/base.js","src/com/google/javascript/jscomp/js/util/defines.js","src/com/google/javascript/jscomp/js/util/defineproperty.js","src/com/google/javascript/jscomp/js/util/global.js","src/com/google/javascript/jscomp/js/util/shouldpolyfill.js","src/com/google/javascript/jscomp/js/util/polyfill.js","src/com/google/javascript/jscomp/js/es6/globalthis.js","src/com/google/javascript/jscomp/js/es6/util/arrayiterator.js","src/com/google/javascript/jscomp/js/es6/symbol.js","src/com/google/javascript/jscomp/js/es6/util/iteratorfromarray.js","src/com/google/javascript/jscomp/js/es6/array/values.js","src/com/google/javascript/jscomp/js/es6/array/flat.js","src/com/google/javascript/jscomp/js/util/owns.js","src/com/google/javascript/jscomp/js/es6/object/entries.js","src/com/google/javascript/jscomp/js/es6/object/values.js","closure/goog/base_minimal.js","closure/goog/goog.js","core/blocks.ts","core/inputs/input_types.ts","core/icons/icon_types.ts","core/utils/size.ts","core/msg.ts","core/events/events_abstract.ts","core/events/events_var_base.ts","core/events/events_var_create.ts","core/variable_model.ts","core/utils/coordinate.ts","core/workspace_comment.ts","core/events/events_ui_base.ts","core/events/events_selected.ts","core/utils/useragent.ts","core/utils/rect.ts","core/utils/svg.ts","core/workspace_comment_svg.ts","core/serialization/exceptions.ts","core/serialization/priorities.ts","core/events/events_block_base.ts","core/events/events_block_create.ts","core/events/workspace_events.ts","core/events/events_block_change.ts","core/events/events_block_delete.ts","core/connection_type.ts","core/constants.ts","core/icons/exceptions.ts","core/marker_manager.ts","core/field.ts","core/menu.ts","core/menuitem.ts","core/icons/icon.ts","core/scrollbar.ts","core/bubbles/bubble.ts","core/theme.ts","core/theme/classic.ts","core/options.ts","core/bubbles/mini_workspace_bubble.ts","core/icons/mutator_icon.ts","core/field_label.ts","core/inputs/input.ts","core/utils/keycodes.ts","core/utils.ts","core/bubbles/text_bubble.ts","core/bubbles/textinput_bubble.ts","core/icons/comment_icon.ts","core/inputs/dummy_input.ts","core/inputs/value_input.ts","core/inputs/statement_input.ts","core/block.ts","core/events/events_block_drag.ts","core/component_manager.ts","core/config.ts","core/insertion_marker_manager.ts","core/contextmenu_registry.ts","core/internal_constants.ts","core/keyboard_nav/marker.ts","core/keyboard_nav/cursor.ts","core/keyboard_nav/basic_cursor.ts","core/keyboard_nav/tab_navigate_cursor.ts","core/rendered_connection.ts","core/icons/warning_icon.ts","core/block_svg.ts","core/bubble_old.ts","core/bubble_dragger.ts","core/connection_checker.ts","core/connection_db.ts","core/events/events_block_move.ts","core/events/events_bubble_open.ts","core/events/events_click.ts","core/events/events_comment_base.ts","core/events/events_comment_change.ts","core/events/events_comment_create.ts","core/events/events_comment_delete.ts","core/events/events_comment_move.ts","core/events/events_marker_move.ts","core/events/events_theme_change.ts","core/events/events_toolbox_item_select.ts","core/events/events_trashcan_open.ts","core/events/events_var_delete.ts","core/events/events_var_rename.ts","core/events/events_viewport.ts","core/events/events.ts","core/renderers/zelos/constants.ts","core/renderers/measurables/types.ts","core/renderers/measurables/base.ts","core/renderers/measurables/connection.ts","core/renderers/common/drawer.ts","core/renderers/zelos/drawer.ts","core/field_image.ts","core/field_input.ts","core/field_textinput.ts","core/renderers/measurables/row.ts","core/renderers/measurables/bottom_row.ts","core/renderers/measurables/input_connection.ts","core/renderers/measurables/external_value_input.ts","core/renderers/measurables/field.ts","core/renderers/measurables/hat.ts","core/renderers/measurables/icon.ts","core/renderers/measurables/in_row_spacer.ts","core/renderers/measurables/inline_input.ts","core/renderers/measurables/statement_input.ts","core/renderers/measurables/input_row.ts","core/renderers/measurables/jagged_edge.ts","core/renderers/measurables/next_connection.ts","core/renderers/measurables/output_connection.ts","core/renderers/measurables/previous_connection.ts","core/renderers/measurables/round_corner.ts","core/renderers/measurables/spacer_row.ts","core/renderers/measurables/square_corner.ts","core/renderers/measurables/top_row.ts","core/renderers/common/info.ts","core/renderers/zelos/measurables/bottom_row.ts","core/renderers/zelos/measurables/inputs.ts","core/renderers/zelos/measurables/row_elements.ts","core/renderers/zelos/measurables/top_row.ts","core/renderers/zelos/info.ts","core/renderers/common/marker_svg.ts","core/renderers/zelos/marker_svg.ts","core/renderers/common/path_object.ts","core/renderers/zelos/path_object.ts","core/renderers/common/renderer.ts","core/renderers/zelos/renderer.ts","core/renderers/zelos/zelos.ts","core/drag_target.ts","core/delete_area.ts","core/field_angle.ts","core/field_checkbox.ts","core/field_colour.ts","core/field_label_serializable.ts","core/field_multilineinput.ts","core/field_number.ts","core/field_variable.ts","core/flyout_button.ts","core/metrics_manager.ts","core/flyout_metrics_manager.ts","core/scrollbar_pair.ts","core/workspace_dragger.ts","core/gesture.ts","core/grid.ts","core/names.ts","core/observable_procedure_map.ts","core/icons.ts","core/theme_manager.ts","core/variable_map.ts","core/workspace.ts","core/workspace_audio.ts","core/sprites.ts","core/zoom_controls.ts","core/flyout_base.ts","core/flyout_horizontal.ts","core/flyout_vertical.ts","core/generator.ts","core/shortcut_registry.ts","core/renderers/geras/constants.ts","core/renderers/geras/highlighter.ts","core/renderers/geras/drawer.ts","core/renderers/geras/highlight_constants.ts","core/renderers/geras/measurables/inline_input.ts","core/renderers/geras/measurables/statement_input.ts","core/renderers/geras/info.ts","core/renderers/geras/path_object.ts","core/renderers/geras/renderer.ts","core/renderers/geras/geras.ts","core/renderers/minimalist/constants.ts","core/renderers/minimalist/drawer.ts","core/renderers/minimalist/info.ts","core/renderers/minimalist/renderer.ts","core/renderers/minimalist/minimalist.ts","core/renderers/thrasos/info.ts","core/renderers/thrasos/renderer.ts","core/renderers/thrasos/thrasos.ts","core/serialization/variables.ts","core/serialization.ts","core/theme/zelos.ts","core/theme/themes.ts","core/toolbox/toolbox_item.ts","core/toolbox/category.ts","core/toolbox/separator.ts","core/toolbox/collapsible_category.ts","core/toolbox/toolbox.ts","core/trashcan.ts","core/main.js"],"names":["register","validate","unregister","getItem","hasItem","getClass","getObject","getAllItems","getClassFromOptions","getWorkspaceById","getAllWorkspaces","registerWorkspace","unregisterWorkpace","getMainWorkspace","setMainWorkspace","getSelected","setSelected","getParentContainer","setParentContainer","svgResize","getBlockTypeCounts","jsonInitFactory","defineBlocksWithJsonArray","defineBlocksWithJsonArrayInternal","getNextUniqueId","genUid","setRecordUndo","getRecordUndo","fire","fireInternal","fireNow","filter","clearPendingUndo","disable","enable","isEnabled","setGroupInternal","getDescendantIds","fromJson","get","disableOrphans","isSerializable","injectDependencies","domToText","sanitizeText","warn","createSvgElement","addClass","removeClasses","removeClass","hasClass","removeNode","insertAfter","containsNode","setCssTransform","startTextWidthCache","stopTextWidthCache","getTextWidth","getFastTextWidth","getFastTextWidthWithSizeString","measureFontMetrics","alert","setAlert","confirm","confirmInternal","setConfirm","prompt","setPrompt","isVariableBackedParameterModel","isLegacyProcedureDefBlock","isLegacyProcedureCallBlock","flyoutCategory","flyoutCategoryBlocks","generateUniqueName","generateUniqueNameInternal","generateUniqueNameFromOptions","createVariableButtonHandler","promptName","nameUsedWithOtherType","nameUsedWithAnyType","nameUsedWithConflictingParam","checkForConflictingParamWithProcedureModels","checkForConflictingParamWithLegacyProcedures","getOrCreateVariablePackage","createVariable","getAddedVariables","longStart","longStop","clearTouchIdentifier","shouldHandleEvent","getTouchIdentifierFromEvent","checkTouchIdentifier","conditionalBind","bind","unbind","isTargetInput","isRightButton","mouseToSvg","getScrollDeltaPixels","inject","getSize","getSizeInternal","getSizeWithDisplay","getComputedStyle","getPageOffset","getViewportPageOffset","getBorderBox","scrollIntoContainerView","getContainerOffsetToScrollInto","getRelativeXY","getInjectionDivXY","getViewportBBox","getDocumentScroll","screenToWsCoordinates","workspaceToDom","variablesToDom","blockToDomWithXY","fieldToDom","allFieldsToDom","blockToDom","cloneShadow","domToPrettyText","clearWorkspaceAndLoadFromXml","domToWorkspace","appendDomToWorkspace","domToBlock","domToVariables","mapSupportedXmlTags","applyMutationTagNodes","applyCommentTagNodes","applyDataTagNodes","applyFieldTagNodes","findChildBlocks","applyInputTagNodes","applyNextTagNodes","domToBlockHeadless","domToField","deleteNext","isElement","save","saveAttributes","saveCoords","saveExtraState","saveIcons","saveFields","saveInputBlocks","saveNextBlocks","saveConnection","append","appendInternal","appendPrivate","loadCoords","loadAttributes","loadExtraState","tryToConnectParent","loadIcons","loadFields","loadInputBlocks","loadNextBlocks","loadConnection","initBlock","hasBubble","connectReciprocally","getSingleConnection","getConnectionForOrphanedOutput","toRadians","toDegrees","clamp","createDom","setBoundsElement","getOwner","getContentDiv","clearContent","setColour","showPositionedByBlock","showPositionedByField","getScaledBboxOfBlock","getScaledBboxOfField","showPositionedByRect","show","getPositionBelowMetrics","getPositionAboveMetrics","getPositionTopOfPageMetrics","getPositionX","isVisible","hideIfOwner","hide","hideWithoutAnimation","positionInternal","repositionForWindowResize","startsWith","shortestStringLength","commonWordPrefix","commonWordSuffix","wrapLine","wrapScore","wrapMutate","wrapToText","setCustomTooltip","getCustomTooltip","getDiv","getTooltipOfObject","getTargetObject","bindMouseEvents","unbindMouseEvents","onMouseOver","onMouseOut","onMouseMove","dispose","block","unblock","renderContent","renderDefaultContent","getPosition","getHsvSaturation","setHsvSaturation","getHsvValue","setHsvValue","parse","rgbToHex","hexToRgb","hsvToHex","blend","hueToHex","tokenizeInterpolationInternal","tokenizeInterpolation","replaceMessageReferences","checkMessageReferences","parseBlockColour","testOnly_setDiv","positionWithAnchor","calculateX","calculateY","isRepositionable","fromJsonInternal","setRole","setState","trimOptions","applyTrim","validateOptions","deepMerge","convertToolboxDefToJson","validateToolbox","convertFlyoutDefToJsonArray","hasCategories","hasCategoriesInternal","isCategoryCollapsible","convertToToolboxJson","xmlToJsonArray","addAttributes","parseToolboxTree","isRegistered","apply","checkNoMutatorProperties","checkXmlHooks","checkJsonHooks","checkMutatorDialog","checkHasFunctionPair","checkHasMutatorProperties","getMutatorProperties","mutatorPropertiesMatch","runAfterPageLoad","checkDropdownOptionsInTable","extensionParentTooltip","removeElem","point","curve","moveTo","moveBy","lineTo","line","lineOnAxis","arc","disposeUiEffect","disposeUiStep","connectionUiEffect","connectionUiStep","disconnectUiEffect","disconnectUiStep","disconnectUiStop","bumpObjectIntoBounds","bumpIntoBoundsHandler","extractObjectFromEvent","bumpTopObjectsIntoBounds","queueRender","finishQueuedRenders","queueBlock","doRenders","renderBlock","updateConnectionLocations","updateIconLocations","initIconData","copy","copyInternal","paste","duplicate","duplicateInternal","getCurrentBlock","setCurrentBlock","populate_","position_","createWidget_","haltPropagation","commentDeleteOption","commentDuplicateOption","workspaceCommentOption","getParentConnection","isDynamicShape","init","registerUndo","registerRedo","registerCleanup","toggleOption_","registerCollapse","registerExpand","addDeletableBlocks_","getDeletableBlocks_","deleteNext_","registerDeleteAll","registerWorkspaceOptions_","registerDuplicate","registerComment","registerInline","registerCollapseExpandBlock","registerDisable","registerDelete","registerHelp","registerBlockOptions_","registerDefaultOptions","isProcedureBlock","isObservable","allProcedures","procTupleComparator","findLegalName","isLegalName","isNameUsed","rename","updateMutatorFlyout","mutatorOpenListener","mutatorChangeListener","getCallers","blockIsModernCallerFor","mutateCallers","getDefinition","stringButtonClickHandler","numberButtonClickHandler","colourButtonClickHandler","getStartPositionRect","getCornerOppositeToolbox","bumpPositionRect","resizeSvgContents","createMainWorkspace","onKeyDown","bindDocumentEvents","loadSounds","saveProcedure","saveParameter","loadProcedure","loadParameter","load","registerEscape","registerCopy","registerCut","registerPaste","registerDefaultShortcuts","isSelectableToolboxItem","hideChaff","type","name","registryItem","opt_allowOverrides","Type","trim","Error","toLowerCase","caselessName","typeRegistry","typeMap","nameRegistry","nameMap","Object","create","String","FIELD","console","opt_throwIfMissing","msg","opt_cased","casedRegistry","key","keys","options","plugin","plugins","DEFAULT","id","WorkspaceDB_","workspaces","workspaceId","push","workspace","mainWorkspace","selected","newSelection","parentContainer","newParent","parentWorkspace","svg","getParentSvg","cachedSize","getCachedParentSvgSize","div","parentElement","HTMLElement","width","offsetWidth","height","offsetHeight","setAttribute","setCachedParentSvgSize","resize","opt_stripFollowing","typeCountsMap","descendants","getDescendants","nextBlock","getNextBlock","index","indexOf","splice","length","i","checkBlock","jsonDef","jsonInit","jsonArray","TEST_ONLY","defineBlocks","createBlockDefinitionsFromJsonArray","blocks","elem","definition","Blocks","toString","nextId","internal","newValue","recordUndo","event","FIRE_QUEUE","requestAnimationFrame","setTimeout","e","queue","eventWorkspace","fireChangeListener","workspaceIds","Set","map","undoStack","getUndoStack","group","undefined","events","queueIn","forward","slice","reverse","mergedQueue","hash","isNull","isUiEvent","eventType","UI","blockId","join","lastEntry","lastEvent","MOVE","moveEvent","newParentId","newInputName","newCoordinate","reason","reasonSet","concat","Array","from","CHANGE","element","VIEWPORT_CHANGE","viewportEvent","viewTop","viewLeft","scale","oldScale","CLICK","BUBBLE_OPEN","unshift","disabled","getGroup","setGroup","state","ids","descendant","json","eventClass","EVENT","CREATE","getBlockById","initialUndoFlag","parent","getParent","children","child","setEnabled","outputConnection","previousConnection","isDragging","obj","saveState","loadState","dependencies","document","DOMParser","XMLSerializer","domParser","xmlSerializer","createElement","tagName","createElementNS","NAME_SPACE","createTextNode","text","textToDom","doc","parseFromString","documentElement","getElementsByTagName","body","firstChild","nodeName","dom","serializeToString","replace","INVALID_CONTROL_CHARS","match","charCodeAt","deprecationDate","deletionDate","opt_use","attrs","opt_parent","SVG_NS","appendChild","className","classNames","split","every","classList","contains","add","remove","node","parentNode","removeChild","newNode","refNode","siblingNode","nextSibling","insertBefore","transform","style","cacheReference","cacheWidths","textElement","textContent","baseVal","getComputedTextLength","fontSize","fontWeight","fontFamily","canvasContext","computeCanvas","getContext","font","measureText","span","result","baseline","alignItems","offsetTop","message","opt_callback","alertImplementation","alertFunction","callback","confirmImplementation","confirmFunction","defaultValue","promptImplementation","promptFunction","param","getVariableModel","getProcedureDef","getProcedureCall","renameProcedure","allUsedVarModels","ws","getAllBlocks","variables","blockVariables","getVarModels","j","variable","getId","values","allDeveloperVariables","getDeveloperVariables","devVars","xmlList","button","registerButtonCallback","getTargetWorkspace","blockList","variableModelList","getVariablesOfType","mostRecentVariable","generateVariableFieldDom","value","sort","VariableModel","compareByName","VAR_LETTER_OPTIONS","charAt","getAllVariableNames","startChar","usedNames","letters","suffix","letterIndex","inUse","potName","Number","opt_type","promptAndCheckWithAlert","defaultName","Msg","existing","renameVariable","promptText","newName","procedure","renameVariableById","defaultText","newVar","allVariables","getVariableMap","getAllVariables","oldName","getProcedureMap","getProcedures","procedures","params","getParameters","procHasOld","some","procHasNew","getName","def","blockHasOld","blockHasNew","variableModel","field","opt_name","getVariable","potentialVariableMap","getPotentialVariableMap","getVariableById","isFlyout","targetWorkspace","originalVariables","allCurrentVariables","addedVariables","gesture","longPid_","handleRightClick","LONGPRESS","clearTimeout","touchIdentifier_","PointerEvent","pointerId","identifier","thisObject","func","opt_noCaptureIdentifier","wrapFunc","call","bindData","TOUCH_MAP","addEventListener","pop","removeEventListener","target","isContentEditable","getAttribute","HTMLInputElement","HTMLTextAreaElement","ctrlKey","MAC","matrix","svgPoint","createSVGPoint","x","clientX","y","clientY","getScreenCTM","inverse","matrixTransform","deltaMode","deltaX","deltaY","LINE_MODE_MULTIPLIER","PAGE_MODE_MULTIPLIER","cssContent","injected","content","hasCss","pathToMedia","mediaPath","cssNode","cssTextNode","head","originalDisplay","display","originalVisibility","visibility","originalPosition","position","Size","property","styles","window","getPropertyValue","el","pos","Coordinate","box","getBoundingClientRect","scrollCoord","pageXOffset","scrollLeft","pageYOffset","scrollTop","left","top","parseFloat","right","bottom","Rect","container","opt_center","offset","elementPos","containerPos","containerBorder","relX","relY","elementSize","spaceX","clientWidth","spaceY","clientHeight","Math","min","max","xy","parseInt","r","XY_REGEX","styleComponents","XY_STYLE_REGEX","scrollOffset","win","screenCoordinates","screenX","screenY","boundingRect","getInjectionDiv","injectionDiv","clientOffsetPixels","mainOffsetPixels","getOriginOffsetInPixels","difference","finalOffsetPixels","finalOffsetMainWs","opt_noId","treeXml","variablesElement","hasChildNodes","comments","getTopComments","comment","toXmlWithXY","getTopBlocks","variableList","isInsertionMarker","getChildren","DocumentFragment","RTL","getWidth","getRelativeToSurfaceXY","round","toXml","inputList","input","fieldRow","fieldDom","isShadow","mutationToDom","mutation","hasAttributes","commentText","getCommentText","getIcon","IconType","COMMENT","size","getBubbleSize","pinned","bubbleIsVisible","commentElement","data","dataElement","empty","inputTypes","DUMMY","childBlock","connection","targetBlock","VALUE","STATEMENT","childShadow","getShadowDom","childElem","nodeType","NodeType","ELEMENT_NODE","inputsInline","inputsInlineDefault","isCollapsed","isDeletable","isMovable","isEditable","nextElem","nextShadow","nextConnection","shadow","cloneNode","textNode","removeAttribute","TEXT_NODE","lines","blob","indent","substring","xml","setResizesEnabled","clear","blockIds","newBlockIds","existingGroup","variablesFirst","xmlChild","childNodes","xmlChildElement","blockX","blockY","isNaN","TypeError","rendered","WorkspaceCommentSvg","fromXmlRendered","WorkspaceComment","fromXml","FINISHED_LOADING","getBlocksBoundingBox","bbox","farY","topX","newLeftX","Infinity","newRightX","newY","blockXY","offsetY","ySeparation","offsetX","xmlBlock","variablesBeforeCreation","topBlock","topBlockSvg","setConnectionTracking","initSvg","render","disposed","updateDisabled","resizeContents","initModel","newVariables","thisVariable","VAR_CREATE","xmlVariables","childNodeMap","next","xmlChildren","shouldCallInitSvg","domToMutation","setCommentText","setBubbleSize","setBubbleVisible","xmlNode","childBlockElement","childShadowElement","prototypeName","getInput","childBlockInfo","setShadowDom","isConnected","parentConnection","connectedToParentNext","outerHTML","newBlock","xmlChildNameMap","connect","inline","setInputsInline","deletable","setDeletable","movable","setMovable","editable","setEditable","collapsed","setCollapsed","setShadow","fieldName","getField","serializer","SERIALIZER","addCoordinates","addInputBlocks","addNextBlocks","doFullSerialization","isOwnDeletable","isOwnMovable","isOwnEditable","extraState","icons","icon","getIcons","getType","fields","inputs","connectionState","getShadowState","prevRecordUndo","BLOCK_CREATE","MissingBlockType","getSourceBlock","RealChildOfShadow","childConnection","MissingConnection","connected","checker","connectionChecker","BadConnectionCheck","getErrorMessage","canConnectWithReason","iconTypes","iconType","iconState","constructor","ICON","UnregisteredIcon","addIcon","fieldState","inputName","setShadowState","onLocationChange","first","second","targetConnection","orphanBlock","foundConnection","output","typeChecker","getConnectionChecker","canConnect","startBlock","angleDegrees","PI","angleRadians","lowerBound","number","upperBound","temp","arrow","opacity","transition","ANIMATION_TIME","boundsElem","boundsElement","owner","backgroundColour","borderColour","backgroundColor","borderColor","opt_onHide","opt_secondaryYOffset","positionToField","blockSvg","getSvgRoot","scaledHeight","scaledWidth","bBox","getScaledBBox","primaryX","primaryY","secondaryY","sourceBlock","newOwner","rtl","secondaryX","onHide","direction","renderedClassName","getRenderer","getClassName","themeClassName","getTheme","boundsInfo","divSize","xCoords","initialX","divX","initialY","finalX","finalY","PADDING_Y","arrowX","arrowY","ARROW_SIZE","BORDER_SIZE","arrowAtTop","arrowVisible","sourceX","boundsLeft","boundsRight","divWidth","relativeArrowX","horizPadding","ARROW_HORIZONTAL_PADDING","divOwner","opt_withoutAnimation","animateOutTimer","markFocused","metrics","getPositionMetrics","floor","str","prefix","array","reduce","a","b","opt_shortest","wordPrefix","len","letter","substr","wrap","limit","words","score","lastText","lineCount","lastScore","wordBreaks","steps","insertedBreaks","lineLengths","linePunctuation","maxLength","pow","abs","bestScore","bestBreaks","mutatedWordBreaks","mutatedScore","isNumber","test","customFn","customTooltip","visible","containerDiv","object","tooltip","mouseOverWrapper_","mouseOutWrapper_","blocked","newElement","currentTarget","poisonedElement","mouseOutPid","_e","showPid","dx","lastX","pageX","dy","lastY","pageY","sqrt","RADIUS_OK","HOVER_MS","tip","LIMIT","windowWidth","windowHeight","anchorX","OFFSET_X","anchorY","OFFSET_Y","scrollY","MARGINS","scrollX","hsvSaturation","newSaturation","hsvValue","hex","names","rgb","g","colour","h","s","v","red","green","blue","sextant","remainder","val1","val2","val3","colour1","colour2","factor","hex1","hex2","rgb1","rgb2","hue","parseInterpolationTokens","tokens","chars","buffer","c","rawKey","keyUpper","toUpperCase","bklyKey","rawValue","prototype","mergedTokens","interpolatedResult","validSoFar","msgTable","m","msgKey","dereferenced","errorMsg","newDiv","newDispose","rendererClassName","oldOwner","viewportBBox","anchorBBox","widgetSize","item","fieldClass","fieldObject","roleName","ROLE_ATTRIBUTE","stateName","isArray","ARIA_PREFIX","hasImages","trimmedOptions","label","imageLabel","alt","stringLabels","shortest","prefixLength","suffixLength","foundError","tuple","error","src","source","toolboxDef","Element","toolboxJson","toolboxKind","toolboxContents","FLYOUT_TOOLBOX_KIND","CATEGORY_TOOLBOX_KIND","flyoutDef","categories","categoryInfo","contents","Node","arr","attributes","attr","parsedToolboxDef","initFn","allExtensions","registerMixin","mixinObj","mixin","registerMutator","opt_helperFn","opt_blockList","errorPrefix","hasMutatorDialog","setMutator","MutatorIcon","isMutator","extensionFn","mutatorProperties","mutationName","properties","compose","decompose","func1","func2","hasXmlHooks","hasJsonHooks","oldProperties","newProperties","fn","readyState","readyStateCheckInterval","setInterval","clearInterval","buildTooltipForDropdown","dropdownName","lookupTable","blockTypesChecked","setTooltip","getFieldValue","warning","dropdown","FieldDropdown","isOptionListDynamic","getOptions","optionKey","buildTooltipWithFieldText","msgTemplate","getText","tooltipWhenNotConnected","getInputsInline","command","points","val","flags","radius","iconConstructor","svgGroup","getAudioManager","play","getSvgXY","clone","cloneRect","Date","rect","start","workspaceScale","percent","getTime","ripple","Svg","CIRCLE","disconnectPid","getHeightWidth","magnitude","atan","DISPLACEMENT","wobblingBlock","DURATION","skew","sin","WIGGLES","getTranslation","bounds","objectMetrics","getBoundingRectangle","newYPosition","leftClamp","rightClamp","newXPosition","metricsManager","getMetricsManager","hasFixedEdges","BUMP_EVENTS","scrollMetricsInWsCoords","getScrollMetrics","wasBumped","BLOCK_MOVE","getRootBlock","COMMENT_CREATE","COMMENT_MOVE","getCommentById","commentId","topBlocks","getTopBoundedElements","afterRendersPromise","Promise","resolve","dirtyBlocks","rootBlocks","isDisposed","blockOrigin","has","renderEfficiently","conn","getConnections_","moved","moveToOffset","isSuperior","sum","relativeCoords","dragIconData","location","toCopy","copyData","toCopyData","typeCounts","isCapacityAvailable","saveInfo","toDuplicate","oldCopyData","pastedThing","currentBlock","dummyOwner","menu","menu_","focus","Menu","Role","MENU","option","menuItem","MenuItem","setRightToLeft","MENUITEM","addChild","enabled","onAction","actionHandler","scope","menuSize","menuDom","preventDefault","stopPropagation","callbackFactory","config","snapRadius","select","deleteOption","duplicateOption","wsCommentOption","wsCommentOption.callback","DEFAULT_SIZE","finalOffset","topConnection","shape","isDynamic","rendererClass","RENDERER","theme","opt_rendererOverrides","renderer","ContextMenuRegistry","registry","undoOption","displayText","preconditionFn","undo","scopeType","ScopeType","WORKSPACE","weight","redoOption","getRedoStack","cleanOption","cleanUp","shouldCollapse","timeoutFn","timeoutCounter","ms","DELAY","collapseOption","collapse","expandOption","deleteList","eventGroup","shift","isDeadOrDying","deletableBlocksLength","cancelCurrentGesture","deletableBlocks","ok","isInFlyout","isDuplicatable","BLOCK","commentOption","hasIcon","CommentIcon","TYPE","inlineOption","StatementInput","collapseExpandOption","disableOption","getInheritedDisabled","descendantCount","checkAndDelete","helpOption","url","helpUrl","showHelp","getProcedureModel","doProcedureUpdate","isProcedureDef","startPublishing","stopPublishing","root","proceduresNoReturn","p","getReturnTypes","pa","getBlocksByType","forEach","proceduresReturn","ta","tb","localeCompare","sensitivity","opt_exclude","Names","equals","excludeModel","model","UnattachedFieldError","legalName","setName","getValue","procedureBlock","populateProcedures","procedureList","templateName","args","arg","nameField","xmlElement","argBlock","argValue","DEFAULT_ARG","fieldContent","updateToolbox","bubbleType","isOpen","getWorkspace","addChangeListener","BLOCK_DELETE","BLOCK_CHANGE","procName","defBlock","oldRecordUndo","callers","caller","oldMutation","oldMutationDom","newMutationDom","newMutation","firstVariable","horizontalPadding","verticalPadding","hasVerticalScrollbar","scrollbar","canScrollVertically","horizontal","horizontalPosition","LEFT","absoluteMetrics","Scrollbar","scrollbarThickness","viewMetrics","vertical","verticalPosition","TOP","canScrollHorizontally","toolboxMetrics","hPosition","Position","horizontalLayout","RIGHT","vPosition","BOTTOM","startRect","margin","bumpDir","savedPositions","otherEl","intersects","bumpDirection","UP","opt_options","containerElement","getElementById","querySelector","ownerDocument","Options","subContainer","tabIndex","State","LABEL","SVG","HTML_NS","XLINK_NS","defs","DEFS","rnd","random","gridPattern","Grid","gridOptions","WorkspaceSvg","wsOptions","zoomOptions","startScale","languageTree","flyout","addFlyout","hasTrashcan","addTrashcan","controls","addZoomControls","getThemeManager","subscribe","translate","workspaceResizeHandler","hideComponents","setResizeHandlerWrapper","toolbox","getToolbox","getFlyout","scrollToStart","trashcan","zoomControls_","moveOptions","scrollbars","ScrollbarPair","setMetrics","hasSounds","ShortcutRegistry","documentEventsBound","updateInverseScreenCTM","IPAD","unbindSounds","soundBinds","oldSoundBinding","audioMgr","preload","proc","returnTypes","parameters","getTypes","types","procedureModelClass","parameterModelClass","setReturnTypes","entries","insertParameter","setTypes","serializerMap","deserializers","priority","deserializer","pluginState","escapeAction","ESCAPE","readOnly","keyCodes","KeyCodes","ESC","deleteShortcut","DELETE","Gesture","inProgress","BACKSPACE","ctrlC","createSerializedKey","C","CTRL","altC","ALT","metaC","META","copyShortcut","COPY","ctrlX","X","altX","metaX","cutShortcut","CUT","BlockSvg","ctrlV","V","altV","metaV","pasteShortcut","PASTE","ctrlZ","Z","altZ","metaZ","undoShortcut","UNDO","ctrlShiftZ","SHIFT","altShiftZ","metaShiftZ","ctrlY","Y","redoShortcut","REDO","toolboxItem","isSelectable","opt_onlyClosePopups","COMPILED","goog","global","globalThis","define","goog.define","DEBUG","DISALLOW_TEST_ONLY_CODE","provide","goog.provide","module","goog.module","goog.module.get","declareLegacyNamespace","goog.module.declareLegacyNamespace","setTestOnly","goog.setTestOnly","opt_message","require","goog.require","namespace","requireType","goog.requireType","declareModuleId","$jscomp$tmp$exports$module$name","CONNECTION_CHECKER","CURSOR","INPUT","TOOLBOX","THEME","TOOLBOX_ITEM","FLYOUTS_VERTICAL_TOOLBOX","FLYOUTS_HORIZONTAL_TOOLBOX","METRICS_MANAGER","BLOCK_DRAGGER","draggingConnections","soup","soupLength","VAR_DELETE","VAR_RENAME","BLOCK_DRAG","SELECTED","MARKER_MOVE","TRASHCAN_OPEN","TOOLBOX_ITEM_SELECT","THEME_CHANGE","COMMENT_DELETE","COMMENT_CHANGE","CUSTOM","MUTATOR","WARNING","COMMENT_NODE","setLocale","locale","k","Abstract","toJson","isBlank","run","_forward","getEventWorkspace_","VarBase","AbstractEvent","opt_variable","varId","newEvent","VarCreate","varType","varName","deleteVariableById","opt_id","id_","var1","var2","CATEGORY_NAME","tx","ty","distance","disposed_","isComment","addTopComment","xy_","height_","width_","content_","fireCreateEvent","removeTopComment","getHeight","setHeight","setWidth","recordNew","getContent","setContent","xmlComment","info","parseAttributes","w","xmlX","xmlY","commentX","NaN","commentY","xmlH","xmlW","xmlId","UiBase","opt_workspaceId","Selected","opt_oldElementId","opt_newElementId","oldElementId","newElementId","TOUCH_ENABLED","rawUserAgent","isJavaFx","isWebKit","isGecko","isAndroid","isIPad","isIPhone","isMac","isTablet","isMobile","raw","rawUpper","maxTouchPoints","JavaFx","GECKO","ANDROID","IPHONE","MOBILE","other","ANIMATE","CLIPPATH","FECOMPOSITE","FECOMPONENTTRANSFER","FEFLOOD","FEFUNCA","FEGAUSSIANBLUR","FEPOINTLIGHT","FESPECULARLIGHTING","FILTER","FOREIGNOBJECT","G","IMAGE","LINE","PATH","PATTERN","POLYGON","RECT","TEXT","TSPAN","RESIZE_SIZE","BORDER_RADIUS","TEXTAREA_OFFSET","onMouseMoveWrapper","onMouseUpWrapper","eventsInit","deleteIconBorder","deleteGroup","resizeGroup","foreignObject","svgHandleTarget","svgRectTarget","textarea","autoLayout","focused","svgRect_","unselect","disposeInternal","opt_noSelect","pathMouseDown","updateMovable","getBubbleCanvas","getGesture","handleBubbleStart","showContextMenu","oldId","addSelect","removeSelect","blurFocus","setFocus","addFocus","removeFocus","moveDuringDrag","newLoc","translation","clearTransformAttributes","commentBounds","setDragging","adding","setDeleteStyle","setAutoLayout","_enable","createEditor","addResizeDom","addDeleteDom","setSize","resizeMouseDown","deleteMouseDown","deleteMouseOut","deleteMouseUp","TOP_OFFSET","unbindDragEvents","startDrag","resizeMouseUp","resizeMouseMove","newXY","moveDrag","resizeComment","topOffset","textOffset","blur","opt_wsWidth","wsWidth","DeserializationError","toDevString","childState","VARIABLES","PROCEDURES","BLOCKS","saveBlock","BlockSerializer","blockStates","BlockBase","opt_block","BlockCreate","FinishedLoading","opt_workspace","BlockChange","opt_element","opt_oldValue","opt_newValue","oldValue","setValue","oldState","getExtraBlockState_","JSON","stringify","BlockDelete","oldXml","wasShadow","oldJson","ConnectionType","INPUT_VALUE","OUTPUT_VALUE","NEXT_STATEMENT","PREVIOUS_STATEMENT","Connection","shadowDom","check","shadowState","sourceBlock_","connect_","parentBlock","disconnectInternal","orphan","stashShadowState","applyShadowState","setReason","setParent","orphanConnection","getConnectionForOrphanedConnection","onFailedConnect","setShadowStateInternal","unplug","_otherConnection","otherConnection","disconnect","getParentAndChildConnections","respawnShadow_","createShadowBlock","reconnect","connectionParent","currentParent","onCheckChanged_","setCheck","getCheck","returnCurrent","neighbours","_maxLimit","getParentInput","parentInput","serializeShadow","attemptToConnect","blockShadow","lastConnectionInStack","CAN_CONNECT","REASON_SELF_CONNECTION","REASON_WRONG_TYPE","REASON_TARGET_NULL","REASON_CHECKS_FAILED","REASON_DIFFERENT_WORKSPACES","REASON_SHADOW_PARENT","REASON_DRAG_CHECKS_FAILED","REASON_PREVIOUS_AND_OUTPUT","COLLAPSED_INPUT_NAME","COLLAPSED_FIELD_NAME","DuplicateIconType","getBoundsInfo","boundPosition","boundSize","clientTop","MarkerManager","cursorSvg_","cursor_","markers","Map","markerSvg_","registerMarker","marker","unregisterMarker","setDrawer","makeMarkerDrawer","setMarkerSvg","getDrawer","set","delete","getCursor","getMarker","setCursor","cursor","drawer","setCursorSvg","cursorSvg","getBlockCanvas","markerSvg","updateMarkers","keyboardAccessibilityMode","draw","markerIds","markerId","LOCAL_MARKER","Field","validator","DEFAULT_VALUE","constants_","mouseDownWrapper_","textContent_","textElement_","borderRect_","fieldGroup_","tooltip_","validator_","maxDisplayLength","enabled_","visible_","isDirty_","suffixField","prefixField","clickTarget_","EDITABLE","SERIALIZABLE","value_","size_","SKIP_SETUP","configure_","setValidator","setSourceBlock","getConstants","initView","updateEditable","bindEvents_","createBorderRect_","createTextElement_","FIELD_BORDER_RECT_RADIUS","FIELD_TEXT_BASELINE_CENTER","clickTarget","getClickTarget_","onMouseDown_","fieldElement","_doFullSerialization","legacyState","saveLegacyState","loadLegacyState","callingClass","isClickable","showEditor_","isCurrentlyEditable","setVisible","handler","getValidator","getBorderRect","getTextElement","getTextContent","applyColour","render_","nodeValue","getDisplayText_","updateSize_","showEditor","constants","xOffset","FIELD_BORDER_RECT_X_PADDING","totalWidth","totalHeight","FIELD_TEXT_HEIGHT","contentWidth","FIELD_TEXT_FONTSIZE","FIELD_TEXT_FONTWEIGHT","FIELD_TEXT_FONTFAMILY","FIELD_BORDER_RECT_HEIGHT","positionTextElement_","positionBorderRect_","halfHeight","FIELD_TEXT_BASELINE","getAbsoluteXY_","NBSP","getText_","markDirty","forceRerender","bumpNeighbours","classValidation","doClassValidation_","classValue","processValidation_","localValidation","localValue","doValueUpdate_","validatedValue","doValueInvalid_","_invalidValue","setStartField","newTip","getTooltip","referencesVariables","refreshVariableName","idx","fieldRows","getFlipRtl","isTabNavigable","onShortcut","_shortcut","updateMarkers_","Symbol","GRID","GRIDCELL","GROUP","LISTBOX","MENUITEMCHECKBOX","OPTION","PRESENTATION","ROW","TREE","TREEITEM","menuItems","onKeyDownHandler","mouseLeaveHandler","mouseEnterHandler","clickHandler","mouseOverHandler","highlightedItem","openingCoords","handleMouseOver","handleClick","handleMouseEnter","handleMouseLeave","handleKeyEvent","getElement","preventScroll","getMenuItem","menuElem","currentElement","setHighlighted","currentHighlighted","ACTIVEDESCENDANT","highlightNext","highlightHelper","highlightPrevious","highlightFirst","highlightLast","startIndex","delta","oldCoords","newCoords","performAction","shiftKey","metaKey","altKey","highlighted","scrollHeight","opt_value","rightToLeft","highlight","checked","checkable","checkbox","contentDom","DISABLED","setCheckable","setChecked","nameDep","menuGenerator","svgArrow","imageElement","selectedMenuItem","generatedOptions","trimmed","menuGenerator_","selectedOption","shouldAddBorderRect_","FIELD_DROPDOWN_SVG_ARROW","createSVGArrow_","createTextArrow_","FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW","ARROW_CHAR","FIELD_DROPDOWN_SVG_ARROW_SIZE","setAttributeNS","FIELD_DROPDOWN_SVG_ARROW_DATAURI","dropdownCreate","menuElement","FIELD_DROPDOWN_COLOURED_DIV","primaryColour","getColour","colourTertiary","dropdownDispose_","image","Image","handleMenuActionEvent","onItemSelected_","useCache","isValueValid","fill","colourSecondary","colourPrimary","renderSelectedImage","renderSelectedText","imageJson","imageHeight","imageWidth","hasBorder","FIELD_DROPDOWN_BORDER_RECT_HEIGHT","IMAGE_Y_PADDING","xPadding","arrowWidth","positionSVGArrow","textWidth","textPadding","FIELD_DROPDOWN_SVG_ARROW_PADDING","svgArrowSize","CHECKMARK_OVERHANG","MAX_MENU_HEIGHT_VH","IMAGE_Y_OFFSET","Icon","offsetInBlock","workspaceLocation","svgRoot","pointerdownListener","svgBlock","updateSvgRootOffset","getWeight","updateCollapsed","hideForInsertionMarker","isShownWhenCollapsed","setOffsetInBlock","onClick","opt_pair","opt_class","opt_margin","oldHostMetrics","ratio","origin","startDragHandle","handlePosition","handleLength","scrollbarLength","startDragMouse","containerVisible","isHandleVisible","onMouseMoveWrapper_","onMouseUpWrapper_","pair","DEFAULT_SCROLLBAR_MARGIN","outerSvg","svgBackground","svgHandle","setInitialThickness","lengthAttribute_","positionAttribute_","onMouseDownBarWrapper_","onMouseDownBar","onMouseDownHandleWrapper_","onMouseDownHandle","unsubscribe","constrainHandleLength","setHandleLength","newLength","constrainHandlePosition","setHandlePosition","newPosition","setScrollbarLength","newSize","setPosition","opt_metrics","hostMetrics","getMetrics","metricsAreEquivalent","resizeHorizontal","resizeVertical","updateMetrics","requiresViewResize","viewWidth","viewHeight","absoluteLeft","absoluteTop","resizeViewHorizontal","resizeContentHorizontal","viewSize","xCoordinate","scrollWidth","maxScrollDistance","maxHandleOffset","handleOffset","resizeViewVertical","resizeContentVertical","setContainerVisible","visibilityChanged","updateDisplay_","mouseXY","getInverseScreenCTM","mouseLocation","handleXY","handleStart","pageLength","onMouseUpHandle","onMouseMoveHandle","currentMouse","getRatio_","setOrigin","_a","Bubble","anchor","ownerRect","relativeLeft","relativeTop","embossGroup","embossFilterId","tail","background","BORDER_WIDTH","contentContainer","onMouseDown","setAnchorLocation","relayout","positionByRect","positionRelativeToAnchor","renderTail","setPositionRelativeToAnchor","MIN_SIZE","getViewMetrics","optimalLeft","getOptimalRelativeLeft","optimalTop","getOptimalRelativeTop","topPosition","MIN_BLOCK_HEIGHT","startPosition","endPosition","bottomPosition","closerPosition","fartherPosition","topPositionOverlap","getOverlap","startPositionOverlap","closerPositionOverlap","fartherPositionOverlap","mostOverlap","relativeMin","workspaceRect","getWorkspaceViewRect","bubbleRight","bubbleLeft","getScrollbarThickness","relBubbleX","relBubbleY","relAnchorX","relAnchorY","rise","hypotenuse","angle","acos","rightAngle","rightRise","rightRun","cos","thickness","TAIL_THICKNESS","backoffRatio","ANCHOR_RADIUS","baseX1","baseY1","baseX2","baseY2","radians","TAIL_ANGLE","swirlAngle","swirlRise","TAIL_BEND","swirlRun","bringToFront","lastChild","_start","DOUBLE_BORDER","Theme","opt_blockStyles","opt_categoryStyles","opt_componentStyles","startHats","blockStyles","categoryStyles","componentStyles","fontStyle","setBlockStyle","blockStyleName","blockStyle","setCategoryStyle","categoryStyleName","categoryStyle","getComponentStyle","componentName","recursiveStyle","setComponentStyle","styleValue","setFontStyle","setStartHats","defineTheme","themeObj","base","defaultBlockStyles","Classic","toolboxJsonDef","hasCollapse","hasComments","hasDisable","rawHasTrashcan","rawHasCollapse","rawHasComments","rawHasDisable","rawHasSounds","maxTrashcanContents","toolboxAtStart","toolboxPosition","endsWith","rawOneBasedIndex","modalInputs","oneBasedIndex","maxBlocks","maxInstances","parseMoveOptions_","hasScrollbars","parseGridOptions_","parseZoomOptions_","parseThemeOptions_","rendererOverrides","move","wheel","drag","zoom","maxScale","minScale","scaleSpeed","pinch","grid","spacing","snap","MiniWorkspaceBubble","workspaceOptions","validateWorkspaceOptions","svgDialog","miniWorkspace","newWorkspaceSvg","getCanvas","onWorkspaceChange","updateBubbleSize","addWorkspaceChangeListener","listener","bumpBlocksIntoBounds","MARGIN","currSize","calculateWorkspaceSize","MINIMUM_VIEW_CHANGE","recordDragTargets","workspaceSize","canvas","getBBox","flyoutScrollMetrics","updateBlockStyles","setStyle","getStyleName","flyoutWs","SIZE","WORKSPACE_MARGIN","flyoutBlockTypes","updateWorkspacePid","rootBlock","miniWorkspaceBubble","WEIGHT","getAnchorLocation","getMiniWorkspaceConfig","getBubbleOwnerRect","createRootBlock","addSaveConnectionsListener","createMiniWorkspaceChangeListener","midIcon","flyoutWidth","saveConnections","saveConnectionsListener","isIgnorableMutatorEvent","recomposeSourceBlock","oldExtraState","newExtraState","connectionChild","findParentWs","getRootWorkspace","FieldLabel","textClass","class","setClass","cssClass","Input","align","Align","appendField","insertFieldAt","removeField","opt_quiet","renderList","renderedConnection","startTrackingAll","stopTrackingAll","setAlign","makeConnection","makeConnection_","CENTRE","WIN_KEY_FF_LINUX","MAC_ENTER","TAB","NUM_CENTER","ENTER","PAUSE","CAPS_LOCK","SPACE","PAGE_UP","PAGE_DOWN","END","HOME","DOWN","PLUS_SIGN","PRINT_SCREEN","INSERT","ZERO","ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","FF_SEMICOLON","FF_EQUALS","FF_DASH","FF_HASH","QUESTION_MARK","AT_SIGN","A","B","D","E","F","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","W","WIN_KEY_RIGHT","CONTEXT_MENU","NUM_ZERO","NUM_ONE","NUM_TWO","NUM_THREE","NUM_FOUR","NUM_FIVE","NUM_SIX","NUM_SEVEN","NUM_EIGHT","NUM_NINE","NUM_MULTIPLY","NUM_PLUS","NUM_MINUS","NUM_PERIOD","NUM_DIVISION","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","NUMLOCK","SCROLL_LOCK","FIRST_MEDIA_KEY","LAST_MEDIA_KEY","SEMICOLON","DASH","EQUALS","COMMA","PERIOD","SLASH","APOSTROPHE","TILDE","SINGLE_QUOTE","OPEN_SQUARE_BRACKET","BACKSLASH","CLOSE_SQUARE_BRACKET","WIN_KEY","MAC_FF_META","MAC_WK_CMD_LEFT","MAC_WK_CMD_RIGHT","WIN_IME","VK_NONAME","PHANTOM","aria","arrayUtils","browserEvents","deprecation","extensions","idGenerator","math","parsing","stringUtils","svgMath","svgPaths","userAgent","TextBubble","paragraph","stringToSvg","setText","createParagraph","spans","createSpans","rightAlignSpans","tspan","maxWidth","TextInputBubble","resizePointerMoveListener","resizePointerUpListener","textChangeListeners","sizeChangeListeners","inputRoot","textArea","createResizeHandle","onTextChange","addTextChangeListener","addSizeChangeListener","bindTextAreaEvents","onStartEdit","onResizePointerDown","widthMinusBorder","heightMinusBorder","onSizeChange","onResizePointerUp","onResizePointerMove","DEFAULT_BUBBLE_WIDTH","DEFAULT_BUBBLE_HEIGHT","textBubble","textInputBubble","bubbleSize","bubbleVisiblity","anchorLocation","showEditableBubble","showNonEditableBubble","hideBubble","DummyInput","ValueInput","Block","hue_","colour_","styleName_","suppressPrefixSuffix","contextMenu","parentBlock_","childBlocks_","editable_","movable_","deletable_","collapsed_","isShadow_","outputShape_","isInsertionMarker_","disposing","onchangeWrapper_","statementInputCount","setBlockById","isInMutator","assign","addTopBlock","addTypedBlock","doInit_","onchange","setOnChange","healStack","removeChangeListener","removeTopBlock","removeTypedBlock","removeBlockById","destroy","opt_healStack","unplugFromRow_","unplugFromStack_","thisConnection","getOnlyValueConnection_","previousTarget","nextTarget","_all","myConnections","ignoreShadows","getInputWithBlock","getSurroundParent","prevBlock","getPreviousBlock","getFirstStatementConnection","getTopStackBlock","previous","ordered","childBlocks","hasBlockLimits","setInsertionMarker","insertionMarker","getMatchingConnection","otherBlock","connections","otherConnections","setHelpUrl","getHue","parsed","onchangeFn","getVars","vars","updateVarName","renameVarById","newId","setFieldValue","setPreviousStatement","newBoolean","opt_check","setNextStatement","setOutput","setOutputShape","outputShape","getOutputShape","ancestor","opt_maxLength","opt_emptyToken","toTokens","prev","acc","curr","emptyToken","checks","shouldAddParens","appendValueInput","appendInput","appendStatementInput","appendDummyInput","appendInputFromRegistry","inputConstructor","warningPrefix","hat","jsonInitStyle_","jsonInitColour_","interpolate_","localizedText","localizedValue","extensionNames","styleError","opt_disableCheck","overwrites","lastDummyAlign","validateTokens_","elements","interpolateArguments_","fieldStack","isInputKeyword_","inputFromJson_","fieldFromJson_","argsCount","visitedArgsHash","visitedArgsCount","token","stringToFieldJson_","dummyInput","alignmentLookup","alignment","moveInputBefore","refName","inputIndex","refIndex","moveNumberedInputBefore","RangeError","removeInput","getInputTargetBlock","oldText","removeIcon","setWarningText","_text","_opt_id","_mutator","find","allInputsFilled","opt_shadowBlocksAreFilled","BlockDrag","opt_isStart","opt_blocks","isStart","bumpIntoBounds","WeakSet","Capability","name_","POSITIONABLE","DRAG_TARGET","DELETE_AREA","AUTOHIDEABLE","ComponentManager","componentData","capabilityToComponentIds","addComponent","componentInfo","component","capabilities","stringCapabilities","capability","removeComponent","addCapability","getComponent","hasCapability","removeCapability","getComponents","sorted","componentIds","components","componentDataList","componentDatum","DEFAULT_SNAP_RADIUS","dragRadius","flyoutDragRadius","connectingSnapRadius","currentConnectionPreference","bumpDelay","DUPLICATE_BLOCK_ERROR","InsertionMarkerManager","activeCandidate","lastMarker","lastOnStack","wouldDeleteBlock","fadedBlock","highlightedBlock","markerConnection","firstMarker","createMarkerBlock","availableConnections","initAvailableConnections","disposeInsertionMarker","updateAvailableConnections","wouldConnectBlock","applyConnections","hidePreview","local","closest","inferiorConnection","then","update","dxy","dragTarget","newCandidate","getCandidate","shouldDelete","shouldUpdatePreviews","maybeHidePreview","maybeShowPreview","imType","sourceInput","resultInput","sourceField","resultField","available","activeLocal","activeClosest","xDiff","yDiff","curDistance","getStartRadius","candidate","myConnection","neighbour","getComponentManager","componentManager","isDeleteArea","wouldDelete","log","showPreview","getConnectionPreviewMethod","method","PREVIEW_TYPE","INPUT_OUTLINE","showInsertionInputOutline","INSERTION_MARKER","showInsertionMarker","REPLACEMENT_FADE","showReplacementFade","shouldHighlightConnection","localChanged","unhighlight","hideReplacementFade","hideInsertionInputOutline","hideInsertionMarker","isLastInStack","imConn","positionNearConnection","markerConn","imBlock","markerOutput","markerPrev","highlightShapeForInput","fadeForReplacement","getInsertionMarkers","PreviewType","BlockDragger","dragTarget_","wouldDeleteBlock_","draggingBlock_","draggedConnectionManager_","workspace_","startXY_","dragIconData_","currentDragDeltaXY","fireDragStartEvent_","shouldDisconnect_","disconnectBlock_","pixelsToWorkspaceUnits_","dragIcons_","oldDragTarget","getDragTarget","oldWouldDeleteBlock","updateCursorDuringBlockDrag_","onDragExit","onDragEnter","onDragOver","endDrag","fireDragEndEvent_","shouldPreventMove","getNewLocationAfterDrag_","newValues","onDrop","maybeDeleteBlock_","deleted","updateBlockAfterMove_","newLocation","fireMoveEvent_","scheduleSnapAndBump","updateToolboxStyle_","isEnd","removeStyle","addStyle","oldCoordinate","pixelCoord","registry_","reset","getContextMenuOptions","menuOptions","precondition","menuOption","COLLAPSE_CHARS","DRAG_STACK","OPPOSITE_TYPE","RENAME_VARIABLE_ID","DELETE_VARIABLE_ID","ASTNode","opt_params","wsCoordinate","isConnectionLocation","isConnectionType","processParams","getLocation","getWsCoordinate","isConnection","findNextForInput","curIdx","NAVIGATE_ALL_FIELDS","createFieldNode","createInputNode","findNextForField","fieldIdx","newInput","findPrevForInput","findPrevForField","navigateBetweenStacks","curLocation","curLocationAsBlock","curRoot","resultIndex","createStackNode","findTopASTNodeForBlock","createConnectionNode","createBlockNode","getOutAstNodeForBlock","findFirstFieldOrInput","STACK","OUTPUT","PREVIOUS","NEXT","in","out","blockPos","DEFAULT_OFFSET_Y","createWorkspaceNode","createTopNode","astNode","Marker","curNode","getCurNode","setCurNode","oldNode","Cursor","BasicCursor","getNextNode_","validNode_","getPreviousNode_","isValid","siblingOrParent","findSiblingOrParent","getRightMostChild","nextNode","registrationName","TabNavigateCursor","BUMP_RANDOMNESS","RenderedConnection","highlightPath","db","connectionDBList","dbOpposite","trackedState","TrackedState","WILL_TRACK","TRACKED","removeConnection","distanceFrom","bumpAwayFrom","staticConnection","updated","addConnection","blockTL","getOffsetInBlock","tighten","moveConnections","tightenEfficiently","maxLimit","searchForClosest","renderConstants","shapeFor","yLen","TAB_OFFSET_FROM_TOP","pathDown","xLen","NOTCH_OFFSET_LEFT","CORNER_RADIUS","pathLeft","setTracking","doTracking","UNTRACKED","getNeighbours","parentRendered","childRendered","WarningIcon","textMap","addMessage","warningTextDb","mutator","eventsInit_","renderIsInProgress_","visuallyDisabled","bumpNeighboursPid","svgGroup_","getBlockStyle","pathObject","makePathObject","svgPath","createIconPointerDownListener","getColourSecondary","getColourTertiary","oldParent","isClearing","oldXY","eventsEnabled","curXY","clearTransformAttributes_","snapToGrid","getGrid","shouldSnap","getSpacing","half","blockBounds","updateCollapsed_","collapsedInputName","collapsedFieldName","tab","tabCursor","currentNode","nextField","handleBlockStart","open","generateContextMenu","customContextMenu","INSERTION_MARKER_COLOUR","updateInsertionMarker","animate","n","getCommentIcon","timeout","collapsedParent","COLLAPSED_WARNING_ID","setStartIcon","removed","updateHighlighted","updateSelected","updateDraggingDelete","styleObj","getBlockStyleForColour","track","all","oldGroup","bumpNeighboursInternal","sourceConnection","opt_bubble","updateConnectionAndIconLocations","tightenChildrenEfficiently","nextHeightWidth","tabHeight","NOTCH_HEIGHT","updateReplacementFade","updateShapeForInputHighlight","INLINE","anchorXY","bubbleWidth","bubbleHeight","bubbleBack","bubbleArrow","bubbleGroup","onMouseDownResizeWrapper","onMouseDownBubbleWrapper","moveCallback","resizeCallback","shape_","ARROW_ANGLE","arrowRadians","positionBubble","renderArrow","hasResize","bubbleEmboss","bubbleMouseDown","setSvgId","promote","bubbleMouseUp","registerResizeEvent","registerMoveEvent","layoutBubble","workspaceRight","workspaceLeft","bubbleTop","bubbleBottom","workspaceTop","workspaceBottom","doubleBorderWidth","ARROW_THICKNESS","ARROW_BEND","hexColour","tspanElement","createNonEditableBubble","paragraphElement","iconXY","bubble","BubbleDragger","wouldDeleteBubble_","startBubbleDrag","dragBubble","oldWouldDeleteBubble","shouldDelete_","updateCursorDuringBubbleDrag_","endBubbleDrag","setOldCoordinate","ConnectionChecker","opt_distance","safety","doSafetyChecks","doTypeChecks","doDragChecks","errorCode","superiorBlock","inferiorBlock","superiorConnection","checkArrayOne","checkArrayTwo","canConnectToPrevious_","ConnectionDB","yPos","calculateIndexForYPos","findIndexOfConnection","bestGuess","pointer","pointerMin","pointerMax","pointerMid","maxRadius","checkConnection","yIndex","currentX","currentY","isInYRange","baseY","baseX","closestIndex","bestConnection","bestRadius","dbList","BlockMove","currentLocation_","oldParentId","parentId","oldInputName","coordinate","blockConnection","connectionType","BubbleOpen","opt_isOpen","opt_bubbleType","BubbleType","Click","opt_targetType","targetType","ClickTarget","ZOOM_CONTROLS","CommentBase","opt_comment","CommentCreateDeleteHelper","CommentChange","opt_oldContents","opt_newContents","oldContents_","newContents_","CommentCreate","CommentDelete","CommentMove","comment_","oldCoordinate_","newCoordinate_","current","MarkerMove","isCursor","opt_oldNode","opt_newNode","ThemeChange","opt_themeName","themeName","ToolboxItemSelect","opt_oldItem","opt_newItem","oldItem","newItem","TrashcanOpen","VarDelete","VarRename","ViewportChange","opt_top","opt_left","opt_scale","opt_oldScale","ConstantProvider","NO_PADDING","SMALL_PADDING","MEDIUM_PADDING","MEDIUM_LARGE_PADDING","LARGE_PADDING","TAB_HEIGHT","TAB_VERTICAL_OVERLAP","TAB_WIDTH","NOTCH_WIDTH","MIN_BLOCK_WIDTH","EMPTY_BLOCK_SPACER_HEIGHT","STATEMENT_BOTTOM_SPACER","STATEMENT_INPUT_PADDING_LEFT","BETWEEN_STATEMENT_PADDING_Y","ADD_START_HATS","START_HAT_HEIGHT","START_HAT_WIDTH","SPACER_DEFAULT_HEIGHT","EMPTY_INLINE_INPUT_PADDING","EXTERNAL_VALUE_INPUT_PADDING","JAGGED_TEETH_HEIGHT","JAGGED_TEETH_WIDTH","FIELD_BORDER_RECT_Y_PADDING","FIELD_BORDER_RECT_COLOUR","FIELD_COLOUR_FULL_BLOCK","FIELD_TEXTINPUT_BOX_SHADOW","FIELD_COLOUR_DEFAULT_WIDTH","embossFilter","disabledPatternId","disabledPattern","debugFilterId","debugFilter","CURSOR_COLOUR","MARKER_COLOUR","CURSOR_WS_WIDTH","WS_CURSOR_HEIGHT","CURSOR_STACK_PADDING","CURSOR_BLOCK_PADDING","CURSOR_STROKE_WIDTH","FULL_BLOCK_FIELDS","INSERTION_MARKER_OPACITY","SHAPES","PUZZLE","NOTCH","TALL_INPUT_FIELD_OFFSET_Y","DUMMY_INPUT_SHADOW_MIN_HEIGHT","DUMMY_INPUT_MIN_HEIGHT","STATEMENT_INPUT_NOTCH_OFFSET","TOP_ROW_MIN_HEIGHT","TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT","BOTTOM_ROW_MIN_HEIGHT","BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT","EMPTY_INLINE_INPUT_HEIGHT","EMPTY_STATEMENT_INPUT_HEIGHT","START_POINT","FIELD_COLOUR_DEFAULT_HEIGHT","FIELD_CHECKBOX_X_OFFSET","randomIdentifier","JAGGED_TEETH","makeJaggedTeeth","makeNotch","START_HAT","makeStartHat","PUZZLE_TAB","makePuzzleTab","INSIDE_CORNERS","makeInsideCorners","OUTSIDE_CORNERS","makeOutsideCorners","setTheme","validatedBlockStyle_","setDynamicProperties_","setFontConstants_","setComponentConstants_","fontMetrics","createBlockStyle_","valid","parsedColour","generateSecondaryColour_","generateTertiaryColour_","inputColour","mainPath","path","makeMainPath","up","back","control1Y","overlap","control2Y","endPoint1","endPoint2","pathUp","dir","outerWidth","innerWidth","pathRight","innerTopLeftCorner","innerBottomLeftCorner","pathTop","pathBottom","topLeft","topRight","bottomLeft","bottomRight","rightHeight","selector","injectCSS_","feSpecularLighting","createDebugFilter","debugComponentTransfer","cssArray","getCSS_","cssNodeId","BaseConstantProvider","GRID_UNIT","CURSOR_RADIUS","HEXAGONAL","ROUND","SQUARE","SHAPE_IN_SHAPE_PADDING","SELECTED_GLOW_COLOUR","SELECTED_GLOW_SIZE","REPLACEMENT_GLOW_COLOUR","REPLACEMENT_GLOW_SIZE","selectedGlowFilterId","selectedGlowFilter","replacementGlowFilterId","SQUARED","ROUNDED","replacementGlowFilter","STATEMENT_INPUT_SPACER_MIN_WIDTH","MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH","makeHexagonal","makeRounded","makeSquared","rightWidth","selectedGlowSize","replacementGlowSize","connectionOffsetY","connectionHeight","connectionOffsetX","connectionWidth","pathRightDown","pathRightUp","blockHeight","remainingHeight","maxHeight","innerHeight","_height","curveWidth","quarterHeight","innerTopRightCorner","innerBottomRightCorner","pathTopRight","pathBottomRight","selectedComponentTransfer","replacementComponentTransfer","TypesContainer","NONE","HAT","SPACER","BETWEEN_ROW_SPACER","IN_ROW_SPACER","EXTERNAL_VALUE_INPUT","INLINE_INPUT","STATEMENT_INPUT","CONNECTION","PREVIOUS_CONNECTION","NEXT_CONNECTION","OUTPUT_CONNECTION","CORNER","LEFT_SQUARE_CORNER","LEFT_ROUND_CORNER","RIGHT_SQUARE_CORNER","RIGHT_ROUND_CORNER","JAGGED_EDGE","TOP_ROW","BOTTOM_ROW","INPUT_ROW","LEFT_CORNER","RIGHT_CORNER","nextTypeValue_","hasOwnProperty","isField","isHat","isIcon","isSpacer","isInRowSpacer","isInput","isExternalInput","isInlineInput","isStatementInput","isPreviousConnection","isNextConnection","isPreviousOrNextConnection","isLeftRoundedCorner","isRightRoundedCorner","isLeftSquareCorner","isRightSquareCorner","isCorner","isJaggedEdge","isRow","row","isBetweenRowSpacer","isTopRow","isBottomRow","isTopOrBottomRow","isInputRow","Types","Measurable","centerline","xPos","notchOffset","connectionModel","Drawer","inlinePath_","outlinePath_","block_","info_","topLeft_","drawOutline_","drawInternals_","setPath","flipRTL","recordSizeOnBlock_","hideHiddenIcons_","widthWithChildren","drawTop_","rows","hasJaggedEdge","drawJaggedEdge_","hasStatement","drawStatementInput_","hasExternalInput","drawValueInput_","drawRightSideRow_","drawBottom_","drawLeft_","topRow","positionPreviousConnection_","startY","getLastInput","positionExternalValueConnection_","positionStatementInputConnection_","bottomRow","elems","positionNextConnection_","rightCornerYOffset","outlinePath","positionOutputConnection_","tabBottom","drawInlineInput_","layoutField_","fieldInfo","flipRtl","connectionTop","connectionBottom","positionInlineInputConnection_","connX","statementEdge","connInfo","startX","BaseDrawer","beginDrawing","outputShapeType","endDrawing","hasStatementInput","hasNextConnection","drawFlatTop_","drawRightDynamicConnection_","drawFlatBottom_","drawLeftDynamicConnection_","precedesStatement","followsStatement","insideCorners","cornerHeight","bottomRightPath","verticalPath","topRightPath","connectedBlock","setOutlinePath","connectedBottomNextConnection","FieldImage","altText","Y_PADDING","setAlt","setOnClickHandler","FieldInput","spellcheck_","htmlInput_","isTextValid_","isBeingEdited_","onKeyInputWrapper_","onKeyDownWrapper_","fullBlockClickTarget_","spellcheck","nFields","nConnections","resizeEditor_","htmlInput","INVALID","setSpellcheck","quietInput","showPromptEditor_","showInlineEditor_","getValueFromEditorText_","widgetDispose_","widgetCreate_","getScale","borderRadius","BORDERRADIUS","strokeColour","border","boxShadow","getEditorText_","bindInputEvents_","onFinishEditing_","unbindInputEvents_","_value","onHtmlInputKeyDown_","onHtmlInputChange_","setEditorValue_","FieldTextInput","Row","widthWithConnectedBlocks","minWidth","minHeight","hasDummyInput","hasInlineInput","measure","startsWithElemSpacer","endsWithElemSpacer","getFirstSpacer","getLastSpacer","BottomRow","descenderHeight","hasLeftSquareCorner","hasRightSquareCorner","_block","InputConnection","connectedBlockWidth","connectedBlockHeight","ExternalValueInput","Hat","ascenderHeight","InRowSpacer","InlineInput","InputRow","connectedBlockWidths","JaggedEdge","NextConnection","OutputConnection","PreviousConnection","RoundCorner","opt_position","SpacerRow","SquareCorner","TopRow","capline","hasPreviousConnection","hasHat","RenderInfo","inputRows","renderer_","isInline","createRows_","addElemSpacing_","addRowSpacing_","computeBounds_","alignRowElements_","finalize_","populateTopRow_","activeRow","iconInfo","lastInput","shouldStartNewRow_","addInput_","populateBottomRow_","hasPrevious","cornerClass","leftSquareCorner","rightSquareCorner","StatementInputMeasurable","oldElems","getInRowSpacing_","widestStatementRowFields","blockWidth","widestRowWithConnectedBlocks","statementInput","alignStatementRow_","currentWidth","missingSpace","getDesiredRowWidth_","desiredWidth","addAlignmentPadding_","_row","firstSpacer","lastSpacer","oldRows","makeSpacerRow_","getSpacerRowHeight_","getSpacerRowWidth_","spacer","_prev","_next","getElemCenterline_","recordElemPositions_","xCursor","yCursor","BaseBottomRow","BaseStatementInput","RightConnectionShape","BaseTopRow","BaseRenderInfo","isMultiRow","rightSide","rightAlignedDummyInputs","WeakMap","adjustXPosition_","alignmentDivider","notchTotalWidth","minXPos","prevSpacer","nextSpacer","hasPrevNotch","hasNextNotch","prevInRowSpacer","finalizeOutputConnection_","outputConnectionShape","rightConnectionWidth","finalizeHorizontalAlignment_","totalNegativeSpacing","lastElem","leftNegPadding","getNegativeSpacing_","firstElem","rightNegPadding","minBlockWidth","outerShape","innerShape","finalizeVerticalAlignment_","firstRow","hasSingleTextOrImageField","hasNonShadowConnectedBlocks","minVerticalTightNestingHeight","CURSOR_CLASS","MARKER_CLASS","HEIGHT_MULTIPLIER","MarkerSvg","markerSvgRect_","markerSvgLine_","markerInput_","markerBlock_","currentMarkerSvg","defaultColour","createDomInternal_","setParent_","applyColour_","showAtLocation_","fireMarkerEvent","beginElement","curNodeAsConnection","showWithBlock_","showWithOutput_","showWithInput_","showWithNext_","showWithPrevious_","showWithField_","showWithCoordinates_","showWithStack_","showWithBlockPrevOutput","markerHeight","markerOffset","connectionShape","positionPrevious_","positionOutput_","positionBlock_","showCurrent_","positionLine_","positionRect_","positionInput_","heightWidth","yPadding","markerPath","curBlock","getBlinkProperties_","blinkProperties","attributeName","_curNode","firstElementChild","BaseMarkerSvg","markerCircle","showWithInputOutput","positionCircle","PathObject","pathString","updateShadow_","updateDisabled_","setClass_","_conn","BasePathObject","svgPathSelected","outlines","remainingOutlines","outline","getOutlinePath","removeOutlinePath","Renderer","overrides","makeConstants_","refreshDom","previousConstants","makeRenderInfo_","makeDrawer_","orphanCanConnectAtEnd","localType","BaseRenderer","DragTarget","_dragElement","getClientRect","DeleteArea","wouldDelete_","couldConnect","couldDeleteBlock","updateWouldDelete_","FieldAngle","clockwise","CLOCKWISE","OFFSET","WRAP","boundEvents","symbol_","gauge","mode","Mode","COMPASS","PROTRACTOR","updateGraph","editor","dropdownDispose","HALF","circle","RADIUS","onMouseMove_","ownerSVGElement","displayMouseOrKeyboardValue","wrapValue","x2","y2","clockwiseFlag","angle1","x1","y1","largeFlag","multiplier","isFinite","FieldCheckbox","checkChar","CHECK_CHAR","checkCharacter","getValueBoolean","setCheckCharacter","character","convertValueToBool_","FieldColour","highlightedIndex","picker","titles","colours","columns","colourOptions","colourTitles","setColours","setColumns","cell","handled","moveHighlightBy","getHighlighted","COLOURS","COLUMNS","setHighlightedCell","onMouseEnter","onMouseLeave","cellId","TITLES","selectedColour","table","EXPANDED","ROWCOUNT","COLCOUNT","title","FieldLabelSerializable","FieldMultilineInput","textGroup","maxLines_","isOverflowedY_","maxLines","setMaxLines","textLines","displayLinesNumber","currentChild","lineHeight","nodes","actualEditorLines","dummyTextElement","lineWidth","paddingX","paddingY","padding","getMaxLines","FieldNumber","precision","min_","max_","precision_","decimalPlaces","setConstraints","setMinInternal","setMaxInternal","setPrecisionInternal","setMin","getMin","setMax","getMax","setPrecision","precisionString","toLocaleString","maximumFractionDigits","decimalIndex","getPrecision","toFixed","VALUEMIN","VALUEMAX","FieldVariable","variableTypes","defaultType","defaultVariableName","variableName","variableType","typeIsAllowed","typeList","getVariableTypes","isInArray","FlyoutButton","isLabel_","svgText","callbackKey","TEXT_MARGIN_X","TEXT_MARGIN_Y","updateTransform","onMouseUp","isLabel","getButtonText","cancel","getButtonCallback","MetricsManager","getDimensionsPx_","getFlyoutMetrics","opt_own","flyoutDimensions","getToolboxMetrics","toolboxDimensions","getSvgMetrics","getAbsoluteMetrics","flyoutMetrics","doesToolboxExist","doesFlyoutExist","atLeft","atTop","opt_getWorkspaceCoordinates","svgMetrics","getContentMetrics","blockBox","isMovableHorizontally","isMovableVertically","getComputedFixedEdges_","opt_viewMetrics","hScrollEnabled","vScrollEnabled","edges","getPaddedContent_","contentMetrics","contentBottom","contentRight","halfWidth","opt_contentMetrics","fixedEdges","paddedContent","getUiMetrics","scrollMetrics","contentHeight","contentTop","contentLeft","svgHeight","svgWidth","toolboxWidth","toolboxHeight","flyoutHeight","FlyoutMetricsManager","flyout_","getBoundingBox_","blockBoundingBox","addHorizontal","addVertical","oldHostMetrics_","corner_","vScroll","hScroll","isPair","resizeH","resizeV","maybeFireViewportChangeEvent","xyRatio","setX","setY","resizeContent","resizeView","WorkspaceDragger","horizontalScrollEnabled_","verticalScrollEnabled_","startScrollXY_","scroll","ZOOM_IN_MULTIPLIER","ZOOM_OUT_MULTIPLIER","creatorWorkspace","mouseDownXY","startWorkspace_","startIcon","startField","startBubble","hasExceededDragRadius","workspaceDragger","blockDragger","bubbleDragger","isMultiTouch_","isEnding_","gestureHasStarted","calledUpdateIsDragging","cachedPoints","startDistance","previousScale","currentDropdownOwner","isPinchZoomEnabled","mostRecentEvent","clearGesture","updateFromEvent","currentXY","updateDragDelta","changed","updateIsDragging","currentDragDelta","limitRadius","updateIsDraggingFromFlyout","isBlockCreatable","isScrollable","isDragTowardWorkspace","updateScreenCalculationsIfScrolled","createBlock","updateIsDraggingBubble","startDraggingBubble","updateIsDraggingBlock","startDraggingBlock","updateIsDraggingWorkspace","wsMovable","isDraggable","BlockDraggerClass","doStart","pointerType","handleTouchStart","handleMove","handleUp","isMultiTouch","handleTouchMove","handleTouchEnd","isBubbleClick","doBubbleClick","isFieldClick","doFieldClick","isIconClick","doIconClick","isBlockClick","doBlockClick","isWorkspaceClick","doWorkspaceClick","getTouchPoint","pointers","point0","point1","handlePinch","moveDistance","gestureScale","bringBlockToFront","handleWsStart","setStartWorkspace","fireWorkspaceClick","handleFlyoutStart","setStartFlyout","setStartBlock","setStartBubble","autoClose","setTargetBlock","hasStartBubble","hasStartBlock","fieldClickable","hasStarted","getCurrentDragger","currentGesture_","pattern","line2","line1","getPatternId","safeSpacing","end","setLineAttributes","reservedWordsList","opt_variablePrefix","dbReverse","variableMap","variablePrefix","reservedWords","setVariableMap","getNameForUserVariable","populateVariables","NameType","VARIABLE","nameOrId","normalizedName","DEVELOPER_VARIABLE","typeDb","safeName","getDistinctName","getUserNames","userNames","encodeURI","name1","name2","PROCEDURE","DEVELOPER_VARIABLE_TYPE","ObservableProcedureMap","existed","exceptions","ThemeManager","subscribedWorkspaces_","componentDB","prevTheme","oldClassName","newClassName","refreshTheme","componentList","propertyName","setProperty","subscribeWorkspace","unsubscribeWorkspace","onCreateVariableButtonClick_String","onCreateVariableButtonClick_Number","onCreateVariableButtonClick_Colour","VariableMap","deleteVariable","conflictVar","renameVariableWithConflict_","renameVariableAndUses_","variableId","tempVar","uses","getVariableUsesById","procedureName","deleteText","confirmText","deleteVariableInternal","list","flat","Workspace","internalIsFlyout","internalIsMutator","MAX_UNDO","topComments","commentDB","listeners","undoStack_","redoStack_","blockDB","typedBlocksDB","procedureMap","connectionCheckerClass","sortObjects_","SCAN_ANGLE","aXY","bXY","filtered","remainingCapacity","remainingCapacityOfType","maxInstanceOfType","copyableBlocksCount","redo","inputStack","outputStack","inputEvent","clearUndo","createPotentialVariableMap","outerWs","getById","getAll","SOUND_LIMIT","WorkspaceAudio","sounds","lastSound_","filenames","audioTest","filename","ext","canPlayType","sound","volume","playPromise","pause","catch","opt_volume","now","mySound","SPRITE","ZoomControls","zoomResetGroup","zoomOutGroup","zoomInGroup","HEIGHT","WIDTH","SMALL_SPACING","LARGE_SPACING","MARGIN_HORIZONTAL","MARGIN_VERTICAL","initialized","createZoomOutSvg","createZoomInSvg","createZoomResetSvg","cornerPosition","positionRect","zoomInTranslateY","zoomOutTranslateY","clip","zoomoutSvg","zoominSvg","amount","zoomCenter","fireZoomEvent","zoomresetSvg","resetZoom","beginCanvasTransition","scrollCenter","endCanvasTransition","uiEvent","ZOOM_TO_FIT_MARGIN","resizeHandlerWrapper","resizesEnabled","isVisible_","startScrollY","startScrollX","dragDeltaXY","oldLeft","oldTop","inverseScreenCTM","configureContextMenu","lastRecordedPageScroll","toolbox_","inverseScreenCTMDirty","highlightedBlocks","toolboxCategoryCallbacks","flyoutButtonCallbacks","cachedParentSvg","topBoundedElements","dragTargetAreas","MetricsManagerClass","setTopLevelWorkspaceMetrics_","audioManager","markerManager","Variables","registerToolboxCategoryCallback","VariablesDynamic","Procedures","themeManager_","cachedParentSvgSize","getMarkerManager","setMetricsManager","updateBlockStyles_","refreshToolboxSelection","ctm","svgBlockCanvas_","opt_backgroundClass","svgBackground_","svgBubbleCanvas_","onMouseWheel_","ToolboxClass","CursorClass","parentSvg","newTrashcan","svgTrashcan","_workspace","svgZoomControls","HorizontalFlyout","VerticalFlyout","updateScreenCalculations_","positionables","positionable","currScroll","imList","highlightBlock","opt_state","pasteBlock_","pasteWorkspaceComment_","jsonBlock","collide","allBlocks","otherXY","refreshSelection","dragTargets","targetArea","clientRect","canWheelZoom","canWheelMove","scrollDelta","commandKey","PIXELS_PER_ZOOM_STEP","topElements","boundary","topElement","blockBoundary","cursorY","scaleChange","newScale","getCTM","center","f","setScale","zoomToFit","workspaceWidth","workspaceHeight","blocksBox","doubleMargin","blocksWidth","blocksHeight","ratioX","ratioY","centerOnBlock","blockOnly","pixelX","pixelY","reflow","maxYScroll","maxYDisplacement","maxXDisplacement","addTopBoundedElement","removeTopBoundedElement","reenabled","removeButtonCallback","getToolboxCategoryCallback","removeToolboxCategoryCallback","onlyClosePopups","autoHideables","autoHideable","autoHide","FlyoutItemType","BUTTON","Flyout","filterWrapper","reflowWrapper","mats","buttons_","permanentlyDisabled","recycledBlocks","SCROLLBAR_MARGIN","dragAngleRange_","setMetrics_","toolboxPosition_","tabWidth_","rectMap_","GAP_X","GAP_Y","wheel_","filterForCapacity","getFlyoutScale","updateDisplay","positionAt_","listen","clearOldBlocks","getDynamicCategoryContents","parsedContent","flyoutInfo","createFlyoutInfo","layout_","gaps","emptyRecycledBlocks","defaultGap","categoryName","parsedDynamicContent","dynamicContents","dynamicGaps","blockInfo","createFlyoutBlock","addBlockGap","addSeparatorGap","createButton","fnToApply","btnInfo","curButton","getRecycledBlock","blockType","gap","sepInfo","newGap","oldBlocks","blockIsRecyclable_","recycleBlock","addBlockListeners_","blockMouseDown","originalBlock","placeNewBlock","initFlyoutButton_","buttonSvg","createRect_","blockHW","moveRectToBlock_","reflowInternal_","oldBlock","svgRootOld","positionNewBlock","flyoutOffsetPixels","oldBlockPos","oldBlockOffsetPixels","getX","getY","targetWorkspaceViewMetrics","setBackgroundPath","cursorX","moveX","dragDirection","atan2","range","flyoutRect","BIG_NUM","buttons","atRight","oldX","newX","registryName","CodeGenerator","forBlock","FUNCTION_NAME_PLACEHOLDER_","STATEMENT_SUFFIX","STATEMENT_PREFIX","INFINITE_LOOP_TRAP","INDENT","COMMENT_WRAP","ORDER_OVERRIDES","isInitialized","RESERVED_WORDS_","definitions_","functionNames_","nameDB_","FUNCTION_NAME_PLACEHOLDER_REGEXP_","RegExp","workspaceToCode","code","blockToCode","scrubNakedValue","injectId","codeString","finish","prefixLines","allNestedComments","opt_thisOnly","scrub_","SyntaxError","valueToCode","outerOrder","innerOrder","parensNeeded","outerOrderClass","innerOrderClass","statementToCode","addLoopTrap","branch","addReservedWords","provideFunction_","desiredName","functionName","codeText","oldCodeText","_opt_thisOnly","shortcuts","keyMap","shortcut","registeredShortcut","addKeyMapping","allowCollision","shortcutName","removeAllKeyMappings","keyCode","opt_allowCollision","shortcutNames","removeKeyMapping","shortcutIdx","setKeyMap","newKeyMap","getKeyMap","legacyKeyMap","getRegistry","legacyRegistry","serializeKeyEvent_","getShortcutNamesByKeyCode","getKeyCodesByShortcutName","serializedKey","modifier","modifierKeys","getModifierState","checkModifiers_","modifiers","modifierKeyCode","Shift","Control","Alt","Meta","DARK_PATH_OFFSET","MAX_BOTTOM_WIDTH","Highlighter","inlineSteps_","steps_","RTL_","highlightConstants_","getHighlightConstants","highlightOffset","outsideCornerPaths_","OUTSIDE_CORNER","insideCornerPaths_","INSIDE_CORNER","puzzleTabPaths_","notchPaths_","startPaths_","jaggedTeethPaths_","getPath","drawTopCorner","drawValueInput","belowTabHeight","drawStatementInput","drawRightSideRow","rightEdge","drawBottomRow","cornerElem","drawLeft","drawInlineInput","connectionRight","bottomHighlightWidth","aboveTabHeight","highlighter_","setHighlightPath","HighlightConstantProvider","constantProvider","makeInsideCorner","makeOutsideCorner","distance45outside","SQRT1_2","pathTopRtl","pathBottomRtl","pathBottomLtr","distance45inside","topLeftCornerHighlightRtl","topLeftCornerHighlightLtr","bottomLeftStartY","bottomLeftPath","highlightRtlUp","highlightRtlDown","verticalOverlap","highlightLtrUp","highlightLtrDown","hatHeight","pathRtl","pathLtr","BaseInlineInput","hasExternalInputs","nextRightEdge","rowNextRightEdges","prevInput","prevRightEdge","heightWithoutHat","diff","colourDark","svgPathDark","svgPathLight","highlightConstants","makeHighlightConstants_","ProcedureSerializer","procState","VariableSerializer","variableStates","varState","priorities","Zelos","ToolboxItem","toolboxItemDef","parentToolbox","level_","parent_","getLevel","toolboxItemDef_","parentToolbox_","getClickTarget","isCollapsible","setVisible_","_isVisible","ToolboxCategory","categoryDef","labelDom_","iconDom_","rowContents_","rowDiv_","htmlDiv_","isDisabled_","isHidden_","flyoutItems_","cssConfig_","makeDefaultCssConfig_","parseCategoryDef_","parseContents_","createDom_","flyoutItem","itemDef","getColour_","createContainer_","LEVEL","createRowContainer_","pointerEvents","createRowContentsContainer_","createIconDom_","createLabelDom_","LABELLEDBY","addColourBorder_","rowDiv","nestedPadding","paddingRight","paddingLeft","contentsContainer","toolboxIcon","isHorizontal","toolboxLabel","borderWidth","borderRight","borderLeft","styleName","getColourfromStyle_","parseColour_","colourValue","openIcon_","iconDiv","closedIconClass","closeIcon_","openIconClass","getSelectedItem","clearSelection","allAncestorsExpanded_","category","isExpanded","isSelected","defaultBackgroundColour","setDisabled","isDisabled","getContents","updateFlyoutContents","newDefinition","kind","custom","categorystyle","cssconfig","hidden","ToolboxSeparator","separatorDef","CollapsibleToolboxCategory","subcategoriesDiv_","expanded_","toolboxItems_","cssConfig","prevIsFlyoutItem","createToolboxItem_","ToolboxItemClass","setExpanded","subCategories","getChildToolboxItems","createSubCategoriesDom_","subcategories","newCategory","newCategoryDiv","handleToolboxItemResize","childToolboxItems","toggleExpanded","Toolbox","contentsDiv_","HtmlDiv","contents_","previouslySelectedItem_","selectedItem_","boundEvents_","toolboxDef_","horizontalLayout_","contentMap_","createFlyout_","themeManager","createContentsContainer_","attachEvents_","toolboxContainer","flexDirection","clickEvent","onClick_","keyDownEvent","onKeyDown_","itemId","getToolboxItemById","setSelectedItem","selectNext_","selectPrevious_","selectParent_","selectChild_","FlyoutClass","renderContents_","fragment","createDocumentFragment","addToolboxItem_","toolboxItemDom","getToolboxItems","toolboxRect","_couldConnect","updateCursorDeleteStyle_","getPreviouslySelectedItem","workspaceMetrics","toolboxDiv","childAsCategory","shouldDeselectItem_","deselectItem_","shouldSelectItem_","selectItem_","updateFlyout_","fireSelectEvent_","selectItemByPosition","oldElement","collapsibleItem","nextItemIdx","nextItem","prevItemIdx","prevItem","Trashcan","isLidOpen","minOpenness","lidTask","svgLid","lidOpen","flyoutWorkspaceOptions","onDelete","BODY_HEIGHT","LID_HEIGHT","SPRITE_LEFT","SPRITE_TOP","blockMouseDownWhenOpenable","click","mouseOver","mouseOut","animateLid","setLidOpen","hasContents","contentsIsOpen","openFlyout","string","blocklyStyle","fireUiEvent","closeFlyout","emptyContents","setMinOpenness","trashRect","MARGIN_HOTSPOT","frames","ANIMATION_FRAMES","setLidAngle","MAX_LID_ANGLE","OPACITY_MIN","OPACITY_MAX","ANIMATION_LENGTH","lidAngle","openAtRight","newMin","closeLid","trashcanOpen","cleanedJson","cleanBlockJson","HAS_BLOCKS_LID_ANGLE","cleanRec","VERSION","ALIGN_LEFT","ALIGN_CENTRE","ALIGN_RIGHT","DUMMY_INPUT","TOOLBOX_AT_TOP","TOOLBOX_AT_BOTTOM","TOOLBOX_AT_LEFT","TOOLBOX_AT_RIGHT","VARIABLE_CATEGORY_NAME","VARIABLE_DYNAMIC_CATEGORY_NAME","PROCEDURE_CATEGORY_NAME","Workspace.prototype.newBlock","WorkspaceSvg.prototype.newBlock","WorkspaceSvg.newTrashcan","WorkspaceCommentSvg.prototype.showContextMenu","MiniWorkspaceBubble.prototype.newWorkspaceSvg","Names.prototype.populateProcedures","flattenedProcedures","DropDownDiv","dropDownDiv","connectionTypes","ContextMenu","ContextMenuItems","Css","Events","Extensions","ShortcutItems","Themes","Tooltip","Touch","WidgetDiv","Xml","blockAnimations","blockRendering","bumpObjects","clipboard","common","dialog","fieldRegistry","geras","minimalist","renderManagement","serialization","thrasos","uiPosition","utils","zelos"],"mappings":"A;;;;;;;;;;;;;;;;;;AAiHMA,IAAAA,wCAAAA,CA4DNC,wCA5DMD,CA6EAE,0CA7EAF,CA4GNG,uCA5GMH,CA4IAI,uCA5IAJ,CAgKAK,wCAhKAL,CAoLAM,yCApLAN,CAsMAO,2CAtMAP,CA2OAQ,mDA3OAR,CCvFAS,8CDuFAT,CC9EAU,8CD8EAV,CCjEAW,+CDiEAX;ACxDAY,gDDwDAZ,CCvCAa,8CDuCAb,CC9BAc,8CD8BAd,CClBAe,yCDkBAf,CCNAgB,yCDMAhB,CCSAiB,gDDTAjB,CCqBAkB,gDDrBAlB,CCkCAmB,uCDlCAnB,CC2EAoB,gDD3EApB,CC0GNqB,6CD1GMrB,CCsHAsB,uDDtHAtB;AC6HNuB,+DD7HMvB,CEvDAwB,wDFuDAxB,CE7CAyB,+CF6CAzB,CG9EA0B,iDH8EA1B,CGrEA2B,iDHqEA3B,CGmGA4B,wCHnGA5B,CG0GN6B,gDH1GM7B,CGgIN8B,2CHhIM9B,CG6LA+B,0CH7LA/B,CG6RAgC,oDH7RAhC,CGsSAiC,2CHtSAjC;AG8SAkC,0CH9SAlC,CGuTAmC,6CHvTAnC,CGiVNoC,oDHjVMpC,CGgWAqC,oDHhWArC,CGiXAsC,4CHjXAtC,CGiYAuC,uCHjYAvC,CGmZAwC,kDHnZAxC,CIxFAyC,+DJwFAzC,CKvDA0C,mDLuDA1C,CK2CA2C,0CL3CA3C,CK+CN4C,6CL/CM5C;AM7FA6C,6CN6FA7C,CO3DA8C,iDP2DA9C,COnCA+C,yCPmCA/C,COpBAgD,8CPoBAhD,COPAiD,4CPOAjD,COSAkD,yCPTAlD,COoBAmD,2CPpBAnD,CO+BAoD,4CP/BApD,COoDAqD,6CPpDArD,COsEAsD,gDPtEAtD,COkFAuD,oDPlFAvD;AO6FAwD,mDP7FAxD,CO0GAyD,6CP1GAzD,COkJA0D,iDPlJA1D,CO6KA2D,+DP7KA3D,COoOA4D,mDPpOA5D,CQxEA6D,mCRwEA7D,CQ9DA8D,sCR8DA9D,CQnDA+D,qCRmDA/D,CQ5CNgE,6CR4CMhE,CQlCAiE,wCRkCAjE,CQlBAkE,oCRkBAlE;AQJAmE,uCRIAnE,CS/FAoE,kGT+FApE,CUpFAqE,qFVoFArE,CUvEAsE,sFVuEAtE,CWtBAuE,+CXsBAvE,CWCAwE,qDXDAxE,CWwDAyE,mDXxDAzE,CW+DN0E,2DX/DM1E;AW+EA2E,8DX/EA3E,CWoIA4E,4DXpIA5E,CW8OA6E,2CX9OA7E,CW0QN8E,sDX1QM9E,CWiSA+E,oDXjSA/E,CW4TAgF,6DX5TAhF,CW0UNiF,4EX1UMjF,CWoWNkF,6EXpWMlF,CWyZAmF,2DXzZAnF;AWkeNoF,+CXleMpF,CWygBAqF,kDXzgBArF,CYhDAsF,sCZgDAtF,CYhCAuF,qCZgCAvF,CYpBAwF,iDZoBAxF,CYPAyF,8CZOAzF,CYUA0F,wDZVA1F,CYwBA2F,iDZxBA3F,CalEA4F,qDbkEA5F,CajBA6F,0CbiBA7F,CasBA8F,4CbtBA9F;AawCA+F,mDbxCA/F,Ca4EAgG,mDb5EAhG,Ca8FAiG,gDb9FAjG,CamHAkG,0DbnHAlG,Cc/FAA,mCd+FAA,Cc7EAmG,iCd6EAnG,Ce7FAoG,0Cf6FApG,CetFNqG,kDfsFMrG,CerDNsG,qDfqDMtG,CepCAuG,mDfoCAvG,CenBAwG,gDfmBAxG;AeIAyG,wDfJAzG,CemBA0G,+CfnBA1G,CeyCA2G,0DfzCA3G,CeiEA4G,iEfjEA5G,CgB1EA6G,mDhB0EA7G,CgB5BA8G,uDhB4BA9G,CgBJA+G,qDhBIA/G,CgBaAgH,uDhBbAhH,CgB8BAiH,2DhB9BAjH;AiBhFAkH,yCjBgFAlH,CiBlDAmH,yCjBkDAnH,CiB3BAoH,2CjB2BApH,CiBSNqH,qCjBTMrH,CiByBNsH,yCjBzBMtH,CiB8CAuH,qCjB9CAvH,CiB+KNwH,sCjB/KMxH,CiBiOA2C,oCjBjOA3C,CiB8OAyH,0CjB9OAzH,CiBgRA0H,uDjBhRA1H,CiBkSA2H,yCjBlSA3H,CiBsXA4H,+CjBtXA5H;AiBibA6H,qCjBjbA7H,CiBifA8H,yCjBjfA9H,CiB8gBN+H,8CjB9gBM/H,CiBokBNgI,gDjBpkBMhI,CiB0lBNiI,+CjB1lBMjI,CiBonBNkI,4CjBpnBMlI,CiBioBNmI,6CjBjoBMnI,CiBmpBNoI,0CjBnpBMpI,CiB6qBNqI,6CjB7qBMrI,CiButBNsI,4CjBvtBMtI,CiBkwBNuI,6CjBlwBMvI,CiB42BNwI,qCjB52BMxI;AiB63BAyI,qCjB73BAzI,CiBu4BN0I,oCjBv4BM1I,CkB9FAA,sDlB8FAA,CkBrFAE,wDlBqFAF,CmBhCA2I,gDnBgCA3I,CmB+BN4I,0DnB/BM5I,CmBiEN6I,sDnBjEM7I,CmB6EN8I,0DnB7EM9I,CmBsGN+I,qDnBtGM/I,CmB4HNgJ,sDnB5HMhJ;AmBoJNiJ,2DnBpJMjJ,CmBmLNkJ,0DnBnLMlJ,CmB6MNmJ,0DnB7MMnJ,CmByOAoJ,kDnBzOApJ,CmBkQAqJ,0DnBlQArJ,CmB0TNsJ,yDnB1TMtJ,CmB4VNuJ,sDnB5VMvJ,CmB4WNwJ,0DnB5WMxJ,CmB2YNyJ,0DnB3YMzJ;AmB6ZN0J,8DnB7ZM1J,CmBmdN2J,qDnBndM3J,CmB8eN4J,sDnB9eM5J,CmBwgBN6J,2DnBxgBM7J,CmB8hBN8J,0DnB9hBM9J,CmB+iBN+J,0DnB/iBM/J,CmBskBNgK,qDnBtkBMhK,CoBlGAiK,wDpBkGAjK,CqBqmBNkK,qDrBrmBMlK;AqBsnBNmK,qDrBtnBMnK,CqBqpBNoK,gErBrpBMpK,CsBjGAqK,2CtBiGArK,CsBtFAsK,2CtBsFAtK,CsB1EAuK,uCtB0EAvK,CuBCHwK,4CvBDGxK,CuBuCHyK,mDvBvCGzK,CuB8CH0K,2CvB9CG1K,CuBuDH2K,gDvBvDG3K,CuB4DN4K,+CvB5DM5K,CuBuEH6K,4CvBvEG7K;AuBwFH8K,wDvBxFG9K,CuBiHH+K,wDvBjHG/K,CuB+HNgL,uDvB/HMhL,CuB8INiL,uDvB9IMjL,CuByJNkL,uDvBzJMlL,CuBwNHmL,uCvBxNGnL,CuBuUNoL,0DvBvUMpL,CuB+WNqL,0DvB/WMrL,CuBwZNsL,8DvBxZMtL;AuBucHuL,+CvBvcGvL,CuBweHwL,4CvBxeGxL,CuBofHyL,8CvBpfGzL,CuBogBN0L,uCvBpgBM1L,CuBohBN2L,uDvBphBM3L,CuByjBN4L,mDvBzjBM5L,CuB6nBH6L,4DvB7nBG7L,CwB7FA8L,8CxB6FA9L,CwB7EA+L,wDxB6EA/L,CwB5DAgM,oDxB4DAhM;AwBpBAiM,oDxBoBAjM,CwBkCNkM,4CxBlCMlM,CwBqFNmM,6CxBrFMnM,CwB8INoM,8CxB9IMpM,CwBkLNqM,8CxBlLMrM,CyBpEAsM,+CzBoEAtM,CyB3DAuM,+CzB2DAvM,CyB/CAwL,wCzB+CAxL,CyBuBAwM,qCzBvBAxM,CyBiCAyM,iDzBjCAzM,CyBuDN0M,8CzBvDM1M;AyByEAwK,wCzBzEAxK,CyByFA2M,8CzBzFA3M,CyBmHA4M,gDzBnHA5M,CyBmIN6M,0CzBnIM7M,CyByJN8M,yCzBzJM9M,CyBiLN+M,0CzBjLM/M,CyByNAgN,sCzBzNAhN,CyBkOA0L,mCzBlOA1L,CyBqPAiN,oCzBrPAjN,CyBgQAkN,sCzBhQAlN,CyBqQNmN,4CzBrQMnN,CyBkRNoN,mDzBlRMpN;AyBqSNqN,0CzBrSMrN,CyByUNmL,mCzBzUMnL,C0B5FAsN,oD1B4FAtN,C0BjFAuN,oD1BiFAvN,C0BjEAwN,+C1BiEAxN,C0BtDAyN,+C1BsDAzN,C0BtCA0N,yC1BsCA1N,C0BAA2N,4C1BAA3N,C0BeA4N,4C1BfA5N,C0BqCA6N,4C1BrCA7N,C0BkGA8N,yC1BlGA9N,C0BsJA+N,4C1BtJA/N;A2B1FNgO,kE3B0FMhO,C2B6DAiO,0D3B7DAjO,C2B0EAkO,6D3B1EAlO,C2B4FAmO,2D3B5FAnO,C2B0HAoO,qD3B1HApO,C4B7EAwM,uC5B6EAxM,C4BnEAqO,gD5BmEArO,C4B5DAwK,0C5B4DAxK,C4BzCAmL,qC5ByCAnL,C4BnBA0L,qC5BmBA1L;A4BYAwL,0C5BZAxL,C4BsBAyL,4C5BtBAzL,C4BmCN4L,iD5BnCM5L,C4ByDAsO,mD5BzDAtO,C4BsFNuO,2C5BtFMvO,C4BwHNwO,2C5BxHMxO,C4B8INyO,iD5B9IMzO,C4BsJA6L,0D5BtJA7L,C6BrFAA,8C7BqFAA,C6B5EAE,gD7B4EAF,C6BpDN0O,sD7BoDM1O;A8BOA2O,yC9BPA3O,C8BqBA4O,0C9BrBA5O,C+B2mBN6O,iD/B3mBM7O,C+BwqBN8O,+C/BxqBM9O,C+ByrBN+O,qD/BzrBM/O,CgCjGAgP,6ChCiGAhP,CiCiEAiP,4DjCjEAjP,CiC0FNkP,oDjC1FMlP,CiC0HAmP,gEjC1HAnP,CiC6JAoP,kDjC7JApP;AiCoKNqP,0DjCpKMrP,CiC2LAsP,0DjC3LAtP,CiC8MNuP,yDjC9MMvP,CiC6NNwP,mDjC7NMxP,CiCwQNyP,kDjCxQMzP,CiC8RA0P,qDjC9RA1P,CkCNAE,4ClCMAF,CkCUA2P,8ClCVA3P,CkCuBA4P,uClCvBA5P,CkCiEN6P,0DlCjEM7P;AkCyFN8P,+ClCzFM9P,CkC8GN+P,gDlC9GM/P,CkCmINgQ,oDlCnIMhQ,CkC0JNiQ,sDlC1JMjQ,CkCgLNkQ,2DlChLMlQ,CkCwMNmQ,sDlCxMMnQ,CkC0ONoQ,wDlC1OMpQ,CkCiQAqQ,kDlCjQArQ,CkCoWNsQ,6DlCpWMtQ,CkC2aNuQ,wDlC3aMvQ;AmChGAwQ,6CnCgGAxQ,CoC9FAyQ,4CpC8FAzQ,CoC7EA0Q,4CpC6EA1Q,CoC/DA2Q,6CpC+DA3Q,CoCjDA4Q,6CpCiDA5Q,CoCnCA6Q,6CpCmCA7Q,CoCrBA8Q,2CpCqBA9Q,CoCJA+Q,iDpCIA/Q,CoCaAgR,0CpCbAhR,CqC/FAA,8CrC+FAA,CqCnFAE,gDrCmFAF;AsChFAiR,uDtCgFAjR,CsChDNkR,qDtCgDMlR,CsClBAmR,0DtCkBAnR,CsCsBNoR,wDtCtBMpR,CsCwCAqR,0DtCxCArR,CsCkENsR,wDtClEMtR,CsC4FAuR,wDtC5FAvR,CuC/ENwR,wDvC+EMxR,CuCpBAyR,yDvCoBAzR;AuCuCN0R,0DvCvCM1R,CuCmEA2R,4DvCnEA3R,CwChFA4R,oDxCgFA5R,CwC/DA6R,4DxC+DA7R,CwCnDN8R,mDxCmDM9R,CwCtCN+R,kDxCsCM/R,CwCRNgS,oDxCQMhS,CwCONiS,kExCPMjS,CwC4BNkS,4DxC5BMlS;AyC8UNmS,iDzC9UMnS,C0C7FAoS,qC1C6FApS,C0CtFNqS,6C1CsFMrS,C0C5EAsS,sC1C4EAtS,C0CjDAuS,0C1CiDAvS,C0C1CNwS,kD1C0CMxS,C2CrEAyS,kD3CqEAzS,C2C5DA0S,kD3C4DA1S,C2C5CAmL,uC3C4CAnL,C2CfN2S,4C3CeM3S,C2C8BN4S,4C3C9BM5S,C2CiEN6S,gD3CjEM7S;A2CuFN8S,kD3CvFM9S,C2CgGA0L,uC3ChGA1L,C2CwGAgN,0C3CxGAhN,C2C2JA+S,sD3C3JA/S,C2CmLAgT,yD3CnLAhT,C2C0MAiT,yD3C1MAjT,C4CuoBNkT,gE5CvoBMlT,C6CdAmT,gE7CcAnT,C8ChEAA,gE9CgEAA,C8CvDAE,kE9CuDAF;A8CzCAoT,4D9CyCApT,C+CtFAqT,qD/CsFArT,C+C9DAsT,qD/C8DAtT,C+CtCAuT,wD/CsCAvT,C+CTNwT,sD/CSMxT,C+CiBAyT,yD/CjBAzT,C+CmDA0T,uD/CnDA1T,C+CwFN2T,4D/CxFM3T,C+CyGN4T,4D/CzGM5T;A+CyHN6T,oD/CzHM7T,C+CgJA8T,0D/ChJA9T,C+CgMN+T,kE/ChMM/T,C+C4MAgU,0D/C5MAhU,C+C0OAiU,wD/C1OAjU,C+CkRAkU,uD/ClRAlU,C+CsTAmU,oE/CtTAnU,C+CqVAoU,wD/CrVApU,C+C6XAqU,uD/C7XArU;A+CiaAsU,qD/CjaAtU,C+C4bNuU,8D/C5bMvU,C+C4cAwU,+D/C5cAxU,CgD9FAyU,oEhD8FAzU,CiD5FA0U,2DjD4FA1U,CkDjDA2U,+ClDiDA3U,CkDJN4U,qDlDIM5U,CkDSA6U,+ClDTA7U,CkDoCN8U,6ClDpCM9U;AkDqDA+U,4ClDrDA/U,CkDsFAgV,wClDtFAhV,CkDwHAuE,gDlDxHAvE,CkDmNNiV,qDlDnNMjV,CkDmPAkV,qDlDnPAlV,CkDkRNmV,uDlDlRMnV,CkDsSAoV,4ClDtSApV,CkDoTNqV,wDlDpTMrV,CkDmUAsV,+ClDnUAtV,CkD2WAuV,+ClD3WAvV,CmDjFNwV,iEnDiFMxV;AmDlENyV,iEnDkEMzV,CmDnDN0V,iEnDmDM1V,CmDlCAuE,uDnDkCAvE,CmDKAwE,6DnDLAxE,CoD1CA2V,gEpD0CA3V,CoDgBA4V,oEpDhBA5V,CoD6CA6V,4DpD7CA7V,CqDg6EA8V,sDrDh6EA9V,CsD7EAmG,oCtD6EAnG;AsD1BNwK,uCtD0BMxK,CsD4BN+V,iDtD5BM/V,CsDkFNoT,kCtDlFMpT,CsD2KNgW,uCtD3KMhW,CsD6MNiW,gDtD7MMjW,CsDkPNkW,wCtDlPMlW,CuDlDAmW,6DvDkDAnW,CuDlCAoW,6DvDkCApW,CuDnBAqW,6DvDmBArW,CuDUAsW,6DvDVAtW;AwD1FA2I,oDxD0FA3I,Cw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","file":"blockly_compressed.js","sourcesContent":["/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.registry');\n\nimport type {Abstract} from './events/events_abstract.js';\nimport type {Field} from './field.js';\nimport type {IBlockDragger} from './interfaces/i_block_dragger.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport type {IIcon} from './interfaces/i_icon.js';\nimport type {Input} from './inputs/input.js';\nimport type {ISerializer} from './interfaces/i_serializer.js';\nimport type {IToolbox} from './interfaces/i_toolbox.js';\nimport type {Cursor} from './keyboard_nav/cursor.js';\nimport type {Options} from './options.js';\nimport type {Renderer} from './renderers/common/renderer.js';\nimport type {Theme} from './theme.js';\nimport type {ToolboxItem} from './toolbox/toolbox_item.js';\n\n/**\n * A map of maps. With the keys being the type and name of the class we are\n * registering and the value being the constructor function.\n * e.g. {'field': {'field_angle': Blockly.FieldAngle}}\n */\nconst typeMap: {\n  [key: string]: {\n    [key: string]: (new () => AnyDuringMigration) | AnyDuringMigration;\n  };\n} = Object.create(null);\nexport const TEST_ONLY = {typeMap};\n\n/**\n * A map of maps. With the keys being the type and caseless name of the class we\n * are registring, and the value being the most recent cased name for that\n * registration.\n */\nconst nameMap: {[key: string]: {[key: string]: string}} = Object.create(null);\n\n/**\n * The string used to register the default class for a type of plugin.\n */\nexport const DEFAULT = 'default';\n\n/**\n * A name with the type of the element stored in the generic.\n */\nexport class Type<_T> {\n  /** @param name The name of the registry type. */\n  constructor(private readonly name: string) {}\n\n  /**\n   * Returns the name of the type.\n   *\n   * @returns The name.\n   */\n  toString(): string {\n    return this.name;\n  }\n\n  static CONNECTION_CHECKER = new Type<IConnectionChecker>('connectionChecker');\n\n  static CURSOR = new Type<Cursor>('cursor');\n\n  static EVENT = new Type<Abstract>('event');\n\n  static FIELD = new Type<Field>('field');\n\n  static INPUT = new Type<Input>('input');\n\n  static RENDERER = new Type<Renderer>('renderer');\n\n  static TOOLBOX = new Type<IToolbox>('toolbox');\n\n  static THEME = new Type<Theme>('theme');\n\n  static TOOLBOX_ITEM = new Type<ToolboxItem>('toolboxItem');\n\n  static FLYOUTS_VERTICAL_TOOLBOX = new Type<IFlyout>('flyoutsVerticalToolbox');\n\n  static FLYOUTS_HORIZONTAL_TOOLBOX = new Type<IFlyout>(\n    'flyoutsHorizontalToolbox'\n  );\n\n  static METRICS_MANAGER = new Type<IMetricsManager>('metricsManager');\n\n  static BLOCK_DRAGGER = new Type<IBlockDragger>('blockDragger');\n\n  /** @internal */\n  static SERIALIZER = new Type<ISerializer>('serializer');\n\n  /** @internal */\n  static ICON = new Type<IIcon>('icon');\n}\n\n/**\n * Registers a class based on a type and name.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @param registryItem The class or object to register.\n * @param opt_allowOverrides True to prevent an error when overriding an already\n *     registered item.\n * @throws {Error} if the type or name is empty, a name with the given type has\n *     already been registered, or if the given class or object is not valid for\n *     its type.\n */\nexport function register<T>(\n  type: string | Type<T>,\n  name: string,\n  registryItem:\n    | (new (...p1: AnyDuringMigration[]) => T)\n    | null\n    | AnyDuringMigration,\n  opt_allowOverrides?: boolean\n): void {\n  if (\n    (!(type instanceof Type) && typeof type !== 'string') ||\n    `${type}`.trim() === ''\n  ) {\n    throw Error(\n      'Invalid type \"' +\n        type +\n        '\". The type must be a' +\n        ' non-empty string or a Blockly.registry.Type.'\n    );\n  }\n  type = `${type}`.toLowerCase();\n\n  if (typeof name !== 'string' || name.trim() === '') {\n    throw Error(\n      'Invalid name \"' + name + '\". The name must be a' + ' non-empty string.'\n    );\n  }\n  const caselessName = name.toLowerCase();\n  if (!registryItem) {\n    throw Error('Can not register a null value');\n  }\n  let typeRegistry = typeMap[type];\n  let nameRegistry = nameMap[type];\n  // If the type registry has not been created, create it.\n  if (!typeRegistry) {\n    typeRegistry = typeMap[type] = Object.create(null);\n    nameRegistry = nameMap[type] = Object.create(null);\n  }\n\n  // Validate that the given class has all the required properties.\n  validate(type, registryItem);\n\n  // Don't throw an error if opt_allowOverrides is true.\n  if (!opt_allowOverrides && typeRegistry[caselessName]) {\n    throw Error(\n      'Name \"' + caselessName + '\" with type \"' + type + '\" already registered.'\n    );\n  }\n  typeRegistry[caselessName] = registryItem;\n  nameRegistry[caselessName] = name;\n}\n\n/**\n * Checks the given registry item for properties that are required based on the\n * type.\n *\n * @param type The type of the plugin. (e.g. Field, Renderer)\n * @param registryItem A class or object that we are checking for the required\n *     properties.\n */\nfunction validate(type: string, registryItem: Function | AnyDuringMigration) {\n  switch (type) {\n    case String(Type.FIELD):\n      if (typeof registryItem.fromJson !== 'function') {\n        throw Error('Type \"' + type + '\" must have a fromJson function');\n      }\n      break;\n  }\n}\n\n/**\n * Unregisters the registry item with the given type and name.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n */\nexport function unregister<T>(type: string | Type<T>, name: string) {\n  type = `${type}`.toLowerCase();\n  name = name.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry || !typeRegistry[name]) {\n    console.warn(\n      'Unable to unregister [' +\n        name +\n        '][' +\n        type +\n        '] from the ' +\n        'registry.'\n    );\n    return;\n  }\n  delete typeMap[type][name];\n  delete nameMap[type][name];\n}\n\n/**\n * Gets the registry item for the given name and type. This can be either a\n * class or an object.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the plugin.\n * @returns The class or object with the given name and type or null if none\n *     exists.\n */\nfunction getItem<T>(\n  type: string | Type<T>,\n  name: string,\n  opt_throwIfMissing?: boolean\n): (new (...p1: AnyDuringMigration[]) => T) | null | AnyDuringMigration {\n  type = `${type}`.toLowerCase();\n  name = name.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry || !typeRegistry[name]) {\n    const msg = 'Unable to find [' + name + '][' + type + '] in the registry.';\n    if (opt_throwIfMissing) {\n      throw new Error(\n        msg + ' You must require or register a ' + type + ' plugin.'\n      );\n    } else {\n      console.warn(msg);\n    }\n    return null;\n  }\n  return typeRegistry[name];\n}\n\n/**\n * Returns whether or not the registry contains an item with the given type and\n * name.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @returns True if the registry has an item with the given type and name, false\n *     otherwise.\n */\nexport function hasItem<T>(type: string | Type<T>, name: string): boolean {\n  type = `${type}`.toLowerCase();\n  name = name.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry) {\n    return false;\n  }\n  return !!typeRegistry[name];\n}\n\n/**\n * Gets the class for the given name and type.\n *\n * @param type The type of the plugin.\n *     (e.g. Field, Renderer)\n * @param name The plugin's name. (Ex. field_angle, geras)\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the plugin.\n * @returns The class with the given name and type or null if none exists.\n */\nexport function getClass<T>(\n  type: string | Type<T>,\n  name: string,\n  opt_throwIfMissing?: boolean\n): (new (...p1: AnyDuringMigration[]) => T) | null {\n  return getItem(type, name, opt_throwIfMissing) as\n    | (new (...p1: AnyDuringMigration[]) => T)\n    | null;\n}\n\n/**\n * Gets the object for the given name and type.\n *\n * @param type The type of the plugin.\n *     (e.g. Category)\n * @param name The plugin's name. (Ex. logic_category)\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the object.\n * @returns The object with the given name and type or null if none exists.\n */\nexport function getObject<T>(\n  type: string | Type<T>,\n  name: string,\n  opt_throwIfMissing?: boolean\n): T | null {\n  return getItem(type, name, opt_throwIfMissing) as T;\n}\n\n/**\n * Returns a map of items registered with the given type.\n *\n * @param type The type of the plugin. (e.g. Category)\n * @param opt_cased Whether or not to return a map with cased keys (rather than\n *     caseless keys). False by default.\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the object. False by default.\n * @returns A map of objects with the given type, or null if none exists.\n */\nexport function getAllItems<T>(\n  type: string | Type<T>,\n  opt_cased?: boolean,\n  opt_throwIfMissing?: boolean\n): {[key: string]: T | null | (new (...p1: AnyDuringMigration[]) => T)} | null {\n  type = `${type}`.toLowerCase();\n  const typeRegistry = typeMap[type];\n  if (!typeRegistry) {\n    const msg = `Unable to find [${type}] in the registry.`;\n    if (opt_throwIfMissing) {\n      throw new Error(`${msg} You must require or register a ${type} plugin.`);\n    } else {\n      console.warn(msg);\n    }\n    return null;\n  }\n  if (!opt_cased) {\n    return typeRegistry;\n  }\n  const nameRegistry = nameMap[type];\n  const casedRegistry = Object.create(null);\n  for (const key of Object.keys(typeRegistry)) {\n    casedRegistry[nameRegistry[key]] = typeRegistry[key];\n  }\n  return casedRegistry;\n}\n\n/**\n * Gets the class from Blockly options for the given type.\n * This is used for plugins that override a built in feature. (e.g. Toolbox)\n *\n * @param type The type of the plugin.\n * @param options The option object to check for the given plugin.\n * @param opt_throwIfMissing Whether or not to throw an error if we are unable\n *     to find the plugin.\n * @returns The class for the plugin.\n */\nexport function getClassFromOptions<T>(\n  type: Type<T>,\n  options: Options,\n  opt_throwIfMissing?: boolean\n): (new (...p1: AnyDuringMigration[]) => T) | null {\n  const plugin = options.plugins[String(type)] || DEFAULT;\n\n  // If the user passed in a plugin class instead of a registered plugin name.\n  if (typeof plugin === 'function') {\n    return plugin;\n  }\n  return getClass(type, plugin, opt_throwIfMissing);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.common');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Block} from './block.js';\nimport {BlockDefinition, Blocks} from './blocks.js';\nimport type {Connection} from './connection.js';\nimport type {ICopyable} from './interfaces/i_copyable.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/** Database of all workspaces. */\nconst WorkspaceDB_ = Object.create(null);\n\n/**\n * Find the workspace with the specified ID.\n *\n * @param id ID of workspace to find.\n * @returns The sought after workspace or null if not found.\n */\nexport function getWorkspaceById(id: string): Workspace | null {\n  return WorkspaceDB_[id] || null;\n}\n\n/**\n * Find all workspaces.\n *\n * @returns Array of workspaces.\n */\nexport function getAllWorkspaces(): Workspace[] {\n  const workspaces = [];\n  for (const workspaceId in WorkspaceDB_) {\n    workspaces.push(WorkspaceDB_[workspaceId]);\n  }\n  return workspaces;\n}\n\n/**\n * Register a workspace in the workspace db.\n *\n * @param workspace\n */\nexport function registerWorkspace(workspace: Workspace) {\n  WorkspaceDB_[workspace.id] = workspace;\n}\n\n/**\n * Unregister a workspace from the workspace db.\n *\n * @param workspace\n */\nexport function unregisterWorkpace(workspace: Workspace) {\n  delete WorkspaceDB_[workspace.id];\n}\n\n/**\n * The main workspace most recently used.\n * Set by Blockly.WorkspaceSvg.prototype.markFocused\n */\nlet mainWorkspace: Workspace;\n\n/**\n * Returns the last used top level workspace (based on focus).  Try not to use\n * this function, particularly if there are multiple Blockly instances on a\n * page.\n *\n * @returns The main workspace.\n */\nexport function getMainWorkspace(): Workspace {\n  return mainWorkspace;\n}\n\n/**\n * Sets last used main workspace.\n *\n * @param workspace The most recently used top level workspace.\n */\nexport function setMainWorkspace(workspace: Workspace) {\n  mainWorkspace = workspace;\n}\n\n/**\n * Currently selected copyable object.\n */\nlet selected: ICopyable | null = null;\n\n/**\n * Returns the currently selected copyable object.\n */\nexport function getSelected(): ICopyable | null {\n  return selected;\n}\n\n/**\n * Sets the currently selected block. This function does not visually mark the\n * block as selected or fire the required events. If you wish to\n * programmatically select a block, use `BlockSvg#select`.\n *\n * @param newSelection The newly selected block.\n * @internal\n */\nexport function setSelected(newSelection: ICopyable | null) {\n  selected = newSelection;\n}\n\n/**\n * Container element in which to render the WidgetDiv, DropDownDiv and Tooltip.\n */\nlet parentContainer: Element | null;\n\n/**\n * Get the container element in which to render the WidgetDiv, DropDownDiv and\n * Tooltip.\n *\n * @returns The parent container.\n */\nexport function getParentContainer(): Element | null {\n  return parentContainer;\n}\n\n/**\n * Set the parent container.  This is the container element that the WidgetDiv,\n * DropDownDiv, and Tooltip are rendered into the first time `Blockly.inject`\n * is called.\n * This method is a NOP if called after the first `Blockly.inject`.\n *\n * @param newParent The container element.\n */\nexport function setParentContainer(newParent: Element) {\n  parentContainer = newParent;\n}\n\n/**\n * Size the SVG image to completely fill its container. Call this when the view\n * actually changes sizes (e.g. on a window resize/device orientation change).\n * See workspace.resizeContents to resize the workspace when the contents\n * change (e.g. when a block is added or removed).\n * Record the height/width of the SVG image.\n *\n * @param workspace Any workspace in the SVG.\n */\nexport function svgResize(workspace: WorkspaceSvg) {\n  let mainWorkspace = workspace;\n  while (mainWorkspace.options.parentWorkspace) {\n    mainWorkspace = mainWorkspace.options.parentWorkspace;\n  }\n  const svg = mainWorkspace.getParentSvg();\n  const cachedSize = mainWorkspace.getCachedParentSvgSize();\n  const div = svg.parentElement;\n  if (!(div instanceof HTMLElement)) {\n    // Workspace deleted, or something.\n    return;\n  }\n\n  const width = div.offsetWidth;\n  const height = div.offsetHeight;\n  if (cachedSize.width !== width) {\n    svg.setAttribute('width', width + 'px');\n    mainWorkspace.setCachedParentSvgSize(width, null);\n  }\n  if (cachedSize.height !== height) {\n    svg.setAttribute('height', height + 'px');\n    mainWorkspace.setCachedParentSvgSize(null, height);\n  }\n  mainWorkspace.resize();\n}\n\n/**\n * All of the connections on blocks that are currently being dragged.\n */\nexport const draggingConnections: Connection[] = [];\n\n/**\n * Get a map of all the block's descendants mapping their type to the number of\n *    children with that type.\n *\n * @param block The block to map.\n * @param opt_stripFollowing Optionally ignore all following\n *    statements (blocks that are not inside a value or statement input\n *    of the block).\n * @returns Map of types to type counts for descendants of the bock.\n */\nexport function getBlockTypeCounts(\n  block: Block,\n  opt_stripFollowing?: boolean\n): {[key: string]: number} {\n  const typeCountsMap = Object.create(null);\n  const descendants = block.getDescendants(true);\n  if (opt_stripFollowing) {\n    const nextBlock = block.getNextBlock();\n    if (nextBlock) {\n      const index = descendants.indexOf(nextBlock);\n      descendants.splice(index, descendants.length - index);\n    }\n  }\n  for (let i = 0, checkBlock; (checkBlock = descendants[i]); i++) {\n    if (typeCountsMap[checkBlock.type]) {\n      typeCountsMap[checkBlock.type]++;\n    } else {\n      typeCountsMap[checkBlock.type] = 1;\n    }\n  }\n  return typeCountsMap;\n}\n\n/**\n * Helper function for defining a block from JSON.  The resulting function has\n * the correct value of jsonDef at the point in code where jsonInit is called.\n *\n * @param jsonDef The JSON definition of a block.\n * @returns A function that calls jsonInit with the correct value\n *     of jsonDef.\n */\nfunction jsonInitFactory(jsonDef: AnyDuringMigration): () => void {\n  return function (this: Block) {\n    this.jsonInit(jsonDef);\n  };\n}\n\n/**\n * Define blocks from an array of JSON block definitions, as might be generated\n * by the Blockly Developer Tools.\n *\n * @param jsonArray An array of JSON block definitions.\n */\nexport function defineBlocksWithJsonArray(jsonArray: AnyDuringMigration[]) {\n  TEST_ONLY.defineBlocksWithJsonArrayInternal(jsonArray);\n}\n\n/**\n * Private version of defineBlocksWithJsonArray for stubbing in tests.\n */\nfunction defineBlocksWithJsonArrayInternal(jsonArray: AnyDuringMigration[]) {\n  defineBlocks(createBlockDefinitionsFromJsonArray(jsonArray));\n}\n\n/**\n * Define blocks from an array of JSON block definitions, as might be generated\n * by the Blockly Developer Tools.\n *\n * @param jsonArray An array of JSON block definitions.\n * @returns A map of the block\n *     definitions created.\n */\nexport function createBlockDefinitionsFromJsonArray(\n  jsonArray: AnyDuringMigration[]\n): {[key: string]: BlockDefinition} {\n  const blocks: {[key: string]: BlockDefinition} = {};\n  for (let i = 0; i < jsonArray.length; i++) {\n    const elem = jsonArray[i];\n    if (!elem) {\n      console.warn(`Block definition #${i} in JSON array is ${elem}. Skipping`);\n      continue;\n    }\n    const type = elem['type'];\n    if (!type) {\n      console.warn(\n        `Block definition #${i} in JSON array is missing a type attribute. ` +\n          'Skipping.'\n      );\n      continue;\n    }\n    blocks[type] = {init: jsonInitFactory(elem)};\n  }\n  return blocks;\n}\n\n/**\n * Add the specified block definitions to the block definitions\n * dictionary (Blockly.Blocks).\n *\n * @param blocks A map of block\n *     type names to block definitions.\n */\nexport function defineBlocks(blocks: {[key: string]: BlockDefinition}) {\n  // Iterate over own enumerable properties.\n  for (const type of Object.keys(blocks)) {\n    const definition = blocks[type];\n    if (type in Blocks) {\n      console.warn(`Block definiton \"${type}\" overwrites previous definition.`);\n    }\n    Blocks[type] = definition;\n  }\n}\n\nexport const TEST_ONLY = {defineBlocksWithJsonArrayInternal};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.idGenerator');\n\n/**\n * Legal characters for the universally unique IDs.  Should be all on\n * a US keyboard.  No characters that conflict with XML or JSON.\n * Requests to remove additional 'problematic' characters from this\n * soup will be denied.  That's your failure to properly escape in\n * your own environment.  Issues #251, #625, #682, #1304.\n */\nconst soup =\n  '!#$%()*+,-./:;=?@[]^_`{|}~' +\n  'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n/**\n * Namespace object for internal implementations we want to be able to\n * stub in tests. Do not use externally.\n *\n * @internal\n */\nconst internal = {\n  /**\n   * Generate a random unique ID.  This should be globally unique.\n   * 87 characters ^ 20 length is greater than 128 bits (better than a UUID).\n   *\n   * @returns A globally unique ID string.\n   */\n  genUid: () => {\n    const length = 20;\n    const soupLength = soup.length;\n    const id = [];\n    for (let i = 0; i < length; i++) {\n      id[i] = soup.charAt(Math.random() * soupLength);\n    }\n    return id.join('');\n  },\n};\nexport const TEST_ONLY = internal;\n\n/** Next unique ID to use. */\nlet nextId = 0;\n\n/**\n * Generate the next unique element IDs.\n * IDs are compatible with the HTML4 'id' attribute restrictions:\n * Use only ASCII letters, digits, '_', '-' and '.'\n *\n * For UUIDs use genUid (below) instead; this ID generator should\n * primarily be used for IDs that end up in the DOM.\n *\n * @returns The next unique identifier.\n */\nexport function getNextUniqueId(): string {\n  return 'blockly-' + (nextId++).toString(36);\n}\n\n/**\n * Generate a random unique ID.\n *\n * @see internal.genUid\n * @returns A globally unique ID string.\n */\nexport function genUid(): string {\n  return internal.genUid();\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.utils');\n\nimport type {Block} from '../block.js';\nimport * as common from '../common.js';\nimport * as registry from '../registry.js';\nimport * as idGenerator from '../utils/idgenerator.js';\nimport type {Workspace} from '../workspace.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\nimport type {Abstract} from './events_abstract.js';\nimport type {BlockChange} from './events_block_change.js';\nimport type {BlockCreate} from './events_block_create.js';\nimport type {BlockMove} from './events_block_move.js';\nimport type {CommentCreate} from './events_comment_create.js';\nimport type {CommentMove} from './events_comment_move.js';\nimport type {ViewportChange} from './events_viewport.js';\n\n/** Group ID for new events.  Grouped events are indivisible. */\nlet group = '';\n\n/** Sets whether the next event should be added to the undo stack. */\nlet recordUndo = true;\n\n/**\n * Sets whether events should be added to the undo stack.\n *\n * @param newValue True if events should be added to the undo stack.\n */\nexport function setRecordUndo(newValue: boolean) {\n  recordUndo = newValue;\n}\n\n/**\n * Returns whether or not events will be added to the undo stack.\n *\n * @returns True if events will be added to the undo stack.\n */\nexport function getRecordUndo(): boolean {\n  return recordUndo;\n}\n\n/** Allow change events to be created and fired. */\nlet disabled = 0;\n\n/**\n * Name of event that creates a block. Will be deprecated for BLOCK_CREATE.\n */\nexport const CREATE = 'create';\n\n/**\n * Name of event that creates a block.\n */\nexport const BLOCK_CREATE = CREATE;\n\n/**\n * Name of event that deletes a block. Will be deprecated for BLOCK_DELETE.\n */\nexport const DELETE = 'delete';\n\n/**\n * Name of event that deletes a block.\n */\nexport const BLOCK_DELETE = DELETE;\n\n/**\n * Name of event that changes a block. Will be deprecated for BLOCK_CHANGE.\n */\nexport const CHANGE = 'change';\n\n/**\n * Name of event that changes a block.\n */\nexport const BLOCK_CHANGE = CHANGE;\n\n/**\n * Name of event that moves a block. Will be deprecated for BLOCK_MOVE.\n */\nexport const MOVE = 'move';\n\n/**\n * Name of event that moves a block.\n */\nexport const BLOCK_MOVE = MOVE;\n\n/**\n * Name of event that creates a variable.\n */\nexport const VAR_CREATE = 'var_create';\n\n/**\n * Name of event that deletes a variable.\n */\nexport const VAR_DELETE = 'var_delete';\n\n/**\n * Name of event that renames a variable.\n */\nexport const VAR_RENAME = 'var_rename';\n\n/**\n * Name of generic event that records a UI change.\n */\nexport const UI = 'ui';\n\n/**\n * Name of event that record a block drags a block.\n */\nexport const BLOCK_DRAG = 'drag';\n\n/**\n * Name of event that records a change in selected element.\n */\nexport const SELECTED = 'selected';\n\n/**\n * Name of event that records a click.\n */\nexport const CLICK = 'click';\n\n/**\n * Name of event that records a marker move.\n */\nexport const MARKER_MOVE = 'marker_move';\n\n/**\n * Name of event that records a bubble open.\n */\nexport const BUBBLE_OPEN = 'bubble_open';\n\n/**\n * Name of event that records a trashcan open.\n */\nexport const TRASHCAN_OPEN = 'trashcan_open';\n\n/**\n * Name of event that records a toolbox item select.\n */\nexport const TOOLBOX_ITEM_SELECT = 'toolbox_item_select';\n\n/**\n * Name of event that records a theme change.\n */\nexport const THEME_CHANGE = 'theme_change';\n\n/**\n * Name of event that records a viewport change.\n */\nexport const VIEWPORT_CHANGE = 'viewport_change';\n\n/**\n * Name of event that creates a comment.\n */\nexport const COMMENT_CREATE = 'comment_create';\n\n/**\n * Name of event that deletes a comment.\n */\nexport const COMMENT_DELETE = 'comment_delete';\n\n/**\n * Name of event that changes a comment.\n */\nexport const COMMENT_CHANGE = 'comment_change';\n\n/**\n * Name of event that moves a comment.\n */\nexport const COMMENT_MOVE = 'comment_move';\n\n/**\n * Name of event that records a workspace load.\n */\nexport const FINISHED_LOADING = 'finished_loading';\n\n/**\n * Type of events that cause objects to be bumped back into the visible\n * portion of the workspace.\n *\n * Not to be confused with bumping so that disconnected connections do not\n * appear connected.\n */\nexport type BumpEvent = BlockCreate | BlockMove | CommentCreate | CommentMove;\n\n/**\n * List of events that cause objects to be bumped back into the visible\n * portion of the workspace.\n *\n * Not to be confused with bumping so that disconnected connections do not\n * appear connected.\n */\nexport const BUMP_EVENTS: string[] = [\n  BLOCK_CREATE,\n  BLOCK_MOVE,\n  COMMENT_CREATE,\n  COMMENT_MOVE,\n];\n\n/** List of events queued for firing. */\nconst FIRE_QUEUE: Abstract[] = [];\n\n/**\n * Create a custom event and fire it.\n *\n * @param event Custom data for event.\n */\nexport function fire(event: Abstract) {\n  TEST_ONLY.fireInternal(event);\n}\n\n/**\n * Private version of fireInternal for stubbing in tests.\n */\nfunction fireInternal(event: Abstract) {\n  if (!isEnabled()) {\n    return;\n  }\n  if (!FIRE_QUEUE.length) {\n    // First event added; schedule a firing of the event queue.\n    try {\n      // If we are in a browser context, we want to make sure that the event\n      // fires after blocks have been rerendered this frame.\n      requestAnimationFrame(() => {\n        setTimeout(fireNow, 0);\n      });\n    } catch (e) {\n      // Otherwise we just want to delay so events can be coallesced.\n      // requestAnimationFrame will error triggering this.\n      setTimeout(fireNow, 0);\n    }\n  }\n  FIRE_QUEUE.push(event);\n}\n\n/** Fire all queued events. */\nfunction fireNow() {\n  const queue = filter(FIRE_QUEUE, true);\n  FIRE_QUEUE.length = 0;\n  for (let i = 0, event; (event = queue[i]); i++) {\n    if (!event.workspaceId) {\n      continue;\n    }\n    const eventWorkspace = common.getWorkspaceById(event.workspaceId);\n    if (eventWorkspace) {\n      eventWorkspace.fireChangeListener(event);\n    }\n  }\n\n  // Post-filter the undo stack to squash and remove any events that result in\n  // a null event\n\n  // 1. Determine which workspaces will need to have their undo stacks validated\n  const workspaceIds = new Set(queue.map((e) => e.workspaceId));\n  for (const workspaceId of workspaceIds) {\n    // Only process valid workspaces\n    if (!workspaceId) {\n      continue;\n    }\n    const eventWorkspace = common.getWorkspaceById(workspaceId);\n    if (!eventWorkspace) {\n      continue;\n    }\n\n    // Find the last contiguous group of events on the stack\n    const undoStack = eventWorkspace.getUndoStack();\n    let i;\n    let group: string | undefined = undefined;\n    for (i = undoStack.length; i > 0; i--) {\n      const event = undoStack[i - 1];\n      if (event.group === '') {\n        break;\n      } else if (group === undefined) {\n        group = event.group;\n      } else if (event.group !== group) {\n        break;\n      }\n    }\n    if (!group || i == undoStack.length - 1) {\n      // Need a group of two or more events on the stack. Nothing to do here.\n      continue;\n    }\n\n    // Extract the event group, filter, and add back to the undo stack\n    let events = undoStack.splice(i, undoStack.length - i);\n    events = filter(events, true);\n    undoStack.push(...events);\n  }\n}\n\n/**\n * Filter the queued events and merge duplicates.\n *\n * @param queueIn Array of events.\n * @param forward True if forward (redo), false if backward (undo).\n * @returns Array of filtered events.\n */\nexport function filter(queueIn: Abstract[], forward: boolean): Abstract[] {\n  let queue = queueIn.slice();\n  // Shallow copy of queue.\n  if (!forward) {\n    // Undo is merged in reverse order.\n    queue.reverse();\n  }\n  const mergedQueue = [];\n  const hash = Object.create(null);\n  // Merge duplicates.\n  for (let i = 0, event; (event = queue[i]); i++) {\n    if (!event.isNull()) {\n      // Treat all UI events as the same type in hash table.\n      const eventType = event.isUiEvent ? UI : event.type;\n      // TODO(#5927): Check whether `blockId` exists before accessing it.\n      const blockId = (event as AnyDuringMigration).blockId;\n      const key = [eventType, blockId, event.workspaceId].join(' ');\n\n      const lastEntry = hash[key];\n      const lastEvent = lastEntry ? lastEntry.event : null;\n      if (!lastEntry) {\n        // Each item in the hash table has the event and the index of that event\n        // in the input array.  This lets us make sure we only merge adjacent\n        // move events.\n        hash[key] = {event, index: i};\n        mergedQueue.push(event);\n      } else if (event.type === MOVE && lastEntry.index === i - 1) {\n        const moveEvent = event as BlockMove;\n        // Merge move events.\n        lastEvent.newParentId = moveEvent.newParentId;\n        lastEvent.newInputName = moveEvent.newInputName;\n        lastEvent.newCoordinate = moveEvent.newCoordinate;\n        if (moveEvent.reason) {\n          if (lastEvent.reason) {\n            // Concatenate reasons without duplicates.\n            const reasonSet = new Set(\n              moveEvent.reason.concat(lastEvent.reason)\n            );\n            lastEvent.reason = Array.from(reasonSet);\n          } else {\n            lastEvent.reason = moveEvent.reason;\n          }\n        }\n        lastEntry.index = i;\n      } else if (\n        event.type === CHANGE &&\n        (event as BlockChange).element === lastEvent.element &&\n        (event as BlockChange).name === lastEvent.name\n      ) {\n        const changeEvent = event as BlockChange;\n        // Merge change events.\n        lastEvent.newValue = changeEvent.newValue;\n      } else if (event.type === VIEWPORT_CHANGE) {\n        const viewportEvent = event as ViewportChange;\n        // Merge viewport change events.\n        lastEvent.viewTop = viewportEvent.viewTop;\n        lastEvent.viewLeft = viewportEvent.viewLeft;\n        lastEvent.scale = viewportEvent.scale;\n        lastEvent.oldScale = viewportEvent.oldScale;\n      } else if (event.type === CLICK && lastEvent.type === BUBBLE_OPEN) {\n        // Drop click events caused by opening/closing bubbles.\n      } else {\n        // Collision: newer events should merge into this event to maintain\n        // order.\n        hash[key] = {event, index: i};\n        mergedQueue.push(event);\n      }\n    }\n  }\n  // Filter out any events that have become null due to merging.\n  queue = mergedQueue.filter(function (e) {\n    return !e.isNull();\n  });\n  if (!forward) {\n    // Restore undo order.\n    queue.reverse();\n  }\n  // Move mutation events to the top of the queue.\n  // Intentionally skip first event.\n  for (let i = 1, event; (event = queue[i]); i++) {\n    // AnyDuringMigration because:  Property 'element' does not exist on type\n    // 'Abstract'.\n    if (\n      event.type === CHANGE &&\n      (event as AnyDuringMigration).element === 'mutation'\n    ) {\n      queue.unshift(queue.splice(i, 1)[0]);\n    }\n  }\n  return queue;\n}\n\n/**\n * Modify pending undo events so that when they are fired they don't land\n * in the undo stack.  Called by Workspace.clearUndo.\n */\nexport function clearPendingUndo() {\n  for (let i = 0, event; (event = FIRE_QUEUE[i]); i++) {\n    event.recordUndo = false;\n  }\n}\n\n/**\n * Stop sending events.  Every call to this function MUST also call enable.\n */\nexport function disable() {\n  disabled++;\n}\n\n/**\n * Start sending events.  Unless events were already disabled when the\n * corresponding call to disable was made.\n */\nexport function enable() {\n  disabled--;\n}\n\n/**\n * Returns whether events may be fired or not.\n *\n * @returns True if enabled.\n */\nexport function isEnabled(): boolean {\n  return disabled === 0;\n}\n\n/**\n * Current group.\n *\n * @returns ID string.\n */\nexport function getGroup(): string {\n  return group;\n}\n\n/**\n * Start or stop a group.\n *\n * @param state True to start new group, false to end group.\n *   String to set group explicitly.\n */\nexport function setGroup(state: boolean | string) {\n  TEST_ONLY.setGroupInternal(state);\n}\n\n/**\n * Private version of setGroup for stubbing in tests.\n */\nfunction setGroupInternal(state: boolean | string) {\n  if (typeof state === 'boolean') {\n    group = state ? idGenerator.genUid() : '';\n  } else {\n    group = state;\n  }\n}\n\n/**\n * Compute a list of the IDs of the specified block and all its descendants.\n *\n * @param block The root block.\n * @returns List of block IDs.\n * @internal\n */\nexport function getDescendantIds(block: Block): string[] {\n  const ids = [];\n  const descendants = block.getDescendants(false);\n  for (let i = 0, descendant; (descendant = descendants[i]); i++) {\n    ids[i] = descendant.id;\n  }\n  return ids;\n}\n\n/**\n * Decode the JSON into an event.\n *\n * @param json JSON representation.\n * @param workspace Target workspace for event.\n * @returns The event represented by the JSON.\n * @throws {Error} if an event type is not found in the registry.\n */\nexport function fromJson(\n  json: AnyDuringMigration,\n  workspace: Workspace\n): Abstract {\n  const eventClass = get(json['type']);\n  if (!eventClass) throw Error('Unknown event type.');\n\n  return (eventClass as any).fromJson(json, workspace);\n}\n\n/**\n * Gets the class for a specific event type from the registry.\n *\n * @param eventType The type of the event to get.\n * @returns The event class with the given type.\n */\nexport function get(\n  eventType: string\n): new (...p1: AnyDuringMigration[]) => Abstract {\n  const event = registry.getClass(registry.Type.EVENT, eventType);\n  if (!event) {\n    throw new Error(`Event type ${eventType} not found in registry.`);\n  }\n  return event;\n}\n\n/**\n * Enable/disable a block depending on whether it is properly connected.\n * Use this on applications where all blocks should be connected to a top block.\n * Recommend setting the 'disable' option to 'false' in the config so that\n * users don't try to re-enable disabled orphan blocks.\n *\n * @param event Custom data for event.\n */\nexport function disableOrphans(event: Abstract) {\n  if (event.type === MOVE || event.type === CREATE) {\n    const blockEvent = event as BlockMove | BlockCreate;\n    if (!blockEvent.workspaceId) {\n      return;\n    }\n    const eventWorkspace = common.getWorkspaceById(\n      blockEvent.workspaceId\n    ) as WorkspaceSvg;\n    if (!blockEvent.blockId) {\n      throw new Error('Encountered a blockEvent without a proper blockId');\n    }\n    let block = eventWorkspace.getBlockById(blockEvent.blockId);\n    if (block) {\n      // Changing blocks as part of this event shouldn't be undoable.\n      const initialUndoFlag = recordUndo;\n      try {\n        recordUndo = false;\n        const parent = block.getParent();\n        if (parent && parent.isEnabled()) {\n          const children = block.getDescendants(false);\n          for (let i = 0, child; (child = children[i]); i++) {\n            child.setEnabled(true);\n          }\n        } else if (\n          (block.outputConnection || block.previousConnection) &&\n          !eventWorkspace.isDragging()\n        ) {\n          do {\n            block.setEnabled(false);\n            block = block.getNextBlock();\n          } while (block);\n        }\n      } finally {\n        recordUndo = initialUndoFlag;\n      }\n    }\n  }\n}\n\nexport const TEST_ONLY = {\n  FIRE_QUEUE,\n  fireNow,\n  fireInternal,\n  setGroupInternal,\n};\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport interface ISerializable {\n  /**\n   * @param doFullSerialization If true, this signals that any backing data\n   *     structures used by this ISerializable should also be serialized. This\n   *     is used for copy-paste.\n   * @returns a JSON serializable value that records the ISerializable's state.\n   */\n  saveState(doFullSerialization: boolean): any;\n\n  /**\n   * Takes in a JSON serializable value and sets the ISerializable's state\n   * based on that.\n   *\n   * @param state The state to apply to the ISerializable.\n   */\n  loadState(state: any): void;\n}\n\n/** Type guard that checks whether the given object is a ISerializable. */\nexport function isSerializable(obj: any): obj is ISerializable {\n  return obj.saveState !== undefined && obj.loadState !== undefined;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.xml');\n\nlet domParser: DOMParser = {\n  parseFromString: function () {\n    throw new Error(\n      'DOMParser was not found in the global scope and was not properly ' +\n        'injected using injectDependencies'\n    );\n  },\n};\n\nlet xmlSerializer: XMLSerializer = {\n  serializeToString: function () {\n    throw new Error(\n      'XMLSerializer was not foundin the global scope and was not properly ' +\n        'injected using injectDependencies'\n    );\n  },\n};\n\n/**\n * Injected dependencies.  By default these are just (and have the\n * same types as) the corresponding DOM Window properties, but the\n * Node.js wrapper for Blockly (see scripts/package/node/core.js)\n * calls injectDependencies to supply implementations from the jsdom\n * package instead.\n */\nlet {document, DOMParser, XMLSerializer} = globalThis;\nif (DOMParser) domParser = new DOMParser();\nif (XMLSerializer) xmlSerializer = new XMLSerializer();\n\n/**\n * Inject implementations of document, DOMParser and/or XMLSerializer\n * to use instead of the default ones.\n *\n * Used by the Node.js wrapper for Blockly (see\n * scripts/package/node/core.js) to supply implementations from the\n * jsdom package instead.\n *\n * While they may be set individually, it is normally the case that\n * all three will be sourced from the same JSDOM instance.  They MUST\n * at least come from the same copy of the jsdom package.  (Typically\n * this is hard to avoid satsifying this requirement, but it can be\n * inadvertently violated by using webpack to build multiple bundles\n * containing Blockly and jsdom, and then loading more than one into\n * the same JavaScript runtime.  See\n * https://github.com/google/blockly-samples/pull/1452#issuecomment-1364442135\n * for an example of how this happened.)\n *\n * @param dependencies Options object containing dependencies to set.\n */\nexport function injectDependencies(dependencies: {\n  document?: Document;\n  DOMParser?: typeof DOMParser;\n  XMLSerializer?: typeof XMLSerializer;\n}) {\n  ({\n    // Default to existing value if option not supplied.\n    document = document,\n    DOMParser = DOMParser,\n    XMLSerializer = XMLSerializer,\n  } = dependencies);\n\n  domParser = new DOMParser();\n  xmlSerializer = new XMLSerializer();\n}\n\n/**\n * Namespace for Blockly's XML.\n */\nexport const NAME_SPACE = 'https://developers.google.com/blockly/xml';\n\n// eslint-disable-next-line no-control-regex\nconst INVALID_CONTROL_CHARS = /[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F]/g;\n\n/**\n * Create DOM element for XML.\n *\n * @param tagName Name of DOM element.\n * @returns New DOM element.\n */\nexport function createElement(tagName: string): Element {\n  return document.createElementNS(NAME_SPACE, tagName);\n}\n\n/**\n * Create text element for XML.\n *\n * @param text Text content.\n * @returns New DOM text node.\n */\nexport function createTextNode(text: string): Text {\n  return document.createTextNode(text);\n}\n\n/**\n * Converts an XML string into a DOM structure.\n *\n * Control characters should be escaped. (But we will try to best-effort parse\n * unescaped characters.)\n *\n * Note that even when escaped, U+0000 will be parsed as U+FFFD (the\n * \"replacement character\") because U+0000 is never a valid XML character\n * (even in XML 1.1).\n * https://www.w3.org/TR/xml11/#charsets\n *\n * @param text An XML string.\n * @returns A DOM object representing the singular child of the document\n *     element.\n * @throws if the text doesn't parse.\n */\nexport function textToDom(text: string): Element {\n  let doc = domParser.parseFromString(text, 'text/xml');\n  if (\n    doc &&\n    doc.documentElement &&\n    !doc.getElementsByTagName('parsererror').length\n  ) {\n    return doc.documentElement;\n  }\n\n  // Attempt to parse as HTML to deserialize control characters that were\n  // serialized before the serializer did proper escaping.\n  doc = domParser.parseFromString(text, 'text/html');\n  if (\n    doc &&\n    doc.body.firstChild &&\n    doc.body.firstChild.nodeName.toLowerCase() === 'xml'\n  ) {\n    return doc.body.firstChild as Element;\n  }\n\n  throw new Error(`DOMParser was unable to parse: ${text}`);\n}\n\n/**\n * Converts a DOM structure into plain text.\n * Currently the text format is fairly ugly: all one line with no whitespace.\n *\n * Control characters are escaped using their decimal encodings. This includes\n * U+0000 even though it is technically never a valid XML character (even in\n * XML 1.1).\n * https://www.w3.org/TR/xml11/#charsets\n *\n * When decoded U+0000 will be parsed as U+FFFD (the \"replacement character\").\n *\n * @param dom A tree of XML nodes.\n * @returns Text representation.\n */\nexport function domToText(dom: Node): string {\n  return sanitizeText(xmlSerializer.serializeToString(dom));\n}\n\nfunction sanitizeText(text: string) {\n  return text.replace(\n    INVALID_CONTROL_CHARS,\n    (match) => `&#${match.charCodeAt(0)};`\n  );\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.deprecation');\n\n/**\n * Warn developers that a function or property is deprecated.\n *\n * @param name The name of the function or property.\n * @param deprecationDate The date of deprecation. Prefer 'version n.0.0'\n *     format, and fall back to 'month yyyy' or 'quarter yyyy' format.\n * @param deletionDate The date of deletion. Prefer 'version n.0.0'\n *     format, and fall back to 'month yyyy' or 'quarter yyyy' format.\n * @param opt_use The name of a function or property to use instead, if any.\n * @internal\n */\nexport function warn(\n  name: string,\n  deprecationDate: string,\n  deletionDate: string,\n  opt_use?: string\n) {\n  let msg =\n    name +\n    ' was deprecated in ' +\n    deprecationDate +\n    ' and will be deleted in ' +\n    deletionDate +\n    '.';\n  if (opt_use) {\n    msg += '\\nUse ' + opt_use + ' instead.';\n  }\n  console.warn(msg);\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.dom');\n\nimport * as deprecation from './deprecation.js';\nimport type {Svg} from './svg.js';\n\n/**\n * Required name space for SVG elements.\n */\nexport const SVG_NS = 'http://www.w3.org/2000/svg';\n\n/**\n * Required name space for HTML elements.\n */\nexport const HTML_NS = 'http://www.w3.org/1999/xhtml';\n\n/**\n * Required name space for XLINK elements.\n */\nexport const XLINK_NS = 'http://www.w3.org/1999/xlink';\n\n/**\n * Node type constants.\n * https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\n */\nexport enum NodeType {\n  ELEMENT_NODE = 1,\n  TEXT_NODE = 3,\n  COMMENT_NODE = 8,\n}\n\n/** Temporary cache of text widths. */\nlet cacheWidths: {[key: string]: number} | null = null;\n\n/** Number of current references to cache. */\nlet cacheReference = 0;\n\n/** A HTML canvas context used for computing text width. */\nlet canvasContext: CanvasRenderingContext2D | null = null;\n\n/**\n * Helper method for creating SVG elements.\n *\n * @param name Element's tag name.\n * @param attrs Dictionary of attribute names and values.\n * @param opt_parent Optional parent on which to append the element.\n * @returns if name is a string or a more specific type if it a member of Svg.\n */\nexport function createSvgElement<T extends SVGElement>(\n  name: string | Svg<T>,\n  attrs: {[key: string]: string | number},\n  opt_parent?: Element | null\n): T {\n  const e = document.createElementNS(SVG_NS, `${name}`) as T;\n  for (const key in attrs) {\n    e.setAttribute(key, `${attrs[key]}`);\n  }\n  if (opt_parent) {\n    opt_parent.appendChild(e);\n  }\n  return e;\n}\n\n/**\n * Add a CSS class to a element.\n *\n * Handles multiple space-separated classes for legacy reasons.\n *\n * @param element DOM element to add class to.\n * @param className Name of class to add.\n * @returns True if class was added, false if already present.\n */\nexport function addClass(element: Element, className: string): boolean {\n  const classNames = className.split(' ');\n  if (classNames.every((name) => element.classList.contains(name))) {\n    return false;\n  }\n  element.classList.add(...classNames);\n  return true;\n}\n\n/**\n * Removes multiple classes from an element.\n *\n * @param element DOM element to remove classes from.\n * @param classNames A string of one or multiple class names for an element.\n */\nexport function removeClasses(element: Element, classNames: string) {\n  element.classList.remove(...classNames.split(' '));\n}\n\n/**\n * Remove a CSS class from a element.\n *\n * Handles multiple space-separated classes for legacy reasons.\n *\n * @param element DOM element to remove class from.\n * @param className Name of class to remove.\n * @returns True if class was removed, false if never present.\n */\nexport function removeClass(element: Element, className: string): boolean {\n  const classNames = className.split(' ');\n  if (classNames.every((name) => !element.classList.contains(name))) {\n    return false;\n  }\n  element.classList.remove(...classNames);\n  return true;\n}\n\n/**\n * Checks if an element has the specified CSS class.\n *\n * @param element DOM element to check.\n * @param className Name of class to check.\n * @returns True if class exists, false otherwise.\n */\nexport function hasClass(element: Element, className: string): boolean {\n  return element.classList.contains(className);\n}\n\n/**\n * Removes a node from its parent. No-op if not attached to a parent.\n *\n * @param node The node to remove.\n * @returns The node removed if removed; else, null.\n */\n// Copied from Closure goog.dom.removeNode\nexport function removeNode(node: Node | null): Node | null {\n  return node && node.parentNode ? node.parentNode.removeChild(node) : null;\n}\n\n/**\n * Insert a node after a reference node.\n * Contrast with node.insertBefore function.\n *\n * @param newNode New element to insert.\n * @param refNode Existing element to precede new node.\n */\nexport function insertAfter(newNode: Element, refNode: Element) {\n  const siblingNode = refNode.nextSibling;\n  const parentNode = refNode.parentNode;\n  if (!parentNode) {\n    throw Error('Reference node has no parent.');\n  }\n  if (siblingNode) {\n    parentNode.insertBefore(newNode, siblingNode);\n  } else {\n    parentNode.appendChild(newNode);\n  }\n}\n\n/**\n * Whether a node contains another node.\n *\n * @param parent The node that should contain the other node.\n * @param descendant The node to test presence of.\n * @returns Whether the parent node contains the descendant node.\n * @deprecated Use native 'contains' DOM method.\n */\nexport function containsNode(parent: Node, descendant: Node): boolean {\n  deprecation.warn(\n    'Blockly.utils.dom.containsNode',\n    'version 10',\n    'version 11',\n    'Use native \"contains\" DOM method'\n  );\n  return parent.contains(descendant);\n}\n\n/**\n * Sets the CSS transform property on an element. This function sets the\n * non-vendor-prefixed and vendor-prefixed versions for backwards compatibility\n * with older browsers. See https://caniuse.com/#feat=transforms2d\n *\n * @param element Element to which the CSS transform will be applied.\n * @param transform The value of the CSS `transform` property.\n */\nexport function setCssTransform(\n  element: HTMLElement | SVGElement,\n  transform: string\n) {\n  element.style['transform'] = transform;\n  element.style['-webkit-transform' as any] = transform;\n}\n\n/**\n * Start caching text widths. Every call to this function MUST also call\n * stopTextWidthCache. Caches must not survive between execution threads.\n */\nexport function startTextWidthCache() {\n  cacheReference++;\n  if (!cacheWidths) {\n    cacheWidths = Object.create(null);\n  }\n}\n\n/**\n * Stop caching field widths. Unless caching was already on when the\n * corresponding call to startTextWidthCache was made.\n */\nexport function stopTextWidthCache() {\n  cacheReference--;\n  if (!cacheReference) {\n    cacheWidths = null;\n  }\n}\n\n/**\n * Gets the width of a text element, caching it in the process.\n *\n * @param textElement An SVG 'text' element.\n * @returns Width of element.\n */\nexport function getTextWidth(textElement: SVGTextElement): number {\n  const key = textElement.textContent + '\\n' + textElement.className.baseVal;\n  let width;\n  // Return the cached width if it exists.\n  if (cacheWidths) {\n    width = cacheWidths[key];\n    if (width) {\n      return width;\n    }\n  }\n\n  // Attempt to compute fetch the width of the SVG text element.\n  try {\n    width = textElement.getComputedTextLength();\n  } catch (e) {\n    // In other cases where we fail to get the computed text. Instead, use an\n    // approximation and do not cache the result. At some later point in time\n    // when the block is inserted into the visible DOM, this method will be\n    // called again and, at that point in time, will not throw an exception.\n    return textElement.textContent!.length * 8;\n  }\n\n  // Cache the computed width and return.\n  if (cacheWidths) {\n    cacheWidths[key] = width;\n  }\n  return width;\n}\n\n/**\n * Gets the width of a text element using a faster method than `getTextWidth`.\n * This method requires that we know the text element's font family and size in\n * advance. Similar to `getTextWidth`, we cache the width we compute.\n *\n * @param textElement An SVG 'text' element.\n * @param fontSize The font size to use.\n * @param fontWeight The font weight to use.\n * @param fontFamily The font family to use.\n * @returns Width of element.\n */\nexport function getFastTextWidth(\n  textElement: SVGTextElement,\n  fontSize: number,\n  fontWeight: string,\n  fontFamily: string\n): number {\n  return getFastTextWidthWithSizeString(\n    textElement,\n    fontSize + 'pt',\n    fontWeight,\n    fontFamily\n  );\n}\n\n/**\n * Gets the width of a text element using a faster method than `getTextWidth`.\n * This method requires that we know the text element's font family and size in\n * advance. Similar to `getTextWidth`, we cache the width we compute.\n * This method is similar to `getFastTextWidth` but expects the font size\n * parameter to be a string.\n *\n * @param textElement An SVG 'text' element.\n * @param fontSize The font size to use.\n * @param fontWeight The font weight to use.\n * @param fontFamily The font family to use.\n * @returns Width of element.\n */\nexport function getFastTextWidthWithSizeString(\n  textElement: SVGTextElement,\n  fontSize: string,\n  fontWeight: string,\n  fontFamily: string\n): number {\n  const text = textElement.textContent;\n  const key = text + '\\n' + textElement.className.baseVal;\n  let width;\n\n  // Return the cached width if it exists.\n  if (cacheWidths) {\n    width = cacheWidths[key];\n    if (width) {\n      return width;\n    }\n  }\n\n  if (!canvasContext) {\n    // Inject the canvas element used for computing text widths.\n    const computeCanvas = document.createElement('canvas');\n    computeCanvas.className = 'blocklyComputeCanvas';\n    document.body.appendChild(computeCanvas);\n\n    // Initialize the HTML canvas context and set the font.\n    // The context font must match blocklyText's fontsize and font-family\n    // set in CSS.\n    canvasContext = computeCanvas.getContext('2d') as CanvasRenderingContext2D;\n  }\n  // Set the desired font size and family.\n  canvasContext.font = fontWeight + ' ' + fontSize + ' ' + fontFamily;\n\n  // Measure the text width using the helper canvas context.\n  if (text) {\n    width = canvasContext.measureText(text).width;\n  } else {\n    width = 0;\n  }\n\n  // Cache the computed width and return.\n  if (cacheWidths) {\n    cacheWidths[key] = width;\n  }\n  return width;\n}\n\n/**\n * Measure a font's metrics. The height and baseline values.\n *\n * @param text Text to measure the font dimensions of.\n * @param fontSize The font size to use.\n * @param fontWeight The font weight to use.\n * @param fontFamily The font family to use.\n * @returns Font measurements.\n */\nexport function measureFontMetrics(\n  text: string,\n  fontSize: string,\n  fontWeight: string,\n  fontFamily: string\n): {height: number; baseline: number} {\n  const span = document.createElement('span');\n  span.style.font = fontWeight + ' ' + fontSize + ' ' + fontFamily;\n  span.textContent = text;\n\n  const block = document.createElement('div');\n  block.style.width = '1px';\n  block.style.height = '0';\n\n  const div = document.createElement('div');\n  div.setAttribute('style', 'position: fixed; top: 0; left: 0; display: flex;');\n  div.appendChild(span);\n  div.appendChild(block);\n\n  document.body.appendChild(div);\n  const result = {\n    height: 0,\n    baseline: 0,\n  };\n  try {\n    div.style.alignItems = 'baseline';\n    result.baseline = block.offsetTop - span.offsetTop;\n    div.style.alignItems = 'flex-end';\n    result.height = block.offsetTop - span.offsetTop;\n  } finally {\n    document.body.removeChild(div);\n  }\n  return result;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.dialog');\n\nlet alertImplementation = function (\n  message: string,\n  opt_callback?: () => void\n) {\n  window.alert(message);\n  if (opt_callback) {\n    opt_callback();\n  }\n};\n\nlet confirmImplementation = function (\n  message: string,\n  callback: (result: boolean) => void\n) {\n  callback(window.confirm(message));\n};\n\nlet promptImplementation = function (\n  message: string,\n  defaultValue: string,\n  callback: (result: string | null) => void\n) {\n  callback(window.prompt(message, defaultValue));\n};\n\n/**\n * Wrapper to window.alert() that app developers may override via setAlert to\n * provide alternatives to the modal browser window.\n *\n * @param message The message to display to the user.\n * @param opt_callback The callback when the alert is dismissed.\n */\nexport function alert(message: string, opt_callback?: () => void) {\n  alertImplementation(message, opt_callback);\n}\n\n/**\n * Sets the function to be run when Blockly.dialog.alert() is called.\n *\n * @param alertFunction The function to be run.\n * @see Blockly.dialog.alert\n */\nexport function setAlert(alertFunction: (p1: string, p2?: () => void) => void) {\n  alertImplementation = alertFunction;\n}\n\n/**\n * Wrapper to window.confirm() that app developers may override via setConfirm\n * to provide alternatives to the modal browser window.\n *\n * @param message The message to display to the user.\n * @param callback The callback for handling user response.\n */\nexport function confirm(message: string, callback: (p1: boolean) => void) {\n  TEST_ONLY.confirmInternal(message, callback);\n}\n\n/**\n * Private version of confirm for stubbing in tests.\n */\nfunction confirmInternal(message: string, callback: (p1: boolean) => void) {\n  confirmImplementation(message, callback);\n}\n\n/**\n * Sets the function to be run when Blockly.dialog.confirm() is called.\n *\n * @param confirmFunction The function to be run.\n * @see Blockly.dialog.confirm\n */\nexport function setConfirm(\n  confirmFunction: (p1: string, p2: (p1: boolean) => void) => void\n) {\n  confirmImplementation = confirmFunction;\n}\n\n/**\n * Wrapper to window.prompt() that app developers may override via setPrompt to\n * provide alternatives to the modal browser window. Built-in browser prompts\n * are often used for better text input experience on mobile device. We strongly\n * recommend testing mobile when overriding this.\n *\n * @param message The message to display to the user.\n * @param defaultValue The value to initialize the prompt with.\n * @param callback The callback for handling user response.\n */\nexport function prompt(\n  message: string,\n  defaultValue: string,\n  callback: (p1: string | null) => void\n) {\n  promptImplementation(message, defaultValue, callback);\n}\n\n/**\n * Sets the function to be run when Blockly.dialog.prompt() is called.\n *\n * @param promptFunction The function to be run.\n * @see Blockly.dialog.prompt\n */\nexport function setPrompt(\n  promptFunction: (\n    p1: string,\n    p2: string,\n    p3: (p1: string | null) => void\n  ) => void\n) {\n  promptImplementation = promptFunction;\n}\n\nexport const TEST_ONLY = {\n  confirmInternal,\n};\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {VariableModel} from '../variable_model.js';\nimport {IParameterModel} from './i_parameter_model.js';\n\n/** Interface for a parameter model that holds a variable model. */\nexport interface IVariableBackedParameterModel extends IParameterModel {\n  /** Returns the variable model held by this type. */\n  getVariableModel(): VariableModel;\n}\n\n/**\n * Returns whether the given object is a variable holder or not.\n */\nexport function isVariableBackedParameterModel(\n  param: IParameterModel\n): param is IVariableBackedParameterModel {\n  return (param as any).getVariableModel !== undefined;\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Legacy means of representing a procedure signature. The elements are\n * respectively: name, parameter names, and whether it has a return value.\n */\nexport type ProcedureTuple = [string, string[], boolean];\n\n/**\n * Procedure block type.\n *\n * @internal\n */\nexport interface ProcedureBlock {\n  getProcedureCall: () => string;\n  renameProcedure: (p1: string, p2: string) => void;\n  getProcedureDef: () => ProcedureTuple;\n}\n\n/** @internal */\nexport interface LegacyProcedureDefBlock {\n  getProcedureDef: () => ProcedureTuple;\n}\n\n/** @internal */\nexport function isLegacyProcedureDefBlock(\n  block: Object\n): block is LegacyProcedureDefBlock {\n  return (block as any).getProcedureDef !== undefined;\n}\n\n/** @internal */\nexport interface LegacyProcedureCallBlock {\n  getProcedureCall: () => string;\n  renameProcedure: (p1: string, p2: string) => void;\n}\n\n/** @internal */\nexport function isLegacyProcedureCallBlock(\n  block: Object\n): block is LegacyProcedureCallBlock {\n  return (\n    (block as any).getProcedureCall !== undefined &&\n    (block as any).renameProcedure !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Variables');\n\nimport {Blocks} from './blocks.js';\nimport * as dialog from './dialog.js';\nimport {isVariableBackedParameterModel} from './interfaces/i_variable_backed_parameter_model.js';\nimport {Msg} from './msg.js';\nimport {isLegacyProcedureDefBlock} from './interfaces/i_legacy_procedure_blocks.js';\nimport * as utilsXml from './utils/xml.js';\nimport {VariableModel} from './variable_model.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n * See also Blockly.Procedures.CATEGORY_NAME and\n * Blockly.VariablesDynamic.CATEGORY_NAME.\n */\nexport const CATEGORY_NAME = 'VARIABLE';\n\n/**\n * Find all user-created variables that are in use in the workspace.\n * For use by generators.\n * To get a list of all variables on a workspace, including unused variables,\n * call Workspace.getAllVariables.\n *\n * @param ws The workspace to search for variables.\n * @returns Array of variable models.\n */\nexport function allUsedVarModels(ws: Workspace): VariableModel[] {\n  const blocks = ws.getAllBlocks(false);\n  const variables = new Set<VariableModel>();\n  // Iterate through every block and add each variable to the set.\n  for (let i = 0; i < blocks.length; i++) {\n    const blockVariables = blocks[i].getVarModels();\n    if (blockVariables) {\n      for (let j = 0; j < blockVariables.length; j++) {\n        const variable = blockVariables[j];\n        const id = variable.getId();\n        if (id) {\n          variables.add(variable);\n        }\n      }\n    }\n  }\n  // Convert the set into a list.\n  return Array.from(variables.values());\n}\n\n/**\n * Find all developer variables used by blocks in the workspace.\n * Developer variables are never shown to the user, but are declared as global\n * variables in the generated code.\n * To declare developer variables, define the getDeveloperVariables function on\n * your block and return a list of variable names.\n * For use by generators.\n *\n * @param workspace The workspace to search.\n * @returns A list of non-duplicated variable names.\n */\nexport function allDeveloperVariables(workspace: Workspace): string[] {\n  const blocks = workspace.getAllBlocks(false);\n  const variables = new Set<string>();\n  for (let i = 0, block; (block = blocks[i]); i++) {\n    const getDeveloperVariables = block.getDeveloperVariables;\n    if (getDeveloperVariables) {\n      const devVars = getDeveloperVariables();\n      for (let j = 0; j < devVars.length; j++) {\n        variables.add(devVars[j]);\n      }\n    }\n  }\n  // Convert the set into a list.\n  return Array.from(variables.values());\n}\n\n/**\n * Construct the elements (blocks and button) required by the flyout for the\n * variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML elements.\n */\nexport function flyoutCategory(workspace: WorkspaceSvg): Element[] {\n  let xmlList = new Array<Element>();\n  const button = document.createElement('button');\n  button.setAttribute('text', '%{BKY_NEW_VARIABLE}');\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE');\n\n  workspace.registerButtonCallback('CREATE_VARIABLE', function (button) {\n    createVariableButtonHandler(button.getTargetWorkspace());\n  });\n\n  xmlList.push(button);\n\n  const blockList = flyoutCategoryBlocks(workspace);\n  xmlList = xmlList.concat(blockList);\n  return xmlList;\n}\n\n/**\n * Construct the blocks required by the flyout for the variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML block elements.\n */\nexport function flyoutCategoryBlocks(workspace: Workspace): Element[] {\n  const variableModelList = workspace.getVariablesOfType('');\n\n  const xmlList = [];\n  if (variableModelList.length > 0) {\n    // New variables are added to the end of the variableModelList.\n    const mostRecentVariable = variableModelList[variableModelList.length - 1];\n    if (Blocks['variables_set']) {\n      const block = utilsXml.createElement('block');\n      block.setAttribute('type', 'variables_set');\n      block.setAttribute('gap', Blocks['math_change'] ? '8' : '24');\n      block.appendChild(generateVariableFieldDom(mostRecentVariable));\n      xmlList.push(block);\n    }\n    if (Blocks['math_change']) {\n      const block = utilsXml.createElement('block');\n      block.setAttribute('type', 'math_change');\n      block.setAttribute('gap', Blocks['variables_get'] ? '20' : '8');\n      block.appendChild(generateVariableFieldDom(mostRecentVariable));\n      const value = utilsXml.textToDom(\n        '<value name=\"DELTA\">' +\n          '<shadow type=\"math_number\">' +\n          '<field name=\"NUM\">1</field>' +\n          '</shadow>' +\n          '</value>'\n      );\n      block.appendChild(value);\n      xmlList.push(block);\n    }\n\n    if (Blocks['variables_get']) {\n      variableModelList.sort(VariableModel.compareByName);\n      for (let i = 0, variable; (variable = variableModelList[i]); i++) {\n        const block = utilsXml.createElement('block');\n        block.setAttribute('type', 'variables_get');\n        block.setAttribute('gap', '8');\n        block.appendChild(generateVariableFieldDom(variable));\n        xmlList.push(block);\n      }\n    }\n  }\n  return xmlList;\n}\n\nexport const VAR_LETTER_OPTIONS = 'ijkmnopqrstuvwxyzabcdefgh';\n\n/**\n * Return a new variable name that is not yet being used. This will try to\n * generate single letter variable names in the range 'i' to 'z' to start with.\n * If no unique name is located it will try 'i' to 'z', 'a' to 'h',\n * then 'i2' to 'z2' etc.  Skip 'l'.\n *\n * @param workspace The workspace to be unique in.\n * @returns New variable name.\n */\nexport function generateUniqueName(workspace: Workspace): string {\n  return TEST_ONLY.generateUniqueNameInternal(workspace);\n}\n\n/**\n * Private version of generateUniqueName for stubbing in tests.\n */\nfunction generateUniqueNameInternal(workspace: Workspace): string {\n  return generateUniqueNameFromOptions(\n    VAR_LETTER_OPTIONS.charAt(0),\n    workspace.getAllVariableNames()\n  );\n}\n\n/**\n * Returns a unique name that is not present in the usedNames array. This\n * will try to generate single letter names in the range a - z (skip l). It\n * will start with the character passed to startChar.\n *\n * @param startChar The character to start the search at.\n * @param usedNames A list of all of the used names.\n * @returns A unique name that is not present in the usedNames array.\n */\nexport function generateUniqueNameFromOptions(\n  startChar: string,\n  usedNames: string[]\n): string {\n  if (!usedNames.length) {\n    return startChar;\n  }\n\n  const letters = VAR_LETTER_OPTIONS;\n  let suffix = '';\n  let letterIndex = letters.indexOf(startChar);\n  let potName = startChar;\n\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    let inUse = false;\n    for (let i = 0; i < usedNames.length; i++) {\n      if (usedNames[i].toLowerCase() === potName) {\n        inUse = true;\n        break;\n      }\n    }\n    if (!inUse) {\n      break;\n    }\n\n    letterIndex++;\n    if (letterIndex === letters.length) {\n      // Reached the end of the character sequence so back to 'i'.\n      letterIndex = 0;\n      suffix = `${Number(suffix) + 1}`;\n    }\n    potName = letters.charAt(letterIndex) + suffix;\n  }\n  return potName;\n}\n\n/**\n * Handles \"Create Variable\" button in the default variables toolbox category.\n * It will prompt the user for a variable name, including re-prompts if a name\n * is already in use among the workspace's variables.\n *\n * Custom button handlers can delegate to this function, allowing variables\n * types and after-creation processing. More complex customization (e.g.,\n * prompting for variable type) is beyond the scope of this function.\n *\n * @param workspace The workspace on which to create the variable.\n * @param opt_callback A callback. It will be passed an acceptable new variable\n *     name, or null if change is to be aborted (cancel button), or undefined if\n *     an existing variable was chosen.\n * @param opt_type The type of the variable like 'int', 'string', or ''. This\n *     will default to '', which is a specific type.\n */\nexport function createVariableButtonHandler(\n  workspace: Workspace,\n  opt_callback?: (p1?: string | null) => void,\n  opt_type?: string\n) {\n  const type = opt_type || '';\n  // This function needs to be named so it can be called recursively.\n  function promptAndCheckWithAlert(defaultName: string) {\n    promptName(Msg['NEW_VARIABLE_TITLE'], defaultName, function (text) {\n      if (!text) {\n        // User canceled prompt.\n        if (opt_callback) opt_callback(null);\n        return;\n      }\n\n      const existing = nameUsedWithAnyType(text, workspace);\n      if (!existing) {\n        // No conflict\n        workspace.createVariable(text, type);\n        if (opt_callback) opt_callback(text);\n        return;\n      }\n\n      let msg;\n      if (existing.type === type) {\n        msg = Msg['VARIABLE_ALREADY_EXISTS'].replace('%1', existing.name);\n      } else {\n        msg = Msg['VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE'];\n        msg = msg.replace('%1', existing.name).replace('%2', existing.type);\n      }\n      dialog.alert(msg, function () {\n        promptAndCheckWithAlert(text);\n      });\n    });\n  }\n  promptAndCheckWithAlert('');\n}\n\n/**\n * Opens a prompt that allows the user to enter a new name for a variable.\n * Triggers a rename if the new name is valid. Or re-prompts if there is a\n * collision.\n *\n * @param workspace The workspace on which to rename the variable.\n * @param variable Variable to rename.\n * @param opt_callback A callback. It will be passed an acceptable new variable\n *     name, or null if change is to be aborted (cancel button), or undefined if\n *     an existing variable was chosen.\n */\nexport function renameVariable(\n  workspace: Workspace,\n  variable: VariableModel,\n  opt_callback?: (p1?: string | null) => void\n) {\n  // This function needs to be named so it can be called recursively.\n  function promptAndCheckWithAlert(defaultName: string) {\n    const promptText = Msg['RENAME_VARIABLE_TITLE'].replace(\n      '%1',\n      variable.name\n    );\n    promptName(promptText, defaultName, function (newName) {\n      if (!newName) {\n        // User canceled prompt.\n        if (opt_callback) opt_callback(null);\n        return;\n      }\n\n      const existing = nameUsedWithOtherType(newName, variable.type, workspace);\n      const procedure = nameUsedWithConflictingParam(\n        variable.name,\n        newName,\n        workspace\n      );\n      if (!existing && !procedure) {\n        // No conflict.\n        workspace.renameVariableById(variable.getId(), newName);\n        if (opt_callback) opt_callback(newName);\n        return;\n      }\n\n      let msg = '';\n      if (existing) {\n        msg = Msg['VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE']\n          .replace('%1', existing.name)\n          .replace('%2', existing.type);\n      } else if (procedure) {\n        msg = Msg['VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER']\n          .replace('%1', newName)\n          .replace('%2', procedure);\n      }\n      dialog.alert(msg, function () {\n        promptAndCheckWithAlert(newName);\n      });\n    });\n  }\n  promptAndCheckWithAlert('');\n}\n\n/**\n * Prompt the user for a new variable name.\n *\n * @param promptText The string of the prompt.\n * @param defaultText The default value to show in the prompt's field.\n * @param callback A callback. It will be passed the new variable name, or null\n *     if the user picked something illegal.\n */\nexport function promptName(\n  promptText: string,\n  defaultText: string,\n  callback: (p1: string | null) => void\n) {\n  dialog.prompt(promptText, defaultText, function (newVar) {\n    // Merge runs of whitespace.  Strip leading and trailing whitespace.\n    // Beyond this, all names are legal.\n    if (newVar) {\n      newVar = newVar.replace(/[\\s\\xa0]+/g, ' ').trim();\n      if (newVar === Msg['RENAME_VARIABLE'] || newVar === Msg['NEW_VARIABLE']) {\n        // Ok, not ALL names are legal...\n        newVar = null;\n      }\n    }\n    callback(newVar);\n  });\n}\n/**\n * Check whether there exists a variable with the given name but a different\n * type.\n *\n * @param name The name to search for.\n * @param type The type to exclude from the search.\n * @param workspace The workspace to search for the variable.\n * @returns The variable with the given name and a different type, or null if\n *     none was found.\n */\nfunction nameUsedWithOtherType(\n  name: string,\n  type: string,\n  workspace: Workspace\n): VariableModel | null {\n  const allVariables = workspace.getVariableMap().getAllVariables();\n\n  name = name.toLowerCase();\n  for (let i = 0, variable; (variable = allVariables[i]); i++) {\n    if (variable.name.toLowerCase() === name && variable.type !== type) {\n      return variable;\n    }\n  }\n  return null;\n}\n\n/**\n * Check whether there exists a variable with the given name of any type.\n *\n * @param name The name to search for.\n * @param workspace The workspace to search for the variable.\n * @returns The variable with the given name, or null if none was found.\n */\nexport function nameUsedWithAnyType(\n  name: string,\n  workspace: Workspace\n): VariableModel | null {\n  const allVariables = workspace.getVariableMap().getAllVariables();\n\n  name = name.toLowerCase();\n  for (let i = 0, variable; (variable = allVariables[i]); i++) {\n    if (variable.name.toLowerCase() === name) {\n      return variable;\n    }\n  }\n  return null;\n}\n\n/**\n * Returns the name of the procedure with a conflicting parameter name, or null\n * if one does not exist.\n *\n * This checks the procedure map if it contains models, and the legacy procedure\n * blocks otherwise.\n *\n * @param oldName The old name of the variable.\n * @param newName The proposed name of the variable.\n * @param workspace The workspace to search for conflicting parameters.\n * @internal\n */\nexport function nameUsedWithConflictingParam(\n  oldName: string,\n  newName: string,\n  workspace: Workspace\n): string | null {\n  return workspace.getProcedureMap().getProcedures().length\n    ? checkForConflictingParamWithProcedureModels(oldName, newName, workspace)\n    : checkForConflictingParamWithLegacyProcedures(oldName, newName, workspace);\n}\n\n/**\n * Returns the name of the procedure model with a conflicting param name, or\n * null if one does not exist.\n */\nfunction checkForConflictingParamWithProcedureModels(\n  oldName: string,\n  newName: string,\n  workspace: Workspace\n): string | null {\n  oldName = oldName.toLowerCase();\n  newName = newName.toLowerCase();\n\n  const procedures = workspace.getProcedureMap().getProcedures();\n  for (const procedure of procedures) {\n    const params = procedure\n      .getParameters()\n      .filter(isVariableBackedParameterModel)\n      .map((param) => param.getVariableModel().name);\n    if (!params) continue;\n    const procHasOld = params.some((param) => param.toLowerCase() === oldName);\n    const procHasNew = params.some((param) => param.toLowerCase() === newName);\n    if (procHasOld && procHasNew) return procedure.getName();\n  }\n  return null;\n}\n\n/**\n * Returns the name of the procedure block with a conflicting param name, or\n * null if one does not exist.\n */\nfunction checkForConflictingParamWithLegacyProcedures(\n  oldName: string,\n  newName: string,\n  workspace: Workspace\n): string | null {\n  oldName = oldName.toLowerCase();\n  newName = newName.toLowerCase();\n\n  const blocks = workspace.getAllBlocks(false);\n  for (const block of blocks) {\n    if (!isLegacyProcedureDefBlock(block)) continue;\n    const def = block.getProcedureDef();\n    const params = def[1];\n    const blockHasOld = params.some((param) => param.toLowerCase() === oldName);\n    const blockHasNew = params.some((param) => param.toLowerCase() === newName);\n    if (blockHasOld && blockHasNew) return def[0];\n  }\n  return null;\n}\n\n/**\n * Generate DOM objects representing a variable field.\n *\n * @param variableModel The variable model to represent.\n * @returns The generated DOM.\n */\nexport function generateVariableFieldDom(\n  variableModel: VariableModel\n): Element {\n  /* Generates the following XML:\n   * <field name=\"VAR\" id=\"goKTKmYJ8DhVHpruv\" variabletype=\"int\">foo</field>\n   */\n  const field = utilsXml.createElement('field');\n  field.setAttribute('name', 'VAR');\n  field.setAttribute('id', variableModel.getId());\n  field.setAttribute('variabletype', variableModel.type);\n  const name = utilsXml.createTextNode(variableModel.name);\n  field.appendChild(name);\n  return field;\n}\n\n/**\n * Helper function to look up or create a variable on the given workspace.\n * If no variable exists, creates and returns it.\n *\n * @param workspace The workspace to search for the variable.  It may be a\n *     flyout workspace or main workspace.\n * @param id The ID to use to look up or create the variable, or null.\n * @param opt_name The string to use to look up or create the variable.\n * @param opt_type The type to use to look up or create the variable.\n * @returns The variable corresponding to the given ID or name + type\n *     combination.\n */\nexport function getOrCreateVariablePackage(\n  workspace: Workspace,\n  id: string | null,\n  opt_name?: string,\n  opt_type?: string\n): VariableModel {\n  let variable = getVariable(workspace, id, opt_name, opt_type);\n  if (!variable) {\n    variable = createVariable(workspace, id, opt_name, opt_type);\n  }\n  return variable;\n}\n\n/**\n * Look up  a variable on the given workspace.\n * Always looks in the main workspace before looking in the flyout workspace.\n * Always prefers lookup by ID to lookup by name + type.\n *\n * @param workspace The workspace to search for the variable.  It may be a\n *     flyout workspace or main workspace.\n * @param id The ID to use to look up the variable, or null.\n * @param opt_name The string to use to look up the variable.\n *     Only used if lookup by ID fails.\n * @param opt_type The type to use to look up the variable.\n *     Only used if lookup by ID fails.\n * @returns The variable corresponding to the given ID or name + type\n *     combination, or null if not found.\n */\nexport function getVariable(\n  workspace: Workspace,\n  id: string | null,\n  opt_name?: string,\n  opt_type?: string\n): VariableModel | null {\n  const potentialVariableMap = workspace.getPotentialVariableMap();\n  let variable = null;\n  // Try to just get the variable, by ID if possible.\n  if (id) {\n    // Look in the real variable map before checking the potential variable map.\n    variable = workspace.getVariableById(id);\n    if (!variable && potentialVariableMap) {\n      variable = potentialVariableMap.getVariableById(id);\n    }\n    if (variable) {\n      return variable;\n    }\n  }\n  // If there was no ID, or there was an ID but it didn't match any variables,\n  // look up by name and type.\n  if (opt_name) {\n    if (opt_type === undefined) {\n      throw Error('Tried to look up a variable by name without a type');\n    }\n    // Otherwise look up by name and type.\n    variable = workspace.getVariable(opt_name, opt_type);\n    if (!variable && potentialVariableMap) {\n      variable = potentialVariableMap.getVariable(opt_name, opt_type);\n    }\n  }\n  return variable;\n}\n\n/**\n * Helper function to create a variable on the given workspace.\n *\n * @param workspace The workspace in which to create the variable.  It may be a\n *     flyout workspace or main workspace.\n * @param id The ID to use to create the variable, or null.\n * @param opt_name The string to use to create the variable.\n * @param opt_type The type to use to create the variable.\n * @returns The variable corresponding to the given ID or name + type\n *     combination.\n */\nfunction createVariable(\n  workspace: Workspace,\n  id: string | null,\n  opt_name?: string,\n  opt_type?: string\n): VariableModel {\n  const potentialVariableMap = workspace.getPotentialVariableMap();\n  // Variables without names get uniquely named for this workspace.\n  if (!opt_name) {\n    const ws = workspace.isFlyout\n      ? (workspace as WorkspaceSvg).targetWorkspace\n      : workspace;\n    opt_name = generateUniqueName(ws!);\n  }\n\n  // Create a potential variable if in the flyout.\n  let variable = null;\n  if (potentialVariableMap) {\n    variable = potentialVariableMap.createVariable(opt_name, opt_type, id);\n  } else {\n    // In the main workspace, create a real variable.\n    variable = workspace.createVariable(opt_name, opt_type, id);\n  }\n  return variable;\n}\n\n/**\n * Helper function to get the list of variables that have been added to the\n * workspace after adding a new block, using the given list of variables that\n * were in the workspace before the new block was added.\n *\n * @param workspace The workspace to inspect.\n * @param originalVariables The array of variables that existed in the workspace\n *     before adding the new block.\n * @returns The new array of variables that were freshly added to the workspace\n *     after creating the new block, or [] if no new variables were added to the\n *     workspace.\n * @internal\n */\nexport function getAddedVariables(\n  workspace: Workspace,\n  originalVariables: VariableModel[]\n): VariableModel[] {\n  const allCurrentVariables = workspace.getAllVariables();\n  const addedVariables = [];\n  if (originalVariables.length !== allCurrentVariables.length) {\n    for (let i = 0; i < allCurrentVariables.length; i++) {\n      const variable = allCurrentVariables[i];\n      // For any variable that is present in allCurrentVariables but not\n      // present in originalVariables, add the variable to addedVariables.\n      if (originalVariables.indexOf(variable) === -1) {\n        addedVariables.push(variable);\n      }\n    }\n  }\n  return addedVariables;\n}\n\nexport const TEST_ONLY = {\n  generateUniqueNameInternal,\n};\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Touch');\n\nimport type {Gesture} from './gesture.js';\n\n/** Length in ms for a touch to become a long press. */\nconst LONGPRESS = 750;\n\n/**\n * Whether touch is enabled in the browser.\n * Copied from Closure's goog.events.BrowserFeature.TOUCH_ENABLED\n */\nexport const TOUCH_ENABLED =\n  'ontouchstart' in globalThis ||\n  !!(\n    globalThis['document'] &&\n    document.documentElement &&\n    'ontouchstart' in document.documentElement\n  ) || // IE10 uses non-standard touch events,\n  // so it has a different check.\n  !!(\n    globalThis['navigator'] &&\n    (globalThis['navigator']['maxTouchPoints'] ||\n      (globalThis['navigator'] as any)['msMaxTouchPoints'])\n  );\n\n/** Which touch events are we currently paying attention to? */\nlet touchIdentifier_: string | null = null;\n\n/**\n * The TOUCH_MAP lookup dictionary specifies additional touch events to fire,\n * in conjunction with mouse events.\n */\nexport const TOUCH_MAP: {[key: string]: string[]} = {\n  'mousedown': ['pointerdown'],\n  'mouseenter': ['pointerenter'],\n  'mouseleave': ['pointerleave'],\n  'mousemove': ['pointermove'],\n  'mouseout': ['pointerout'],\n  'mouseover': ['pointerover'],\n  'mouseup': ['pointerup', 'pointercancel'],\n  'touchend': ['pointerup'],\n  'touchcancel': ['pointercancel'],\n};\n\n/** PID of queued long-press task. */\nlet longPid_: AnyDuringMigration = 0;\n\n/**\n * Context menus on touch devices are activated using a long-press.\n * Unfortunately the contextmenu touch event is currently (2015) only supported\n * by Chrome.  This function is fired on any touchstart event, queues a task,\n * which after about a second opens the context menu.  The tasks is killed\n * if the touch event terminates early.\n *\n * @param e Touch start event.\n * @param gesture The gesture that triggered this longStart.\n * @internal\n */\nexport function longStart(e: PointerEvent, gesture: Gesture) {\n  longStop();\n  longPid_ = setTimeout(function () {\n    // Let the gesture route the right-click correctly.\n    if (gesture) {\n      gesture.handleRightClick(e);\n    }\n  }, LONGPRESS);\n}\n\n/**\n * Nope, that's not a long-press.  Either touchend or touchcancel was fired,\n * or a drag hath begun.  Kill the queued long-press task.\n *\n * @internal\n */\nexport function longStop() {\n  if (longPid_) {\n    clearTimeout(longPid_);\n    longPid_ = 0;\n  }\n}\n\n/**\n * Clear the touch identifier that tracks which touch stream to pay attention\n * to.  This ends the current drag/gesture and allows other pointers to be\n * captured.\n */\nexport function clearTouchIdentifier() {\n  touchIdentifier_ = null;\n}\n\n/**\n * Decide whether Blockly should handle or ignore this event.\n * Mouse and touch events require special checks because we only want to deal\n * with one touch stream at a time.  All other events should always be handled.\n *\n * @param e The event to check.\n * @returns True if this event should be passed through to the registered\n *     handler; false if it should be blocked.\n */\nexport function shouldHandleEvent(e: Event): boolean {\n  // Do not replace the startsWith with a check for `instanceof PointerEvent`.\n  // `click` and `contextmenu` are PointerEvents in some browsers,\n  // despite not starting with `pointer`, but we want to always handle them\n  // without worrying about touch identifiers.\n  return (\n    !e.type.startsWith('pointer') ||\n    (e instanceof PointerEvent && checkTouchIdentifier(e))\n  );\n}\n\n/**\n * Get the pointer identifier from the given event.\n *\n * @param e Pointer event.\n * @returns The pointerId of the event.\n */\nexport function getTouchIdentifierFromEvent(e: PointerEvent): string {\n  return `${e.pointerId}`;\n}\n\n/**\n * Check whether the pointer identifier on the event matches the current saved\n * identifier. If the current identifier was unset, save the identifier from\n * the event. This starts a drag/gesture, during which pointer events with\n * other identifiers will be silently ignored.\n *\n * @param e Pointer event.\n * @returns Whether the identifier on the event matches the current saved\n *     identifier.\n */\nexport function checkTouchIdentifier(e: PointerEvent): boolean {\n  const identifier = getTouchIdentifierFromEvent(e);\n\n  if (touchIdentifier_) {\n    // We're already tracking some touch/mouse event.  Is this from the same\n    // source?\n    return touchIdentifier_ === identifier;\n  }\n  if (e.type === 'pointerdown') {\n    // No identifier set yet, and this is the start of a drag.  Set it and\n    // return.\n    touchIdentifier_ = identifier;\n    return true;\n  }\n  // There was no identifier yet, but this wasn't a start event so we're going\n  // to ignore it.  This probably means that another drag finished while this\n  // pointer was down.\n  return false;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.browserEvents');\n\nimport * as Touch from './touch.js';\nimport * as userAgent from './utils/useragent.js';\n\n/**\n * Blockly opaque event data used to unbind events when using\n * `bind` and `conditionalBind`.\n */\nexport type Data = [EventTarget, string, (e: Event) => void][];\n\n/**\n * The multiplier for scroll wheel deltas using the line delta mode.\n * See https://developer.mozilla.org/en-US/docs/Web/API/WheelEvent/deltaMode\n * for more information on deltaMode.\n */\nconst LINE_MODE_MULTIPLIER = 40;\n\n/**\n * The multiplier for scroll wheel deltas using the page delta mode.\n * See https://developer.mozilla.org/en-US/docs/Web/API/WheelEvent/deltaMode\n * for more information on deltaMode.\n */\nconst PAGE_MODE_MULTIPLIER = 125;\n\n/**\n * Bind an event handler that can be ignored if it is not part of the active\n * touch stream.\n * Use this for events that either start or continue a multi-part gesture (e.g.\n * mousedown or mousemove, which may be part of a drag or click).\n *\n * @param node Node upon which to listen.\n * @param name Event name to listen to (e.g. 'mousedown').\n * @param thisObject The value of 'this' in the function.\n * @param func Function to call when event is triggered.\n * @param opt_noCaptureIdentifier True if triggering on this event should not\n *     block execution of other event handlers on this touch or other\n *     simultaneous touches.  False by default.\n * @returns Opaque data that can be passed to unbindEvent_.\n */\nexport function conditionalBind(\n  node: EventTarget,\n  name: string,\n  thisObject: Object | null,\n  func: Function,\n  opt_noCaptureIdentifier?: boolean\n): Data {\n  /**\n   *\n   * @param e\n   */\n  function wrapFunc(e: Event) {\n    const captureIdentifier = !opt_noCaptureIdentifier;\n\n    if (!(captureIdentifier && !Touch.shouldHandleEvent(e))) {\n      if (thisObject) {\n        func.call(thisObject, e);\n      } else {\n        func(e);\n      }\n    }\n  }\n\n  const bindData: Data = [];\n  if (name in Touch.TOUCH_MAP) {\n    for (let i = 0; i < Touch.TOUCH_MAP[name].length; i++) {\n      const type = Touch.TOUCH_MAP[name][i];\n      node.addEventListener(type, wrapFunc, false);\n      bindData.push([node, type, wrapFunc]);\n    }\n  } else {\n    node.addEventListener(name, wrapFunc, false);\n    bindData.push([node, name, wrapFunc]);\n  }\n  return bindData;\n}\n\n/**\n * Bind an event handler that should be called regardless of whether it is part\n * of the active touch stream.\n * Use this for events that are not part of a multi-part gesture (e.g.\n * mouseover for tooltips).\n *\n * @param node Node upon which to listen.\n * @param name Event name to listen to (e.g. 'mousedown').\n * @param thisObject The value of 'this' in the function.\n * @param func Function to call when event is triggered.\n * @returns Opaque data that can be passed to unbindEvent_.\n */\nexport function bind(\n  node: EventTarget,\n  name: string,\n  thisObject: Object | null,\n  func: Function\n): Data {\n  /**\n   *\n   * @param e\n   */\n  function wrapFunc(e: Event) {\n    if (thisObject) {\n      func.call(thisObject, e);\n    } else {\n      func(e);\n    }\n  }\n\n  const bindData: Data = [];\n  if (name in Touch.TOUCH_MAP) {\n    for (let i = 0; i < Touch.TOUCH_MAP[name].length; i++) {\n      const type = Touch.TOUCH_MAP[name][i];\n      node.addEventListener(type, wrapFunc, false);\n      bindData.push([node, type, wrapFunc]);\n    }\n  } else {\n    node.addEventListener(name, wrapFunc, false);\n    bindData.push([node, name, wrapFunc]);\n  }\n  return bindData;\n}\n\n/**\n * Unbind one or more events event from a function call.\n *\n * @param bindData Opaque data from bindEvent_.\n *     This list is emptied during the course of calling this function.\n * @returns The function call.\n */\nexport function unbind(bindData: Data): (e: Event) => void {\n  // Accessing an element of the last property of the array is unsafe if the\n  // bindData is an empty array. But that should never happen because developers\n  // should only pass Data from bind or conditionalBind.\n  const callback = bindData[bindData.length - 1][2];\n  while (bindData.length) {\n    const [node, name, func] = bindData.pop()!;\n    node.removeEventListener(name, func, false);\n  }\n  return callback;\n}\n\n/**\n * Returns true if this event is targeting a text input widget?\n *\n * @param e An event.\n * @returns True if text input.\n */\nexport function isTargetInput(e: Event): boolean {\n  if (e.target instanceof HTMLElement) {\n    if (\n      e.target.isContentEditable ||\n      e.target.getAttribute('data-is-text-input') === 'true'\n    ) {\n      return true;\n    }\n\n    if (e.target instanceof HTMLInputElement) {\n      const target = e.target;\n      return (\n        target.type === 'text' ||\n        target.type === 'number' ||\n        target.type === 'email' ||\n        target.type === 'password' ||\n        target.type === 'search' ||\n        target.type === 'tel' ||\n        target.type === 'url'\n      );\n    }\n\n    if (e.target instanceof HTMLTextAreaElement) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Returns true this event is a right-click.\n *\n * @param e Mouse event.\n * @returns True if right-click.\n */\nexport function isRightButton(e: MouseEvent): boolean {\n  if (e.ctrlKey && userAgent.MAC) {\n    // Control-clicking on Mac OS X is treated as a right-click.\n    // WebKit on Mac OS X fails to change button to 2 (but Gecko does).\n    return true;\n  }\n  return e.button === 2;\n}\n\n/**\n * Returns the converted coordinates of the given mouse event.\n * The origin (0,0) is the top-left corner of the Blockly SVG.\n *\n * @param e Mouse event.\n * @param svg SVG element.\n * @param matrix Inverted screen CTM to use.\n * @returns Object with .x and .y properties.\n */\nexport function mouseToSvg(\n  e: MouseEvent,\n  svg: SVGSVGElement,\n  matrix: SVGMatrix | null\n): SVGPoint {\n  const svgPoint = svg.createSVGPoint();\n  svgPoint.x = e.clientX;\n  svgPoint.y = e.clientY;\n\n  if (!matrix) {\n    matrix = svg.getScreenCTM()!.inverse();\n  }\n  return svgPoint.matrixTransform(matrix);\n}\n\n/**\n * Returns the scroll delta of a mouse event in pixel units.\n *\n * @param e Mouse event.\n * @returns Scroll delta object with .x and .y properties.\n */\nexport function getScrollDeltaPixels(e: WheelEvent): {x: number; y: number} {\n  switch (e.deltaMode) {\n    case 0x00: // Pixel mode.\n    default:\n      return {x: e.deltaX, y: e.deltaY};\n    case 0x01: // Line mode.\n      return {\n        x: e.deltaX * LINE_MODE_MULTIPLIER,\n        y: e.deltaY * LINE_MODE_MULTIPLIER,\n      };\n    case 0x02: // Page mode.\n      return {\n        x: e.deltaX * PAGE_MODE_MULTIPLIER,\n        y: e.deltaY * PAGE_MODE_MULTIPLIER,\n      };\n  }\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Css');\n\n/** Has CSS already been injected? */\nlet injected = false;\n\n/**\n * Add some CSS to the blob that will be injected later.  Allows optional\n * components such as fields and the toolbox to store separate CSS.\n *\n * @param cssContent Multiline CSS string or an array of single lines of CSS.\n */\nexport function register(cssContent: string) {\n  if (injected) {\n    throw Error('CSS already injected');\n  }\n  content += '\\n' + cssContent;\n}\n\n/**\n * Inject the CSS into the DOM.  This is preferable over using a regular CSS\n * file since:\n * a) It loads synchronously and doesn't force a redraw later.\n * b) It speeds up loading by not blocking on a separate HTTP transfer.\n * c) The CSS content may be made dynamic depending on init options.\n *\n * @param hasCss If false, don't inject CSS (providing CSS becomes the\n *     document's responsibility).\n * @param pathToMedia Path from page to the Blockly media directory.\n */\nexport function inject(hasCss: boolean, pathToMedia: string) {\n  // Only inject the CSS once.\n  if (injected) {\n    return;\n  }\n  injected = true;\n  if (!hasCss) {\n    return;\n  }\n  // Strip off any trailing slash (either Unix or Windows).\n  const mediaPath = pathToMedia.replace(/[\\\\/]$/, '');\n  const cssContent = content.replace(/<<<PATH>>>/g, mediaPath);\n  // Cleanup the collected css content after injecting it to the DOM.\n  content = '';\n\n  // Inject CSS tag at start of head.\n  const cssNode = document.createElement('style');\n  cssNode.id = 'blockly-common-style';\n  const cssTextNode = document.createTextNode(cssContent);\n  cssNode.appendChild(cssTextNode);\n  document.head.insertBefore(cssNode, document.head.firstChild);\n}\n\n/**\n * The CSS content for Blockly.\n */\nlet content = `\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n}\n\n.blocklyNonSelectable {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n  overflow: auto;\n  overflow-x: hidden;\n  position: relative;\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n}\n\n.blocklyDropDownButton {\n  display: inline-block;\n  float: left;\n  padding: 0;\n  margin: 4px;\n  border-radius: 4px;\n  outline: none;\n  border: 1px solid;\n  transition: box-shadow .1s;\n  cursor: pointer;\n}\n\n.blocklyArrowTop {\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyArrowBottom {\n  border-bottom: 1px solid;\n  border-right: 1px solid;\n  border-bottom-right-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyResizeSE {\n  cursor: se-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeSW {\n  cursor: sw-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeLine {\n  stroke: #515A5A;\n  stroke-width: 1;\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabled>.blocklyPath {\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyMultilineText {\n  font-family: monospace;\n}\n\n.blocklyNonEditableText>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don't allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyHidden {\n  display: none;\n}\n\n.blocklyFieldDropdown:not(.blocklyHidden) {\n  display: block;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px \"Helvetica Neue\", Helvetica, sans-serif;\n  outline: none;\n  position: relative;  /* Compatibility with gapi, reset from goog-menu */\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n`;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.style');\n\nimport {Coordinate} from './coordinate.js';\nimport {Rect} from './rect.js';\nimport {Size} from './size.js';\n\n/**\n * Gets the height and width of an element.\n * Similar to Closure's goog.style.getSize\n *\n * @param element Element to get size of.\n * @returns Object with width/height properties.\n */\nexport function getSize(element: Element): Size {\n  return TEST_ONLY.getSizeInternal(element);\n}\n\n/**\n * Private version of getSize for stubbing in tests.\n */\nfunction getSizeInternal(element: Element): Size {\n  if (getComputedStyle(element, 'display') !== 'none') {\n    return getSizeWithDisplay(element);\n  }\n\n  // Evaluate size with a temporary element.\n  // AnyDuringMigration because:  Property 'style' does not exist on type\n  // 'Element'.\n  const style = (element as AnyDuringMigration).style;\n  const originalDisplay = style.display;\n  const originalVisibility = style.visibility;\n  const originalPosition = style.position;\n\n  style.visibility = 'hidden';\n  style.position = 'absolute';\n  style.display = 'inline';\n\n  const offsetWidth = (element as HTMLElement).offsetWidth;\n  const offsetHeight = (element as HTMLElement).offsetHeight;\n\n  style.display = originalDisplay;\n  style.position = originalPosition;\n  style.visibility = originalVisibility;\n\n  return new Size(offsetWidth, offsetHeight);\n}\n\n/**\n * Gets the height and width of an element when the display is not none.\n *\n * @param element Element to get size of.\n * @returns Object with width/height properties.\n */\nfunction getSizeWithDisplay(element: Element): Size {\n  const offsetWidth = (element as HTMLElement).offsetWidth;\n  const offsetHeight = (element as HTMLElement).offsetHeight;\n  return new Size(offsetWidth, offsetHeight);\n}\n\n/**\n * Retrieves a computed style value of a node. It returns empty string\n * if the property requested is an SVG one and it has not been\n * explicitly set (firefox and webkit).\n *\n * Copied from Closure's goog.style.getComputedStyle\n *\n * @param element Element to get style of.\n * @param property Property to get (camel-case).\n * @returns Style value.\n */\nexport function getComputedStyle(element: Element, property: string): string {\n  const styles = window.getComputedStyle(element);\n  // element.style[..] is undefined for browser specific styles\n  // as 'filter'.\n  return (\n    (styles as AnyDuringMigration)[property] ||\n    styles.getPropertyValue(property)\n  );\n}\n\n/**\n * Returns a Coordinate object relative to the top-left of the HTML document.\n * Similar to Closure's goog.style.getPageOffset\n *\n * @param el Element to get the page offset for.\n * @returns The page offset.\n */\nexport function getPageOffset(el: Element): Coordinate {\n  const pos = new Coordinate(0, 0);\n  const box = el.getBoundingClientRect();\n  const documentElement = document.documentElement;\n  // Must add the scroll coordinates in to get the absolute page offset\n  // of element since getBoundingClientRect returns relative coordinates to\n  // the viewport.\n  const scrollCoord = new Coordinate(\n    window.pageXOffset || documentElement.scrollLeft,\n    window.pageYOffset || documentElement.scrollTop\n  );\n  pos.x = box.left + scrollCoord.x;\n  pos.y = box.top + scrollCoord.y;\n\n  return pos;\n}\n\n/**\n * Calculates the viewport coordinates relative to the document.\n * Similar to Closure's goog.style.getViewportPageOffset\n *\n * @returns The page offset of the viewport.\n */\nexport function getViewportPageOffset(): Coordinate {\n  const body = document.body;\n  const documentElement = document.documentElement;\n  const scrollLeft = body.scrollLeft || documentElement.scrollLeft;\n  const scrollTop = body.scrollTop || documentElement.scrollTop;\n  return new Coordinate(scrollLeft, scrollTop);\n}\n\n/**\n * Gets the computed border widths (on all sides) in pixels\n * Copied from Closure's goog.style.getBorderBox\n *\n * @param element  The element to get the border widths for.\n * @returns The computed border widths.\n */\nexport function getBorderBox(element: Element): Rect {\n  const left = parseFloat(getComputedStyle(element, 'borderLeftWidth'));\n  const right = parseFloat(getComputedStyle(element, 'borderRightWidth'));\n  const top = parseFloat(getComputedStyle(element, 'borderTopWidth'));\n  const bottom = parseFloat(getComputedStyle(element, 'borderBottomWidth'));\n\n  return new Rect(top, bottom, left, right);\n}\n\n/**\n * Changes the scroll position of `container` with the minimum amount so\n * that the content and the borders of the given `element` become visible.\n * If the element is bigger than the container, its top left corner will be\n * aligned as close to the container's top left corner as possible.\n * Copied from Closure's goog.style.scrollIntoContainerView\n *\n * @param element The element to make visible.\n * @param container The container to scroll. If not set, then the document\n *     scroll element will be used.\n * @param opt_center Whether to center the element in the container.\n *     Defaults to false.\n */\nexport function scrollIntoContainerView(\n  element: Element,\n  container: Element,\n  opt_center?: boolean\n) {\n  const offset = getContainerOffsetToScrollInto(element, container, opt_center);\n  container.scrollLeft = offset.x;\n  container.scrollTop = offset.y;\n}\n\n/**\n * Calculate the scroll position of `container` with the minimum amount so\n * that the content and the borders of the given `element` become visible.\n * If the element is bigger than the container, its top left corner will be\n * aligned as close to the container's top left corner as possible.\n * Copied from Closure's goog.style.getContainerOffsetToScrollInto\n *\n * @param element The element to make visible.\n * @param container The container to scroll. If not set, then the document\n *     scroll element will be used.\n * @param opt_center Whether to center the element in the container.\n *     Defaults to false.\n * @returns The new scroll position of the container.\n */\nexport function getContainerOffsetToScrollInto(\n  element: Element,\n  container: Element,\n  opt_center?: boolean\n): Coordinate {\n  // Absolute position of the element's border's top left corner.\n  const elementPos = getPageOffset(element);\n  // Absolute position of the container's border's top left corner.\n  const containerPos = getPageOffset(container);\n  const containerBorder = getBorderBox(container);\n  // Relative pos. of the element's border box to the container's content box.\n  const relX = elementPos.x - containerPos.x - containerBorder.left;\n  const relY = elementPos.y - containerPos.y - containerBorder.top;\n  // How much the element can move in the container, i.e. the difference between\n  // the element's bottom-right-most and top-left-most position where it's\n  // fully visible.\n  const elementSize = getSizeWithDisplay(element);\n  const spaceX = container.clientWidth - elementSize.width;\n  const spaceY = container.clientHeight - elementSize.height;\n  let scrollLeft = container.scrollLeft;\n  let scrollTop = container.scrollTop;\n  if (opt_center) {\n    // All browsers round non-integer scroll positions down.\n    scrollLeft += relX - spaceX / 2;\n    scrollTop += relY - spaceY / 2;\n  } else {\n    // This formula was designed to give the correct scroll values in the\n    // following cases:\n    // - element is higher than container (spaceY < 0) => scroll down by relY\n    // - element is not higher that container (spaceY >= 0):\n    //   - it is above container (relY < 0) => scroll up by abs(relY)\n    //   - it is below container (relY > spaceY) => scroll down by relY - spaceY\n    //   - it is in the container => don't scroll\n    scrollLeft += Math.min(relX, Math.max(relX - spaceX, 0));\n    scrollTop += Math.min(relY, Math.max(relY - spaceY, 0));\n  }\n  return new Coordinate(scrollLeft, scrollTop);\n}\n\nexport const TEST_ONLY = {\n  getSizeInternal,\n};\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.svgMath');\n\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\nimport {Coordinate} from './coordinate.js';\nimport {Rect} from './rect.js';\nimport * as style from './style.js';\n\n/**\n * Static regex to pull the x,y values out of an SVG translate() directive.\n * Note that Firefox and IE (9,10) return 'translate(12)' instead of\n * 'translate(12, 0)'.\n * Note that IE (9,10) returns 'translate(16 8)' instead of 'translate(16, 8)'.\n * Note that IE has been reported to return scientific notation (0.123456e-42).\n */\nconst XY_REGEX = /translate\\(\\s*([-+\\d.e]+)([ ,]\\s*([-+\\d.e]+)\\s*)?/;\n\n/**\n * Static regex to pull the x,y values out of a translate() or translate3d()\n * style property.\n * Accounts for same exceptions as XY_REGEX.\n */\nconst XY_STYLE_REGEX =\n  /transform:\\s*translate(?:3d)?\\(\\s*([-+\\d.e]+)\\s*px([ ,]\\s*([-+\\d.e]+)\\s*px)?/;\n\n/**\n * Return the coordinates of the top-left corner of this element relative to\n * its parent.  Only for SVG elements and children (e.g. rect, g, path).\n *\n * @param element SVG element to find the coordinates of.\n * @returns Object with .x and .y properties.\n */\nexport function getRelativeXY(element: Element): Coordinate {\n  const xy = new Coordinate(0, 0);\n  // First, check for x and y attributes.\n  // Checking for the existence of x/y properties is faster than getAttribute.\n  // However, x/y contains an SVGAnimatedLength object, so rely on getAttribute\n  // to get the number.\n  const x = (element as any).x && element.getAttribute('x');\n  const y = (element as any).y && element.getAttribute('y');\n  if (x) {\n    xy.x = parseInt(x);\n  }\n  if (y) {\n    xy.y = parseInt(y);\n  }\n  // Second, check for transform=\"translate(...)\" attribute.\n  const transform = element.getAttribute('transform');\n  const r = transform && transform.match(XY_REGEX);\n  if (r) {\n    xy.x += Number(r[1]);\n    if (r[3]) {\n      xy.y += Number(r[3]);\n    }\n  }\n\n  // Then check for style = transform: translate(...) or translate3d(...)\n  const style = element.getAttribute('style');\n  if (style && style.indexOf('translate') > -1) {\n    const styleComponents = style.match(XY_STYLE_REGEX);\n    if (styleComponents) {\n      xy.x += Number(styleComponents[1]);\n      if (styleComponents[3]) {\n        xy.y += Number(styleComponents[3]);\n      }\n    }\n  }\n  return xy;\n}\n\n/**\n * Return the coordinates of the top-left corner of this element relative to\n * the div Blockly was injected into.\n *\n * @param element SVG element to find the coordinates of. If this is not a child\n *     of the div Blockly was injected into, the behaviour is undefined.\n * @returns Object with .x and .y properties.\n */\nexport function getInjectionDivXY(element: Element): Coordinate {\n  let x = 0;\n  let y = 0;\n  while (element) {\n    const xy = getRelativeXY(element);\n    x = x + xy.x;\n    y = y + xy.y;\n    const classes = element.getAttribute('class') || '';\n    if ((' ' + classes + ' ').indexOf(' injectionDiv ') !== -1) {\n      break;\n    }\n    element = element.parentNode as Element;\n  }\n  return new Coordinate(x, y);\n}\n\n/**\n * Get the position of the current viewport in window coordinates.  This takes\n * scroll into account.\n *\n * @returns An object containing window width, height, and scroll position in\n *     window coordinates.\n * @internal\n */\nexport function getViewportBBox(): Rect {\n  // Pixels, in window coordinates.\n  const scrollOffset = style.getViewportPageOffset();\n  return new Rect(\n    scrollOffset.y,\n    document.documentElement.clientHeight + scrollOffset.y,\n    scrollOffset.x,\n    document.documentElement.clientWidth + scrollOffset.x\n  );\n}\n\n/**\n * Gets the document scroll distance as a coordinate object.\n * Copied from Closure's goog.dom.getDocumentScroll.\n *\n * @returns Object with values 'x' and 'y'.\n */\nexport function getDocumentScroll(): Coordinate {\n  const el = document.documentElement;\n  const win = window;\n  return new Coordinate(\n    win.pageXOffset || el.scrollLeft,\n    win.pageYOffset || el.scrollTop\n  );\n}\n\n/**\n * Converts screen coordinates to workspace coordinates.\n *\n * @param ws The workspace to find the coordinates on.\n * @param screenCoordinates The screen coordinates to be converted to workspace\n *     coordinates\n * @returns The workspace coordinates.\n */\nexport function screenToWsCoordinates(\n  ws: WorkspaceSvg,\n  screenCoordinates: Coordinate\n): Coordinate {\n  const screenX = screenCoordinates.x;\n  const screenY = screenCoordinates.y;\n\n  const injectionDiv = ws.getInjectionDiv();\n  // Bounding rect coordinates are in client coordinates, meaning that they\n  // are in pixels relative to the upper left corner of the visible browser\n  // window.  These coordinates change when you scroll the browser window.\n  const boundingRect = injectionDiv.getBoundingClientRect();\n\n  // The client coordinates offset by the injection div's upper left corner.\n  const clientOffsetPixels = new Coordinate(\n    screenX - boundingRect.left,\n    screenY - boundingRect.top\n  );\n\n  // The offset in pixels between the main workspace's origin and the upper\n  // left corner of the injection div.\n  const mainOffsetPixels = ws.getOriginOffsetInPixels();\n\n  // The position of the new comment in pixels relative to the origin of the\n  // main workspace.\n  const finalOffsetPixels = Coordinate.difference(\n    clientOffsetPixels,\n    mainOffsetPixels\n  );\n  // The position in main workspace coordinates.\n  const finalOffsetMainWs = finalOffsetPixels.scale(1 / ws.scale);\n  return finalOffsetMainWs;\n}\n\nexport const TEST_ONLY = {\n  XY_REGEX,\n  XY_STYLE_REGEX,\n};\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Xml');\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport type {Connection} from './connection.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport {IconType} from './icons/icon_types.js';\nimport {inputTypes} from './inputs/input_types.js';\nimport * as dom from './utils/dom.js';\nimport {Size} from './utils/size.js';\nimport * as utilsXml from './utils/xml.js';\nimport type {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\nimport {WorkspaceComment} from './workspace_comment.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Encode a block tree as XML.\n *\n * @param workspace The workspace containing blocks.\n * @param opt_noId True if the encoder should skip the block IDs.\n * @returns XML DOM element.\n */\nexport function workspaceToDom(\n  workspace: Workspace,\n  opt_noId?: boolean\n): Element {\n  const treeXml = utilsXml.createElement('xml');\n  const variablesElement = variablesToDom(\n    Variables.allUsedVarModels(workspace)\n  );\n  if (variablesElement.hasChildNodes()) {\n    treeXml.appendChild(variablesElement);\n  }\n  const comments = workspace.getTopComments(true);\n  for (let i = 0; i < comments.length; i++) {\n    const comment = comments[i];\n    treeXml.appendChild(comment.toXmlWithXY(opt_noId));\n  }\n  const blocks = workspace.getTopBlocks(true);\n  for (let i = 0; i < blocks.length; i++) {\n    const block = blocks[i];\n    treeXml.appendChild(blockToDomWithXY(block, opt_noId));\n  }\n  return treeXml;\n}\n\n/**\n * Encode a list of variables as XML.\n *\n * @param variableList List of all variable models.\n * @returns Tree of XML elements.\n */\nexport function variablesToDom(variableList: VariableModel[]): Element {\n  const variables = utilsXml.createElement('variables');\n  for (let i = 0; i < variableList.length; i++) {\n    const variable = variableList[i];\n    const element = utilsXml.createElement('variable');\n    element.appendChild(utilsXml.createTextNode(variable.name));\n    if (variable.type) {\n      element.setAttribute('type', variable.type);\n    }\n    element.id = variable.getId();\n    variables.appendChild(element);\n  }\n  return variables;\n}\n\n/**\n * Encode a block subtree as XML with XY coordinates.\n *\n * @param block The root block to encode.\n * @param opt_noId True if the encoder should skip the block ID.\n * @returns Tree of XML elements or an empty document fragment if the block was\n *     an insertion marker.\n */\nexport function blockToDomWithXY(\n  block: Block,\n  opt_noId?: boolean\n): Element | DocumentFragment {\n  if (block.isInsertionMarker()) {\n    // Skip over insertion markers.\n    block = block.getChildren(false)[0];\n    if (!block) {\n      // Disappears when appended.\n      return new DocumentFragment();\n    }\n  }\n\n  let width = 0; // Not used in LTR.\n  if (block.workspace.RTL) {\n    width = block.workspace.getWidth();\n  }\n\n  const element = blockToDom(block, opt_noId);\n  if (isElement(element)) {\n    const xy = block.getRelativeToSurfaceXY();\n    element.setAttribute(\n      'x',\n      String(Math.round(block.workspace.RTL ? width - xy.x : xy.x))\n    );\n    element.setAttribute('y', String(Math.round(xy.y)));\n  }\n  return element;\n}\n\n/**\n * Encode a field as XML.\n *\n * @param field The field to encode.\n * @returns XML element, or null if the field did not need to be serialized.\n */\nfunction fieldToDom(field: Field): Element | null {\n  if (field.isSerializable()) {\n    const container = utilsXml.createElement('field');\n    container.setAttribute('name', field.name || '');\n    return field.toXml(container);\n  }\n  return null;\n}\n\n/**\n * Encode all of a block's fields as XML and attach them to the given tree of\n * XML elements.\n *\n * @param block A block with fields to be encoded.\n * @param element The XML element to which the field DOM should be attached.\n */\nfunction allFieldsToDom(block: Block, element: Element) {\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    for (let j = 0; j < input.fieldRow.length; j++) {\n      const field = input.fieldRow[j];\n      const fieldDom = fieldToDom(field);\n      if (fieldDom) {\n        element.appendChild(fieldDom);\n      }\n    }\n  }\n}\n\n/**\n * Encode a block subtree as XML.\n *\n * @param block The root block to encode.\n * @param opt_noId True if the encoder should skip the block ID.\n * @returns Tree of XML elements or an empty document fragment if the block was\n *     an insertion marker.\n */\nexport function blockToDom(\n  block: Block,\n  opt_noId?: boolean\n): Element | DocumentFragment {\n  // Skip over insertion markers.\n  if (block.isInsertionMarker()) {\n    const child = block.getChildren(false)[0];\n    if (child) {\n      return blockToDom(child);\n    } else {\n      // Disappears when appended.\n      return new DocumentFragment();\n    }\n  }\n\n  const element = utilsXml.createElement(block.isShadow() ? 'shadow' : 'block');\n  element.setAttribute('type', block.type);\n  if (!opt_noId) {\n    element.id = block.id;\n  }\n  if (block.mutationToDom) {\n    // Custom data for an advanced block.\n    const mutation = block.mutationToDom();\n    if (mutation && (mutation.hasChildNodes() || mutation.hasAttributes())) {\n      element.appendChild(mutation);\n    }\n  }\n\n  allFieldsToDom(block, element);\n\n  const commentText = block.getCommentText();\n  if (commentText) {\n    const comment = block.getIcon(IconType.COMMENT)!;\n    const size = comment.getBubbleSize();\n    const pinned = comment.bubbleIsVisible();\n\n    const commentElement = utilsXml.createElement('comment');\n    commentElement.appendChild(utilsXml.createTextNode(commentText));\n    commentElement.setAttribute('pinned', `${pinned}`);\n    commentElement.setAttribute('h', String(size.height));\n    commentElement.setAttribute('w', String(size.width));\n\n    element.appendChild(commentElement);\n  }\n\n  if (block.data) {\n    const dataElement = utilsXml.createElement('data');\n    dataElement.appendChild(utilsXml.createTextNode(block.data));\n    element.appendChild(dataElement);\n  }\n\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    let container: Element;\n    let empty = true;\n    if (input.type === inputTypes.DUMMY) {\n      continue;\n    } else {\n      const childBlock = input.connection!.targetBlock();\n      if (input.type === inputTypes.VALUE) {\n        container = utilsXml.createElement('value');\n      } else if (input.type === inputTypes.STATEMENT) {\n        container = utilsXml.createElement('statement');\n      }\n      const childShadow = input.connection!.getShadowDom();\n      if (childShadow && (!childBlock || !childBlock.isShadow())) {\n        container!.appendChild(cloneShadow(childShadow, opt_noId));\n      }\n      if (childBlock) {\n        const childElem = blockToDom(childBlock, opt_noId);\n        if (childElem.nodeType === dom.NodeType.ELEMENT_NODE) {\n          container!.appendChild(childElem);\n          empty = false;\n        }\n      }\n    }\n    container!.setAttribute('name', input.name);\n    if (!empty) {\n      element.appendChild(container!);\n    }\n  }\n  if (\n    block.inputsInline !== undefined &&\n    block.inputsInline !== block.inputsInlineDefault\n  ) {\n    element.setAttribute('inline', String(block.inputsInline));\n  }\n  if (block.isCollapsed()) {\n    element.setAttribute('collapsed', 'true');\n  }\n  if (!block.isEnabled()) {\n    element.setAttribute('disabled', 'true');\n  }\n  if (!block.isDeletable() && !block.isShadow()) {\n    element.setAttribute('deletable', 'false');\n  }\n  if (!block.isMovable() && !block.isShadow()) {\n    element.setAttribute('movable', 'false');\n  }\n  if (!block.isEditable()) {\n    element.setAttribute('editable', 'false');\n  }\n\n  const nextBlock = block.getNextBlock();\n  let container: Element;\n  if (nextBlock) {\n    const nextElem = blockToDom(nextBlock, opt_noId);\n    if (nextElem.nodeType === dom.NodeType.ELEMENT_NODE) {\n      container = utilsXml.createElement('next');\n      container.appendChild(nextElem);\n      element.appendChild(container);\n    }\n  }\n  const nextShadow =\n    block.nextConnection && block.nextConnection.getShadowDom();\n  if (nextShadow && (!nextBlock || !nextBlock.isShadow())) {\n    container!.appendChild(cloneShadow(nextShadow, opt_noId));\n  }\n\n  return element;\n}\n\n/**\n * Deeply clone the shadow's DOM so that changes don't back-wash to the block.\n *\n * @param shadow A tree of XML elements.\n * @param opt_noId True if the encoder should skip the block ID.\n * @returns A tree of XML elements.\n */\nfunction cloneShadow(shadow: Element, opt_noId?: boolean): Element {\n  shadow = shadow.cloneNode(true) as Element;\n  // Walk the tree looking for whitespace.  Don't prune whitespace in a tag.\n  let node: Node | null = shadow;\n  let textNode;\n  while (node) {\n    if (opt_noId && node.nodeName === 'shadow') {\n      // Strip off IDs from shadow blocks.  There should never be a 'block' as\n      // a child of a 'shadow', so no need to check that.\n      (node as Element).removeAttribute('id');\n    }\n    if (node.firstChild) {\n      node = node.firstChild;\n    } else {\n      while (node && !node.nextSibling) {\n        textNode = node;\n        node = node.parentNode;\n        if (\n          textNode.nodeType === dom.NodeType.TEXT_NODE &&\n          (textNode as Text).data.trim() === '' &&\n          node?.firstChild !== textNode\n        ) {\n          // Prune whitespace after a tag.\n          dom.removeNode(textNode);\n        }\n      }\n      if (node) {\n        textNode = node;\n        node = node.nextSibling;\n        if (\n          textNode.nodeType === dom.NodeType.TEXT_NODE &&\n          (textNode as Text).data.trim() === ''\n        ) {\n          // Prune whitespace before a tag.\n          dom.removeNode(textNode);\n        }\n      }\n    }\n  }\n  return shadow;\n}\n\n/**\n * Converts a DOM structure into plain text.\n * Currently the text format is fairly ugly: all one line with no whitespace,\n * unless the DOM itself has whitespace built-in.\n *\n * @param dom A tree of XML nodes.\n * @returns Text representation.\n */\nexport function domToText(dom: Node): string {\n  const text = utilsXml.domToText(dom);\n  // Unpack self-closing tags.  These tags fail when embedded in HTML.\n  // <block name=\"foo\"/> -> <block name=\"foo\"></block>\n  return text.replace(/<(\\w+)([^<]*)\\/>/g, '<$1$2></$1>');\n}\n\n/**\n * Converts a DOM structure into properly indented text.\n *\n * @param dom A tree of XML elements.\n * @returns Text representation.\n */\nexport function domToPrettyText(dom: Node): string {\n  // This function is not guaranteed to be correct for all XML.\n  // But it handles the XML that Blockly generates.\n  const blob = domToText(dom);\n  // Place every open and close tag on its own line.\n  const lines = blob.split('<');\n  // Indent every line.\n  let indent = '';\n  for (let i = 1; i < lines.length; i++) {\n    const line = lines[i];\n    if (line[0] === '/') {\n      indent = indent.substring(2);\n    }\n    lines[i] = indent + '<' + line;\n    if (line[0] !== '/' && line.slice(-2) !== '/>') {\n      indent += '  ';\n    }\n  }\n  // Pull simple tags back together.\n  // E.g. <foo></foo>\n  let text = lines.join('\\n');\n  text = text.replace(/(<(\\w+)\\b[^>]*>[^\\n]*)\\n *<\\/\\2>/g, '$1</$2>');\n  // Trim leading blank line.\n  return text.replace(/^\\n/, '');\n}\n\n/**\n * Clear the given workspace then decode an XML DOM and\n * create blocks on the workspace.\n *\n * @param xml XML DOM.\n * @param workspace The workspace.\n * @returns An array containing new block IDs.\n */\nexport function clearWorkspaceAndLoadFromXml(\n  xml: Element,\n  workspace: WorkspaceSvg\n): string[] {\n  workspace.setResizesEnabled(false);\n  workspace.clear();\n  const blockIds = domToWorkspace(xml, workspace);\n  workspace.setResizesEnabled(true);\n  return blockIds;\n}\n\n/**\n * Decode an XML DOM and create blocks on the workspace.\n *\n * @param xml XML DOM.\n * @param workspace The workspace.\n * @returns An array containing new block IDs.\n */\nexport function domToWorkspace(xml: Element, workspace: Workspace): string[] {\n  let width = 0; // Not used in LTR.\n  if (workspace.RTL) {\n    width = workspace.getWidth();\n  }\n  const newBlockIds = []; // A list of block IDs added by this call.\n  dom.startTextWidthCache();\n  const existingGroup = eventUtils.getGroup();\n  if (!existingGroup) {\n    eventUtils.setGroup(true);\n  }\n\n  // Disable workspace resizes as an optimization.\n  // Assume it is rendered so we can check.\n  if ((workspace as WorkspaceSvg).setResizesEnabled) {\n    (workspace as WorkspaceSvg).setResizesEnabled(false);\n  }\n  let variablesFirst = true;\n  try {\n    for (let i = 0, xmlChild; (xmlChild = xml.childNodes[i]); i++) {\n      const name = xmlChild.nodeName.toLowerCase();\n      const xmlChildElement = xmlChild as Element;\n      if (\n        name === 'block' ||\n        (name === 'shadow' && !eventUtils.getRecordUndo())\n      ) {\n        // Allow top-level shadow blocks if recordUndo is disabled since\n        // that means an undo is in progress.  Such a block is expected\n        // to be moved to a nested destination in the next operation.\n        const block = domToBlock(xmlChildElement, workspace);\n        newBlockIds.push(block.id);\n        const blockX = parseInt(xmlChildElement.getAttribute('x') ?? '10', 10);\n        const blockY = parseInt(xmlChildElement.getAttribute('y') ?? '10', 10);\n        if (!isNaN(blockX) && !isNaN(blockY)) {\n          block.moveBy(workspace.RTL ? width - blockX : blockX, blockY, [\n            'create',\n          ]);\n        }\n        variablesFirst = false;\n      } else if (name === 'shadow') {\n        throw TypeError('Shadow block cannot be a top-level block.');\n      } else if (name === 'comment') {\n        if (workspace.rendered) {\n          WorkspaceCommentSvg.fromXmlRendered(\n            xmlChildElement,\n            workspace as WorkspaceSvg,\n            width\n          );\n        } else {\n          WorkspaceComment.fromXml(xmlChildElement, workspace);\n        }\n      } else if (name === 'variables') {\n        if (variablesFirst) {\n          domToVariables(xmlChildElement, workspace);\n        } else {\n          throw Error(\n            \"'variables' tag must exist once before block and \" +\n              'shadow tag elements in the workspace XML, but it was found in ' +\n              'another location.'\n          );\n        }\n        variablesFirst = false;\n      }\n    }\n  } finally {\n    eventUtils.setGroup(existingGroup);\n    dom.stopTextWidthCache();\n  }\n  // Re-enable workspace resizing.\n  if ((workspace as WorkspaceSvg).setResizesEnabled) {\n    (workspace as WorkspaceSvg).setResizesEnabled(true);\n  }\n  eventUtils.fire(new (eventUtils.get(eventUtils.FINISHED_LOADING))(workspace));\n  return newBlockIds;\n}\n\n/**\n * Decode an XML DOM and create blocks on the workspace. Position the new\n * blocks immediately below prior blocks, aligned by their starting edge.\n *\n * @param xml The XML DOM.\n * @param workspace The workspace to add to.\n * @returns An array containing new block IDs.\n */\nexport function appendDomToWorkspace(\n  xml: Element,\n  workspace: WorkspaceSvg\n): string[] {\n  // First check if we have a WorkspaceSvg, otherwise the blocks have no shape\n  // and the position does not matter.\n  // Assume it is rendered so we can check.\n  if (!(workspace as WorkspaceSvg).getBlocksBoundingBox) {\n    return domToWorkspace(xml, workspace);\n  }\n\n  const bbox = (workspace as WorkspaceSvg).getBlocksBoundingBox();\n  // Load the new blocks into the workspace and get the IDs of the new blocks.\n  const newBlockIds = domToWorkspace(xml, workspace);\n  if (bbox && bbox.top !== bbox.bottom) {\n    // Check if any previous block.\n    let offsetY = 0; // Offset to add to y of the new block.\n    let offsetX = 0;\n    const farY = bbox.bottom; // Bottom position.\n    const topX = workspace.RTL ? bbox.right : bbox.left; // X of bounding box.\n    // Check position of the new blocks.\n    let newLeftX = Infinity; // X of top left corner.\n    let newRightX = -Infinity; // X of top right corner.\n    let newY = Infinity; // Y of top corner.\n    const ySeparation = 10;\n    for (let i = 0; i < newBlockIds.length; i++) {\n      const blockXY = workspace\n        .getBlockById(newBlockIds[i])!\n        .getRelativeToSurfaceXY();\n      if (blockXY.y < newY) {\n        newY = blockXY.y;\n      }\n      if (blockXY.x < newLeftX) {\n        // if we left align also on x\n        newLeftX = blockXY.x;\n      }\n      if (blockXY.x > newRightX) {\n        // if we right align also on x\n        newRightX = blockXY.x;\n      }\n    }\n    offsetY = farY - newY + ySeparation;\n    offsetX = workspace.RTL ? topX - newRightX : topX - newLeftX;\n    for (let i = 0; i < newBlockIds.length; i++) {\n      const block = workspace.getBlockById(newBlockIds[i]);\n      block!.moveBy(offsetX, offsetY, ['create']);\n    }\n  }\n  return newBlockIds;\n}\n\n/**\n * Decode an XML block tag and create a block (and possibly sub blocks) on the\n * workspace.\n *\n * @param xmlBlock XML block element.\n * @param workspace The workspace.\n * @returns The root block created.\n */\nexport function domToBlock(xmlBlock: Element, workspace: Workspace): Block {\n  // Create top-level block.\n  eventUtils.disable();\n  const variablesBeforeCreation = workspace.getAllVariables();\n  let topBlock;\n  try {\n    topBlock = domToBlockHeadless(xmlBlock, workspace);\n    // Generate list of all blocks.\n    if (workspace.rendered) {\n      const topBlockSvg = topBlock as BlockSvg;\n      const blocks = topBlock.getDescendants(false);\n      topBlockSvg.setConnectionTracking(false);\n      // Render each block.\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        (blocks[i] as BlockSvg).initSvg();\n      }\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        (blocks[i] as BlockSvg).render(false);\n      }\n      // Populating the connection database may be deferred until after the\n      // blocks have rendered.\n      setTimeout(function () {\n        if (!topBlockSvg.disposed) {\n          topBlockSvg.setConnectionTracking(true);\n        }\n      }, 1);\n      topBlockSvg.updateDisabled();\n      // Allow the scrollbars to resize and move based on the new contents.\n      // TODO(@picklesrus): #387. Remove when domToBlock avoids resizing.\n      (workspace as WorkspaceSvg).resizeContents();\n    } else {\n      const blocks = topBlock.getDescendants(false);\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        blocks[i].initModel();\n      }\n    }\n  } finally {\n    eventUtils.enable();\n  }\n  if (eventUtils.isEnabled()) {\n    const newVariables = Variables.getAddedVariables(\n      workspace,\n      variablesBeforeCreation\n    );\n    // Fire a VarCreate event for each (if any) new variable created.\n    for (let i = 0; i < newVariables.length; i++) {\n      const thisVariable = newVariables[i];\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.VAR_CREATE))(thisVariable)\n      );\n    }\n    // Block events come after var events, in case they refer to newly created\n    // variables.\n    eventUtils.fire(new (eventUtils.get(eventUtils.CREATE))(topBlock));\n  }\n  return topBlock;\n}\n\n/**\n * Decode an XML list of variables and add the variables to the workspace.\n *\n * @param xmlVariables List of XML variable elements.\n * @param workspace The workspace to which the variable should be added.\n */\nexport function domToVariables(xmlVariables: Element, workspace: Workspace) {\n  for (let i = 0; i < xmlVariables.children.length; i++) {\n    const xmlChild = xmlVariables.children[i];\n    const type = xmlChild.getAttribute('type');\n    const id = xmlChild.getAttribute('id');\n    const name = xmlChild.textContent;\n\n    if (!name) return;\n    workspace.createVariable(name, type, id);\n  }\n}\n\n/** A mapping of nodeName to node for child nodes of xmlBlock. */\ninterface childNodeTagMap {\n  mutation: Element[];\n  comment: Element[];\n  data: Element[];\n  field: Element[];\n  input: Element[];\n  next: Element[];\n}\n\n/**\n * Creates a mapping of childNodes for each supported XML tag for the provided\n * xmlBlock. Logs a warning for any encountered unsupported tags.\n *\n * @param xmlBlock XML block element.\n * @returns The childNode map from nodeName to node.\n */\nfunction mapSupportedXmlTags(xmlBlock: Element): childNodeTagMap {\n  const childNodeMap = {\n    mutation: new Array<Element>(),\n    comment: new Array<Element>(),\n    data: new Array<Element>(),\n    field: new Array<Element>(),\n    input: new Array<Element>(),\n    next: new Array<Element>(),\n  };\n  for (let i = 0; i < xmlBlock.children.length; i++) {\n    const xmlChild = xmlBlock.children[i];\n    if (xmlChild.nodeType === dom.NodeType.TEXT_NODE) {\n      // Ignore any text at the <block> level.  It's all whitespace anyway.\n      continue;\n    }\n    switch (xmlChild.nodeName.toLowerCase()) {\n      case 'mutation':\n        childNodeMap.mutation.push(xmlChild);\n        break;\n      case 'comment':\n        childNodeMap.comment.push(xmlChild);\n        break;\n      case 'data':\n        childNodeMap.data.push(xmlChild);\n        break;\n      case 'title':\n      // Titles were renamed to field in December 2013.\n      // Fall through.\n      case 'field':\n        childNodeMap.field.push(xmlChild);\n        break;\n      case 'value':\n      case 'statement':\n        childNodeMap.input.push(xmlChild);\n        break;\n      case 'next':\n        childNodeMap.next.push(xmlChild);\n        break;\n      default:\n        // Unknown tag; ignore.  Same principle as HTML parsers.\n        console.warn('Ignoring unknown tag: ' + xmlChild.nodeName);\n    }\n  }\n  return childNodeMap;\n}\n\n/**\n * Applies mutation tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n * @returns True if mutation may have added some elements that need\n *     initialization (requiring initSvg call).\n */\nfunction applyMutationTagNodes(xmlChildren: Element[], block: Block): boolean {\n  let shouldCallInitSvg = false;\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    // Custom data for an advanced block.\n    if (block.domToMutation) {\n      block.domToMutation(xmlChild);\n      if ((block as BlockSvg).initSvg) {\n        // Mutation may have added some elements that need initializing.\n        shouldCallInitSvg = true;\n      }\n    }\n  }\n  return shouldCallInitSvg;\n}\n\n/**\n * Applies comment tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n */\nfunction applyCommentTagNodes(xmlChildren: Element[], block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const text = xmlChild.textContent;\n    const pinned = xmlChild.getAttribute('pinned') === 'true';\n    const width = parseInt(xmlChild.getAttribute('w') ?? '50', 10);\n    const height = parseInt(xmlChild.getAttribute('h') ?? '50', 10);\n\n    block.setCommentText(text);\n    const comment = block.getIcon(IconType.COMMENT)!;\n    if (!isNaN(width) && !isNaN(height)) {\n      comment.setBubbleSize(new Size(width, height));\n    }\n    // Set the pinned state of the bubble.\n    comment.setBubbleVisible(pinned);\n    // Actually show the bubble after the block has been rendered.\n    setTimeout(() => comment.setBubbleVisible(pinned), 1);\n  }\n}\n\n/**\n * Applies data tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n */\nfunction applyDataTagNodes(xmlChildren: Element[], block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    block.data = xmlChild.textContent;\n  }\n}\n\n/**\n * Applies field tag child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param block The block to apply the child nodes on.\n */\nfunction applyFieldTagNodes(xmlChildren: Element[], block: Block) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const nodeName = xmlChild.getAttribute('name');\n    if (!nodeName) {\n      console.warn(`Ignoring unnamed field in block ${block.type}`);\n      continue;\n    }\n    domToField(block, nodeName, xmlChild);\n  }\n}\n\n/**\n * Finds any enclosed blocks or shadows within this XML node.\n *\n * @param xmlNode The XML node to extract child block info from.\n * @returns Any found child block.\n */\nfunction findChildBlocks(xmlNode: Element): {\n  childBlockElement: Element | null;\n  childShadowElement: Element | null;\n} {\n  let childBlockElement: Element | null = null;\n  let childShadowElement: Element | null = null;\n  for (let i = 0; i < xmlNode.childNodes.length; i++) {\n    const xmlChild = xmlNode.childNodes[i];\n    if (isElement(xmlChild)) {\n      if (xmlChild.nodeName.toLowerCase() === 'block') {\n        childBlockElement = xmlChild;\n      } else if (xmlChild.nodeName.toLowerCase() === 'shadow') {\n        childShadowElement = xmlChild;\n      }\n    }\n  }\n  return {childBlockElement, childShadowElement};\n}\n/**\n * Applies input child nodes (value or statement) to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param workspace The workspace containing the given block.\n * @param block The block to apply the child nodes on.\n * @param prototypeName The prototype name of the block.\n */\nfunction applyInputTagNodes(\n  xmlChildren: Element[],\n  workspace: Workspace,\n  block: Block,\n  prototypeName: string\n) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const nodeName = xmlChild.getAttribute('name');\n    const input = nodeName ? block.getInput(nodeName) : null;\n    if (!input) {\n      console.warn(\n        'Ignoring non-existent input ' + nodeName + ' in block ' + prototypeName\n      );\n      break;\n    }\n    const childBlockInfo = findChildBlocks(xmlChild);\n    if (childBlockInfo.childBlockElement) {\n      if (!input.connection) {\n        throw TypeError('Input connection does not exist.');\n      }\n      domToBlockHeadless(\n        childBlockInfo.childBlockElement,\n        workspace,\n        input.connection,\n        false\n      );\n    }\n    // Set shadow after so we don't create a shadow we delete immediately.\n    if (childBlockInfo.childShadowElement) {\n      input.connection?.setShadowDom(childBlockInfo.childShadowElement);\n    }\n  }\n}\n\n/**\n * Applies next child nodes to the given block.\n *\n * @param xmlChildren Child nodes.\n * @param workspace The workspace containing the given block.\n * @param block The block to apply the child nodes on.\n */\nfunction applyNextTagNodes(\n  xmlChildren: Element[],\n  workspace: Workspace,\n  block: Block\n) {\n  for (let i = 0; i < xmlChildren.length; i++) {\n    const xmlChild = xmlChildren[i];\n    const childBlockInfo = findChildBlocks(xmlChild);\n    if (childBlockInfo.childBlockElement) {\n      if (!block.nextConnection) {\n        throw TypeError('Next statement does not exist.');\n      }\n      // If there is more than one XML 'next' tag.\n      if (block.nextConnection.isConnected()) {\n        throw TypeError('Next statement is already connected.');\n      }\n      // Create child block.\n      domToBlockHeadless(\n        childBlockInfo.childBlockElement,\n        workspace,\n        block.nextConnection,\n        true\n      );\n    }\n    // Set shadow after so we don't create a shadow we delete immediately.\n    if (childBlockInfo.childShadowElement && block.nextConnection) {\n      block.nextConnection.setShadowDom(childBlockInfo.childShadowElement);\n    }\n  }\n}\n\n/**\n * Decode an XML block tag and create a block (and possibly sub blocks) on the\n * workspace.\n *\n * @param xmlBlock XML block element.\n * @param workspace The workspace.\n * @param parentConnection The parent connection to to connect this block to\n *     after instantiating.\n * @param connectedToParentNext Whether the provided parent connection is a next\n *     connection, rather than output or statement.\n * @returns The root block created.\n */\nfunction domToBlockHeadless(\n  xmlBlock: Element,\n  workspace: Workspace,\n  parentConnection?: Connection,\n  connectedToParentNext?: boolean\n): Block {\n  let block = null;\n  const prototypeName = xmlBlock.getAttribute('type');\n  if (!prototypeName) {\n    throw TypeError('Block type unspecified: ' + xmlBlock.outerHTML);\n  }\n  const id = xmlBlock.getAttribute('id') ?? undefined;\n  block = workspace.newBlock(prototypeName, id);\n\n  // Preprocess childNodes so tags can be processed in a consistent order.\n  const xmlChildNameMap = mapSupportedXmlTags(xmlBlock);\n\n  const shouldCallInitSvg = applyMutationTagNodes(\n    xmlChildNameMap.mutation,\n    block\n  );\n  applyCommentTagNodes(xmlChildNameMap.comment, block);\n  applyDataTagNodes(xmlChildNameMap.data, block);\n\n  // Connect parent after processing mutation and before setting fields.\n  if (parentConnection) {\n    if (connectedToParentNext) {\n      if (block.previousConnection) {\n        parentConnection.connect(block.previousConnection);\n      } else {\n        throw TypeError('Next block does not have previous statement.');\n      }\n    } else {\n      if (block.outputConnection) {\n        parentConnection.connect(block.outputConnection);\n      } else if (block.previousConnection) {\n        parentConnection.connect(block.previousConnection);\n      } else {\n        throw TypeError(\n          'Child block does not have output or previous statement.'\n        );\n      }\n    }\n  }\n\n  applyFieldTagNodes(xmlChildNameMap.field, block);\n  applyInputTagNodes(xmlChildNameMap.input, workspace, block, prototypeName);\n  applyNextTagNodes(xmlChildNameMap.next, workspace, block);\n\n  if (shouldCallInitSvg) {\n    // This shouldn't even be called here\n    // (ref: https://github.com/google/blockly/pull/4296#issuecomment-884226021\n    // But the XML serializer/deserializer is iceboxed so I'm not going to fix\n    // it.\n    (block as BlockSvg).initSvg();\n  }\n\n  const inline = xmlBlock.getAttribute('inline');\n  if (inline) {\n    block.setInputsInline(inline === 'true');\n  }\n  const disabled = xmlBlock.getAttribute('disabled');\n  if (disabled) {\n    block.setEnabled(disabled !== 'true' && disabled !== 'disabled');\n  }\n  const deletable = xmlBlock.getAttribute('deletable');\n  if (deletable) {\n    block.setDeletable(deletable === 'true');\n  }\n  const movable = xmlBlock.getAttribute('movable');\n  if (movable) {\n    block.setMovable(movable === 'true');\n  }\n  const editable = xmlBlock.getAttribute('editable');\n  if (editable) {\n    block.setEditable(editable === 'true');\n  }\n  const collapsed = xmlBlock.getAttribute('collapsed');\n  if (collapsed) {\n    block.setCollapsed(collapsed === 'true');\n  }\n  if (xmlBlock.nodeName.toLowerCase() === 'shadow') {\n    // Ensure all children are also shadows.\n    const children = block.getChildren(false);\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i];\n      if (!child.isShadow()) {\n        throw TypeError('Shadow block not allowed non-shadow child.');\n      }\n    }\n    // Ensure this block doesn't have any variable inputs.\n    if (block.getVarModels().length) {\n      throw TypeError('Shadow blocks cannot have variable references.');\n    }\n    block.setShadow(true);\n  }\n  return block;\n}\n\n/**\n * Decode an XML field tag and set the value of that field on the given block.\n *\n * @param block The block that is currently being deserialized.\n * @param fieldName The name of the field on the block.\n * @param xml The field tag to decode.\n */\nfunction domToField(block: Block, fieldName: string, xml: Element) {\n  const field = block.getField(fieldName);\n  if (!field) {\n    console.warn(\n      'Ignoring non-existent field ' + fieldName + ' in block ' + block.type\n    );\n    return;\n  }\n  field.fromXml(xml);\n}\n\n/**\n * Remove any 'next' block (statements in a stack).\n *\n * @param xmlBlock XML block element or an empty DocumentFragment if the block\n *     was an insertion marker.\n */\nexport function deleteNext(xmlBlock: Element | DocumentFragment) {\n  for (let i = 0; i < xmlBlock.childNodes.length; i++) {\n    const child = xmlBlock.childNodes[i];\n    if (child.nodeName.toLowerCase() === 'next') {\n      xmlBlock.removeChild(child);\n      break;\n    }\n  }\n}\n\nfunction isElement(node: Node): node is Element {\n  return node.nodeType === dom.NodeType.ELEMENT_NODE;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization.registry');\n\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as registry from '../registry.js';\n\n/**\n * Registers the given serializer so that it can be used for serialization and\n * deserialization.\n *\n * @param name The name of the serializer to register.\n * @param serializer The serializer to register.\n */\nexport function register(name: string, serializer: ISerializer) {\n  registry.register(registry.Type.SERIALIZER, name, serializer);\n}\n\n/**\n * Unregisters the serializer associated with the given name.\n *\n * @param name The name of the serializer to unregister.\n */\nexport function unregister(name: string) {\n  registry.unregister(registry.Type.SERIALIZER, name);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization.blocks');\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport type {Connection} from '../connection.js';\nimport * as eventUtils from '../events/utils.js';\nimport {inputTypes} from '../inputs/input_types.js';\nimport {isSerializable} from '../interfaces/i_serializable.js';\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as registry from '../registry.js';\nimport * as utilsXml from '../utils/xml.js';\nimport type {Workspace} from '../workspace.js';\nimport * as Xml from '../xml.js';\n\nimport {\n  BadConnectionCheck,\n  MissingBlockType,\n  MissingConnection,\n  RealChildOfShadow,\n  UnregisteredIcon,\n} from './exceptions.js';\nimport * as priorities from './priorities.js';\nimport * as serializationRegistry from './registry.js';\n\n// TODO(#5160): Remove this once lint is fixed.\n/* eslint-disable no-use-before-define */\n\n/**\n * Represents the state of a connection.\n */\nexport interface ConnectionState {\n  shadow?: State;\n  block?: State;\n}\n\n/**\n * Represents the state of a given block.\n */\nexport interface State {\n  type: string;\n  id?: string;\n  x?: number;\n  y?: number;\n  collapsed?: boolean;\n  deletable?: boolean;\n  movable?: boolean;\n  editable?: boolean;\n  enabled?: boolean;\n  inline?: boolean;\n  data?: string;\n  extraState?: AnyDuringMigration;\n  icons?: {[key: string]: AnyDuringMigration};\n  fields?: {[key: string]: AnyDuringMigration};\n  inputs?: {[key: string]: ConnectionState};\n  next?: ConnectionState;\n}\n\n/**\n * Returns the state of the given block as a plain JavaScript object.\n *\n * @param block The block to serialize.\n * @param param1 addCoordinates: If true, the coordinates of the block are added\n *     to the serialized state. False by default. addinputBlocks: If true,\n *     children of the block which are connected to inputs will be serialized.\n *     True by default. addNextBlocks: If true, children of the block which are\n *     connected to the block's next connection (if it exists) will be\n *     serialized. True by default. doFullSerialization: If true, fields that\n *     normally just save a reference to some external state (eg variables) will\n *     instead serialize all of the info about that state. This supports\n *     deserializing the block into a workspace where that state doesn't yet\n *     exist. True by default.\n * @returns The serialized state of the block, or null if the block could not be\n *     serialied (eg it was an insertion marker).\n */\nexport function save(\n  block: Block,\n  {\n    addCoordinates = false,\n    addInputBlocks = true,\n    addNextBlocks = true,\n    doFullSerialization = true,\n  }: {\n    addCoordinates?: boolean;\n    addInputBlocks?: boolean;\n    addNextBlocks?: boolean;\n    doFullSerialization?: boolean;\n  } = {}\n): State | null {\n  if (block.isInsertionMarker()) {\n    return null;\n  }\n\n  const state = {\n    'type': block.type,\n    'id': block.id,\n  };\n\n  if (addCoordinates) {\n    // AnyDuringMigration because:  Argument of type '{ type: string; id:\n    // string; }' is not assignable to parameter of type 'State'.\n    saveCoords(block, state as AnyDuringMigration);\n  }\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveAttributes(block, state as AnyDuringMigration);\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveExtraState(block, state as AnyDuringMigration);\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveIcons(block, state as AnyDuringMigration, doFullSerialization);\n  // AnyDuringMigration because:  Argument of type '{ type: string; id: string;\n  // }' is not assignable to parameter of type 'State'.\n  saveFields(block, state as AnyDuringMigration, doFullSerialization);\n  if (addInputBlocks) {\n    // AnyDuringMigration because:  Argument of type '{ type: string; id:\n    // string; }' is not assignable to parameter of type 'State'.\n    saveInputBlocks(block, state as AnyDuringMigration, doFullSerialization);\n  }\n  if (addNextBlocks) {\n    // AnyDuringMigration because:  Argument of type '{ type: string; id:\n    // string; }' is not assignable to parameter of type 'State'.\n    saveNextBlocks(block, state as AnyDuringMigration, doFullSerialization);\n  }\n\n  // AnyDuringMigration because:  Type '{ type: string; id: string; }' is not\n  // assignable to type 'State'.\n  return state as AnyDuringMigration;\n}\n\n/**\n * Adds attributes to the given state object based on the state of the block.\n * Eg collapsed, disabled, inline, etc.\n *\n * @param block The block to base the attributes on.\n * @param state The state object to append to.\n */\nfunction saveAttributes(block: Block, state: State) {\n  if (block.isCollapsed()) {\n    state['collapsed'] = true;\n  }\n  if (!block.isEnabled()) {\n    state['enabled'] = false;\n  }\n  if (!block.isOwnDeletable()) {\n    state['deletable'] = false;\n  }\n  if (!block.isOwnMovable()) {\n    state['movable'] = false;\n  }\n  if (!block.isOwnEditable()) {\n    state['editable'] = false;\n  }\n  if (\n    block.inputsInline !== undefined &&\n    block.inputsInline !== block.inputsInlineDefault\n  ) {\n    state['inline'] = block.inputsInline;\n  }\n  // Data is a nullable string, so we don't need to worry about falsy values.\n  if (block.data) {\n    state['data'] = block.data;\n  }\n}\n\n/**\n * Adds the coordinates of the given block to the given state object.\n *\n * @param block The block to base the coordinates on.\n * @param state The state object to append to.\n */\nfunction saveCoords(block: Block, state: State) {\n  const workspace = block.workspace;\n  const xy = block.getRelativeToSurfaceXY();\n  state['x'] = Math.round(workspace.RTL ? workspace.getWidth() - xy.x : xy.x);\n  state['y'] = Math.round(xy.y);\n}\n/**\n * Adds any extra state the block may provide to the given state object.\n *\n * @param block The block to serialize the extra state of.\n * @param state The state object to append to.\n */\nfunction saveExtraState(block: Block, state: State) {\n  if (block.saveExtraState) {\n    const extraState = block.saveExtraState();\n    if (extraState !== null) {\n      state['extraState'] = extraState;\n    }\n  } else if (block.mutationToDom) {\n    const extraState = block.mutationToDom();\n    if (extraState !== null) {\n      state['extraState'] = Xml.domToText(extraState).replace(\n        ' xmlns=\"https://developers.google.com/blockly/xml\"',\n        ''\n      );\n    }\n  }\n}\n\n/**\n * Adds the state of all of the icons on the block to the given state object.\n *\n * @param block The block to serialize the icon state of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to serialize the full state of the\n *     icon (rather than possibly saving a reference to some state).\n */\nfunction saveIcons(block: Block, state: State, doFullSerialization: boolean) {\n  const icons = Object.create(null);\n  for (const icon of block.getIcons()) {\n    if (isSerializable(icon)) {\n      const state = icon.saveState(doFullSerialization);\n      if (state) icons[icon.getType().toString()] = state;\n    }\n  }\n\n  if (Object.keys(icons).length) {\n    state['icons'] = icons;\n  }\n}\n\n/**\n * Adds the state of all of the fields on the block to the given state object.\n *\n * @param block The block to serialize the field state of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to serialize the full state of the\n *     field (rather than possibly saving a reference to some state).\n */\nfunction saveFields(block: Block, state: State, doFullSerialization: boolean) {\n  const fields = Object.create(null);\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    for (let j = 0; j < input.fieldRow.length; j++) {\n      const field = input.fieldRow[j];\n      if (field.isSerializable()) {\n        fields[field.name!] = field.saveState(doFullSerialization);\n      }\n    }\n  }\n  if (Object.keys(fields).length) {\n    state['fields'] = fields;\n  }\n}\n\n/**\n * Adds the state of all of the child blocks of the given block (which are\n * connected to inputs) to the given state object.\n *\n * @param block The block to serialize the input blocks of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to do full serialization.\n */\nfunction saveInputBlocks(\n  block: Block,\n  state: State,\n  doFullSerialization: boolean\n) {\n  const inputs = Object.create(null);\n  for (let i = 0; i < block.inputList.length; i++) {\n    const input = block.inputList[i];\n    if (!input.connection) continue;\n    const connectionState = saveConnection(\n      input.connection as Connection,\n      doFullSerialization\n    );\n    if (connectionState) {\n      inputs[input.name] = connectionState;\n    }\n  }\n\n  if (Object.keys(inputs).length) {\n    state['inputs'] = inputs;\n  }\n}\n\n/**\n * Adds the state of all of the next blocks of the given block to the given\n * state object.\n *\n * @param block The block to serialize the next blocks of.\n * @param state The state object to append to.\n * @param doFullSerialization Whether or not to do full serialization.\n */\nfunction saveNextBlocks(\n  block: Block,\n  state: State,\n  doFullSerialization: boolean\n) {\n  if (!block.nextConnection) {\n    return;\n  }\n  const connectionState = saveConnection(\n    block.nextConnection,\n    doFullSerialization\n  );\n  if (connectionState) {\n    state['next'] = connectionState;\n  }\n}\n\n/**\n * Returns the state of the given connection (ie the state of any connected\n * shadow or real blocks).\n *\n * @param connection The connection to serialize the connected blocks of.\n * @returns An object containing the state of any connected shadow block, or any\n *     connected real block.\n * @param doFullSerialization Whether or not to do full serialization.\n */\nfunction saveConnection(\n  connection: Connection,\n  doFullSerialization: boolean\n): ConnectionState | null {\n  const shadow = connection.getShadowState(true);\n  const child = connection.targetBlock();\n  if (!shadow && !child) {\n    return null;\n  }\n  const state = Object.create(null);\n  if (shadow) {\n    state['shadow'] = shadow;\n  }\n  if (child && !child.isShadow()) {\n    state['block'] = save(child, {doFullSerialization});\n  }\n  return state;\n}\n\n/**\n * Loads the block represented by the given state into the given workspace.\n *\n * @param state The state of a block to deserialize into the workspace.\n * @param workspace The workspace to add the block to.\n * @param param1 recordUndo: If true, events triggered by this function will be\n *     undo-able by the user. False by default.\n * @returns The block that was just loaded.\n */\nexport function append(\n  state: State,\n  workspace: Workspace,\n  {recordUndo = false}: {recordUndo?: boolean} = {}\n): Block {\n  return appendInternal(state, workspace, {recordUndo});\n}\n\n/**\n * Loads the block represented by the given state into the given workspace.\n * This is defined internally so that the extra parameters don't clutter our\n * external API.\n * But it is exported so that other places within Blockly can call it directly\n * with the extra parameters.\n *\n * @param state The state of a block to deserialize into the workspace.\n * @param workspace The workspace to add the block to.\n * @param param1 parentConnection: If provided, the system will attempt to\n *     connect the block to this connection after it is created. Undefined by\n *     default. isShadow: If true, the block will be set to a shadow block after\n *     it is created. False by default. recordUndo: If true, events triggered by\n *     this function will be undo-able by the user. False by default.\n * @returns The block that was just appended.\n * @internal\n */\nexport function appendInternal(\n  state: State,\n  workspace: Workspace,\n  {\n    parentConnection = undefined,\n    isShadow = false,\n    recordUndo = false,\n  }: {\n    parentConnection?: Connection;\n    isShadow?: boolean;\n    recordUndo?: boolean;\n  } = {}\n): Block {\n  const prevRecordUndo = eventUtils.getRecordUndo();\n  eventUtils.setRecordUndo(recordUndo);\n  const existingGroup = eventUtils.getGroup();\n  if (!existingGroup) {\n    eventUtils.setGroup(true);\n  }\n  eventUtils.disable();\n\n  const block = appendPrivate(state, workspace, {parentConnection, isShadow});\n\n  eventUtils.enable();\n  eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(block));\n  eventUtils.setGroup(existingGroup);\n  eventUtils.setRecordUndo(prevRecordUndo);\n\n  // Adding connections to the connection db is expensive. This defers that\n  // operation to decrease load time.\n  if (workspace.rendered) {\n    const blockSvg = block as BlockSvg;\n    setTimeout(() => {\n      if (!blockSvg.disposed) {\n        blockSvg.setConnectionTracking(true);\n      }\n    }, 1);\n  }\n\n  return block;\n}\n\n/**\n * Loads the block represented by the given state into the given workspace.\n * This is defined privately so that it can be called recursively without firing\n * eroneous events. Events (and other things we only want to occur on the top\n * block) are handled by appendInternal.\n *\n * @param state The state of a block to deserialize into the workspace.\n * @param workspace The workspace to add the block to.\n * @param param1 parentConnection: If provided, the system will attempt to\n *     connect the block to this connection after it is created. Undefined by\n *     default. isShadow: The block will be set to a shadow block after it is\n *     created. False by default.\n * @returns The block that was just appended.\n */\nfunction appendPrivate(\n  state: State,\n  workspace: Workspace,\n  {\n    parentConnection = undefined,\n    isShadow = false,\n  }: {parentConnection?: Connection; isShadow?: boolean} = {}\n): Block {\n  if (!state['type']) {\n    throw new MissingBlockType(state);\n  }\n\n  const block = workspace.newBlock(state['type'], state['id']);\n  block.setShadow(isShadow);\n  loadCoords(block, state);\n  loadAttributes(block, state);\n  loadExtraState(block, state);\n  tryToConnectParent(parentConnection, block, state);\n  loadIcons(block, state);\n  loadFields(block, state);\n  loadInputBlocks(block, state);\n  loadNextBlocks(block, state);\n  initBlock(block, workspace.rendered);\n\n  return block;\n}\n\n/**\n * Applies any coordinate information available on the state object to the\n * block.\n *\n * @param block The block to set the position of.\n * @param state The state object to reference.\n */\nfunction loadCoords(block: Block, state: State) {\n  let x = state['x'] === undefined ? 0 : state['x'];\n  const y = state['y'] === undefined ? 0 : state['y'];\n\n  const workspace = block.workspace;\n  x = workspace.RTL ? workspace.getWidth() - x : x;\n\n  block.moveBy(x, y);\n}\n\n/**\n * Applies any attribute information available on the state object to the block.\n *\n * @param block The block to set the attributes of.\n * @param state The state object to reference.\n */\nfunction loadAttributes(block: Block, state: State) {\n  if (state['collapsed']) {\n    block.setCollapsed(true);\n  }\n  if (state['deletable'] === false) {\n    block.setDeletable(false);\n  }\n  if (state['movable'] === false) {\n    block.setMovable(false);\n  }\n  if (state['editable'] === false) {\n    block.setEditable(false);\n  }\n  if (state['enabled'] === false) {\n    block.setEnabled(false);\n  }\n  if (state['inline'] !== undefined) {\n    block.setInputsInline(state['inline']);\n  }\n  if (state['data'] !== undefined) {\n    block.data = state['data'];\n  }\n}\n\n/**\n * Applies any extra state information available on the state object to the\n * block.\n *\n * @param block The block to set the extra state of.\n * @param state The state object to reference.\n */\nfunction loadExtraState(block: Block, state: State) {\n  if (!state['extraState']) {\n    return;\n  }\n  if (block.loadExtraState) {\n    block.loadExtraState(state['extraState']);\n  } else if (block.domToMutation) {\n    block.domToMutation(utilsXml.textToDom(state['extraState']));\n  }\n}\n\n/**\n * Attempts to connect the block to the parent connection, if it exists.\n *\n * @param parentConnection The parent connection to try to connect the block to.\n * @param child The block to try to connect to the parent.\n * @param state The state which defines the given block\n */\nfunction tryToConnectParent(\n  parentConnection: Connection | undefined,\n  child: Block,\n  state: State\n) {\n  if (!parentConnection) {\n    return;\n  }\n\n  if (parentConnection.getSourceBlock().isShadow() && !child.isShadow()) {\n    throw new RealChildOfShadow(state);\n  }\n\n  let connected = false;\n  let childConnection;\n  if (parentConnection.type === inputTypes.VALUE) {\n    childConnection = child.outputConnection;\n    if (!childConnection) {\n      throw new MissingConnection('output', child, state);\n    }\n    connected = parentConnection.connect(childConnection);\n  } else {\n    // Statement type.\n    childConnection = child.previousConnection;\n    if (!childConnection) {\n      throw new MissingConnection('previous', child, state);\n    }\n    connected = parentConnection.connect(childConnection);\n  }\n\n  if (!connected) {\n    const checker = child.workspace.connectionChecker;\n    throw new BadConnectionCheck(\n      checker.getErrorMessage(\n        checker.canConnectWithReason(childConnection, parentConnection, false),\n        childConnection,\n        parentConnection\n      ),\n      parentConnection.type === inputTypes.VALUE\n        ? 'output connection'\n        : 'previous connection',\n      child,\n      state\n    );\n  }\n}\n\n/**\n * Applies icon state to the icons on the block, based on the given state\n * object.\n *\n * @param block The block to set the icon state of.\n * @param state The state object to reference.\n */\nfunction loadIcons(block: Block, state: State) {\n  if (!state['icons']) return;\n\n  const iconTypes = Object.keys(state['icons']);\n  for (const iconType of iconTypes) {\n    const iconState = state['icons'][iconType];\n    let icon = block.getIcon(iconType);\n    if (!icon) {\n      const constructor = registry.getClass(\n        registry.Type.ICON,\n        iconType,\n        false\n      );\n      if (!constructor) throw new UnregisteredIcon(iconType, block, state);\n      icon = new constructor(block);\n      block.addIcon(icon);\n    }\n    if (isSerializable(icon)) icon.loadState(iconState);\n  }\n}\n\n/**\n * Applies any field information available on the state object to the block.\n *\n * @param block The block to set the field state of.\n * @param state The state object to reference.\n */\nfunction loadFields(block: Block, state: State) {\n  if (!state['fields']) {\n    return;\n  }\n  const keys = Object.keys(state['fields']);\n  for (let i = 0; i < keys.length; i++) {\n    const fieldName = keys[i];\n    const fieldState = state['fields'][fieldName];\n    const field = block.getField(fieldName);\n    if (!field) {\n      console.warn(\n        `Ignoring non-existant field ${fieldName} in block ${block.type}`\n      );\n      continue;\n    }\n    field.loadState(fieldState);\n  }\n}\n\n/**\n * Creates any child blocks (attached to inputs) defined by the given state\n * and attaches them to the given block.\n *\n * @param block The block to attach input blocks to.\n * @param state The state object to reference.\n */\nfunction loadInputBlocks(block: Block, state: State) {\n  if (!state['inputs']) {\n    return;\n  }\n  const keys = Object.keys(state['inputs']);\n  for (let i = 0; i < keys.length; i++) {\n    const inputName = keys[i];\n    const input = block.getInput(inputName);\n    if (!input || !input.connection) {\n      throw new MissingConnection(inputName, block, state);\n    }\n    loadConnection(input.connection, state['inputs'][inputName]);\n  }\n}\n\n/**\n * Creates any next blocks defined by the given state and attaches them to the\n * given block.\n *\n * @param block The block to attach next blocks to.\n * @param state The state object to reference.\n */\nfunction loadNextBlocks(block: Block, state: State) {\n  if (!state['next']) {\n    return;\n  }\n  if (!block.nextConnection) {\n    throw new MissingConnection('next', block, state);\n  }\n  loadConnection(block.nextConnection, state['next']);\n}\n/**\n * Applies the state defined by connectionState to the given connection, ie\n * assigns shadows and attaches child blocks.\n *\n * @param connection The connection to deserialize the connected blocks of.\n * @param connectionState The object containing the state of any connected\n *     shadow block, or any connected real block.\n */\nfunction loadConnection(\n  connection: Connection,\n  connectionState: ConnectionState\n) {\n  if (connectionState['shadow']) {\n    connection.setShadowState(connectionState['shadow']);\n  }\n  if (connectionState['block']) {\n    appendPrivate(\n      connectionState['block'],\n      connection.getSourceBlock().workspace,\n      {parentConnection: connection}\n    );\n  }\n}\n\n// TODO(#5146): Remove this from the serialization system.\n/**\n * Initializes the give block, eg init the model, inits the svg, renders, etc.\n *\n * @param block The block to initialize.\n * @param rendered Whether the block is a rendered or headless block.\n */\nfunction initBlock(block: Block, rendered: boolean) {\n  if (rendered) {\n    const blockSvg = block as BlockSvg;\n    // Adding connections to the connection db is expensive. This defers that\n    // operation to decrease load time.\n    blockSvg.setConnectionTracking(false);\n\n    blockSvg.initSvg();\n    blockSvg.render(false);\n    // fixes #6076 JSO deserialization doesn't\n    // set .iconXY_ property so here it will be set\n    for (const icon of blockSvg.getIcons()) {\n      icon.onLocationChange(blockSvg.getRelativeToSurfaceXY());\n    }\n  } else {\n    block.initModel();\n  }\n}\n\n// Alias to disambiguate saving within the serializer.\nconst saveBlock = save;\n\n/**\n * Serializer for saving and loading block state.\n */\nexport class BlockSerializer implements ISerializer {\n  priority: number;\n\n  /* eslint-disable-next-line require-jsdoc */\n  constructor() {\n    /** The priority for deserializing blocks. */\n    this.priority = priorities.BLOCKS;\n  }\n\n  /**\n   * Serializes the blocks of the given workspace.\n   *\n   * @param workspace The workspace to save the blocks of.\n   * @returns The state of the workspace's blocks, or null if there are no\n   *     blocks.\n   */\n  save(\n    workspace: Workspace\n  ): {languageVersion: number; blocks: State[]} | null {\n    const blockStates = [];\n    for (const block of workspace.getTopBlocks(false)) {\n      const state = saveBlock(block, {\n        addCoordinates: true,\n        doFullSerialization: false,\n      });\n      if (state) {\n        blockStates.push(state);\n      }\n    }\n    if (blockStates.length) {\n      return {\n        'languageVersion': 0, // Currently unused.\n        'blocks': blockStates,\n      };\n    }\n    return null;\n  }\n\n  /**\n   * Deserializes the blocks defined by the given state into the given\n   * workspace.\n   *\n   * @param state The state of the blocks to deserialize.\n   * @param workspace The workspace to deserialize into.\n   */\n  load(\n    state: {languageVersion: number; blocks: State[]},\n    workspace: Workspace\n  ) {\n    const blockStates = state['blocks'];\n    for (const state of blockStates) {\n      append(state, workspace, {recordUndo: eventUtils.getRecordUndo()});\n    }\n  }\n\n  /**\n   * Disposes of any blocks that exist on the workspace.\n   *\n   * @param workspace The workspace to clear the blocks of.\n   */\n  clear(workspace: Workspace) {\n    // Cannot use workspace.clear() because that also removes variables.\n    for (const block of workspace.getTopBlocks(false)) {\n      block.dispose(false);\n    }\n  }\n}\n\nserializationRegistry.register('blocks', new BlockSerializer());\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport interface IHasBubble {\n  /** @returns True if the bubble is currently open, false otherwise. */\n  bubbleIsVisible(): boolean;\n\n  /** Sets whether the bubble is open or not. */\n  setBubbleVisible(visible: boolean): void;\n}\n\n/** Type guard that checks whether the given object is a IHasBubble. */\nexport function hasBubble(obj: any): obj is IHasBubble {\n  return (\n    obj.bubbleIsVisible !== undefined && obj.setBubbleVisible !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Components for creating connections between blocks.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Connection');\n\nimport type {Block} from './block.js';\nimport {ConnectionType} from './connection_type.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Input} from './inputs/input.js';\nimport type {IASTNodeLocationWithBlock} from './interfaces/i_ast_node_location_with_block.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport * as blocks from './serialization/blocks.js';\nimport * as Xml from './xml.js';\n\n/**\n * Class for a connection between blocks.\n */\nexport class Connection implements IASTNodeLocationWithBlock {\n  /** Constants for checking whether two connections are compatible. */\n  static CAN_CONNECT = 0;\n  static REASON_SELF_CONNECTION = 1;\n  static REASON_WRONG_TYPE = 2;\n  static REASON_TARGET_NULL = 3;\n  static REASON_CHECKS_FAILED = 4;\n  static REASON_DIFFERENT_WORKSPACES = 5;\n  static REASON_SHADOW_PARENT = 6;\n  static REASON_DRAG_CHECKS_FAILED = 7;\n  static REASON_PREVIOUS_AND_OUTPUT = 8;\n\n  protected sourceBlock_: Block;\n\n  /** Connection this connection connects to.  Null if not connected. */\n  targetConnection: Connection | null = null;\n\n  /**\n   * Has this connection been disposed of?\n   *\n   * @internal\n   */\n  disposed = false;\n\n  /** List of compatible value types.  Null if all types are compatible. */\n  private check: string[] | null = null;\n\n  /** DOM representation of a shadow block, or null if none. */\n  private shadowDom: Element | null = null;\n\n  /**\n   * Horizontal location of this connection.\n   *\n   * @internal\n   */\n  x = 0;\n\n  /**\n   * Vertical location of this connection.\n   *\n   * @internal\n   */\n  y = 0;\n\n  private shadowState: blocks.State | null = null;\n\n  /**\n   * @param source The block establishing this connection.\n   * @param type The type of the connection.\n   */\n  constructor(source: Block, public type: number) {\n    this.sourceBlock_ = source;\n  }\n\n  /**\n   * Connect two connections together.  This is the connection on the superior\n   * block.\n   *\n   * @param childConnection Connection on inferior block.\n   */\n  protected connect_(childConnection: Connection) {\n    const INPUT = ConnectionType.INPUT_VALUE;\n    const parentBlock = this.getSourceBlock();\n    const childBlock = childConnection.getSourceBlock();\n\n    // Make sure the childConnection is available.\n    if (childConnection.isConnected()) {\n      childConnection.disconnectInternal(false);\n    }\n\n    // Make sure the parentConnection is available.\n    let orphan;\n    if (this.isConnected()) {\n      const shadowState = this.stashShadowState();\n      const target = this.targetBlock();\n      if (target!.isShadow()) {\n        target!.dispose(false);\n      } else {\n        this.disconnectInternal();\n        orphan = target;\n      }\n      this.applyShadowState(shadowState);\n    }\n\n    // Connect the new connection to the parent.\n    let event;\n    if (eventUtils.isEnabled()) {\n      event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n        childBlock\n      ) as BlockMove;\n      event.setReason(['connect']);\n    }\n    connectReciprocally(this, childConnection);\n    childBlock.setParent(parentBlock);\n    if (event) {\n      event.recordNew();\n      eventUtils.fire(event);\n    }\n\n    // Deal with the orphan if it exists.\n    if (orphan) {\n      const orphanConnection =\n        this.type === INPUT\n          ? orphan.outputConnection\n          : orphan.previousConnection;\n      if (!orphanConnection) return;\n      const connection = Connection.getConnectionForOrphanedConnection(\n        childBlock,\n        orphanConnection\n      );\n      if (connection) {\n        orphanConnection.connect(connection);\n      } else {\n        orphanConnection.onFailedConnect(this);\n      }\n    }\n  }\n\n  /**\n   * Dispose of this connection and deal with connected blocks.\n   *\n   * @internal\n   */\n  dispose() {\n    // isConnected returns true for shadows and non-shadows.\n    if (this.isConnected()) {\n      // Destroy the attached shadow block & its children (if it exists).\n      this.setShadowStateInternal();\n\n      const targetBlock = this.targetBlock();\n      if (targetBlock && !targetBlock.isDeadOrDying()) {\n        // Disconnect the attached normal block.\n        targetBlock.unplug();\n      }\n    }\n\n    this.disposed = true;\n  }\n\n  /**\n   * Get the source block for this connection.\n   *\n   * @returns The source block.\n   */\n  getSourceBlock(): Block {\n    return this.sourceBlock_;\n  }\n\n  /**\n   * Does the connection belong to a superior block (higher in the source\n   * stack)?\n   *\n   * @returns True if connection faces down or right.\n   */\n  isSuperior(): boolean {\n    return (\n      this.type === ConnectionType.INPUT_VALUE ||\n      this.type === ConnectionType.NEXT_STATEMENT\n    );\n  }\n\n  /**\n   * Is the connection connected?\n   *\n   * @returns True if connection is connected to another connection.\n   */\n  isConnected(): boolean {\n    return !!this.targetConnection;\n  }\n\n  /**\n   * Get the workspace's connection type checker object.\n   *\n   * @returns The connection type checker for the source block's workspace.\n   * @internal\n   */\n  getConnectionChecker(): IConnectionChecker {\n    return this.sourceBlock_.workspace.connectionChecker;\n  }\n\n  /**\n   * Called when an attempted connection fails. NOP by default (i.e. for\n   * headless workspaces).\n   *\n   * @param _otherConnection Connection that this connection failed to connect\n   *     to.\n   * @internal\n   */\n  onFailedConnect(_otherConnection: Connection) {}\n  // NOP\n\n  /**\n   * Connect this connection to another connection.\n   *\n   * @param otherConnection Connection to connect to.\n   * @returns Whether the the blocks are now connected or not.\n   */\n  connect(otherConnection: Connection): boolean {\n    if (this.targetConnection === otherConnection) {\n      // Already connected together.  NOP.\n      return true;\n    }\n\n    const checker = this.getConnectionChecker();\n    if (checker.canConnect(this, otherConnection, false)) {\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      // Determine which block is superior (higher in the source stack).\n      if (this.isSuperior()) {\n        // Superior block.\n        this.connect_(otherConnection);\n      } else {\n        // Inferior block.\n        otherConnection.connect_(this);\n      }\n      eventUtils.setGroup(existingGroup);\n    }\n\n    return this.isConnected();\n  }\n\n  /**\n   * Disconnect this connection.\n   */\n  disconnect() {\n    this.disconnectInternal();\n  }\n\n  /**\n   * Disconnect two blocks that are connected by this connection.\n   *\n   * @param setParent Whether to set the parent of the disconnected block or\n   *     not, defaults to true.\n   *     If you do not set the parent, ensure that a subsequent action does,\n   *     otherwise the view and model will be out of sync.\n   */\n  protected disconnectInternal(setParent = true) {\n    const {parentConnection, childConnection} =\n      this.getParentAndChildConnections();\n    if (!parentConnection || !childConnection) {\n      throw Error('Source connection not connected.');\n    }\n\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n\n    let event;\n    if (eventUtils.isEnabled()) {\n      event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n        childConnection.getSourceBlock()\n      ) as BlockMove;\n      event.setReason(['disconnect']);\n    }\n    const otherConnection = this.targetConnection;\n    if (otherConnection) {\n      otherConnection.targetConnection = null;\n    }\n    this.targetConnection = null;\n    if (setParent) childConnection.getSourceBlock().setParent(null);\n    if (event) {\n      event.recordNew();\n      eventUtils.fire(event);\n    }\n\n    if (!childConnection.getSourceBlock().isShadow()) {\n      // If we were disconnecting a shadow, no need to spawn a new one.\n      parentConnection.respawnShadow_();\n    }\n\n    eventUtils.setGroup(existingGroup);\n  }\n\n  /**\n   * Returns the parent connection (superior) and child connection (inferior)\n   * given this connection and the connection it is connected to.\n   *\n   * @returns The parent connection and child connection, given this connection\n   *     and the connection it is connected to.\n   */\n  protected getParentAndChildConnections(): {\n    parentConnection?: Connection;\n    childConnection?: Connection;\n  } {\n    if (!this.targetConnection) return {};\n    if (this.isSuperior()) {\n      return {\n        parentConnection: this,\n        childConnection: this.targetConnection,\n      };\n    }\n    return {\n      parentConnection: this.targetConnection,\n      childConnection: this,\n    };\n  }\n\n  /**\n   * Respawn the shadow block if there was one connected to the this connection.\n   */\n  protected respawnShadow_() {\n    // Have to keep respawnShadow_ for backwards compatibility.\n    this.createShadowBlock(true);\n  }\n\n  /**\n   * Reconnects this connection to the input with the given name on the given\n   * block. If there is already a connection connected to that input, that\n   * connection is disconnected.\n   *\n   * @param block The block to connect this connection to.\n   * @param inputName The name of the input to connect this connection to.\n   * @returns True if this connection was able to connect, false otherwise.\n   */\n  reconnect(block: Block, inputName: string): boolean {\n    // No need to reconnect if this connection's block is deleted.\n    if (this.getSourceBlock().isDeadOrDying()) return false;\n\n    const connectionParent = block.getInput(inputName)?.connection;\n    const currentParent = this.targetBlock();\n    if (\n      (!currentParent || currentParent === block) &&\n      connectionParent &&\n      connectionParent.targetConnection !== this\n    ) {\n      if (connectionParent.isConnected()) {\n        // There's already something connected here.  Get rid of it.\n        connectionParent.disconnect();\n      }\n      connectionParent.connect(this);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the block that this connection connects to.\n   *\n   * @returns The connected block or null if none is connected.\n   */\n  targetBlock(): Block | null {\n    if (this.isConnected()) {\n      return this.targetConnection?.getSourceBlock() ?? null;\n    }\n    return null;\n  }\n\n  /**\n   * Function to be called when this connection's compatible types have changed.\n   */\n  protected onCheckChanged_() {\n    // The new value type may not be compatible with the existing connection.\n    if (\n      this.isConnected() &&\n      (!this.targetConnection ||\n        !this.getConnectionChecker().canConnect(\n          this,\n          this.targetConnection,\n          false\n        ))\n    ) {\n      const child = this.isSuperior() ? this.targetBlock() : this.sourceBlock_;\n      child!.unplug();\n    }\n  }\n\n  /**\n   * Change a connection's compatibility.\n   *\n   * @param check Compatible value type or list of value types. Null if all\n   *     types are compatible.\n   * @returns The connection being modified (to allow chaining).\n   */\n  setCheck(check: string | string[] | null): Connection {\n    if (check) {\n      if (!Array.isArray(check)) {\n        check = [check];\n      }\n      this.check = check;\n      this.onCheckChanged_();\n    } else {\n      this.check = null;\n    }\n    return this;\n  }\n\n  /**\n   * Get a connection's compatibility.\n   *\n   * @returns List of compatible value types.\n   *     Null if all types are compatible.\n   */\n  getCheck(): string[] | null {\n    return this.check;\n  }\n\n  /**\n   * Changes the connection's shadow block.\n   *\n   * @param shadowDom DOM representation of a block or null.\n   */\n  setShadowDom(shadowDom: Element | null) {\n    this.setShadowStateInternal({shadowDom});\n  }\n\n  /**\n   * Returns the xml representation of the connection's shadow block.\n   *\n   * @param returnCurrent If true, and the shadow block is currently attached to\n   *     this connection, this serializes the state of that block and returns it\n   *     (so that field values are correct). Otherwise the saved shadowDom is\n   *     just returned.\n   * @returns Shadow DOM representation of a block or null.\n   */\n  getShadowDom(returnCurrent?: boolean): Element | null {\n    return returnCurrent && this.targetBlock()!.isShadow()\n      ? (Xml.blockToDom(this.targetBlock() as Block) as Element)\n      : this.shadowDom;\n  }\n\n  /**\n   * Changes the connection's shadow block.\n   *\n   * @param shadowState An state represetation of the block or null.\n   */\n  setShadowState(shadowState: blocks.State | null) {\n    this.setShadowStateInternal({shadowState});\n  }\n\n  /**\n   * Returns the serialized object representation of the connection's shadow\n   * block.\n   *\n   * @param returnCurrent If true, and the shadow block is currently attached to\n   *     this connection, this serializes the state of that block and returns it\n   *     (so that field values are correct). Otherwise the saved state is just\n   *     returned.\n   * @returns Serialized object representation of the block, or null.\n   */\n  getShadowState(returnCurrent?: boolean): blocks.State | null {\n    if (returnCurrent && this.targetBlock() && this.targetBlock()!.isShadow()) {\n      return blocks.save(this.targetBlock() as Block);\n    }\n    return this.shadowState;\n  }\n\n  /**\n   * Find all nearby compatible connections to this connection.\n   * Type checking does not apply, since this function is used for bumping.\n   *\n   * Headless configurations (the default) do not have neighboring connection,\n   * and always return an empty list (the default).\n   * {@link RenderedConnection#neighbours} overrides this behavior with a list\n   * computed from the rendered positioning.\n   *\n   * @param _maxLimit The maximum radius to another connection.\n   * @returns List of connections.\n   * @internal\n   */\n  neighbours(_maxLimit: number): Connection[] {\n    return [];\n  }\n\n  /**\n   * Get the parent input of a connection.\n   *\n   * @returns The input that the connection belongs to or null if no parent\n   *     exists.\n   * @internal\n   */\n  getParentInput(): Input | null {\n    let parentInput = null;\n    const inputs = this.sourceBlock_.inputList;\n    for (let i = 0; i < inputs.length; i++) {\n      if (inputs[i].connection === this) {\n        parentInput = inputs[i];\n        break;\n      }\n    }\n    return parentInput;\n  }\n\n  /**\n   * This method returns a string describing this Connection in developer terms\n   * (English only). Intended to on be used in console logs and errors.\n   *\n   * @returns The description.\n   */\n  toString(): string {\n    const block = this.sourceBlock_;\n    if (!block) {\n      return 'Orphan Connection';\n    }\n    let msg;\n    if (block.outputConnection === this) {\n      msg = 'Output Connection of ';\n    } else if (block.previousConnection === this) {\n      msg = 'Previous Connection of ';\n    } else if (block.nextConnection === this) {\n      msg = 'Next Connection of ';\n    } else {\n      let parentInput = null;\n      for (let i = 0, input; (input = block.inputList[i]); i++) {\n        if (input.connection === this) {\n          parentInput = input;\n          break;\n        }\n      }\n      if (parentInput) {\n        msg = 'Input \"' + parentInput.name + '\" connection on ';\n      } else {\n        console.warn('Connection not actually connected to sourceBlock_');\n        return 'Orphan Connection';\n      }\n    }\n    return msg + block.toDevString();\n  }\n\n  /**\n   * Returns the state of the shadowDom_ and shadowState_ properties, then\n   * temporarily sets those properties to null so no shadow respawns.\n   *\n   * @returns The state of both the shadowDom_ and shadowState_ properties.\n   */\n  private stashShadowState(): {\n    shadowDom: Element | null;\n    shadowState: blocks.State | null;\n  } {\n    const shadowDom = this.getShadowDom(true);\n    const shadowState = this.getShadowState(true);\n    // Set to null so it doesn't respawn.\n    this.shadowDom = null;\n    this.shadowState = null;\n    return {shadowDom, shadowState};\n  }\n\n  /**\n   * Reapplies the stashed state of the shadowDom_ and shadowState_ properties.\n   *\n   * @param param0 The state to reapply to the shadowDom_ and shadowState_\n   *     properties.\n   */\n  private applyShadowState({\n    shadowDom,\n    shadowState,\n  }: {\n    shadowDom: Element | null;\n    shadowState: blocks.State | null;\n  }) {\n    this.shadowDom = shadowDom;\n    this.shadowState = shadowState;\n  }\n\n  /**\n   * Sets the state of the shadow of this connection.\n   *\n   * @param param0 The state to set the shadow of this connection to.\n   */\n  private setShadowStateInternal({\n    shadowDom = null,\n    shadowState = null,\n  }: {\n    shadowDom?: Element | null;\n    shadowState?: blocks.State | null;\n  } = {}) {\n    // One or both of these should always be null.\n    // If neither is null, the shadowState will get priority.\n    this.shadowDom = shadowDom;\n    this.shadowState = shadowState;\n\n    const target = this.targetBlock();\n    if (!target) {\n      this.respawnShadow_();\n      if (this.targetBlock() && this.targetBlock()!.isShadow()) {\n        this.serializeShadow(this.targetBlock());\n      }\n    } else if (target.isShadow()) {\n      target.dispose(false);\n      if (this.getSourceBlock().isDeadOrDying()) return;\n      this.respawnShadow_();\n      if (this.targetBlock() && this.targetBlock()!.isShadow()) {\n        this.serializeShadow(this.targetBlock());\n      }\n    } else {\n      const shadow = this.createShadowBlock(false);\n      this.serializeShadow(shadow);\n      if (shadow) {\n        shadow.dispose(false);\n      }\n    }\n  }\n\n  /**\n   * Creates a shadow block based on the current shadowState_ or shadowDom_.\n   * shadowState_ gets priority.\n   *\n   * @param attemptToConnect Whether to try to connect the shadow block to this\n   *     connection or not.\n   * @returns The shadow block that was created, or null if both the\n   *     shadowState_ and shadowDom_ are null.\n   */\n  private createShadowBlock(attemptToConnect: boolean): Block | null {\n    const parentBlock = this.getSourceBlock();\n    const shadowState = this.getShadowState();\n    const shadowDom = this.getShadowDom();\n    if (parentBlock.isDeadOrDying() || (!shadowState && !shadowDom)) {\n      return null;\n    }\n\n    let blockShadow;\n    if (shadowState) {\n      blockShadow = blocks.appendInternal(shadowState, parentBlock.workspace, {\n        parentConnection: attemptToConnect ? this : undefined,\n        isShadow: true,\n        recordUndo: false,\n      });\n      return blockShadow;\n    }\n\n    if (shadowDom) {\n      blockShadow = Xml.domToBlock(shadowDom, parentBlock.workspace);\n      if (attemptToConnect) {\n        if (this.type === ConnectionType.INPUT_VALUE) {\n          if (!blockShadow.outputConnection) {\n            throw new Error('Shadow block is missing an output connection');\n          }\n          if (!this.connect(blockShadow.outputConnection)) {\n            throw new Error('Could not connect shadow block to connection');\n          }\n        } else if (this.type === ConnectionType.NEXT_STATEMENT) {\n          if (!blockShadow.previousConnection) {\n            throw new Error('Shadow block is missing previous connection');\n          }\n          if (!this.connect(blockShadow.previousConnection)) {\n            throw new Error('Could not connect shadow block to connection');\n          }\n        } else {\n          throw new Error(\n            'Cannot connect a shadow block to a previous/output connection'\n          );\n        }\n      }\n      return blockShadow;\n    }\n    return null;\n  }\n\n  /**\n   * Saves the given shadow block to both the shadowDom_ and shadowState_\n   * properties, in their respective serialized forms.\n   *\n   * @param shadow The shadow to serialize, or null.\n   */\n  private serializeShadow(shadow: Block | null) {\n    if (!shadow) {\n      return;\n    }\n    this.shadowDom = Xml.blockToDom(shadow) as Element;\n    this.shadowState = blocks.save(shadow);\n  }\n\n  /**\n   * Returns the connection (starting at the startBlock) which will accept\n   * the given connection. This includes compatible connection types and\n   * connection checks.\n   *\n   * @param startBlock The block on which to start the search.\n   * @param orphanConnection The connection that is looking for a home.\n   * @returns The suitable connection point on the chain of blocks, or null.\n   */\n  static getConnectionForOrphanedConnection(\n    startBlock: Block,\n    orphanConnection: Connection\n  ): Connection | null {\n    if (orphanConnection.type === ConnectionType.OUTPUT_VALUE) {\n      return getConnectionForOrphanedOutput(\n        startBlock,\n        orphanConnection.getSourceBlock()\n      );\n    }\n    // Otherwise we're dealing with a stack.\n    const connection = startBlock.lastConnectionInStack(true);\n    const checker = orphanConnection.getConnectionChecker();\n    if (connection && checker.canConnect(orphanConnection, connection, false)) {\n      return connection;\n    }\n    return null;\n  }\n}\n\n/**\n * Update two connections to target each other.\n *\n * @param first The first connection to update.\n * @param second The second connection to update.\n */\nfunction connectReciprocally(first: Connection, second: Connection) {\n  if (!first || !second) {\n    throw Error('Cannot connect null connections.');\n  }\n  first.targetConnection = second;\n  second.targetConnection = first;\n}\n/**\n * Returns the single connection on the block that will accept the orphaned\n * block, if one can be found. If the block has multiple compatible connections\n * (even if they are filled) this returns null. If the block has no compatible\n * connections, this returns null.\n *\n * @param block The superior block.\n * @param orphanBlock The inferior block.\n * @returns The suitable connection point on 'block', or null.\n */\nfunction getSingleConnection(\n  block: Block,\n  orphanBlock: Block\n): Connection | null {\n  let foundConnection = null;\n  const output = orphanBlock.outputConnection;\n  const typeChecker = output?.getConnectionChecker();\n\n  for (let i = 0, input; (input = block.inputList[i]); i++) {\n    const connection = input.connection;\n    if (connection && typeChecker?.canConnect(output, connection, false)) {\n      if (foundConnection) {\n        return null; // More than one connection.\n      }\n      foundConnection = connection;\n    }\n  }\n  return foundConnection;\n}\n\n/**\n * Walks down a row a blocks, at each stage checking if there are any\n * connections that will accept the orphaned block.  If at any point there\n * are zero or multiple eligible connections, returns null.  Otherwise\n * returns the only input on the last block in the chain.\n * Terminates early for shadow blocks.\n *\n * @param startBlock The block on which to start the search.\n * @param orphanBlock The block that is looking for a home.\n * @returns The suitable connection point on the chain of blocks, or null.\n */\nfunction getConnectionForOrphanedOutput(\n  startBlock: Block,\n  orphanBlock: Block\n): Connection | null {\n  let newBlock: Block | null = startBlock;\n  let connection;\n  while ((connection = getSingleConnection(newBlock, orphanBlock))) {\n    newBlock = connection.targetBlock();\n    if (!newBlock || newBlock.isShadow()) {\n      return connection;\n    }\n  }\n  return null;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.math');\n\n/**\n * Converts degrees to radians.\n * Copied from Closure's goog.math.toRadians.\n *\n * @param angleDegrees Angle in degrees.\n * @returns Angle in radians.\n */\nexport function toRadians(angleDegrees: number): number {\n  return (angleDegrees * Math.PI) / 180;\n}\n\n/**\n * Converts radians to degrees.\n * Copied from Closure's goog.math.toDegrees.\n *\n * @param angleRadians Angle in radians.\n * @returns Angle in degrees.\n */\nexport function toDegrees(angleRadians: number): number {\n  return (angleRadians * 180) / Math.PI;\n}\n\n/**\n * Clamp the provided number between the lower bound and the upper bound.\n *\n * @param lowerBound The desired lower bound.\n * @param number The number to clamp.\n * @param upperBound The desired upper bound.\n * @returns The clamped number.\n */\nexport function clamp(\n  lowerBound: number,\n  number: number,\n  upperBound: number\n): number {\n  if (upperBound < lowerBound) {\n    const temp = upperBound;\n    upperBound = lowerBound;\n    lowerBound = temp;\n  }\n  return Math.max(lowerBound, Math.min(number, upperBound));\n}\n","/**\n * @license\n * Copyright 2016 Massachusetts Institute of Technology\n * All rights reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A div that floats on top of the workspace, for drop-down menus.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.dropDownDiv');\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as common from './common.js';\nimport * as dom from './utils/dom.js';\nimport type {Field} from './field.js';\nimport * as math from './utils/math.js';\nimport {Rect} from './utils/rect.js';\nimport type {Size} from './utils/size.js';\nimport * as style from './utils/style.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Arrow size in px. Should match the value in CSS\n * (need to position pre-render).\n */\nexport const ARROW_SIZE = 16;\n\n/**\n * Drop-down border size in px. Should match the value in CSS (need to position\n * the arrow).\n */\nexport const BORDER_SIZE = 1;\n\n/**\n * Amount the arrow must be kept away from the edges of the main drop-down div,\n * in px.\n */\nexport const ARROW_HORIZONTAL_PADDING = 12;\n\n/** Amount drop-downs should be padded away from the source, in px. */\nexport const PADDING_Y = 16;\n\n/** Length of animations in seconds. */\nexport const ANIMATION_TIME = 0.25;\n\n/**\n * Timer for animation out, to be cleared if we need to immediately hide\n * without disrupting new shows.\n */\nlet animateOutTimer: ReturnType<typeof setTimeout> | null = null;\n\n/** Callback for when the drop-down is hidden. */\nlet onHide: Function | null = null;\n\n/** A class name representing the current owner's workspace renderer. */\nlet renderedClassName = '';\n\n/** A class name representing the current owner's workspace theme. */\nlet themeClassName = '';\n\n/** The content element. */\nlet div: HTMLDivElement;\n\n/** The content element. */\nlet content: HTMLDivElement;\n\n/** The arrow element. */\nlet arrow: HTMLDivElement;\n\n/**\n * Drop-downs will appear within the bounds of this element if possible.\n * Set in setBoundsElement.\n */\nlet boundsElement: Element | null = null;\n\n/** The object currently using the drop-down. */\nlet owner: Field | null = null;\n\n/** Whether the dropdown was positioned to a field or the source block. */\nlet positionToField: boolean | null = null;\n\n/**\n * Dropdown bounds info object used to encapsulate sizing information about a\n * bounding element (bounding box and width/height).\n */\nexport interface BoundsInfo {\n  top: number;\n  left: number;\n  bottom: number;\n  right: number;\n  width: number;\n  height: number;\n}\n\n/** Dropdown position metrics. */\nexport interface PositionMetrics {\n  initialX: number;\n  initialY: number;\n  finalX: number;\n  finalY: number;\n  arrowX: number | null;\n  arrowY: number | null;\n  arrowAtTop: boolean | null;\n  arrowVisible: boolean;\n}\n\n/**\n * Create and insert the DOM element for this div.\n *\n * @internal\n */\nexport function createDom() {\n  if (div) {\n    return; // Already created.\n  }\n  div = document.createElement('div');\n  div.className = 'blocklyDropDownDiv';\n  const parentDiv = common.getParentContainer() || document.body;\n  parentDiv.appendChild(div);\n\n  content = document.createElement('div');\n  content.className = 'blocklyDropDownContent';\n  div.appendChild(content);\n\n  arrow = document.createElement('div');\n  arrow.className = 'blocklyDropDownArrow';\n  div.appendChild(arrow);\n\n  div.style.opacity = '0';\n  // Transition animation for transform: translate() and opacity.\n  div.style.transition =\n    'transform ' + ANIMATION_TIME + 's, ' + 'opacity ' + ANIMATION_TIME + 's';\n\n  // Handle focusin/out events to add a visual indicator when\n  // a child is focused or blurred.\n  div.addEventListener('focusin', function () {\n    dom.addClass(div, 'blocklyFocused');\n  });\n  div.addEventListener('focusout', function () {\n    dom.removeClass(div, 'blocklyFocused');\n  });\n}\n\n/**\n * Set an element to maintain bounds within. Drop-downs will appear\n * within the box of this element if possible.\n *\n * @param boundsElem Element to bind drop-down to.\n */\nexport function setBoundsElement(boundsElem: Element | null) {\n  boundsElement = boundsElem;\n}\n\n/**\n * @returns The field that currently owns this, or null.\n */\nexport function getOwner(): Field | null {\n  return owner;\n}\n\n/**\n * Provide the div for inserting content into the drop-down.\n *\n * @returns Div to populate with content.\n */\nexport function getContentDiv(): Element {\n  return content;\n}\n\n/** Clear the content of the drop-down. */\nexport function clearContent() {\n  content.textContent = '';\n  content.style.width = '';\n}\n\n/**\n * Set the colour for the drop-down.\n *\n * @param backgroundColour Any CSS colour for the background.\n * @param borderColour Any CSS colour for the border.\n */\nexport function setColour(backgroundColour: string, borderColour: string) {\n  div.style.backgroundColor = backgroundColour;\n  div.style.borderColor = borderColour;\n}\n\n/**\n * Shortcut to show and place the drop-down with positioning determined\n * by a particular block. The primary position will be below the block,\n * and the secondary position above the block. Drop-down will be\n * constrained to the block's workspace.\n *\n * @param field The field showing the drop-down.\n * @param block Block to position the drop-down around.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @param opt_secondaryYOffset Optional Y offset for above-block positioning.\n * @returns True if the menu rendered below block; false if above.\n */\nexport function showPositionedByBlock<T>(\n  field: Field<T>,\n  block: BlockSvg,\n  opt_onHide?: Function,\n  opt_secondaryYOffset?: number\n): boolean {\n  return showPositionedByRect(\n    getScaledBboxOfBlock(block),\n    field as Field,\n    opt_onHide,\n    opt_secondaryYOffset\n  );\n}\n\n/**\n * Shortcut to show and place the drop-down with positioning determined\n * by a particular field. The primary position will be below the field,\n * and the secondary position above the field. Drop-down will be\n * constrained to the block's workspace.\n *\n * @param field The field to position the dropdown against.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @param opt_secondaryYOffset Optional Y offset for above-block positioning.\n * @returns True if the menu rendered below block; false if above.\n */\nexport function showPositionedByField<T>(\n  field: Field<T>,\n  opt_onHide?: Function,\n  opt_secondaryYOffset?: number\n): boolean {\n  positionToField = true;\n  return showPositionedByRect(\n    getScaledBboxOfField(field as Field),\n    field as Field,\n    opt_onHide,\n    opt_secondaryYOffset\n  );\n}\n/**\n * Get the scaled bounding box of a block.\n *\n * @param block The block.\n * @returns The scaled bounding box of the block.\n */\nfunction getScaledBboxOfBlock(block: BlockSvg): Rect {\n  const blockSvg = block.getSvgRoot();\n  const scale = block.workspace.scale;\n  const scaledHeight = block.height * scale;\n  const scaledWidth = block.width * scale;\n  const xy = style.getPageOffset(blockSvg);\n  return new Rect(xy.y, xy.y + scaledHeight, xy.x, xy.x + scaledWidth);\n}\n\n/**\n * Get the scaled bounding box of a field.\n *\n * @param field The field.\n * @returns The scaled bounding box of the field.\n */\nfunction getScaledBboxOfField(field: Field): Rect {\n  const bBox = field.getScaledBBox();\n  return new Rect(bBox.top, bBox.bottom, bBox.left, bBox.right);\n}\n\n/**\n * Helper method to show and place the drop-down with positioning determined\n * by a scaled bounding box.  The primary position will be below the rect,\n * and the secondary position above the rect. Drop-down will be constrained to\n * the block's workspace.\n *\n * @param bBox The scaled bounding box.\n * @param field The field to position the dropdown against.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @param opt_secondaryYOffset Optional Y offset for above-block positioning.\n * @returns True if the menu rendered below block; false if above.\n */\nfunction showPositionedByRect(\n  bBox: Rect,\n  field: Field,\n  opt_onHide?: Function,\n  opt_secondaryYOffset?: number\n): boolean {\n  // If we can fit it, render below the block.\n  const primaryX = bBox.left + (bBox.right - bBox.left) / 2;\n  const primaryY = bBox.bottom;\n  // If we can't fit it, render above the entire parent block.\n  const secondaryX = primaryX;\n  let secondaryY = bBox.top;\n  if (opt_secondaryYOffset) {\n    secondaryY += opt_secondaryYOffset;\n  }\n  const sourceBlock = field.getSourceBlock() as BlockSvg;\n  // Set bounds to main workspace; show the drop-down.\n  let workspace = sourceBlock.workspace;\n  while (workspace.options.parentWorkspace) {\n    workspace = workspace.options.parentWorkspace;\n  }\n  setBoundsElement(workspace.getParentSvg().parentNode as Element | null);\n  return show(\n    field,\n    sourceBlock.RTL,\n    primaryX,\n    primaryY,\n    secondaryX,\n    secondaryY,\n    opt_onHide\n  );\n}\n\n/**\n * Show and place the drop-down.\n * The drop-down is placed with an absolute \"origin point\" (x, y) - i.e.,\n * the arrow will point at this origin and box will positioned below or above\n * it.  If we can maintain the container bounds at the primary point, the arrow\n * will point there, and the container will be positioned below it.\n * If we can't maintain the container bounds at the primary point, fall-back to\n * the secondary point and position above.\n *\n * @param newOwner The object showing the drop-down\n * @param rtl Right-to-left (true) or left-to-right (false).\n * @param primaryX Desired origin point x, in absolute px.\n * @param primaryY Desired origin point y, in absolute px.\n * @param secondaryX Secondary/alternative origin point x, in absolute px.\n * @param secondaryY Secondary/alternative origin point y, in absolute px.\n * @param opt_onHide Optional callback for when the drop-down is hidden.\n * @returns True if the menu rendered at the primary origin point.\n * @internal\n */\nexport function show<T>(\n  newOwner: Field<T>,\n  rtl: boolean,\n  primaryX: number,\n  primaryY: number,\n  secondaryX: number,\n  secondaryY: number,\n  opt_onHide?: Function\n): boolean {\n  owner = newOwner as Field;\n  onHide = opt_onHide || null;\n  // Set direction.\n  div.style.direction = rtl ? 'rtl' : 'ltr';\n\n  const mainWorkspace = common.getMainWorkspace() as WorkspaceSvg;\n  renderedClassName = mainWorkspace.getRenderer().getClassName();\n  themeClassName = mainWorkspace.getTheme().getClassName();\n  if (renderedClassName) {\n    dom.addClass(div, renderedClassName);\n  }\n  if (themeClassName) {\n    dom.addClass(div, themeClassName);\n  }\n\n  // When we change `translate` multiple times in close succession,\n  // Chrome may choose to wait and apply them all at once.\n  // Since we want the translation to initial X, Y to be immediate,\n  // and the translation to final X, Y to be animated,\n  // we saw problems where both would be applied after animation was turned on,\n  // making the dropdown appear to fly in from (0, 0).\n  // Using both `left`, `top` for the initial translation and then `translate`\n  // for the animated transition to final X, Y is a workaround.\n  return positionInternal(primaryX, primaryY, secondaryX, secondaryY);\n}\n\nconst internal = {\n  /**\n   * Get sizing info about the bounding element.\n   *\n   * @returns An object containing size information about the bounding element\n   *     (bounding box and width/height).\n   */\n  getBoundsInfo: function (): BoundsInfo {\n    const boundPosition = style.getPageOffset(boundsElement as Element);\n    const boundSize = style.getSize(boundsElement as Element);\n\n    return {\n      left: boundPosition.x,\n      right: boundPosition.x + boundSize.width,\n      top: boundPosition.y,\n      bottom: boundPosition.y + boundSize.height,\n      width: boundSize.width,\n      height: boundSize.height,\n    };\n  },\n\n  /**\n   * Helper to position the drop-down and the arrow, maintaining bounds.\n   * See explanation of origin points in show.\n   *\n   * @param primaryX Desired origin point x, in absolute px.\n   * @param primaryY Desired origin point y, in absolute px.\n   * @param secondaryX Secondary/alternative origin point x, in absolute px.\n   * @param secondaryY Secondary/alternative origin point y, in absolute px.\n   * @returns Various final metrics, including rendered positions for drop-down\n   *     and arrow.\n   */\n  getPositionMetrics: function (\n    primaryX: number,\n    primaryY: number,\n    secondaryX: number,\n    secondaryY: number\n  ): PositionMetrics {\n    const boundsInfo = internal.getBoundsInfo();\n    const divSize = style.getSize(div as Element);\n\n    // Can we fit in-bounds below the target?\n    if (primaryY + divSize.height < boundsInfo.bottom) {\n      return getPositionBelowMetrics(primaryX, primaryY, boundsInfo, divSize);\n    }\n    // Can we fit in-bounds above the target?\n    if (secondaryY - divSize.height > boundsInfo.top) {\n      return getPositionAboveMetrics(\n        secondaryX,\n        secondaryY,\n        boundsInfo,\n        divSize\n      );\n    }\n    // Can we fit outside the workspace bounds (but inside the window)\n    // below?\n    if (primaryY + divSize.height < document.documentElement.clientHeight) {\n      return getPositionBelowMetrics(primaryX, primaryY, boundsInfo, divSize);\n    }\n    // Can we fit outside the workspace bounds (but inside the window)\n    // above?\n    if (secondaryY - divSize.height > document.documentElement.clientTop) {\n      return getPositionAboveMetrics(\n        secondaryX,\n        secondaryY,\n        boundsInfo,\n        divSize\n      );\n    }\n\n    // Last resort, render at top of page.\n    return getPositionTopOfPageMetrics(primaryX, boundsInfo, divSize);\n  },\n};\n\n/**\n * Get the metrics for positioning the div below the source.\n *\n * @param primaryX Desired origin point x, in absolute px.\n * @param primaryY Desired origin point y, in absolute px.\n * @param boundsInfo An object containing size information about the bounding\n *     element (bounding box and width/height).\n * @param divSize An object containing information about the size of the\n *     DropDownDiv (width & height).\n * @returns Various final metrics, including rendered positions for drop-down\n *     and arrow.\n */\nfunction getPositionBelowMetrics(\n  primaryX: number,\n  primaryY: number,\n  boundsInfo: BoundsInfo,\n  divSize: Size\n): PositionMetrics {\n  const xCoords = getPositionX(\n    primaryX,\n    boundsInfo.left,\n    boundsInfo.right,\n    divSize.width\n  );\n\n  const arrowY = -(ARROW_SIZE / 2 + BORDER_SIZE);\n  const finalY = primaryY + PADDING_Y;\n\n  return {\n    initialX: xCoords.divX,\n    initialY: primaryY,\n    finalX: xCoords.divX, // X position remains constant during animation.\n    finalY,\n    arrowX: xCoords.arrowX,\n    arrowY,\n    arrowAtTop: true,\n    arrowVisible: true,\n  };\n}\n\n/**\n * Get the metrics for positioning the div above the source.\n *\n * @param secondaryX Secondary/alternative origin point x, in absolute px.\n * @param secondaryY Secondary/alternative origin point y, in absolute px.\n * @param boundsInfo An object containing size information about the bounding\n *     element (bounding box and width/height).\n * @param divSize An object containing information about the size of the\n *     DropDownDiv (width & height).\n * @returns Various final metrics, including rendered positions for drop-down\n *     and arrow.\n */\nfunction getPositionAboveMetrics(\n  secondaryX: number,\n  secondaryY: number,\n  boundsInfo: BoundsInfo,\n  divSize: Size\n): PositionMetrics {\n  const xCoords = getPositionX(\n    secondaryX,\n    boundsInfo.left,\n    boundsInfo.right,\n    divSize.width\n  );\n\n  const arrowY = divSize.height - BORDER_SIZE * 2 - ARROW_SIZE / 2;\n  const finalY = secondaryY - divSize.height - PADDING_Y;\n  const initialY = secondaryY - divSize.height; // No padding on Y.\n\n  return {\n    initialX: xCoords.divX,\n    initialY,\n    finalX: xCoords.divX, // X position remains constant during animation.\n    finalY,\n    arrowX: xCoords.arrowX,\n    arrowY,\n    arrowAtTop: false,\n    arrowVisible: true,\n  };\n}\n\n/**\n * Get the metrics for positioning the div at the top of the page.\n *\n * @param sourceX Desired origin point x, in absolute px.\n * @param boundsInfo An object containing size information about the bounding\n *     element (bounding box and width/height).\n * @param divSize An object containing information about the size of the\n *     DropDownDiv (width & height).\n * @returns Various final metrics, including rendered positions for drop-down\n *     and arrow.\n */\nfunction getPositionTopOfPageMetrics(\n  sourceX: number,\n  boundsInfo: BoundsInfo,\n  divSize: Size\n): PositionMetrics {\n  const xCoords = getPositionX(\n    sourceX,\n    boundsInfo.left,\n    boundsInfo.right,\n    divSize.width\n  );\n\n  // No need to provide arrow-specific information because it won't be visible.\n  return {\n    initialX: xCoords.divX,\n    initialY: 0,\n    finalX: xCoords.divX, // X position remains constant during animation.\n    finalY: 0, // Y position remains constant during animation.\n    arrowAtTop: null,\n    arrowX: null,\n    arrowY: null,\n    arrowVisible: false,\n  };\n}\n\n/**\n * Get the x positions for the left side of the DropDownDiv and the arrow,\n * accounting for the bounds of the workspace.\n *\n * @param sourceX Desired origin point x, in absolute px.\n * @param boundsLeft The left edge of the bounding element, in absolute px.\n * @param boundsRight The right edge of the bounding element, in absolute px.\n * @param divWidth The width of the div in px.\n * @returns An object containing metrics for the x positions of the left side of\n *     the DropDownDiv and the arrow.\n * @internal\n */\nexport function getPositionX(\n  sourceX: number,\n  boundsLeft: number,\n  boundsRight: number,\n  divWidth: number\n): {divX: number; arrowX: number} {\n  let divX = sourceX;\n  // Offset the topLeft coord so that the dropdowndiv is centered.\n  divX -= divWidth / 2;\n  // Fit the dropdowndiv within the bounds of the workspace.\n  divX = math.clamp(boundsLeft, divX, boundsRight - divWidth);\n\n  let arrowX = sourceX;\n  // Offset the arrow coord so that the arrow is centered.\n  arrowX -= ARROW_SIZE / 2;\n  // Convert the arrow position to be relative to the top left of the div.\n  let relativeArrowX = arrowX - divX;\n  const horizPadding = ARROW_HORIZONTAL_PADDING;\n  // Clamp the arrow position so that it stays attached to the dropdowndiv.\n  relativeArrowX = math.clamp(\n    horizPadding,\n    relativeArrowX,\n    divWidth - horizPadding - ARROW_SIZE\n  );\n\n  return {arrowX: relativeArrowX, divX};\n}\n\n/**\n * Is the container visible?\n *\n * @returns True if visible.\n */\nexport function isVisible(): boolean {\n  return !!owner;\n}\n\n/**\n * Hide the menu only if it is owned by the provided object.\n *\n * @param divOwner Object which must be owning the drop-down to hide.\n * @param opt_withoutAnimation True if we should hide the dropdown without\n *     animating.\n * @returns True if hidden.\n */\nexport function hideIfOwner<T>(\n  divOwner: Field<T>,\n  opt_withoutAnimation?: boolean\n): boolean {\n  if (owner === divOwner) {\n    if (opt_withoutAnimation) {\n      hideWithoutAnimation();\n    } else {\n      hide();\n    }\n    return true;\n  }\n  return false;\n}\n\n/** Hide the menu, triggering animation. */\nexport function hide() {\n  // Start the animation by setting the translation and fading out.\n  // Reset to (initialX, initialY) - i.e., no translation.\n  div.style.transform = 'translate(0, 0)';\n  div.style.opacity = '0';\n  // Finish animation - reset all values to default.\n  animateOutTimer = setTimeout(function () {\n    hideWithoutAnimation();\n  }, ANIMATION_TIME * 1000);\n  if (onHide) {\n    onHide();\n    onHide = null;\n  }\n}\n\n/** Hide the menu, without animation. */\nexport function hideWithoutAnimation() {\n  if (!isVisible()) {\n    return;\n  }\n  if (animateOutTimer) {\n    clearTimeout(animateOutTimer);\n  }\n\n  // Reset style properties in case this gets called directly\n  // instead of hide() - see discussion on #2551.\n  div.style.transform = '';\n  div.style.left = '';\n  div.style.top = '';\n  div.style.opacity = '0';\n  div.style.display = 'none';\n  div.style.backgroundColor = '';\n  div.style.borderColor = '';\n\n  if (onHide) {\n    onHide();\n    onHide = null;\n  }\n  clearContent();\n  owner = null;\n\n  if (renderedClassName) {\n    dom.removeClass(div, renderedClassName);\n    renderedClassName = '';\n  }\n  if (themeClassName) {\n    dom.removeClass(div, themeClassName);\n    themeClassName = '';\n  }\n  (common.getMainWorkspace() as WorkspaceSvg).markFocused();\n}\n\n/**\n * Set the dropdown div's position.\n *\n * @param primaryX Desired origin point x, in absolute px.\n * @param primaryY Desired origin point y, in absolute px.\n * @param secondaryX Secondary/alternative origin point x, in absolute px.\n * @param secondaryY Secondary/alternative origin point y, in absolute px.\n * @returns True if the menu rendered at the primary origin point.\n */\nfunction positionInternal(\n  primaryX: number,\n  primaryY: number,\n  secondaryX: number,\n  secondaryY: number\n): boolean {\n  const metrics = internal.getPositionMetrics(\n    primaryX,\n    primaryY,\n    secondaryX,\n    secondaryY\n  );\n\n  // Update arrow CSS.\n  if (metrics.arrowVisible) {\n    arrow.style.display = '';\n    arrow.style.transform =\n      'translate(' +\n      metrics.arrowX +\n      'px,' +\n      metrics.arrowY +\n      'px) rotate(45deg)';\n    arrow.setAttribute(\n      'class',\n      metrics.arrowAtTop\n        ? 'blocklyDropDownArrow blocklyArrowTop'\n        : 'blocklyDropDownArrow blocklyArrowBottom'\n    );\n  } else {\n    arrow.style.display = 'none';\n  }\n\n  const initialX = Math.floor(metrics.initialX);\n  const initialY = Math.floor(metrics.initialY);\n  const finalX = Math.floor(metrics.finalX);\n  const finalY = Math.floor(metrics.finalY);\n\n  // First apply initial translation.\n  div.style.left = initialX + 'px';\n  div.style.top = initialY + 'px';\n\n  // Show the div.\n  div.style.display = 'block';\n  div.style.opacity = '1';\n  // Add final translate, animated through `transition`.\n  // Coordinates are relative to (initialX, initialY),\n  // where the drop-down is absolutely positioned.\n  const dx = finalX - initialX;\n  const dy = finalY - initialY;\n  div.style.transform = 'translate(' + dx + 'px,' + dy + 'px)';\n\n  return !!metrics.arrowAtTop;\n}\n\n/**\n * Repositions the dropdownDiv on window resize. If it doesn't know how to\n * calculate the new position, it will just hide it instead.\n *\n * @internal\n */\nexport function repositionForWindowResize() {\n  // This condition mainly catches the dropdown div when it is being used as a\n  // dropdown.  It is important not to close it in this case because on Android,\n  // when a field is focused, the soft keyboard opens triggering a window resize\n  // event and we want the dropdown div to stick around so users can type into\n  // it.\n  if (owner) {\n    const block = owner.getSourceBlock() as BlockSvg;\n    const bBox = positionToField\n      ? getScaledBboxOfField(owner)\n      : getScaledBboxOfBlock(block);\n    // If we can fit it, render below the block.\n    const primaryX = bBox.left + (bBox.right - bBox.left) / 2;\n    const primaryY = bBox.bottom;\n    // If we can't fit it, render above the entire parent block.\n    const secondaryX = primaryX;\n    const secondaryY = bBox.top;\n    positionInternal(primaryX, primaryY, secondaryX, secondaryY);\n  } else {\n    hide();\n  }\n}\n\nexport const TEST_ONLY = internal;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.string');\n\nimport * as deprecation from './deprecation.js';\n\n/**\n * Fast prefix-checker.\n * Copied from Closure's goog.string.startsWith.\n *\n * @param str The string to check.\n * @param prefix A string to look for at the start of `str`.\n * @returns True if `str` begins with `prefix`.\n * @deprecated Use built-in **string.startsWith** instead.\n */\nexport function startsWith(str: string, prefix: string): boolean {\n  deprecation.warn(\n    'Blockly.utils.string.startsWith()',\n    'April 2022',\n    'April 2023',\n    'Use built-in string.startsWith'\n  );\n  return str.startsWith(prefix);\n}\n\n/**\n * Given an array of strings, return the length of the shortest one.\n *\n * @param array Array of strings.\n * @returns Length of shortest string.\n */\nexport function shortestStringLength(array: string[]): number {\n  if (!array.length) {\n    return 0;\n  }\n  return array.reduce(function (a, b) {\n    return a.length < b.length ? a : b;\n  }).length;\n}\n\n/**\n * Given an array of strings, return the length of the common prefix.\n * Words may not be split.  Any space after a word is included in the length.\n *\n * @param array Array of strings.\n * @param opt_shortest Length of shortest string.\n * @returns Length of common prefix.\n */\nexport function commonWordPrefix(\n  array: string[],\n  opt_shortest?: number\n): number {\n  if (!array.length) {\n    return 0;\n  } else if (array.length === 1) {\n    return array[0].length;\n  }\n  let wordPrefix = 0;\n  const max = opt_shortest || shortestStringLength(array);\n  let len;\n  for (len = 0; len < max; len++) {\n    const letter = array[0][len];\n    for (let i = 1; i < array.length; i++) {\n      if (letter !== array[i][len]) {\n        return wordPrefix;\n      }\n    }\n    if (letter === ' ') {\n      wordPrefix = len + 1;\n    }\n  }\n  for (let i = 1; i < array.length; i++) {\n    const letter = array[i][len];\n    if (letter && letter !== ' ') {\n      return wordPrefix;\n    }\n  }\n  return max;\n}\n\n/**\n * Given an array of strings, return the length of the common suffix.\n * Words may not be split.  Any space after a word is included in the length.\n *\n * @param array Array of strings.\n * @param opt_shortest Length of shortest string.\n * @returns Length of common suffix.\n */\nexport function commonWordSuffix(\n  array: string[],\n  opt_shortest?: number\n): number {\n  if (!array.length) {\n    return 0;\n  } else if (array.length === 1) {\n    return array[0].length;\n  }\n  let wordPrefix = 0;\n  const max = opt_shortest || shortestStringLength(array);\n  let len;\n  for (len = 0; len < max; len++) {\n    const letter = array[0].substr(-len - 1, 1);\n    for (let i = 1; i < array.length; i++) {\n      if (letter !== array[i].substr(-len - 1, 1)) {\n        return wordPrefix;\n      }\n    }\n    if (letter === ' ') {\n      wordPrefix = len + 1;\n    }\n  }\n  for (let i = 1; i < array.length; i++) {\n    const letter = array[i].charAt(array[i].length - len - 1);\n    if (letter && letter !== ' ') {\n      return wordPrefix;\n    }\n  }\n  return max;\n}\n\n/**\n * Wrap text to the specified width.\n *\n * @param text Text to wrap.\n * @param limit Width to wrap each line.\n * @returns Wrapped text.\n */\nexport function wrap(text: string, limit: number): string {\n  const lines = text.split('\\n');\n  for (let i = 0; i < lines.length; i++) {\n    lines[i] = wrapLine(lines[i], limit);\n  }\n  return lines.join('\\n');\n}\n\n/**\n * Wrap single line of text to the specified width.\n *\n * @param text Text to wrap.\n * @param limit Width to wrap each line.\n * @returns Wrapped text.\n */\nfunction wrapLine(text: string, limit: number): string {\n  if (text.length <= limit) {\n    // Short text, no need to wrap.\n    return text;\n  }\n  // Split the text into words.\n  const words = text.trim().split(/\\s+/);\n  // Set limit to be the length of the largest word.\n  for (let i = 0; i < words.length; i++) {\n    if (words[i].length > limit) {\n      limit = words[i].length;\n    }\n  }\n\n  let lastScore;\n  let score = -Infinity;\n  let lastText;\n  let lineCount = 1;\n  do {\n    lastScore = score;\n    lastText = text;\n    // Create a list of booleans representing if a space (false) or\n    // a break (true) appears after each word.\n    let wordBreaks = [];\n    // Seed the list with evenly spaced linebreaks.\n    const steps = words.length / lineCount;\n    let insertedBreaks = 1;\n    for (let i = 0; i < words.length - 1; i++) {\n      if (insertedBreaks < (i + 1.5) / steps) {\n        insertedBreaks++;\n        wordBreaks[i] = true;\n      } else {\n        wordBreaks[i] = false;\n      }\n    }\n    wordBreaks = wrapMutate(words, wordBreaks, limit);\n    score = wrapScore(words, wordBreaks, limit);\n    text = wrapToText(words, wordBreaks);\n    lineCount++;\n  } while (score > lastScore);\n  return lastText;\n}\n\n/**\n * Compute a score for how good the wrapping is.\n *\n * @param words Array of each word.\n * @param wordBreaks Array of line breaks.\n * @param limit Width to wrap each line.\n * @returns Larger the better.\n */\nfunction wrapScore(\n  words: string[],\n  wordBreaks: boolean[],\n  limit: number\n): number {\n  // If this function becomes a performance liability, add caching.\n  // Compute the length of each line.\n  const lineLengths = [0];\n  const linePunctuation = [];\n  for (let i = 0; i < words.length; i++) {\n    lineLengths[lineLengths.length - 1] += words[i].length;\n    if (wordBreaks[i] === true) {\n      lineLengths.push(0);\n      linePunctuation.push(words[i].charAt(words[i].length - 1));\n    } else if (wordBreaks[i] === false) {\n      lineLengths[lineLengths.length - 1]++;\n    }\n  }\n  const maxLength = Math.max(...lineLengths);\n\n  let score = 0;\n  for (let i = 0; i < lineLengths.length; i++) {\n    // Optimize for width.\n    // -2 points per char over limit (scaled to the power of 1.5).\n    score -= Math.pow(Math.abs(limit - lineLengths[i]), 1.5) * 2;\n    // Optimize for even lines.\n    // -1 point per char smaller than max (scaled to the power of 1.5).\n    score -= Math.pow(maxLength - lineLengths[i], 1.5);\n    // Optimize for structure.\n    // Add score to line endings after punctuation.\n    if ('.?!'.indexOf(linePunctuation[i]) !== -1) {\n      score += limit / 3;\n    } else if (',;)]}'.indexOf(linePunctuation[i]) !== -1) {\n      score += limit / 4;\n    }\n  }\n  // All else being equal, the last line should not be longer than the\n  // previous line.  For example, this looks wrong:\n  // aaa bbb\n  // ccc ddd eee\n  if (\n    lineLengths.length > 1 &&\n    lineLengths[lineLengths.length - 1] <= lineLengths[lineLengths.length - 2]\n  ) {\n    score += 0.5;\n  }\n  return score;\n}\n/**\n * Mutate the array of line break locations until an optimal solution is found.\n * No line breaks are added or deleted, they are simply moved around.\n *\n * @param words Array of each word.\n * @param wordBreaks Array of line breaks.\n * @param limit Width to wrap each line.\n * @returns New array of optimal line breaks.\n */\nfunction wrapMutate(\n  words: string[],\n  wordBreaks: boolean[],\n  limit: number\n): boolean[] {\n  let bestScore = wrapScore(words, wordBreaks, limit);\n  let bestBreaks;\n  // Try shifting every line break forward or backward.\n  for (let i = 0; i < wordBreaks.length - 1; i++) {\n    if (wordBreaks[i] === wordBreaks[i + 1]) {\n      continue;\n    }\n    const mutatedWordBreaks = new Array<boolean>().concat(wordBreaks);\n    mutatedWordBreaks[i] = !mutatedWordBreaks[i];\n    mutatedWordBreaks[i + 1] = !mutatedWordBreaks[i + 1];\n    const mutatedScore = wrapScore(words, mutatedWordBreaks, limit);\n    if (mutatedScore > bestScore) {\n      bestScore = mutatedScore;\n      bestBreaks = mutatedWordBreaks;\n    }\n  }\n  if (bestBreaks) {\n    // Found an improvement.  See if it may be improved further.\n    return wrapMutate(words, bestBreaks, limit);\n  }\n  // No improvements found.  Done.\n  return wordBreaks;\n}\n\n/**\n * Reassemble the array of words into text, with the specified line breaks.\n *\n * @param words Array of each word.\n * @param wordBreaks Array of line breaks.\n * @returns Plain text.\n */\nfunction wrapToText(words: string[], wordBreaks: boolean[]): string {\n  const text = [];\n  for (let i = 0; i < words.length; i++) {\n    text.push(words[i]);\n    if (wordBreaks[i] !== undefined) {\n      text.push(wordBreaks[i] ? '\\n' : ' ');\n    }\n  }\n  return text.join('');\n}\n\n/**\n * Is the given string a number (includes negative and decimals).\n *\n * @param str Input string.\n * @returns True if number, false otherwise.\n */\nexport function isNumber(str: string): boolean {\n  return /^\\s*-?\\d+(\\.\\d+)?\\s*$/.test(str);\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Tooltip');\n\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport * as blocklyString from './utils/string.js';\n\n/**\n * A type which can define a tooltip.\n * Either a string, an object containing a tooltip property, or a function which\n * returns either a string, or another arbitrarily nested function which\n * eventually unwinds to a string.\n */\nexport type TipInfo =\n  | string\n  | {tooltip: AnyDuringMigration}\n  | (() => TipInfo | string | Function);\n\n/**\n * A function that renders custom tooltip UI.\n * 1st parameter: the div element to render content into.\n * 2nd parameter: the element being moused over (i.e., the element for which the\n * tooltip should be shown).\n */\nexport type CustomTooltip = (p1: Element, p2: Element) => AnyDuringMigration;\n\n/**\n * An optional function that renders custom tooltips into the provided DIV. If\n * this is defined, the function will be called instead of rendering the default\n * tooltip UI.\n */\nlet customTooltip: CustomTooltip | undefined = undefined;\n\n/**\n * Sets a custom function that will be called if present instead of the default\n * tooltip UI.\n *\n * @param customFn A custom tooltip used to render an alternate tooltip UI.\n */\nexport function setCustomTooltip(customFn: CustomTooltip) {\n  customTooltip = customFn;\n}\n\n/**\n * Gets the custom tooltip function.\n *\n * @returns The custom tooltip function, if defined.\n */\nexport function getCustomTooltip(): CustomTooltip | undefined {\n  return customTooltip;\n}\n\n/** Is a tooltip currently showing? */\nlet visible = false;\n\n/**\n * Returns whether or not a tooltip is showing\n *\n * @returns True if a tooltip is showing\n */\nexport function isVisible(): boolean {\n  return visible;\n}\n\n/** Is someone else blocking the tooltip from being shown? */\nlet blocked = false;\n\n/**\n * Maximum width (in characters) of a tooltip.\n */\nexport const LIMIT = 50;\n\n/** PID of suspended thread to clear tooltip on mouse out. */\nlet mouseOutPid: AnyDuringMigration = 0;\n\n/** PID of suspended thread to show the tooltip. */\nlet showPid: AnyDuringMigration = 0;\n\n/**\n * Last observed X location of the mouse pointer (freezes when tooltip appears).\n */\nlet lastX = 0;\n\n/**\n * Last observed Y location of the mouse pointer (freezes when tooltip appears).\n */\nlet lastY = 0;\n\n/** Current element being pointed at. */\nlet element: AnyDuringMigration = null;\n\n/**\n * Once a tooltip has opened for an element, that element is 'poisoned' and\n * cannot respawn a tooltip until the pointer moves over a different element.\n */\nlet poisonedElement: AnyDuringMigration = null;\n\n/**\n * Horizontal offset between mouse cursor and tooltip.\n */\nexport const OFFSET_X = 0;\n\n/**\n * Vertical offset between mouse cursor and tooltip.\n */\nexport const OFFSET_Y = 10;\n\n/**\n * Radius mouse can move before killing tooltip.\n */\nexport const RADIUS_OK = 10;\n\n/**\n * Delay before tooltip appears.\n */\nexport const HOVER_MS = 750;\n\n/**\n * Horizontal padding between tooltip and screen edge.\n */\nexport const MARGINS = 5;\n\n/** The HTML container.  Set once by createDom. */\nlet containerDiv: HTMLDivElement | null = null;\n\n/**\n * Returns the HTML tooltip container.\n *\n * @returns The HTML tooltip container.\n */\nexport function getDiv(): HTMLDivElement | null {\n  return containerDiv;\n}\n\n/**\n * Returns the tooltip text for the given element.\n *\n * @param object The object to get the tooltip text of.\n * @returns The tooltip text of the element.\n */\nexport function getTooltipOfObject(object: AnyDuringMigration | null): string {\n  const obj = getTargetObject(object);\n  if (obj) {\n    let tooltip = obj.tooltip;\n    while (typeof tooltip === 'function') {\n      tooltip = tooltip();\n    }\n    if (typeof tooltip !== 'string') {\n      throw Error('Tooltip function must return a string.');\n    }\n    return tooltip;\n  }\n  return '';\n}\n\n/**\n * Returns the target object that the given object is targeting for its\n * tooltip. Could be the object itself.\n *\n * @param obj The object are trying to find the target tooltip object of.\n * @returns The target tooltip object.\n */\nfunction getTargetObject(\n  obj: object | null\n): {tooltip: AnyDuringMigration} | null {\n  while (obj && (obj as any).tooltip) {\n    if (\n      typeof (obj as any).tooltip === 'string' ||\n      typeof (obj as any).tooltip === 'function'\n    ) {\n      return obj as {tooltip: string | (() => string)};\n    }\n    obj = (obj as any).tooltip;\n  }\n  return null;\n}\n\n/**\n * Create the tooltip div and inject it onto the page.\n */\nexport function createDom() {\n  if (containerDiv) {\n    return; // Already created.\n  }\n  // Create an HTML container for popup overlays (e.g. editor widgets).\n  containerDiv = document.createElement('div');\n  containerDiv.className = 'blocklyTooltipDiv';\n  const container = common.getParentContainer() || document.body;\n  container.appendChild(containerDiv);\n}\n\n/**\n * Binds the required mouse events onto an SVG element.\n *\n * @param element SVG element onto which tooltip is to be bound.\n */\nexport function bindMouseEvents(element: Element) {\n  // TODO (#6097): Don't stash wrapper info on the DOM.\n  (element as AnyDuringMigration).mouseOverWrapper_ = browserEvents.bind(\n    element,\n    'pointerover',\n    null,\n    onMouseOver\n  );\n  (element as AnyDuringMigration).mouseOutWrapper_ = browserEvents.bind(\n    element,\n    'pointerout',\n    null,\n    onMouseOut\n  );\n\n  // Don't use bindEvent_ for mousemove since that would create a\n  // corresponding touch handler, even though this only makes sense in the\n  // context of a mouseover/mouseout.\n  element.addEventListener('pointermove', onMouseMove, false);\n}\n\n/**\n * Unbinds tooltip mouse events from the SVG element.\n *\n * @param element SVG element onto which tooltip is bound.\n */\nexport function unbindMouseEvents(element: Element | null) {\n  if (!element) {\n    return;\n  }\n  // TODO (#6097): Don't stash wrapper info on the DOM.\n  browserEvents.unbind((element as AnyDuringMigration).mouseOverWrapper_);\n  browserEvents.unbind((element as AnyDuringMigration).mouseOutWrapper_);\n  element.removeEventListener('pointermove', onMouseMove);\n}\n\n/**\n * Hide the tooltip if the mouse is over a different object.\n * Initialize the tooltip to potentially appear for this object.\n *\n * @param e Mouse event.\n */\nfunction onMouseOver(e: PointerEvent) {\n  if (blocked) {\n    // Someone doesn't want us to show tooltips.\n    return;\n  }\n  // If the tooltip is an object, treat it as a pointer to the next object in\n  // the chain to look at.  Terminate when a string or function is found.\n  const newElement = getTargetObject(e.currentTarget);\n  if (element !== newElement) {\n    hide();\n    poisonedElement = null;\n    element = newElement;\n  }\n  // Forget about any immediately preceding mouseOut event.\n  clearTimeout(mouseOutPid);\n}\n\n/**\n * Hide the tooltip if the mouse leaves the object and enters the workspace.\n *\n * @param _e Mouse event.\n */\nfunction onMouseOut(_e: PointerEvent) {\n  if (blocked) {\n    // Someone doesn't want us to show tooltips.\n    return;\n  }\n  // Moving from one element to another (overlapping or with no gap) generates\n  // a mouseOut followed instantly by a mouseOver.  Fork off the mouseOut\n  // event and kill it if a mouseOver is received immediately.\n  // This way the task only fully executes if mousing into the void.\n  mouseOutPid = setTimeout(function () {\n    element = null;\n    poisonedElement = null;\n    hide();\n  }, 1);\n  clearTimeout(showPid);\n  showPid = 0;\n}\n\n/**\n * When hovering over an element, schedule a tooltip to be shown.  If a tooltip\n * is already visible, hide it if the mouse strays out of a certain radius.\n *\n * @param e Mouse event.\n */\nfunction onMouseMove(e: Event) {\n  if (!element || !(element as AnyDuringMigration).tooltip) {\n    // No tooltip here to show.\n    return;\n  } else if (blocked) {\n    // Someone doesn't want us to show tooltips.  We are probably handling a\n    // user gesture, such as a click or drag.\n    return;\n  }\n  if (visible) {\n    // Compute the distance between the mouse position when the tooltip was\n    // shown and the current mouse position.  Pythagorean theorem.\n    // AnyDuringMigration because:  Property 'pageX' does not exist on type\n    // 'Event'.\n    const dx = lastX - (e as AnyDuringMigration).pageX;\n    // AnyDuringMigration because:  Property 'pageY' does not exist on type\n    // 'Event'.\n    const dy = lastY - (e as AnyDuringMigration).pageY;\n    if (Math.sqrt(dx * dx + dy * dy) > RADIUS_OK) {\n      hide();\n    }\n  } else if (poisonedElement !== element) {\n    // The mouse moved, clear any previously scheduled tooltip.\n    clearTimeout(showPid);\n    // Maybe this time the mouse will stay put.  Schedule showing of tooltip.\n    // AnyDuringMigration because:  Property 'pageX' does not exist on type\n    // 'Event'.\n    lastX = (e as AnyDuringMigration).pageX;\n    // AnyDuringMigration because:  Property 'pageY' does not exist on type\n    // 'Event'.\n    lastY = (e as AnyDuringMigration).pageY;\n    showPid = setTimeout(show, HOVER_MS);\n  }\n}\n\n/**\n * Dispose of the tooltip.\n *\n * @internal\n */\nexport function dispose() {\n  element = null;\n  poisonedElement = null;\n  hide();\n}\n\n/**\n * Hide the tooltip.\n */\nexport function hide() {\n  if (visible) {\n    visible = false;\n    if (containerDiv) {\n      containerDiv.style.display = 'none';\n    }\n  }\n  if (showPid) {\n    clearTimeout(showPid);\n    showPid = 0;\n  }\n}\n\n/**\n * Hide any in-progress tooltips and block showing new tooltips until the next\n * call to unblock().\n *\n * @internal\n */\nexport function block() {\n  hide();\n  blocked = true;\n}\n\n/**\n * Unblock tooltips: allow them to be scheduled and shown according to their own\n * logic.\n *\n * @internal\n */\nexport function unblock() {\n  blocked = false;\n}\n\n/** Renders the tooltip content into the tooltip div. */\nfunction renderContent() {\n  if (!containerDiv || !element) {\n    // This shouldn't happen, but if it does, we can't render.\n    return;\n  }\n  if (typeof customTooltip === 'function') {\n    customTooltip(containerDiv, element);\n  } else {\n    renderDefaultContent();\n  }\n}\n\n/** Renders the default tooltip UI. */\nfunction renderDefaultContent() {\n  let tip = getTooltipOfObject(element);\n  tip = blocklyString.wrap(tip, LIMIT);\n  // Create new text, line by line.\n  const lines = tip.split('\\n');\n  for (let i = 0; i < lines.length; i++) {\n    const div = document.createElement('div');\n    div.appendChild(document.createTextNode(lines[i]));\n    containerDiv!.appendChild(div);\n  }\n}\n\n/**\n * Gets the coordinates for the tooltip div, taking into account the edges of\n * the screen to prevent showing the tooltip offscreen.\n *\n * @param rtl True if the tooltip should be in right-to-left layout.\n * @returns Coordinates at which the tooltip div should be placed.\n */\nfunction getPosition(rtl: boolean): {x: number; y: number} {\n  // Position the tooltip just below the cursor.\n  const windowWidth = document.documentElement.clientWidth;\n  const windowHeight = document.documentElement.clientHeight;\n\n  let anchorX = lastX;\n  if (rtl) {\n    anchorX -= OFFSET_X + containerDiv!.offsetWidth;\n  } else {\n    anchorX += OFFSET_X;\n  }\n\n  let anchorY = lastY + OFFSET_Y;\n  if (anchorY + containerDiv!.offsetHeight > windowHeight + window.scrollY) {\n    // Falling off the bottom of the screen; shift the tooltip up.\n    anchorY -= containerDiv!.offsetHeight + 2 * OFFSET_Y;\n  }\n\n  if (rtl) {\n    // Prevent falling off left edge in RTL mode.\n    anchorX = Math.max(MARGINS - window.scrollX, anchorX);\n  } else {\n    if (\n      anchorX + containerDiv!.offsetWidth >\n      windowWidth + window.scrollX - 2 * MARGINS\n    ) {\n      // Falling off the right edge of the screen;\n      // clamp the tooltip on the edge.\n      anchorX = windowWidth - containerDiv!.offsetWidth - 2 * MARGINS;\n    }\n  }\n\n  return {x: anchorX, y: anchorY};\n}\n\n/** Create the tooltip and show it. */\nfunction show() {\n  if (blocked) {\n    // Someone doesn't want us to show tooltips.\n    return;\n  }\n  poisonedElement = element;\n  if (!containerDiv) {\n    return;\n  }\n  // Erase all existing text.\n  containerDiv.textContent = '';\n\n  // Add new content.\n  renderContent();\n\n  // Display the tooltip.\n  const rtl = (element as any).RTL;\n  containerDiv.style.direction = rtl ? 'rtl' : 'ltr';\n  containerDiv.style.display = 'block';\n  visible = true;\n\n  const {x, y} = getPosition(rtl);\n  containerDiv.style.left = x + 'px';\n  containerDiv.style.top = y + 'px';\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.colour');\n\n/**\n * The richness of block colours, regardless of the hue.\n * Must be in the range of 0 (inclusive) to 1 (exclusive).\n */\nlet hsvSaturation = 0.45;\n\n/**\n * Get the richness of block colours, regardless of the hue.\n *\n * @returns The current richness.\n * @internal\n */\nexport function getHsvSaturation(): number {\n  return hsvSaturation;\n}\n\n/**\n * Set the richness of block colours, regardless of the hue.\n *\n * @param newSaturation The new richness, in the range of  0 (inclusive) to 1\n *     (exclusive)\n * @internal\n */\nexport function setHsvSaturation(newSaturation: number) {\n  hsvSaturation = newSaturation;\n}\n\n/**\n * The intensity of block colours, regardless of the hue.\n * Must be in the range of 0 (inclusive) to 1 (exclusive).\n */\nlet hsvValue = 0.65;\n\n/**\n * Get the intensity of block colours, regardless of the hue.\n *\n * @returns The current intensity.\n * @internal\n */\nexport function getHsvValue(): number {\n  return hsvValue;\n}\n\n/**\n * Set the intensity of block colours, regardless of the hue.\n *\n * @param newValue The new intensity, in the range of  0 (inclusive) to 1\n *     (exclusive)\n * @internal\n */\nexport function setHsvValue(newValue: number) {\n  hsvValue = newValue;\n}\n\n/**\n * Parses a colour from a string.\n * .parse('red') = '#ff0000'\n * .parse('#f00') = '#ff0000'\n * .parse('#ff0000') = '#ff0000'\n * .parse('0xff0000') = '#ff0000'\n * .parse('rgb(255, 0, 0)') = '#ff0000'\n *\n * @param str Colour in some CSS format.\n * @returns A string containing a hex representation of the colour, or null if\n *     can't be parsed.\n */\nexport function parse(str: string | number): string | null {\n  str = `${str}`.toLowerCase().trim();\n  let hex = names[str];\n  if (hex) {\n    // e.g. 'red'\n    return hex;\n  }\n  hex = str.substring(0, 2) === '0x' ? '#' + str.substring(2) : str;\n  hex = hex[0] === '#' ? hex : '#' + hex;\n  if (/^#[0-9a-f]{6}$/.test(hex)) {\n    // e.g. '#00ff88'\n    return hex;\n  }\n  if (/^#[0-9a-f]{3}$/.test(hex)) {\n    // e.g. '#0f8'\n    return ['#', hex[1], hex[1], hex[2], hex[2], hex[3], hex[3]].join('');\n  }\n  const rgb = str.match(/^(?:rgb)?\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/);\n  if (rgb) {\n    // e.g. 'rgb(0, 128, 255)'\n    const r = Number(rgb[1]);\n    const g = Number(rgb[2]);\n    const b = Number(rgb[3]);\n    if (r >= 0 && r < 256 && g >= 0 && g < 256 && b >= 0 && b < 256) {\n      return rgbToHex(r, g, b);\n    }\n  }\n  return null;\n}\n\n/**\n * Converts a colour from RGB to hex representation.\n *\n * @param r Amount of red, int between 0 and 255.\n * @param g Amount of green, int between 0 and 255.\n * @param b Amount of blue, int between 0 and 255.\n * @returns Hex representation of the colour.\n */\nexport function rgbToHex(r: number, g: number, b: number): string {\n  const rgb = (r << 16) | (g << 8) | b;\n  if (r < 0x10) {\n    return '#' + (0x1000000 | rgb).toString(16).substr(1);\n  }\n  return '#' + rgb.toString(16);\n}\n\n/**\n * Converts a colour to RGB.\n *\n * @param colour String representing colour in any colour format ('#ff0000',\n *     'red', '0xff000', etc).\n * @returns RGB representation of the colour.\n */\nexport function hexToRgb(colour: string): number[] {\n  const hex = parse(colour);\n  if (!hex) {\n    return [0, 0, 0];\n  }\n\n  const rgb = parseInt(hex.substr(1), 16);\n  const r = rgb >> 16;\n  const g = (rgb >> 8) & 255;\n  const b = rgb & 255;\n\n  return [r, g, b];\n}\n\n/**\n * Converts an HSV triplet to hex representation.\n *\n * @param h Hue value in [0, 360].\n * @param s Saturation value in [0, 1].\n * @param v Brightness in [0, 255].\n * @returns Hex representation of the colour.\n */\nexport function hsvToHex(h: number, s: number, v: number): string {\n  let red = 0;\n  let green = 0;\n  let blue = 0;\n  if (s === 0) {\n    red = v;\n    green = v;\n    blue = v;\n  } else {\n    const sextant = Math.floor(h / 60);\n    const remainder = h / 60 - sextant;\n    const val1 = v * (1 - s);\n    const val2 = v * (1 - s * remainder);\n    const val3 = v * (1 - s * (1 - remainder));\n    switch (sextant) {\n      case 1:\n        red = val2;\n        green = v;\n        blue = val1;\n        break;\n      case 2:\n        red = val1;\n        green = v;\n        blue = val3;\n        break;\n      case 3:\n        red = val1;\n        green = val2;\n        blue = v;\n        break;\n      case 4:\n        red = val3;\n        green = val1;\n        blue = v;\n        break;\n      case 5:\n        red = v;\n        green = val1;\n        blue = val2;\n        break;\n      case 6:\n      case 0:\n        red = v;\n        green = val3;\n        blue = val1;\n        break;\n    }\n  }\n  return rgbToHex(Math.floor(red), Math.floor(green), Math.floor(blue));\n}\n\n/**\n * Blend two colours together, using the specified factor to indicate the\n * weight given to the first colour.\n *\n * @param colour1 First colour.\n * @param colour2 Second colour.\n * @param factor The weight to be given to colour1 over colour2.\n *     Values should be in the range [0, 1].\n * @returns Combined colour represented in hex.\n */\nexport function blend(\n  colour1: string,\n  colour2: string,\n  factor: number\n): string | null {\n  const hex1 = parse(colour1);\n  if (!hex1) {\n    return null;\n  }\n  const hex2 = parse(colour2);\n  if (!hex2) {\n    return null;\n  }\n  const rgb1 = hexToRgb(hex1);\n  const rgb2 = hexToRgb(hex2);\n  const r = Math.round(rgb2[0] + factor * (rgb1[0] - rgb2[0]));\n  const g = Math.round(rgb2[1] + factor * (rgb1[1] - rgb2[1]));\n  const b = Math.round(rgb2[2] + factor * (rgb1[2] - rgb2[2]));\n  return rgbToHex(r, g, b);\n}\n\n/**\n * A map that contains the 16 basic colour keywords as defined by W3C:\n * https://www.w3.org/TR/2018/REC-css-color-3-20180619/#html4\n * The keys of this map are the lowercase \"readable\" names of the colours,\n * while the values are the \"hex\" values.\n */\nexport const names: {[key: string]: string} = {\n  'aqua': '#00ffff',\n  'black': '#000000',\n  'blue': '#0000ff',\n  'fuchsia': '#ff00ff',\n  'gray': '#808080',\n  'green': '#008000',\n  'lime': '#00ff00',\n  'maroon': '#800000',\n  'navy': '#000080',\n  'olive': '#808000',\n  'purple': '#800080',\n  'red': '#ff0000',\n  'silver': '#c0c0c0',\n  'teal': '#008080',\n  'white': '#ffffff',\n  'yellow': '#ffff00',\n};\n\n/**\n * Convert a hue (HSV model) into an RGB hex triplet.\n *\n * @param hue Hue on a colour wheel (0-360).\n * @returns RGB code, e.g. '#5ba65b'.\n */\nexport function hueToHex(hue: number): string {\n  return hsvToHex(hue, hsvSaturation, hsvValue * 255);\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.parsing');\n\nimport {Msg} from '../msg.js';\n\nimport * as colourUtils from './colour.js';\n\n/**\n * Internal implementation of the message reference and interpolation token\n * parsing used by tokenizeInterpolation() and replaceMessageReferences().\n *\n * @param message Text which might contain string table references and\n *     interpolation tokens.\n * @param parseInterpolationTokens Option to parse numeric\n *     interpolation tokens (%1, %2, ...) when true.\n * @returns Array of strings and numbers.\n */\nfunction tokenizeInterpolationInternal(\n  message: string,\n  parseInterpolationTokens: boolean\n): (string | number)[] {\n  const tokens = [];\n  const chars = message.split('');\n  chars.push(''); // End marker.\n  // Parse the message with a finite state machine.\n  // 0 - Base case.\n  // 1 - % found.\n  // 2 - Digit found.\n  // 3 - Message ref found.\n  let state = 0;\n  const buffer = new Array<string>();\n  let number = null;\n  for (let i = 0; i < chars.length; i++) {\n    const c = chars[i];\n    if (state === 0) {\n      // Start escape.\n      if (c === '%') {\n        const text = buffer.join('');\n        if (text) {\n          tokens.push(text);\n        }\n        buffer.length = 0;\n        state = 1;\n      } else {\n        buffer.push(c); // Regular char.\n      }\n    } else if (state === 1) {\n      if (c === '%') {\n        buffer.push(c); // Escaped %: %%\n        state = 0;\n      } else if (parseInterpolationTokens && '0' <= c && c <= '9') {\n        state = 2;\n        number = c;\n        const text = buffer.join('');\n        if (text) {\n          tokens.push(text);\n        }\n        buffer.length = 0;\n      } else if (c === '{') {\n        state = 3;\n      } else {\n        buffer.push('%', c); // Not recognized. Return as literal.\n        state = 0;\n      }\n    } else if (state === 2) {\n      if ('0' <= c && c <= '9') {\n        number += c; // Multi-digit number.\n      } else {\n        tokens.push(parseInt(number ?? '', 10));\n        i--; // Parse this char again.\n        state = 0;\n      }\n    } else if (state === 3) {\n      // String table reference\n      if (c === '') {\n        // Premature end before closing '}'\n        buffer.splice(0, 0, '%{'); // Re-insert leading delimiter\n        i--; // Parse this char again.\n        state = 0; // and parse as string literal.\n      } else if (c !== '}') {\n        buffer.push(c);\n      } else {\n        const rawKey = buffer.join('');\n        if (/[A-Z]\\w*/i.test(rawKey)) {\n          // Strict matching\n          // Found a valid string key. Attempt case insensitive match.\n          const keyUpper = rawKey.toUpperCase();\n\n          // BKY_ is the prefix used to namespace the strings used in\n          // Blockly core files and the predefined blocks in ../blocks/.\n          // These strings are defined in ../msgs/ files.\n          const bklyKey = keyUpper.startsWith('BKY_')\n            ? keyUpper.substring(4)\n            : null;\n          if (bklyKey && bklyKey in Msg) {\n            const rawValue = Msg[bklyKey];\n            if (typeof rawValue === 'string') {\n              // Attempt to dereference substrings, too, appending to the\n              // end.\n              Array.prototype.push.apply(\n                tokens,\n                tokenizeInterpolationInternal(\n                  rawValue,\n                  parseInterpolationTokens\n                )\n              );\n            } else if (parseInterpolationTokens) {\n              // When parsing interpolation tokens, numbers are special\n              // placeholders (%1, %2, etc). Make sure all other values are\n              // strings.\n              tokens.push(`${rawValue}`);\n            } else {\n              tokens.push(rawValue);\n            }\n          } else {\n            // No entry found in the string table. Pass reference as string.\n            tokens.push('%{' + rawKey + '}');\n          }\n          buffer.length = 0; // Clear the array\n          state = 0;\n        } else {\n          tokens.push('%{' + rawKey + '}');\n          buffer.length = 0;\n          state = 0; // and parse as string literal.\n        }\n      }\n    }\n  }\n  let text = buffer.join('');\n  if (text) {\n    tokens.push(text);\n  }\n\n  // Merge adjacent text tokens into a single string.\n  const mergedTokens = [];\n  buffer.length = 0;\n  for (let i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'string') {\n      buffer.push(tokens[i] as string);\n    } else {\n      text = buffer.join('');\n      if (text) {\n        mergedTokens.push(text);\n      }\n      buffer.length = 0;\n      mergedTokens.push(tokens[i]);\n    }\n  }\n  text = buffer.join('');\n  if (text) {\n    mergedTokens.push(text);\n  }\n  buffer.length = 0;\n\n  return mergedTokens;\n}\n\n/**\n * Parse a string with any number of interpolation tokens (%1, %2, ...).\n * It will also replace string table references (e.g., %{bky_my_msg} and\n * %{BKY_MY_MSG} will both be replaced with the value in\n * Msg['MY_MSG']). Percentage sign characters '%' may be self-escaped\n * (e.g., '%%').\n *\n * @param message Text which might contain string table references and\n *     interpolation tokens.\n * @returns Array of strings and numbers.\n */\nexport function tokenizeInterpolation(message: string): (string | number)[] {\n  return tokenizeInterpolationInternal(message, true);\n}\n\n/**\n * Replaces string table references in a message, if the message is a string.\n * For example, \"%{bky_my_msg}\" and \"%{BKY_MY_MSG}\" will both be replaced with\n * the value in Msg['MY_MSG'].\n *\n * @param message Message, which may be a string that contains\n *     string table references.\n * @returns String with message references replaced.\n */\nexport function replaceMessageReferences(message: string | any): string {\n  if (typeof message !== 'string') {\n    return message;\n  }\n  const interpolatedResult = tokenizeInterpolationInternal(message, false);\n  // When parseInterpolationTokens === false, interpolatedResult should be at\n  // most length 1.\n  return interpolatedResult.length ? String(interpolatedResult[0]) : '';\n}\n\n/**\n * Validates that any %{MSG_KEY} references in the message refer to keys of\n * the Msg string table.\n *\n * @param message Text which might contain string table references.\n * @returns True if all message references have matching values.\n *     Otherwise, false.\n */\nexport function checkMessageReferences(message: string): boolean {\n  let validSoFar = true;\n\n  const msgTable = Msg;\n  // TODO (#1169): Implement support for other string tables,\n  // prefixes other than BKY_.\n  const m = message.match(/%{BKY_[A-Z]\\w*}/gi);\n  if (m) {\n    for (let i = 0; i < m.length; i++) {\n      const msgKey = m[i].toUpperCase();\n      if (msgTable[msgKey.slice(6, -1)] === undefined) {\n        console.warn('No message string for ' + m[i] + ' in ' + message);\n        validSoFar = false; // Continue to report other errors.\n      }\n    }\n  }\n\n  return validSoFar;\n}\n\n/**\n * Parse a block colour from a number or string, as provided in a block\n * definition.\n *\n * @param colour HSV hue value (0 to 360), #RRGGBB string,\n *     or a message reference string pointing to one of those two values.\n * @returns An object containing the colour as\n *     a #RRGGBB string, and the hue if the input was an HSV hue value.\n * @throws {Error} If the colour cannot be parsed.\n */\nexport function parseBlockColour(colour: number | string): {\n  hue: number | null;\n  hex: string;\n} {\n  const dereferenced =\n    typeof colour === 'string' ? replaceMessageReferences(colour) : colour;\n\n  const hue = Number(dereferenced);\n  if (!isNaN(hue) && 0 <= hue && hue <= 360) {\n    return {\n      hue: hue,\n      hex: colourUtils.hsvToHex(\n        hue,\n        colourUtils.getHsvSaturation(),\n        colourUtils.getHsvValue() * 255\n      ),\n    };\n  } else {\n    const hex = colourUtils.parse(dereferenced);\n    if (hex) {\n      // Only store hue if colour is set as a hue.\n      return {hue: null, hex: hex};\n    } else {\n      let errorMsg = 'Invalid colour: \"' + dereferenced + '\"';\n      if (colour !== dereferenced) {\n        errorMsg += ' (from \"' + colour + '\")';\n      }\n      throw Error(errorMsg);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WidgetDiv');\n\nimport * as common from './common.js';\nimport * as dom from './utils/dom.js';\nimport type {Field} from './field.js';\nimport type {Rect} from './utils/rect.js';\nimport type {Size} from './utils/size.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/** The object currently using this container. */\nlet owner: unknown = null;\n\n/** Optional cleanup function set by whichever object uses the widget. */\nlet dispose: (() => void) | null = null;\n\n/** A class name representing the current owner's workspace renderer. */\nlet rendererClassName = '';\n\n/** A class name representing the current owner's workspace theme. */\nlet themeClassName = '';\n\n/** The HTML container for popup overlays (e.g. editor widgets). */\nlet containerDiv: HTMLDivElement | null;\n\n/**\n * Returns the HTML container for editor widgets.\n *\n * @returns The editor widget container.\n */\nexport function getDiv(): HTMLDivElement | null {\n  return containerDiv;\n}\n\n/**\n * Allows unit tests to reset the div. Do not use outside of tests.\n *\n * @param newDiv The new value for the DIV field.\n * @internal\n */\nexport function testOnly_setDiv(newDiv: HTMLDivElement | null) {\n  containerDiv = newDiv;\n}\n\n/**\n * Create the widget div and inject it onto the page.\n */\nexport function createDom() {\n  if (containerDiv) {\n    return; // Already created.\n  }\n\n  containerDiv = document.createElement('div') as HTMLDivElement;\n  containerDiv.className = 'blocklyWidgetDiv';\n  const container = common.getParentContainer() || document.body;\n  container.appendChild(containerDiv);\n}\n\n/**\n * Initialize and display the widget div.  Close the old one if needed.\n *\n * @param newOwner The object that will be using this container.\n * @param rtl Right-to-left (true) or left-to-right (false).\n * @param newDispose Optional cleanup function to be run when the widget is\n *     closed.\n */\nexport function show(newOwner: unknown, rtl: boolean, newDispose: () => void) {\n  hide();\n  owner = newOwner;\n  dispose = newDispose;\n  const div = containerDiv;\n  if (!div) return;\n  div.style.direction = rtl ? 'rtl' : 'ltr';\n  div.style.display = 'block';\n  const mainWorkspace = common.getMainWorkspace() as WorkspaceSvg;\n  rendererClassName = mainWorkspace.getRenderer().getClassName();\n  themeClassName = mainWorkspace.getTheme().getClassName();\n  if (rendererClassName) {\n    dom.addClass(div, rendererClassName);\n  }\n  if (themeClassName) {\n    dom.addClass(div, themeClassName);\n  }\n}\n\n/**\n * Destroy the widget and hide the div.\n */\nexport function hide() {\n  if (!isVisible()) {\n    return;\n  }\n  owner = null;\n\n  const div = containerDiv;\n  if (!div) return;\n  div.style.display = 'none';\n  div.style.left = '';\n  div.style.top = '';\n  dispose && dispose();\n  dispose = null;\n  div.textContent = '';\n\n  if (rendererClassName) {\n    dom.removeClass(div, rendererClassName);\n    rendererClassName = '';\n  }\n  if (themeClassName) {\n    dom.removeClass(div, themeClassName);\n    themeClassName = '';\n  }\n  (common.getMainWorkspace() as WorkspaceSvg).markFocused();\n}\n\n/**\n * Is the container visible?\n *\n * @returns True if visible.\n */\nexport function isVisible(): boolean {\n  return !!owner;\n}\n\n/**\n * Destroy the widget and hide the div if it is being used by the specified\n * object.\n *\n * @param oldOwner The object that was using this container.\n */\nexport function hideIfOwner(oldOwner: unknown) {\n  if (owner === oldOwner) {\n    hide();\n  }\n}\n/**\n * Set the widget div's position and height.  This function does nothing clever:\n * it will not ensure that your widget div ends up in the visible window.\n *\n * @param x Horizontal location (window coordinates, not body).\n * @param y Vertical location (window coordinates, not body).\n * @param height The height of the widget div (pixels).\n */\nfunction positionInternal(x: number, y: number, height: number) {\n  containerDiv!.style.left = x + 'px';\n  containerDiv!.style.top = y + 'px';\n  containerDiv!.style.height = height + 'px';\n}\n\n/**\n * Position the widget div based on an anchor rectangle.\n * The widget should be placed adjacent to but not overlapping the anchor\n * rectangle.  The preferred position is directly below and aligned to the left\n * (LTR) or right (RTL) side of the anchor.\n *\n * @param viewportBBox The bounding rectangle of the current viewport, in window\n *     coordinates.\n * @param anchorBBox The bounding rectangle of the anchor, in window\n *     coordinates.\n * @param widgetSize The size of the widget that is inside the widget div, in\n *     window coordinates.\n * @param rtl Whether the workspace is in RTL mode.  This determines horizontal\n *     alignment.\n * @internal\n */\nexport function positionWithAnchor(\n  viewportBBox: Rect,\n  anchorBBox: Rect,\n  widgetSize: Size,\n  rtl: boolean\n) {\n  const y = calculateY(viewportBBox, anchorBBox, widgetSize);\n  const x = calculateX(viewportBBox, anchorBBox, widgetSize, rtl);\n\n  if (y < 0) {\n    positionInternal(x, 0, widgetSize.height + y);\n  } else {\n    positionInternal(x, y, widgetSize.height);\n  }\n}\n\n/**\n * Calculate an x position (in window coordinates) such that the widget will not\n * be offscreen on the right or left.\n *\n * @param viewportBBox The bounding rectangle of the current viewport, in window\n *     coordinates.\n * @param anchorBBox The bounding rectangle of the anchor, in window\n *     coordinates.\n * @param widgetSize The dimensions of the widget inside the widget div.\n * @param rtl Whether the Blockly workspace is in RTL mode.\n * @returns A valid x-coordinate for the top left corner of the widget div, in\n *     window coordinates.\n */\nfunction calculateX(\n  viewportBBox: Rect,\n  anchorBBox: Rect,\n  widgetSize: Size,\n  rtl: boolean\n): number {\n  if (rtl) {\n    // Try to align the right side of the field and the right side of widget.\n    const widgetLeft = anchorBBox.right - widgetSize.width;\n    // Don't go offscreen left.\n    const x = Math.max(widgetLeft, viewportBBox.left);\n    // But really don't go offscreen right:\n    return Math.min(x, viewportBBox.right - widgetSize.width);\n  } else {\n    // Try to align the left side of the field and the left side of widget.\n    // Don't go offscreen right.\n    const x = Math.min(anchorBBox.left, viewportBBox.right - widgetSize.width);\n    // But left is more important, because that's where the text is.\n    return Math.max(x, viewportBBox.left);\n  }\n}\n\n/**\n * Calculate a y position (in window coordinates) such that the widget will not\n * be offscreen on the top or bottom.\n *\n * @param viewportBBox The bounding rectangle of the current viewport, in window\n *     coordinates.\n * @param anchorBBox The bounding rectangle of the anchor, in window\n *     coordinates.\n * @param widgetSize The dimensions of the widget inside the widget div.\n * @returns A valid y-coordinate for the top left corner of the widget div, in\n *     window coordinates.\n */\nfunction calculateY(\n  viewportBBox: Rect,\n  anchorBBox: Rect,\n  widgetSize: Size\n): number {\n  // Flip the widget vertically if off the bottom.\n  // The widget could go off the top of the window, but it would also go off\n  // the bottom.  The window is just too small.\n  if (anchorBBox.bottom + widgetSize.height >= viewportBBox.bottom) {\n    // The bottom of the widget is at the top of the field.\n    return anchorBBox.top - widgetSize.height;\n  } else {\n    // The top of the widget is at the bottom of the field.\n    return anchorBBox.bottom;\n  }\n}\n\n/**\n * Determine if the owner is a field for purposes of repositioning.\n * We can't simply check `instanceof Field` as that would introduce a circular\n * dependency.\n */\nfunction isRepositionable(item: any): item is Field {\n  return !!item?.repositionForWindowResize;\n}\n\n/**\n * Reposition the widget div if the owner of it says to.\n * If the owner isn't a field, just give up and hide it.\n */\nexport function repositionForWindowResize(): void {\n  if (!isRepositionable(owner) || !owner.repositionForWindowResize()) {\n    // If the owner is not a Field, or if the owner returns false from the\n    // reposition method, we should hide the widget div. Otherwise, we'll assume\n    // the owner handled any needed resize.\n    hide();\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.fieldRegistry');\n\nimport type {Field, FieldProto} from './field.js';\nimport * as registry from './registry.js';\n\ninterface RegistryOptions {\n  type: string;\n  [key: string]: unknown;\n}\n\n/**\n * Registers a field type.\n * fieldRegistry.fromJson uses this registry to\n * find the appropriate field type.\n *\n * @param type The field type name as used in the JSON definition.\n * @param fieldClass The field class containing a fromJson function that can\n *     construct an instance of the field.\n * @throws {Error} if the type name is empty, the field is already registered,\n *     or the fieldClass is not an object containing a fromJson function.\n */\nexport function register(type: string, fieldClass: FieldProto) {\n  registry.register(registry.Type.FIELD, type, fieldClass);\n}\n\n/**\n * Unregisters the field registered with the given type.\n *\n * @param type The field type name as used in the JSON definition.\n */\nexport function unregister(type: string) {\n  registry.unregister(registry.Type.FIELD, type);\n}\n\n/**\n * Construct a Field from a JSON arg object.\n * Finds the appropriate registered field by the type name as registered using\n * fieldRegistry.register.\n *\n * @param options A JSON object with a type and options specific to the field\n *     type.\n * @returns The new field instance or null if a field wasn't found with the\n *     given type name\n * @internal\n */\nexport function fromJson<T>(options: RegistryOptions): Field<T> | null {\n  return TEST_ONLY.fromJsonInternal(options);\n}\n\n/**\n * Private version of fromJson for stubbing in tests.\n *\n * @param options\n */\nfunction fromJsonInternal<T>(options: RegistryOptions): Field<T> | null {\n  const fieldObject = registry.getObject(registry.Type.FIELD, options.type);\n  if (!fieldObject) {\n    console.warn(\n      'Blockly could not create a field of type ' +\n        options['type'] +\n        '. The field is probably not being registered. This could be because' +\n        ' the file is not loaded, the field does not register itself (Issue' +\n        ' #1584), or the registration is not being reached.'\n    );\n    return null;\n  } else if (typeof (fieldObject as any).fromJson !== 'function') {\n    throw new TypeError('returned Field was not a IRegistrableField');\n  } else {\n    type fromJson = (options: {}) => Field<T>;\n    return (fieldObject as unknown as {fromJson: fromJson}).fromJson(options);\n  }\n}\n\nexport const TEST_ONLY = {\n  fromJsonInternal,\n};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.aria');\n\n/** ARIA states/properties prefix. */\nconst ARIA_PREFIX = 'aria-';\n\n/** ARIA role attribute. */\nconst ROLE_ATTRIBUTE = 'role';\n\n/**\n * ARIA role values.\n * Copied from Closure's goog.a11y.aria.Role\n */\nexport enum Role {\n  // ARIA role for an interactive control of tabular data.\n  GRID = 'grid',\n\n  // ARIA role for a cell in a grid.\n  GRIDCELL = 'gridcell',\n  // ARIA role for a group of related elements like tree item siblings.\n  GROUP = 'group',\n\n  // ARIA role for a listbox.\n  LISTBOX = 'listbox',\n\n  // ARIA role for a popup menu.\n  MENU = 'menu',\n\n  // ARIA role for menu item elements.\n  MENUITEM = 'menuitem',\n  // ARIA role for a checkbox box element inside a menu.\n  MENUITEMCHECKBOX = 'menuitemcheckbox',\n  // ARIA role for option items that are  children of combobox, listbox, menu,\n  // radiogroup, or tree elements.\n  OPTION = 'option',\n  // ARIA role for ignorable cosmetic elements with no semantic significance.\n  PRESENTATION = 'presentation',\n\n  // ARIA role for a row of cells in a grid.\n  ROW = 'row',\n  // ARIA role for a tree.\n  TREE = 'tree',\n\n  // ARIA role for a tree item that sometimes may be expanded or collapsed.\n  TREEITEM = 'treeitem',\n}\n\n/**\n * ARIA states and properties.\n * Copied from Closure's goog.a11y.aria.State\n */\nexport enum State {\n  // ARIA property for setting the currently active descendant of an element,\n  // for example the selected item in a list box. Value: ID of an element.\n  ACTIVEDESCENDANT = 'activedescendant',\n  // ARIA property defines the total number of columns in a table, grid, or\n  // treegrid.\n  // Value: integer.\n  COLCOUNT = 'colcount',\n  // ARIA state for a disabled item. Value: one of {true, false}.\n  DISABLED = 'disabled',\n\n  // ARIA state for setting whether the element like a tree node is expanded.\n  // Value: one of {true, false, undefined}.\n  EXPANDED = 'expanded',\n\n  // ARIA state indicating that the entered value does not conform. Value:\n  // one of {false, true, 'grammar', 'spelling'}\n  INVALID = 'invalid',\n\n  // ARIA property that provides a label to override any other text, value, or\n  // contents used to describe this element. Value: string.\n  LABEL = 'label',\n  // ARIA property for setting the element which labels another element.\n  // Value: space-separated IDs of elements.\n  LABELLEDBY = 'labelledby',\n\n  // ARIA property for setting the level of an element in the hierarchy.\n  // Value: integer.\n  LEVEL = 'level',\n  // ARIA property indicating if the element is horizontal or vertical.\n  // Value: one of {'vertical', 'horizontal'}.\n  ORIENTATION = 'orientation',\n\n  // ARIA property that defines an element's number of position in a list.\n  // Value: integer.\n  POSINSET = 'posinset',\n\n  // ARIA property defines the total number of rows in a table, grid, or\n  // treegrid.\n  // Value: integer.\n  ROWCOUNT = 'rowcount',\n\n  // ARIA state for setting the currently selected item in the list.\n  // Value: one of {true, false, undefined}.\n  SELECTED = 'selected',\n  // ARIA property defining the number of items in a list. Value: integer.\n  SETSIZE = 'setsize',\n\n  // ARIA property for slider maximum value. Value: number.\n  VALUEMAX = 'valuemax',\n\n  // ARIA property for slider minimum value. Value: number.\n  VALUEMIN = 'valuemin',\n}\n\n/**\n * Sets the role of an element.\n *\n * Similar to Closure's goog.a11y.aria\n *\n * @param element DOM node to set role of.\n * @param roleName Role name.\n */\nexport function setRole(element: Element, roleName: Role) {\n  element.setAttribute(ROLE_ATTRIBUTE, roleName);\n}\n\n/**\n * Sets the state or property of an element.\n * Copied from Closure's goog.a11y.aria\n *\n * @param element DOM node where we set state.\n * @param stateName State attribute being set.\n *     Automatically adds prefix 'aria-' to the state name if the attribute is\n * not an extra attribute.\n * @param value Value for the state attribute.\n */\nexport function setState(\n  element: Element,\n  stateName: State,\n  value: string | boolean | number | string[]\n) {\n  if (Array.isArray(value)) {\n    value = value.join(' ');\n  }\n  const attrStateName = ARIA_PREFIX + stateName;\n  element.setAttribute(attrStateName, `${value}`);\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Dropdown input field.  Used for editable titles and variables.\n * In the interests of a consistent UI, the toolbox shares some functions and\n * properties with the context menu.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldDropdown');\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {\n  Field,\n  FieldConfig,\n  FieldValidator,\n  UnattachedFieldError,\n} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {Menu} from './menu.js';\nimport {MenuItem} from './menuitem.js';\nimport * as style from './utils/style.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport * as utilsString from './utils/string.js';\nimport {Svg} from './utils/svg.js';\n\n/**\n * Class for an editable dropdown field.\n */\nexport class FieldDropdown extends Field<string> {\n  /** Horizontal distance that a checkmark overhangs the dropdown. */\n  static CHECKMARK_OVERHANG = 25;\n\n  /**\n   * Maximum height of the dropdown menu, as a percentage of the viewport\n   * height.\n   */\n  static MAX_MENU_HEIGHT_VH = 0.45;\n\n  static ARROW_CHAR = '▾';\n\n  /** A reference to the currently selected menu item. */\n  private selectedMenuItem: MenuItem | null = null;\n\n  /** The dropdown menu. */\n  protected menu_: Menu | null = null;\n\n  /**\n   * SVG image element if currently selected option is an image, or null.\n   */\n  private imageElement: SVGImageElement | null = null;\n\n  /** Tspan based arrow element. */\n  private arrow: SVGTSpanElement | null = null;\n\n  /** SVG based arrow element. */\n  private svgArrow: SVGElement | null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  override CURSOR = 'default';\n\n  protected menuGenerator_?: MenuGenerator;\n\n  /** A cache of the most recently generated options. */\n  private generatedOptions: MenuOption[] | null = null;\n\n  /**\n   * The prefix field label, of common words set after options are trimmed.\n   *\n   * @internal\n   */\n  override prefixField: string | null = null;\n\n  /**\n   * The suffix field label, of common words set after options are trimmed.\n   *\n   * @internal\n   */\n  override suffixField: string | null = null;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  private selectedOption!: MenuOption;\n  override clickTarget_: SVGElement | null = null;\n\n  /**\n   * @param menuGenerator A non-empty array of options for a dropdown list, or a\n   *     function which generates these options. Also accepts Field.SKIP_SETUP\n   *     if you wish to skip setup (only used by subclasses that want to handle\n   *     configuration and setting the field value after their own constructors\n   *     have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a language-neutral dropdown option & returns a\n   *     validated language-neutral dropdown option, or null to abort the\n   *     change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/dropdown#creation}\n   * for a list of properties this parameter supports.\n   * @throws {TypeError} If `menuGenerator` options are incorrectly structured.\n   */\n  constructor(\n    menuGenerator: MenuGenerator,\n    validator?: FieldDropdownValidator,\n    config?: FieldDropdownConfig\n  );\n  constructor(menuGenerator: typeof Field.SKIP_SETUP);\n  constructor(\n    menuGenerator: MenuGenerator | typeof Field.SKIP_SETUP,\n    validator?: FieldDropdownValidator,\n    config?: FieldDropdownConfig\n  ) {\n    super(Field.SKIP_SETUP);\n\n    // If we pass SKIP_SETUP, don't do *anything* with the menu generator.\n    if (menuGenerator === Field.SKIP_SETUP) return;\n\n    if (Array.isArray(menuGenerator)) {\n      validateOptions(menuGenerator);\n      const trimmed = trimOptions(menuGenerator);\n      this.menuGenerator_ = trimmed.options;\n      this.prefixField = trimmed.prefix || null;\n      this.suffixField = trimmed.suffix || null;\n    } else {\n      this.menuGenerator_ = menuGenerator;\n    }\n\n    /**\n     * The currently selected option. The field is initialized with the\n     * first option selected.\n     */\n    this.selectedOption = this.getOptions(false)[0];\n\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(this.selectedOption[1]);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Sets the field's value based on the given XML element. Should only be\n   * called by Blockly.Xml.\n   *\n   * @param fieldElement The element containing info about the field's state.\n   * @internal\n   */\n  override fromXml(fieldElement: Element) {\n    if (this.isOptionListDynamic()) {\n      this.getOptions(false);\n    }\n    this.setValue(fieldElement.textContent);\n  }\n\n  /**\n   * Sets the field's value based on the given state.\n   *\n   * @param state The state to apply to the dropdown field.\n   * @internal\n   */\n  override loadState(state: AnyDuringMigration) {\n    if (this.loadLegacyState(FieldDropdown, state)) {\n      return;\n    }\n    if (this.isOptionListDynamic()) {\n      this.getOptions(false);\n    }\n    this.setValue(state);\n  }\n\n  /**\n   * Create the block UI for this dropdown.\n   *\n   * @internal\n   */\n  override initView() {\n    if (this.shouldAddBorderRect_()) {\n      this.createBorderRect_();\n    } else {\n      this.clickTarget_ = (this.sourceBlock_ as BlockSvg).getSvgRoot();\n    }\n    this.createTextElement_();\n\n    this.imageElement = dom.createSvgElement(Svg.IMAGE, {}, this.fieldGroup_);\n\n    if (this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW) {\n      this.createSVGArrow_();\n    } else {\n      this.createTextArrow_();\n    }\n\n    if (this.borderRect_) {\n      dom.addClass(this.borderRect_, 'blocklyDropdownRect');\n    }\n  }\n\n  /**\n   * Whether or not the dropdown should add a border rect.\n   *\n   * @returns True if the dropdown field should add a border rect.\n   */\n  protected shouldAddBorderRect_(): boolean {\n    return (\n      !this.getConstants()!.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW ||\n      (this.getConstants()!.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW &&\n        !this.getSourceBlock()?.isShadow())\n    );\n  }\n\n  /** Create a tspan based arrow. */\n  protected createTextArrow_() {\n    this.arrow = dom.createSvgElement(Svg.TSPAN, {}, this.textElement_);\n    this.arrow!.appendChild(\n      document.createTextNode(\n        this.getSourceBlock()?.RTL\n          ? FieldDropdown.ARROW_CHAR + ' '\n          : ' ' + FieldDropdown.ARROW_CHAR\n      )\n    );\n    if (this.getSourceBlock()?.RTL) {\n      this.getTextElement().insertBefore(this.arrow, this.textContent_);\n    } else {\n      this.getTextElement().appendChild(this.arrow);\n    }\n  }\n\n  /** Create an SVG based arrow. */\n  protected createSVGArrow_() {\n    this.svgArrow = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'height': this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE + 'px',\n        'width': this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE + 'px',\n      },\n      this.fieldGroup_\n    );\n    this.svgArrow!.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_DATAURI\n    );\n  }\n\n  /**\n   * Create a dropdown menu under the text.\n   *\n   * @param e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   */\n  protected override showEditor_(e?: MouseEvent) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    this.dropdownCreate();\n    if (e && typeof e.clientX === 'number') {\n      this.menu_!.openingCoords = new Coordinate(e.clientX, e.clientY);\n    } else {\n      this.menu_!.openingCoords = null;\n    }\n\n    // Remove any pre-existing elements in the dropdown.\n    dropDownDiv.clearContent();\n    // Element gets created in render.\n    const menuElement = this.menu_!.render(dropDownDiv.getContentDiv());\n    dom.addClass(menuElement, 'blocklyDropdownMenu');\n\n    if (this.getConstants()!.FIELD_DROPDOWN_COLOURED_DIV) {\n      const primaryColour = block.isShadow()\n        ? block.getParent()!.getColour()\n        : block.getColour();\n      const borderColour = block.isShadow()\n        ? (block.getParent() as BlockSvg).style.colourTertiary\n        : (this.sourceBlock_ as BlockSvg).style.colourTertiary;\n      dropDownDiv.setColour(primaryColour, borderColour);\n    }\n\n    dropDownDiv.showPositionedByField(this, this.dropdownDispose_.bind(this));\n\n    // Focusing needs to be handled after the menu is rendered and positioned.\n    // Otherwise it will cause a page scroll to get the misplaced menu in\n    // view. See issue #1329.\n    this.menu_!.focus();\n\n    if (this.selectedMenuItem) {\n      this.menu_!.setHighlighted(this.selectedMenuItem);\n      style.scrollIntoContainerView(\n        this.selectedMenuItem.getElement()!,\n        dropDownDiv.getContentDiv(),\n        true\n      );\n    }\n\n    this.applyColour();\n  }\n\n  /** Create the dropdown editor. */\n  private dropdownCreate() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const menu = new Menu();\n    menu.setRole(aria.Role.LISTBOX);\n    this.menu_ = menu;\n\n    const options = this.getOptions(false);\n    this.selectedMenuItem = null;\n    for (let i = 0; i < options.length; i++) {\n      const [label, value] = options[i];\n      const content = (() => {\n        if (typeof label === 'object') {\n          // Convert ImageProperties to an HTMLImageElement.\n          const image = new Image(label['width'], label['height']);\n          image.src = label['src'];\n          image.alt = label['alt'] || '';\n          return image;\n        }\n        return label;\n      })();\n      const menuItem = new MenuItem(content, value);\n      menuItem.setRole(aria.Role.OPTION);\n      menuItem.setRightToLeft(block.RTL);\n      menuItem.setCheckable(true);\n      menu.addChild(menuItem);\n      menuItem.setChecked(value === this.value_);\n      if (value === this.value_) {\n        this.selectedMenuItem = menuItem;\n      }\n      menuItem.onAction(this.handleMenuActionEvent, this);\n    }\n  }\n\n  /**\n   * Disposes of events and DOM-references belonging to the dropdown editor.\n   */\n  protected dropdownDispose_() {\n    if (this.menu_) {\n      this.menu_.dispose();\n    }\n    this.menu_ = null;\n    this.selectedMenuItem = null;\n    this.applyColour();\n  }\n\n  /**\n   * Handle an action in the dropdown menu.\n   *\n   * @param menuItem The MenuItem selected within menu.\n   */\n  private handleMenuActionEvent(menuItem: MenuItem) {\n    dropDownDiv.hideIfOwner(this, true);\n    this.onItemSelected_(this.menu_ as Menu, menuItem);\n  }\n\n  /**\n   * Handle the selection of an item in the dropdown menu.\n   *\n   * @param menu The Menu component clicked.\n   * @param menuItem The MenuItem selected within menu.\n   */\n  protected onItemSelected_(menu: Menu, menuItem: MenuItem) {\n    this.setValue(menuItem.getValue());\n  }\n\n  /**\n   * @returns True if the option list is generated by a function.\n   *     Otherwise false.\n   */\n  isOptionListDynamic(): boolean {\n    return typeof this.menuGenerator_ === 'function';\n  }\n\n  /**\n   * Return a list of the options for this dropdown.\n   *\n   * @param useCache For dynamic options, whether or not to use the cached\n   *     options or to re-generate them.\n   * @returns A non-empty array of option tuples:\n   *     (human-readable text or image, language-neutral name).\n   * @throws {TypeError} If generated options are incorrectly structured.\n   */\n  getOptions(useCache?: boolean): MenuOption[] {\n    if (!this.menuGenerator_) {\n      // A subclass improperly skipped setup without defining the menu\n      // generator.\n      throw TypeError('A menu generator was never defined.');\n    }\n    if (Array.isArray(this.menuGenerator_)) return this.menuGenerator_;\n    if (useCache && this.generatedOptions) return this.generatedOptions;\n\n    this.generatedOptions = this.menuGenerator_();\n    validateOptions(this.generatedOptions);\n    return this.generatedOptions;\n  }\n\n  /**\n   * Ensure that the input value is a valid language-neutral option.\n   *\n   * @param newValue The input value.\n   * @returns A valid language-neutral option, or null if invalid.\n   */\n  protected override doClassValidation_(newValue?: string): string | null {\n    const options = this.getOptions(true);\n    const isValueValid = options.some((option) => option[1] === newValue);\n\n    if (!isValueValid) {\n      if (this.sourceBlock_) {\n        console.warn(\n          \"Cannot set the dropdown's value to an unavailable option.\" +\n            ' Block type: ' +\n            this.sourceBlock_.type +\n            ', Field name: ' +\n            this.name +\n            ', Value: ' +\n            newValue\n        );\n      }\n      return null;\n    }\n    return newValue as string;\n  }\n\n  /**\n   * Update the value of this dropdown field.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is one of the valid dropdown options.\n   */\n  protected override doValueUpdate_(newValue: string) {\n    super.doValueUpdate_(newValue);\n    const options = this.getOptions(true);\n    for (let i = 0, option; (option = options[i]); i++) {\n      if (option[1] === this.value_) {\n        this.selectedOption = option;\n      }\n    }\n  }\n\n  /**\n   * Updates the dropdown arrow to match the colour/style of the block.\n   */\n  override applyColour() {\n    const style = (this.sourceBlock_ as BlockSvg).style;\n    if (this.borderRect_) {\n      this.borderRect_.setAttribute('stroke', style.colourTertiary);\n      if (this.menu_) {\n        this.borderRect_.setAttribute('fill', style.colourTertiary);\n      } else {\n        this.borderRect_.setAttribute('fill', 'transparent');\n      }\n    }\n    // Update arrow's colour.\n    if (this.sourceBlock_ && this.arrow) {\n      if (this.sourceBlock_.isShadow()) {\n        this.arrow.style.fill = style.colourSecondary;\n      } else {\n        this.arrow.style.fill = style.colourPrimary;\n      }\n    }\n  }\n\n  /** Draws the border with the correct width. */\n  protected override render_() {\n    // Hide both elements.\n    this.getTextContent().nodeValue = '';\n    this.imageElement!.style.display = 'none';\n\n    // Show correct element.\n    const option = this.selectedOption && this.selectedOption[0];\n    if (option && typeof option === 'object') {\n      this.renderSelectedImage(option);\n    } else {\n      this.renderSelectedText();\n    }\n\n    this.positionBorderRect_();\n  }\n\n  /**\n   * Renders the selected option, which must be an image.\n   *\n   * @param imageJson Selected option that must be an image.\n   */\n  private renderSelectedImage(imageJson: ImageProperties) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    this.imageElement!.style.display = '';\n    this.imageElement!.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      imageJson.src\n    );\n    this.imageElement!.setAttribute('height', String(imageJson.height));\n    this.imageElement!.setAttribute('width', String(imageJson.width));\n\n    const imageHeight = Number(imageJson.height);\n    const imageWidth = Number(imageJson.width);\n\n    // Height and width include the border rect.\n    const hasBorder = !!this.borderRect_;\n    const height = Math.max(\n      hasBorder ? this.getConstants()!.FIELD_DROPDOWN_BORDER_RECT_HEIGHT : 0,\n      imageHeight + IMAGE_Y_PADDING\n    );\n    const xPadding = hasBorder\n      ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING\n      : 0;\n    let arrowWidth = 0;\n    if (this.svgArrow) {\n      arrowWidth = this.positionSVGArrow(\n        imageWidth + xPadding,\n        height / 2 - this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE / 2\n      );\n    } else {\n      arrowWidth = dom.getFastTextWidth(\n        this.arrow as SVGTSpanElement,\n        this.getConstants()!.FIELD_TEXT_FONTSIZE,\n        this.getConstants()!.FIELD_TEXT_FONTWEIGHT,\n        this.getConstants()!.FIELD_TEXT_FONTFAMILY\n      );\n    }\n    this.size_.width = imageWidth + arrowWidth + xPadding * 2;\n    this.size_.height = height;\n\n    let arrowX = 0;\n    if (block.RTL) {\n      const imageX = xPadding + arrowWidth;\n      this.imageElement!.setAttribute('x', `${imageX}`);\n    } else {\n      arrowX = imageWidth + arrowWidth;\n      this.getTextElement().setAttribute('text-anchor', 'end');\n      this.imageElement!.setAttribute('x', `${xPadding}`);\n    }\n    this.imageElement!.setAttribute('y', String(height / 2 - imageHeight / 2));\n\n    this.positionTextElement_(arrowX + xPadding, imageWidth + arrowWidth);\n  }\n\n  /** Renders the selected option, which must be text. */\n  private renderSelectedText() {\n    // Retrieves the selected option to display through getText_.\n    this.getTextContent().nodeValue = this.getDisplayText_();\n    const textElement = this.getTextElement();\n    dom.addClass(textElement, 'blocklyDropdownText');\n    textElement.setAttribute('text-anchor', 'start');\n\n    // Height and width include the border rect.\n    const hasBorder = !!this.borderRect_;\n    const height = Math.max(\n      hasBorder ? this.getConstants()!.FIELD_DROPDOWN_BORDER_RECT_HEIGHT : 0,\n      this.getConstants()!.FIELD_TEXT_HEIGHT\n    );\n    const textWidth = dom.getFastTextWidth(\n      this.getTextElement(),\n      this.getConstants()!.FIELD_TEXT_FONTSIZE,\n      this.getConstants()!.FIELD_TEXT_FONTWEIGHT,\n      this.getConstants()!.FIELD_TEXT_FONTFAMILY\n    );\n    const xPadding = hasBorder\n      ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING\n      : 0;\n    let arrowWidth = 0;\n    if (this.svgArrow) {\n      arrowWidth = this.positionSVGArrow(\n        textWidth + xPadding,\n        height / 2 - this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE / 2\n      );\n    }\n    this.size_.width = textWidth + arrowWidth + xPadding * 2;\n    this.size_.height = height;\n\n    this.positionTextElement_(xPadding, textWidth);\n  }\n\n  /**\n   * Position a drop-down arrow at the appropriate location at render-time.\n   *\n   * @param x X position the arrow is being rendered at, in px.\n   * @param y Y position the arrow is being rendered at, in px.\n   * @returns Amount of space the arrow is taking up, in px.\n   */\n  private positionSVGArrow(x: number, y: number): number {\n    if (!this.svgArrow) {\n      return 0;\n    }\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const hasBorder = !!this.borderRect_;\n    const xPadding = hasBorder\n      ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING\n      : 0;\n    const textPadding = this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_PADDING;\n    const svgArrowSize = this.getConstants()!.FIELD_DROPDOWN_SVG_ARROW_SIZE;\n    const arrowX = block.RTL ? xPadding : x + textPadding;\n    this.svgArrow.setAttribute(\n      'transform',\n      'translate(' + arrowX + ',' + y + ')'\n    );\n    return svgArrowSize + textPadding;\n  }\n\n  /**\n   * Use the `getText_` developer hook to override the field's text\n   * representation.  Get the selected option text.  If the selected option is\n   * an image we return the image alt text.\n   *\n   * @returns Selected option text.\n   */\n  protected override getText_(): string | null {\n    if (!this.selectedOption) {\n      return null;\n    }\n    const option = this.selectedOption[0];\n    if (typeof option === 'object') {\n      return option['alt'];\n    }\n    return option;\n  }\n\n  /**\n   * Construct a FieldDropdown from a JSON arg object.\n   *\n   * @param options A JSON object with options (options).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldDropdownFromJsonConfig): FieldDropdown {\n    if (!options.options) {\n      throw new Error(\n        'options are required for the dropdown field. The ' +\n          'options property must be assigned an array of ' +\n          '[humanReadableValue, languageNeutralValue] tuples.'\n      );\n    }\n    // `this` might be a subclass of FieldDropdown if that class doesn't\n    // override the static fromJson method.\n    return new this(options.options, undefined, options);\n  }\n}\n\n/**\n * Definition of a human-readable image dropdown option.\n */\nexport interface ImageProperties {\n  src: string;\n  alt: string;\n  width: number;\n  height: number;\n}\n\n/**\n * An individual option in the dropdown menu. The first element is the human-\n * readable value (text or image), and the second element is the language-\n * neutral value.\n */\nexport type MenuOption = [string | ImageProperties, string];\n\n/**\n * A function that generates an array of menu options for FieldDropdown\n * or its descendants.\n */\nexport type MenuGeneratorFunction = (this: FieldDropdown) => MenuOption[];\n\n/**\n * Either an array of menu options or a function that generates an array of\n * menu options for FieldDropdown or its descendants.\n */\nexport type MenuGenerator = MenuOption[] | MenuGeneratorFunction;\n\n/**\n * Config options for the dropdown field.\n */\nexport type FieldDropdownConfig = FieldConfig;\n\n/**\n * fromJson config for the dropdown field.\n */\nexport interface FieldDropdownFromJsonConfig extends FieldDropdownConfig {\n  options?: MenuOption[];\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldDropdownValidator = FieldValidator<string>;\n\n/**\n * The y offset from the top of the field to the top of the image, if an image\n * is selected.\n */\nconst IMAGE_Y_OFFSET = 5;\n\n/** The total vertical padding above and below an image. */\nconst IMAGE_Y_PADDING: number = IMAGE_Y_OFFSET * 2;\n\n/**\n * Factor out common words in statically defined options.\n * Create prefix and/or suffix labels.\n */\nfunction trimOptions(options: MenuOption[]): {\n  options: MenuOption[];\n  prefix?: string;\n  suffix?: string;\n} {\n  let hasImages = false;\n  const trimmedOptions = options.map(([label, value]): MenuOption => {\n    if (typeof label === 'string') {\n      return [parsing.replaceMessageReferences(label), value];\n    }\n\n    hasImages = true;\n    // Copy the image properties so they're not influenced by the original.\n    // NOTE: No need to deep copy since image properties are only 1 level deep.\n    const imageLabel =\n      label.alt !== null\n        ? {...label, alt: parsing.replaceMessageReferences(label.alt)}\n        : {...label};\n    return [imageLabel, value];\n  });\n\n  if (hasImages || options.length < 2) return {options: trimmedOptions};\n\n  const stringOptions = trimmedOptions as [string, string][];\n  const stringLabels = stringOptions.map(([label]) => label);\n\n  const shortest = utilsString.shortestStringLength(stringLabels);\n  const prefixLength = utilsString.commonWordPrefix(stringLabels, shortest);\n  const suffixLength = utilsString.commonWordSuffix(stringLabels, shortest);\n\n  if (\n    (!prefixLength && !suffixLength) ||\n    shortest <= prefixLength + suffixLength\n  ) {\n    // One or more strings will entirely vanish if we proceed.  Abort.\n    return {options: stringOptions};\n  }\n\n  const prefix = prefixLength\n    ? stringLabels[0].substring(0, prefixLength - 1)\n    : undefined;\n  const suffix = suffixLength\n    ? stringLabels[0].substr(1 - suffixLength)\n    : undefined;\n  return {\n    options: applyTrim(stringOptions, prefixLength, suffixLength),\n    prefix,\n    suffix,\n  };\n}\n\n/**\n * Use the calculated prefix and suffix lengths to trim all of the options in\n * the given array.\n *\n * @param options Array of option tuples:\n *     (human-readable text or image, language-neutral name).\n * @param prefixLength The length of the common prefix.\n * @param suffixLength The length of the common suffix\n * @returns A new array with all of the option text trimmed.\n */\nfunction applyTrim(\n  options: [string, string][],\n  prefixLength: number,\n  suffixLength: number\n): MenuOption[] {\n  return options.map(([text, value]) => [\n    text.substring(prefixLength, text.length - suffixLength),\n    value,\n  ]);\n}\n\n/**\n * Validates the data structure to be processed as an options list.\n *\n * @param options The proposed dropdown options.\n * @throws {TypeError} If proposed options are incorrectly structured.\n */\nfunction validateOptions(options: MenuOption[]) {\n  if (!Array.isArray(options)) {\n    throw TypeError('FieldDropdown options must be an array.');\n  }\n  if (!options.length) {\n    throw TypeError('FieldDropdown options must not be an empty array.');\n  }\n  let foundError = false;\n  for (let i = 0; i < options.length; i++) {\n    const tuple = options[i];\n    if (!Array.isArray(tuple)) {\n      foundError = true;\n      console.error(\n        'Invalid option[' +\n          i +\n          ']: Each FieldDropdown option must be an ' +\n          'array. Found: ',\n        tuple\n      );\n    } else if (typeof tuple[1] !== 'string') {\n      foundError = true;\n      console.error(\n        'Invalid option[' +\n          i +\n          ']: Each FieldDropdown option id must be ' +\n          'a string. Found ' +\n          tuple[1] +\n          ' in: ',\n        tuple\n      );\n    } else if (\n      tuple[0] &&\n      typeof tuple[0] !== 'string' &&\n      typeof tuple[0].src !== 'string'\n    ) {\n      foundError = true;\n      console.error(\n        'Invalid option[' +\n          i +\n          ']: Each FieldDropdown option must have a ' +\n          'string label or image description. Found' +\n          tuple[0] +\n          ' in: ',\n        tuple\n      );\n    }\n  }\n  if (foundError) {\n    throw TypeError('Found invalid FieldDropdown options.');\n  }\n}\n\nfieldRegistry.register('field_dropdown', FieldDropdown);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.object');\n\n/**\n * Complete a deep merge of all members of a source object with a target object.\n *\n * @param target Target.\n * @param source Source.\n * @returns The resulting object.\n */\nexport function deepMerge(\n  target: AnyDuringMigration,\n  source: AnyDuringMigration\n): AnyDuringMigration {\n  for (const x in source) {\n    if (source[x] !== null && typeof source[x] === 'object') {\n      target[x] = deepMerge(target[x] || Object.create(null), source[x]);\n    } else {\n      target[x] = source[x];\n    }\n  }\n  return target;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.toolbox');\n\nimport type {ConnectionState} from '../serialization/blocks.js';\nimport type {CssConfig as CategoryCssConfig} from '../toolbox/category.js';\nimport type {CssConfig as SeparatorCssConfig} from '../toolbox/separator.js';\nimport * as utilsXml from './xml.js';\n\n/**\n * The information needed to create a block in the toolbox.\n * Note that disabled has a different type for backwards compatibility.\n */\nexport interface BlockInfo {\n  kind: string;\n  blockxml?: string | Node;\n  type?: string;\n  gap?: string | number;\n  disabled?: string | boolean;\n  enabled?: boolean;\n  id?: string;\n  x?: number;\n  y?: number;\n  collapsed?: boolean;\n  inline?: boolean;\n  data?: string;\n  extraState?: AnyDuringMigration;\n  icons?: {[key: string]: AnyDuringMigration};\n  fields?: {[key: string]: AnyDuringMigration};\n  inputs?: {[key: string]: ConnectionState};\n  next?: ConnectionState;\n}\n\n/**\n * The information needed to create a separator in the toolbox.\n */\nexport interface SeparatorInfo {\n  kind: string;\n  id: string | undefined;\n  gap: number | undefined;\n  cssconfig: SeparatorCssConfig | undefined;\n}\n\n/**\n * The information needed to create a button in the toolbox.\n */\nexport interface ButtonInfo {\n  kind: string;\n  text: string;\n  callbackkey: string;\n}\n\n/**\n * The information needed to create a label in the toolbox.\n */\nexport interface LabelInfo {\n  kind: string;\n  text: string;\n  id: string | undefined;\n}\n\n/**\n * The information needed to create either a button or a label in the flyout.\n */\nexport type ButtonOrLabelInfo = ButtonInfo | LabelInfo;\n\n/**\n * The information needed to create a category in the toolbox.\n */\nexport interface StaticCategoryInfo {\n  kind: string;\n  name: string;\n  contents: ToolboxItemInfo[];\n  id: string | undefined;\n  categorystyle: string | undefined;\n  colour: string | undefined;\n  cssconfig: CategoryCssConfig | undefined;\n  hidden: string | undefined;\n  expanded?: string | boolean;\n}\n\n/**\n * The information needed to create a custom category.\n */\nexport interface DynamicCategoryInfo {\n  kind: string;\n  custom: string;\n  id: string | undefined;\n  categorystyle: string | undefined;\n  colour: string | undefined;\n  cssconfig: CategoryCssConfig | undefined;\n  hidden: string | undefined;\n  expanded?: string | boolean;\n}\n\n/**\n * The information needed to create either a dynamic or static category.\n */\nexport type CategoryInfo = StaticCategoryInfo | DynamicCategoryInfo;\n\n/**\n * Any information that can be used to create an item in the toolbox.\n */\nexport type ToolboxItemInfo = FlyoutItemInfo | StaticCategoryInfo;\n\n/**\n * All the different types that can be displayed in a flyout.\n */\nexport type FlyoutItemInfo =\n  | BlockInfo\n  | SeparatorInfo\n  | ButtonInfo\n  | LabelInfo\n  | DynamicCategoryInfo;\n\n/**\n * The JSON definition of a toolbox.\n */\nexport interface ToolboxInfo {\n  kind?: string;\n  contents: ToolboxItemInfo[];\n}\n\n/**\n * An array holding flyout items.\n */\nexport type FlyoutItemInfoArray = FlyoutItemInfo[];\n\n/**\n * All of the different types that can create a toolbox.\n */\nexport type ToolboxDefinition = Node | ToolboxInfo | string;\n\n/**\n * All of the different types that can be used to show items in a flyout.\n */\nexport type FlyoutDefinition =\n  | FlyoutItemInfoArray\n  | NodeList\n  | ToolboxInfo\n  | Node[];\n\n/**\n * The name used to identify a toolbox that has category like items.\n * This only needs to be used if a toolbox wants to be treated like a category\n * toolbox but does not actually contain any toolbox items with the kind\n * 'category'.\n */\nconst CATEGORY_TOOLBOX_KIND = 'categoryToolbox';\n\n/**\n * The name used to identify a toolbox that has no categories and is displayed\n * as a simple flyout displaying blocks, buttons, or labels.\n */\nconst FLYOUT_TOOLBOX_KIND = 'flyoutToolbox';\n\n/**\n * Position of the toolbox and/or flyout relative to the workspace.\n */\nexport enum Position {\n  TOP,\n  BOTTOM,\n  LEFT,\n  RIGHT,\n}\n\n/**\n * Converts the toolbox definition into toolbox JSON.\n *\n * @param toolboxDef The definition of the toolbox in one of its many forms.\n * @returns Object holding information for creating a toolbox.\n * @internal\n */\nexport function convertToolboxDefToJson(\n  toolboxDef: ToolboxDefinition | null\n): ToolboxInfo | null {\n  if (!toolboxDef) {\n    return null;\n  }\n\n  if (toolboxDef instanceof Element || typeof toolboxDef === 'string') {\n    toolboxDef = parseToolboxTree(toolboxDef);\n    // AnyDuringMigration because:  Argument of type 'Node | null' is not\n    // assignable to parameter of type 'Node'.\n    toolboxDef = convertToToolboxJson(toolboxDef as AnyDuringMigration);\n  }\n\n  const toolboxJson = toolboxDef as ToolboxInfo;\n  validateToolbox(toolboxJson);\n  return toolboxJson;\n}\n\n/**\n * Validates the toolbox JSON fields have been set correctly.\n *\n * @param toolboxJson Object holding information for creating a toolbox.\n * @throws {Error} if the toolbox is not the correct format.\n */\nfunction validateToolbox(toolboxJson: ToolboxInfo) {\n  const toolboxKind = toolboxJson['kind'];\n  const toolboxContents = toolboxJson['contents'];\n\n  if (toolboxKind) {\n    if (\n      toolboxKind !== FLYOUT_TOOLBOX_KIND &&\n      toolboxKind !== CATEGORY_TOOLBOX_KIND\n    ) {\n      throw Error(\n        'Invalid toolbox kind ' +\n          toolboxKind +\n          '.' +\n          ' Please supply either ' +\n          FLYOUT_TOOLBOX_KIND +\n          ' or ' +\n          CATEGORY_TOOLBOX_KIND\n      );\n    }\n  }\n  if (!toolboxContents) {\n    throw Error('Toolbox must have a contents attribute.');\n  }\n}\n\n/**\n * Converts the flyout definition into a list of flyout items.\n *\n * @param flyoutDef The definition of the flyout in one of its many forms.\n * @returns A list of flyout items.\n * @internal\n */\nexport function convertFlyoutDefToJsonArray(\n  flyoutDef: FlyoutDefinition | null\n): FlyoutItemInfoArray {\n  if (!flyoutDef) {\n    return [];\n  }\n\n  if ((flyoutDef as AnyDuringMigration)['contents']) {\n    return (flyoutDef as AnyDuringMigration)['contents'];\n  }\n  // If it is already in the correct format return the flyoutDef.\n  // AnyDuringMigration because:  Property 'nodeType' does not exist on type\n  // 'Node | FlyoutItemInfo'.\n  if (\n    Array.isArray(flyoutDef) &&\n    flyoutDef.length > 0 &&\n    !(flyoutDef[0] as AnyDuringMigration).nodeType\n  ) {\n    // AnyDuringMigration because:  Type 'FlyoutItemInfoArray | Node[]' is not\n    // assignable to type 'FlyoutItemInfoArray'.\n    return flyoutDef as AnyDuringMigration;\n  }\n\n  // AnyDuringMigration because:  Type 'ToolboxItemInfo[] | FlyoutItemInfoArray'\n  // is not assignable to type 'FlyoutItemInfoArray'.\n  return xmlToJsonArray(flyoutDef as Node[] | NodeList) as AnyDuringMigration;\n}\n\n/**\n * Whether or not the toolbox definition has categories.\n *\n * @param toolboxJson Object holding information for creating a toolbox.\n * @returns True if the toolbox has categories.\n * @internal\n */\nexport function hasCategories(toolboxJson: ToolboxInfo | null): boolean {\n  return TEST_ONLY.hasCategoriesInternal(toolboxJson);\n}\n\n/**\n * Private version of hasCategories for stubbing in tests.\n */\nfunction hasCategoriesInternal(toolboxJson: ToolboxInfo | null): boolean {\n  if (!toolboxJson) {\n    return false;\n  }\n\n  const toolboxKind = toolboxJson['kind'];\n  if (toolboxKind) {\n    return toolboxKind === CATEGORY_TOOLBOX_KIND;\n  }\n\n  const categories = toolboxJson['contents'].filter(function (item) {\n    return item['kind'].toUpperCase() === 'CATEGORY';\n  });\n  return !!categories.length;\n}\n\n/**\n * Whether or not the category is collapsible.\n *\n * @param categoryInfo Object holing information for creating a category.\n * @returns True if the category has subcategories.\n * @internal\n */\nexport function isCategoryCollapsible(categoryInfo: CategoryInfo): boolean {\n  if (!categoryInfo || !(categoryInfo as AnyDuringMigration)['contents']) {\n    return false;\n  }\n\n  const categories = (categoryInfo as AnyDuringMigration)['contents'].filter(\n    function (item: AnyDuringMigration) {\n      return item['kind'].toUpperCase() === 'CATEGORY';\n    }\n  );\n  return !!categories.length;\n}\n\n/**\n * Parses the provided toolbox definition into a consistent format.\n *\n * @param toolboxDef The definition of the toolbox in one of its many forms.\n * @returns Object holding information for creating a toolbox.\n */\nfunction convertToToolboxJson(toolboxDef: Node): ToolboxInfo {\n  const contents = xmlToJsonArray(toolboxDef as Node | Node[]);\n  const toolboxJson = {'contents': contents};\n  if (toolboxDef instanceof Node) {\n    addAttributes(toolboxDef, toolboxJson);\n  }\n  return toolboxJson;\n}\n\n/**\n * Converts the xml for a toolbox to JSON.\n *\n * @param toolboxDef The definition of the toolbox in one of its many forms.\n * @returns A list of objects in the toolbox.\n */\nfunction xmlToJsonArray(\n  toolboxDef: Node | Node[] | NodeList\n): FlyoutItemInfoArray | ToolboxItemInfo[] {\n  const arr = [];\n  // If it is a node it will have children.\n  // AnyDuringMigration because:  Property 'childNodes' does not exist on type\n  // 'Node | NodeList | Node[]'.\n  let childNodes = (toolboxDef as AnyDuringMigration).childNodes;\n  if (!childNodes) {\n    // Otherwise the toolboxDef is an array or collection.\n    childNodes = toolboxDef;\n  }\n  for (let i = 0, child; (child = childNodes[i]); i++) {\n    if (!child.tagName) {\n      continue;\n    }\n    const obj = {};\n    const tagName = child.tagName.toUpperCase();\n    (obj as AnyDuringMigration)['kind'] = tagName;\n\n    // Store the XML for a block.\n    if (tagName === 'BLOCK') {\n      (obj as AnyDuringMigration)['blockxml'] = child;\n    } else if (child.childNodes && child.childNodes.length > 0) {\n      // Get the contents of a category\n      (obj as AnyDuringMigration)['contents'] = xmlToJsonArray(child);\n    }\n\n    // Add XML attributes to object\n    addAttributes(child, obj);\n    arr.push(obj);\n  }\n  // AnyDuringMigration because:  Type '{}[]' is not assignable to type\n  // 'ToolboxItemInfo[] | FlyoutItemInfoArray'.\n  return arr as AnyDuringMigration;\n}\n\n/**\n * Adds the attributes on the node to the given object.\n *\n * @param node The node to copy the attributes from.\n * @param obj The object to copy the attributes to.\n */\nfunction addAttributes(node: Node, obj: AnyDuringMigration) {\n  // AnyDuringMigration because:  Property 'attributes' does not exist on type\n  // 'Node'.\n  for (let j = 0; j < (node as AnyDuringMigration).attributes.length; j++) {\n    // AnyDuringMigration because:  Property 'attributes' does not exist on type\n    // 'Node'.\n    const attr = (node as AnyDuringMigration).attributes[j];\n    if (attr.nodeName.indexOf('css-') > -1) {\n      obj['cssconfig'] = obj['cssconfig'] || {};\n      obj['cssconfig'][attr.nodeName.replace('css-', '')] = attr.value;\n    } else {\n      obj[attr.nodeName] = attr.value;\n    }\n  }\n}\n\n/**\n * Parse the provided toolbox tree into a consistent DOM format.\n *\n * @param toolboxDef DOM tree of blocks, or text representation of same.\n * @returns DOM tree of blocks, or null.\n */\nexport function parseToolboxTree(\n  toolboxDef: Element | null | string\n): Element | null {\n  let parsedToolboxDef: Element | null = null;\n  if (toolboxDef) {\n    if (typeof toolboxDef === 'string') {\n      parsedToolboxDef = utilsXml.textToDom(toolboxDef);\n      if (parsedToolboxDef.nodeName.toLowerCase() !== 'xml') {\n        throw TypeError('Toolbox should be an <xml> document.');\n      }\n    } else if (toolboxDef instanceof Element) {\n      parsedToolboxDef = toolboxDef;\n    }\n  }\n  return parsedToolboxDef;\n}\n\nexport const TEST_ONLY = {\n  hasCategoriesInternal,\n};\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Extensions');\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport {FieldDropdown} from './field_dropdown.js';\nimport {MutatorIcon} from './icons/mutator_icon.js';\nimport * as parsing from './utils/parsing.js';\n\n/** The set of all registered extensions, keyed by extension name/id. */\nconst allExtensions = Object.create(null);\nexport const TEST_ONLY = {allExtensions};\n\n/**\n * Registers a new extension function. Extensions are functions that help\n * initialize blocks, usually adding dynamic behavior such as onchange\n * handlers and mutators. These are applied using Block.applyExtension(), or\n * the JSON \"extensions\" array attribute.\n *\n * @param name The name of this extension.\n * @param initFn The function to initialize an extended block.\n * @throws {Error} if the extension name is empty, the extension is already\n *     registered, or extensionFn is not a function.\n */\nexport function register(name: string, initFn: Function) {\n  if (typeof name !== 'string' || name.trim() === '') {\n    throw Error('Error: Invalid extension name \"' + name + '\"');\n  }\n  if (allExtensions[name]) {\n    throw Error('Error: Extension \"' + name + '\" is already registered.');\n  }\n  if (typeof initFn !== 'function') {\n    throw Error('Error: Extension \"' + name + '\" must be a function');\n  }\n  allExtensions[name] = initFn;\n}\n\n/**\n * Registers a new extension function that adds all key/value of mixinObj.\n *\n * @param name The name of this extension.\n * @param mixinObj The values to mix in.\n * @throws {Error} if the extension name is empty or the extension is already\n *     registered.\n */\nexport function registerMixin(name: string, mixinObj: AnyDuringMigration) {\n  if (!mixinObj || typeof mixinObj !== 'object') {\n    throw Error('Error: Mixin \"' + name + '\" must be a object');\n  }\n  register(name, function (this: Block) {\n    this.mixin(mixinObj);\n  });\n}\n\n/**\n * Registers a new extension function that adds a mutator to the block.\n * At register time this performs some basic sanity checks on the mutator.\n * The wrapper may also add a mutator dialog to the block, if both compose and\n * decompose are defined on the mixin.\n *\n * @param name The name of this mutator extension.\n * @param mixinObj The values to mix in.\n * @param opt_helperFn An optional function to apply after mixing in the object.\n * @param opt_blockList A list of blocks to appear in the flyout of the mutator\n *     dialog.\n * @throws {Error} if the mutation is invalid or can't be applied to the block.\n */\nexport function registerMutator(\n  name: string,\n  mixinObj: AnyDuringMigration,\n  opt_helperFn?: () => AnyDuringMigration,\n  opt_blockList?: string[]\n) {\n  const errorPrefix = 'Error when registering mutator \"' + name + '\": ';\n\n  checkHasMutatorProperties(errorPrefix, mixinObj);\n  const hasMutatorDialog = checkMutatorDialog(mixinObj, errorPrefix);\n\n  if (opt_helperFn && typeof opt_helperFn !== 'function') {\n    throw Error(errorPrefix + 'Extension \"' + name + '\" is not a function');\n  }\n\n  // Sanity checks passed.\n  register(name, function (this: Block) {\n    if (hasMutatorDialog) {\n      this.setMutator(new MutatorIcon(opt_blockList || [], this as BlockSvg));\n    }\n    // Mixin the object.\n    this.mixin(mixinObj);\n\n    if (opt_helperFn) {\n      opt_helperFn.apply(this);\n    }\n  });\n}\n\n/**\n * Unregisters the extension registered with the given name.\n *\n * @param name The name of the extension to unregister.\n */\nexport function unregister(name: string) {\n  if (isRegistered(name)) {\n    delete allExtensions[name];\n  } else {\n    console.warn(\n      'No extension mapping for name \"' + name + '\" found to unregister'\n    );\n  }\n}\n\n/**\n * Returns whether an extension is registered with the given name.\n *\n * @param name The name of the extension to check for.\n * @returns True if the extension is registered.  False if it is not registered.\n */\nexport function isRegistered(name: string): boolean {\n  return !!allExtensions[name];\n}\n\n/**\n * Applies an extension method to a block. This should only be called during\n * block construction.\n *\n * @param name The name of the extension.\n * @param block The block to apply the named extension to.\n * @param isMutator True if this extension defines a mutator.\n * @throws {Error} if the extension is not found.\n */\nexport function apply(name: string, block: Block, isMutator: boolean) {\n  const extensionFn = allExtensions[name];\n  if (typeof extensionFn !== 'function') {\n    throw Error('Error: Extension \"' + name + '\" not found.');\n  }\n  let mutatorProperties;\n  if (isMutator) {\n    // Fail early if the block already has mutation properties.\n    checkNoMutatorProperties(name, block);\n  } else {\n    // Record the old properties so we can make sure they don't change after\n    // applying the extension.\n    mutatorProperties = getMutatorProperties(block);\n  }\n  extensionFn.apply(block);\n\n  if (isMutator) {\n    const errorPrefix = 'Error after applying mutator \"' + name + '\": ';\n    checkHasMutatorProperties(errorPrefix, block);\n  } else {\n    if (\n      !mutatorPropertiesMatch(mutatorProperties as AnyDuringMigration[], block)\n    ) {\n      throw Error(\n        'Error when applying extension \"' +\n          name +\n          '\": ' +\n          'mutation properties changed when applying a non-mutator extension.'\n      );\n    }\n  }\n}\n\n/**\n * Check that the given block does not have any of the four mutator properties\n * defined on it.  This function should be called before applying a mutator\n * extension to a block, to make sure we are not overwriting properties.\n *\n * @param mutationName The name of the mutation to reference in error messages.\n * @param block The block to check.\n * @throws {Error} if any of the properties already exist on the block.\n */\nfunction checkNoMutatorProperties(mutationName: string, block: Block) {\n  const properties = getMutatorProperties(block);\n  if (properties.length) {\n    throw Error(\n      'Error: tried to apply mutation \"' +\n        mutationName +\n        '\" to a block that already has mutator functions.' +\n        '  Block id: ' +\n        block.id\n    );\n  }\n}\n\n/**\n * Checks if the given object has both the 'mutationToDom' and 'domToMutation'\n * functions.\n *\n * @param object The object to check.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} if the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkXmlHooks(\n  object: AnyDuringMigration,\n  errorPrefix: string\n): boolean {\n  return checkHasFunctionPair(\n    object.mutationToDom,\n    object.domToMutation,\n    errorPrefix + ' mutationToDom/domToMutation'\n  );\n}\n/**\n * Checks if the given object has both the 'saveExtraState' and 'loadExtraState'\n * functions.\n *\n * @param object The object to check.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} if the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkJsonHooks(\n  object: AnyDuringMigration,\n  errorPrefix: string\n): boolean {\n  return checkHasFunctionPair(\n    object.saveExtraState,\n    object.loadExtraState,\n    errorPrefix + ' saveExtraState/loadExtraState'\n  );\n}\n\n/**\n * Checks if the given object has both the 'compose' and 'decompose' functions.\n *\n * @param object The object to check.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} if the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkMutatorDialog(\n  object: AnyDuringMigration,\n  errorPrefix: string\n): boolean {\n  return checkHasFunctionPair(\n    object.compose,\n    object.decompose,\n    errorPrefix + ' compose/decompose'\n  );\n}\n\n/**\n * Checks that both or neither of the given functions exist and that they are\n * indeed functions.\n *\n * @param func1 The first function in the pair.\n * @param func2 The second function in the pair.\n * @param errorPrefix The string to prepend to any error message.\n * @returns True if the object has both functions.  False if it has neither\n *     function.\n * @throws {Error} If the object has only one of the functions, or either is not\n *     actually a function.\n */\nfunction checkHasFunctionPair(\n  func1: AnyDuringMigration,\n  func2: AnyDuringMigration,\n  errorPrefix: string\n): boolean {\n  if (func1 && func2) {\n    if (typeof func1 !== 'function' || typeof func2 !== 'function') {\n      throw Error(errorPrefix + ' must be a function');\n    }\n    return true;\n  } else if (!func1 && !func2) {\n    return false;\n  }\n  throw Error(errorPrefix + 'Must have both or neither functions');\n}\n\n/**\n * Checks that the given object required mutator properties.\n *\n * @param errorPrefix The string to prepend to any error message.\n * @param object The object to inspect.\n */\nfunction checkHasMutatorProperties(\n  errorPrefix: string,\n  object: AnyDuringMigration\n) {\n  const hasXmlHooks = checkXmlHooks(object, errorPrefix);\n  const hasJsonHooks = checkJsonHooks(object, errorPrefix);\n  if (!hasXmlHooks && !hasJsonHooks) {\n    throw Error(\n      errorPrefix +\n        'Mutations must contain either XML hooks, or JSON hooks, or both'\n    );\n  }\n  // A block with a mutator isn't required to have a mutation dialog, but\n  // it should still have both or neither of compose and decompose.\n  checkMutatorDialog(object, errorPrefix);\n}\n\n/**\n * Get a list of values of mutator properties on the given block.\n *\n * @param block The block to inspect.\n * @returns A list with all of the defined properties, which should be\n *     functions, but may be anything other than undefined.\n */\nfunction getMutatorProperties(block: Block): AnyDuringMigration[] {\n  const result = [];\n  // List each function explicitly by reference to allow for renaming\n  // during compilation.\n  if (block.domToMutation !== undefined) {\n    result.push(block.domToMutation);\n  }\n  if (block.mutationToDom !== undefined) {\n    result.push(block.mutationToDom);\n  }\n  if (block.saveExtraState !== undefined) {\n    result.push(block.saveExtraState);\n  }\n  if (block.loadExtraState !== undefined) {\n    result.push(block.loadExtraState);\n  }\n  if (block.compose !== undefined) {\n    result.push(block.compose);\n  }\n  if (block.decompose !== undefined) {\n    result.push(block.decompose);\n  }\n  return result;\n}\n\n/**\n * Check that the current mutator properties match a list of old mutator\n * properties.  This should be called after applying a non-mutator extension,\n * to verify that the extension didn't change properties it shouldn't.\n *\n * @param oldProperties The old values to compare to.\n * @param block The block to inspect for new values.\n * @returns True if the property lists match.\n */\nfunction mutatorPropertiesMatch(\n  oldProperties: AnyDuringMigration[],\n  block: Block\n): boolean {\n  const newProperties = getMutatorProperties(block);\n  if (newProperties.length !== oldProperties.length) {\n    return false;\n  }\n  for (let i = 0; i < newProperties.length; i++) {\n    if (oldProperties[i] !== newProperties[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Calls a function after the page has loaded, possibly immediately.\n *\n * @param fn Function to run.\n * @throws Error Will throw if no global document can be found (e.g., Node.js).\n * @internal\n */\nexport function runAfterPageLoad(fn: () => void) {\n  if (typeof document !== 'object') {\n    throw Error('runAfterPageLoad() requires browser document.');\n  }\n  if (document.readyState === 'complete') {\n    fn(); // Page has already loaded. Call immediately.\n  } else {\n    // Poll readyState.\n    const readyStateCheckInterval = setInterval(function () {\n      if (document.readyState === 'complete') {\n        clearInterval(readyStateCheckInterval);\n        fn();\n      }\n    }, 10);\n  }\n}\n\n/**\n * Builds an extension function that will map a dropdown value to a tooltip\n * string.\n *\n * This method includes multiple checks to ensure tooltips, dropdown options,\n * and message references are aligned. This aims to catch errors as early as\n * possible, without requiring developers to manually test tooltips under each\n * option. After the page is loaded, each tooltip text string will be checked\n * for matching message keys in the internationalized string table. Deferring\n * this until the page is loaded decouples loading dependencies. Later, upon\n * loading the first block of any given type, the extension will validate every\n * dropdown option has a matching tooltip in the lookupTable.  Errors are\n * reported as warnings in the console, and are never fatal.\n *\n * @param dropdownName The name of the field whose value is the key to the\n *     lookup table.\n * @param lookupTable The table of field values to tooltip text.\n * @returns The extension function.\n */\nexport function buildTooltipForDropdown(\n  dropdownName: string,\n  lookupTable: {[key: string]: string}\n): Function {\n  // List of block types already validated, to minimize duplicate warnings.\n  const blockTypesChecked: AnyDuringMigration[] = [];\n\n  // Check the tooltip string messages for invalid references.\n  // Wait for load, in case Blockly.Msg is not yet populated.\n  // runAfterPageLoad() does not run in a Node.js environment due to lack\n  // of document object, in which case skip the validation.\n  if (typeof document === 'object') {\n    // Relies on document.readyState\n    runAfterPageLoad(function () {\n      for (const key in lookupTable) {\n        // Will print warnings if reference is missing.\n        parsing.checkMessageReferences(lookupTable[key]);\n      }\n    });\n  }\n\n  /** The actual extension. */\n  function extensionFn(this: Block) {\n    if (this.type && blockTypesChecked.indexOf(this.type) === -1) {\n      checkDropdownOptionsInTable(this, dropdownName, lookupTable);\n      blockTypesChecked.push(this.type);\n    }\n\n    this.setTooltip(\n      function (this: Block) {\n        const value = String(this.getFieldValue(dropdownName));\n        let tooltip = lookupTable[value];\n        if (tooltip === null) {\n          if (blockTypesChecked.indexOf(this.type) === -1) {\n            // Warn for missing values on generated tooltips.\n            let warning =\n              'No tooltip mapping for value ' +\n              value +\n              ' of field ' +\n              dropdownName;\n            if (this.type !== null) {\n              warning += ' of block type ' + this.type;\n            }\n            console.warn(warning + '.');\n          }\n        } else {\n          tooltip = parsing.replaceMessageReferences(tooltip);\n        }\n        return tooltip;\n      }.bind(this)\n    );\n  }\n  return extensionFn;\n}\n\n/**\n * Checks all options keys are present in the provided string lookup table.\n * Emits console warnings when they are not.\n *\n * @param block The block containing the dropdown\n * @param dropdownName The name of the dropdown\n * @param lookupTable The string lookup table\n */\nfunction checkDropdownOptionsInTable(\n  block: Block,\n  dropdownName: string,\n  lookupTable: {[key: string]: string}\n) {\n  // Validate all dropdown options have values.\n  const dropdown = block.getField(dropdownName);\n  if (dropdown instanceof FieldDropdown && !dropdown.isOptionListDynamic()) {\n    const options = dropdown.getOptions();\n    for (let i = 0; i < options.length; i++) {\n      const optionKey = options[i][1]; // label, then value\n      if (lookupTable[optionKey] === null) {\n        console.warn(\n          'No tooltip mapping for value ' +\n            optionKey +\n            ' of field ' +\n            dropdownName +\n            ' of block type ' +\n            block.type\n        );\n      }\n    }\n  }\n}\n\n/**\n * Builds an extension function that will install a dynamic tooltip. The\n * tooltip message should include the string '%1' and that string will be\n * replaced with the text of the named field.\n *\n * @param msgTemplate The template form to of the message text, with %1\n *     placeholder.\n * @param fieldName The field with the replacement text.\n * @returns The extension function.\n */\nexport function buildTooltipWithFieldText(\n  msgTemplate: string,\n  fieldName: string\n): Function {\n  // Check the tooltip string messages for invalid references.\n  // Wait for load, in case Blockly.Msg is not yet populated.\n  // runAfterPageLoad() does not run in a Node.js environment due to lack\n  // of document object, in which case skip the validation.\n  if (typeof document === 'object') {\n    // Relies on document.readyState\n    runAfterPageLoad(function () {\n      // Will print warnings if reference is missing.\n      parsing.checkMessageReferences(msgTemplate);\n    });\n  }\n\n  /** The actual extension. */\n  function extensionFn(this: Block) {\n    this.setTooltip(\n      function (this: Block) {\n        const field = this.getField(fieldName);\n        return parsing\n          .replaceMessageReferences(msgTemplate)\n          .replace('%1', field ? field.getText() : '');\n      }.bind(this)\n    );\n  }\n  return extensionFn;\n}\n\n/**\n * Configures the tooltip to mimic the parent block when connected. Otherwise,\n * uses the tooltip text at the time this extension is initialized. This takes\n * advantage of the fact that all other values from JSON are initialized before\n * extensions.\n */\nfunction extensionParentTooltip(this: Block) {\n  const tooltipWhenNotConnected = this.tooltip;\n  this.setTooltip(\n    function (this: Block) {\n      const parent = this.getParent();\n      return (\n        (parent && parent.getInputsInline() && parent.tooltip) ||\n        tooltipWhenNotConnected\n      );\n    }.bind(this)\n  );\n}\nregister('parent_tooltip_when_inline', extensionParentTooltip);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.array');\n\n/**\n * Removes the first occurrence of a particular value from an array.\n *\n * @param arr Array from which to remove value.\n * @param value Value to remove.\n * @returns True if an element was removed.\n * @internal\n */\nexport function removeElem<T>(arr: Array<T>, value: T): boolean {\n  const i = arr.indexOf(value);\n  if (i === -1) {\n    return false;\n  }\n  arr.splice(i, 1);\n  return true;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.svgPaths');\n\n/**\n * Create a string representing the given x, y pair.  It does not matter whether\n * the coordinate is relative or absolute.  The result has leading\n * and trailing spaces, and separates the x and y coordinates with a comma but\n * no space.\n *\n * @param x The x coordinate.\n * @param y The y coordinate.\n * @returns A string of the format ' x,y '\n */\nexport function point(x: number, y: number): string {\n  return ' ' + x + ',' + y + ' ';\n}\n\n/**\n * Draw a cubic or quadratic curve.  See\n * developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#Cubic_B%C3%A9zier_Curve\n * These coordinates are unitless and hence in the user coordinate system.\n *\n * @param command The command to use.\n *     Should be one of: c, C, s, S, q, Q.\n * @param points  An array containing all of the points to pass to the curve\n *     command, in order.  The points are represented as strings of the format '\n *     x, y '.\n * @returns A string defining one or more Bezier curves.  See the MDN\n *     documentation for exact format.\n */\nexport function curve(command: string, points: string[]): string {\n  return ' ' + command + points.join('');\n}\n\n/**\n * Move the cursor to the given position without drawing a line.\n * The coordinates are absolute.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param x The absolute x coordinate.\n * @param y The absolute y coordinate.\n * @returns A string of the format ' M x,y '\n */\nexport function moveTo(x: number, y: number): string {\n  return ' M ' + x + ',' + y + ' ';\n}\n\n/**\n * Move the cursor to the given position without drawing a line.\n * Coordinates are relative.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param dx The relative x coordinate.\n * @param dy The relative y coordinate.\n * @returns A string of the format ' m dx,dy '\n */\nexport function moveBy(dx: number, dy: number): string {\n  return ' m ' + dx + ',' + dy + ' ';\n}\n\n/**\n * Draw a line from the current point to the end point, which is the current\n * point shifted by dx along the x-axis and dy along the y-axis.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param dx The relative x coordinate.\n * @param dy The relative y coordinate.\n * @returns A string of the format ' l dx,dy '\n */\nexport function lineTo(dx: number, dy: number): string {\n  return ' l ' + dx + ',' + dy + ' ';\n}\n\n/**\n * Draw multiple lines connecting all of the given points in order.  This is\n * equivalent to a series of 'l' commands.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths#Line_commands\n *\n * @param points An array containing all of the points to draw lines to, in\n *     order.  The points are represented as strings of the format ' dx,dy '.\n * @returns A string of the format ' l (dx,dy)+ '\n */\nexport function line(points: string[]): string {\n  return ' l' + points.join('');\n}\n\n/**\n * Draw a horizontal or vertical line.\n * The first argument specifies the direction and whether the given position is\n * relative or absolute.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#LineTo_path_commands\n *\n * @param command The command to prepend to the coordinate.  This should be one\n *     of: V, v, H, h.\n * @param val The coordinate to pass to the command.  It may be absolute or\n *     relative.\n * @returns A string of the format ' command val '\n */\nexport function lineOnAxis(command: string, val: number): string {\n  return ' ' + command + ' ' + val + ' ';\n}\n\n/**\n * Draw an elliptical arc curve.\n * These coordinates are unitless and hence in the user coordinate system.\n * See developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#Elliptical_Arc_Curve\n *\n * @param command The command string.  Either 'a' or 'A'.\n * @param flags The flag string.  See the MDN documentation for a description\n *     and examples.\n * @param radius The radius of the arc to draw.\n * @param point The point to move the cursor to after drawing the arc, specified\n *     either in absolute or relative coordinates depending on the command.\n * @returns A string of the format 'command radius radius flags point'\n */\nexport function arc(\n  command: string,\n  flags: string,\n  radius: number,\n  point: string\n): string {\n  return command + ' ' + radius + ' ' + radius + ' ' + flags + point;\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport type {IIcon} from '../interfaces/i_icon.js';\nimport * as registry from '../registry.js';\nimport {IconType} from './icon_types.js';\n\n/**\n * Registers the given icon so that it can be deserialized.\n *\n * @param type The type of the icon to register. This should be the same string\n *     that is returned from its `getType` method.\n * @param iconConstructor The icon class/constructor to register.\n */\nexport function register(\n  type: IconType<IIcon>,\n  iconConstructor: new (block: Block) => IIcon\n) {\n  registry.register(registry.Type.ICON, type.toString(), iconConstructor);\n}\n\n/**\n * Unregisters the icon associated with the given type.\n *\n * @param type The type of the icon to unregister.\n */\nexport function unregister(type: string) {\n  registry.unregister(registry.Type.ICON, type);\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockAnimations');\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\n\n/** A bounding box for a cloned block. */\ninterface CloneRect {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\n/** PID of disconnect UI animation.  There can only be one at a time. */\nlet disconnectPid: ReturnType<typeof setTimeout> | null = null;\n\n/** The wobbling block.  There can only be one at a time. */\nlet wobblingBlock: BlockSvg | null = null;\n\n/**\n * Play some UI effects (sound, animation) when disposing of a block.\n *\n * @param block The block being disposed of.\n * @internal\n */\nexport function disposeUiEffect(block: BlockSvg) {\n  // Disposing is going to take so long the animation won't play anyway.\n  if (block.getDescendants(false).length > 100) return;\n\n  const workspace = block.workspace;\n  const svgGroup = block.getSvgRoot();\n  workspace.getAudioManager().play('delete');\n\n  const xy = workspace.getSvgXY(svgGroup);\n  // Deeply clone the current block.\n  const clone: SVGGElement = svgGroup.cloneNode(true) as SVGGElement;\n  clone.setAttribute('transform', 'translate(' + xy.x + ',' + xy.y + ')');\n  workspace.getParentSvg().appendChild(clone);\n  const cloneRect = {\n    'x': xy.x,\n    'y': xy.y,\n    'width': block.width,\n    'height': block.height,\n  };\n  disposeUiStep(clone, cloneRect, workspace.RTL, new Date(), workspace.scale);\n}\n/**\n * Animate a cloned block and eventually dispose of it.\n * This is a class method, not an instance method since the original block has\n * been destroyed and is no longer accessible.\n *\n * @param clone SVG element to animate and dispose of.\n * @param rect Starting rect of the clone.\n * @param rtl True if RTL, false if LTR.\n * @param start Date of animation's start.\n * @param workspaceScale Scale of workspace.\n */\nfunction disposeUiStep(\n  clone: Element,\n  rect: CloneRect,\n  rtl: boolean,\n  start: Date,\n  workspaceScale: number\n) {\n  const ms = new Date().getTime() - start.getTime();\n  const percent = ms / 150;\n  if (percent > 1) {\n    dom.removeNode(clone);\n  } else {\n    const x =\n      rect.x + (((rtl ? -1 : 1) * rect.width * workspaceScale) / 2) * percent;\n    const y = rect.y + rect.height * workspaceScale * percent;\n    const scale = (1 - percent) * workspaceScale;\n    clone.setAttribute(\n      'transform',\n      'translate(' + x + ',' + y + ')' + ' scale(' + scale + ')'\n    );\n    setTimeout(disposeUiStep, 10, clone, rect, rtl, start, workspaceScale);\n  }\n}\n\n/**\n * Play some UI effects (sound, ripple) after a connection has been established.\n *\n * @param block The block being connected.\n * @internal\n */\nexport function connectionUiEffect(block: BlockSvg) {\n  const workspace = block.workspace;\n  const scale = workspace.scale;\n  workspace.getAudioManager().play('click');\n  if (scale < 1) {\n    return; // Too small to care about visual effects.\n  }\n  // Determine the absolute coordinates of the inferior block.\n  const xy = workspace.getSvgXY(block.getSvgRoot());\n  // Offset the coordinates based on the two connection types, fix scale.\n  if (block.outputConnection) {\n    xy.x += (block.RTL ? 3 : -3) * scale;\n    xy.y += 13 * scale;\n  } else if (block.previousConnection) {\n    xy.x += (block.RTL ? -23 : 23) * scale;\n    xy.y += 3 * scale;\n  }\n  const ripple = dom.createSvgElement(\n    Svg.CIRCLE,\n    {\n      'cx': xy.x,\n      'cy': xy.y,\n      'r': 0,\n      'fill': 'none',\n      'stroke': '#888',\n      'stroke-width': 10,\n    },\n    workspace.getParentSvg()\n  );\n  // Start the animation.\n  connectionUiStep(ripple, new Date(), scale);\n}\n\n/**\n * Expand a ripple around a connection.\n *\n * @param ripple Element to animate.\n * @param start Date of animation's start.\n * @param scale Scale of workspace.\n */\nfunction connectionUiStep(ripple: SVGElement, start: Date, scale: number) {\n  const ms = new Date().getTime() - start.getTime();\n  const percent = ms / 150;\n  if (percent > 1) {\n    dom.removeNode(ripple);\n  } else {\n    ripple.setAttribute('r', String(percent * 25 * scale));\n    ripple.style.opacity = String(1 - percent);\n    disconnectPid = setTimeout(connectionUiStep, 10, ripple, start, scale);\n  }\n}\n\n/**\n * Play some UI effects (sound, animation) when disconnecting a block.\n *\n * @param block The block being disconnected.\n * @internal\n */\nexport function disconnectUiEffect(block: BlockSvg) {\n  disconnectUiStop();\n  block.workspace.getAudioManager().play('disconnect');\n  if (block.workspace.scale < 1) {\n    return; // Too small to care about visual effects.\n  }\n  // Horizontal distance for bottom of block to wiggle.\n  const DISPLACEMENT = 10;\n  // Scale magnitude of skew to height of block.\n  const height = block.getHeightWidth().height;\n  let magnitude = (Math.atan(DISPLACEMENT / height) / Math.PI) * 180;\n  if (!block.RTL) {\n    magnitude *= -1;\n  }\n  // Start the animation.\n  wobblingBlock = block;\n  disconnectUiStep(block, magnitude, new Date());\n}\n\n/**\n * Animate a brief wiggle of a disconnected block.\n *\n * @param block Block to animate.\n * @param magnitude Maximum degrees skew (reversed for RTL).\n * @param start Date of animation's start.\n */\nfunction disconnectUiStep(block: BlockSvg, magnitude: number, start: Date) {\n  const DURATION = 200; // Milliseconds.\n  const WIGGLES = 3; // Half oscillations.\n\n  const ms = new Date().getTime() - start.getTime();\n  const percent = ms / DURATION;\n\n  let skew = '';\n  if (percent <= 1) {\n    const val = Math.round(\n      Math.sin(percent * Math.PI * WIGGLES) * (1 - percent) * magnitude\n    );\n    skew = `skewX(${val})`;\n    disconnectPid = setTimeout(disconnectUiStep, 10, block, magnitude, start);\n  }\n\n  block\n    .getSvgRoot()\n    .setAttribute('transform', `${block.getTranslation()} ${skew}`);\n}\n\n/**\n * Stop the disconnect UI animation immediately.\n *\n * @internal\n */\nexport function disconnectUiStop() {\n  if (!wobblingBlock) return;\n  if (disconnectPid) {\n    clearTimeout(disconnectPid);\n    disconnectPid = null;\n  }\n  wobblingBlock\n    .getSvgRoot()\n    .setAttribute('transform', wobblingBlock.getTranslation());\n  wobblingBlock = null;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.bumpObjects');\n\nimport type {BlockSvg} from './block_svg.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BlockCreate} from './events/events_block_create.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport type {CommentCreate} from './events/events_comment_create.js';\nimport type {CommentMove} from './events/events_comment_move.js';\nimport type {ViewportChange} from './events/events_viewport.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {ContainerRegion} from './metrics_manager.js';\nimport * as mathUtils from './utils/math.js';\nimport type {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Bumps the given object that has passed out of bounds.\n *\n * @param workspace The workspace containing the object.\n * @param bounds The region to bump an object into. For example, pass\n *     ScrollMetrics to bump a block into the scrollable region of the\n *     workspace, or pass ViewMetrics to bump a block into the visible region of\n *     the workspace. This should be specified in workspace coordinates.\n * @param object The object to bump.\n * @returns True if object was bumped.\n */\nfunction bumpObjectIntoBounds(\n  workspace: WorkspaceSvg,\n  bounds: ContainerRegion,\n  object: IBoundedElement\n): boolean {\n  // Compute new top/left position for object.\n  const objectMetrics = object.getBoundingRectangle();\n  const height = objectMetrics.bottom - objectMetrics.top;\n  const width = objectMetrics.right - objectMetrics.left;\n\n  const topClamp = bounds.top;\n  const boundsBottom = bounds.top + bounds.height;\n  const bottomClamp = boundsBottom - height;\n  // If the object is taller than the workspace we want to\n  // top-align the block\n  const newYPosition = mathUtils.clamp(\n    topClamp,\n    objectMetrics.top,\n    bottomClamp\n  );\n  const deltaY = newYPosition - objectMetrics.top;\n\n  // Note: Even in RTL mode the \"anchor\" of the object is the\n  // top-left corner of the object.\n  let leftClamp = bounds.left;\n  const boundsRight = bounds.left + bounds.width;\n  let rightClamp = boundsRight - width;\n  if (workspace.RTL) {\n    // If the object is wider than the workspace and we're in RTL\n    // mode we want to right-align the block, which means setting\n    // the left clamp to match.\n    leftClamp = Math.min(rightClamp, leftClamp);\n  } else {\n    // If the object is wider than the workspace and we're in LTR\n    // mode we want to left-align the block, which means setting\n    // the right clamp to match.\n    rightClamp = Math.max(leftClamp, rightClamp);\n  }\n  const newXPosition = mathUtils.clamp(\n    leftClamp,\n    objectMetrics.left,\n    rightClamp\n  );\n  const deltaX = newXPosition - objectMetrics.left;\n\n  if (deltaX || deltaY) {\n    object.moveBy(deltaX, deltaY, ['inbounds']);\n    return true;\n  }\n  return false;\n}\nexport const bumpIntoBounds = bumpObjectIntoBounds;\n\n/**\n * Creates a handler for bumping objects when they cross fixed bounds.\n *\n * @param workspace The workspace to handle.\n * @returns The event handler.\n */\nexport function bumpIntoBoundsHandler(\n  workspace: WorkspaceSvg\n): (p1: Abstract) => void {\n  return (e) => {\n    const metricsManager = workspace.getMetricsManager();\n    if (!metricsManager.hasFixedEdges() || workspace.isDragging()) {\n      return;\n    }\n\n    if (eventUtils.BUMP_EVENTS.indexOf(e.type ?? '') !== -1) {\n      const scrollMetricsInWsCoords = metricsManager.getScrollMetrics(true);\n\n      // Triggered by move/create event\n      const object = extractObjectFromEvent(\n        workspace,\n        e as eventUtils.BumpEvent\n      );\n      if (!object) {\n        return;\n      }\n      // Handle undo.\n      const existingGroup = eventUtils.getGroup() || false;\n      eventUtils.setGroup(e.group);\n\n      const wasBumped = bumpObjectIntoBounds(\n        workspace,\n        scrollMetricsInWsCoords,\n        object as IBoundedElement\n      );\n\n      if (wasBumped && !e.group) {\n        console.warn(\n          'Moved object in bounds but there was no' +\n            ' event group. This may break undo.'\n        );\n      }\n      eventUtils.setGroup(existingGroup);\n    } else if (e.type === eventUtils.VIEWPORT_CHANGE) {\n      const viewportEvent = e as ViewportChange;\n      if (\n        viewportEvent.scale &&\n        viewportEvent.oldScale &&\n        viewportEvent.scale > viewportEvent.oldScale\n      ) {\n        bumpTopObjectsIntoBounds(workspace);\n      }\n    }\n  };\n}\n\n/**\n * Extracts the object from the given event.\n *\n * @param workspace The workspace the event originated\n *    from.\n * @param e An event containing an object.\n * @returns The extracted\n *    object.\n */\nfunction extractObjectFromEvent(\n  workspace: WorkspaceSvg,\n  e: eventUtils.BumpEvent\n): BlockSvg | null | WorkspaceCommentSvg {\n  let object = null;\n  switch (e.type) {\n    case eventUtils.BLOCK_CREATE:\n    case eventUtils.BLOCK_MOVE:\n      object = workspace.getBlockById((e as BlockCreate | BlockMove).blockId!);\n      if (object) {\n        object = object.getRootBlock();\n      }\n      break;\n    case eventUtils.COMMENT_CREATE:\n    case eventUtils.COMMENT_MOVE:\n      object = workspace.getCommentById(\n        (e as CommentCreate | CommentMove).commentId!\n      ) as WorkspaceCommentSvg | null;\n      break;\n  }\n  return object;\n}\n\n/**\n * Bumps the top objects in the given workspace into bounds.\n *\n * @param workspace The workspace.\n */\nexport function bumpTopObjectsIntoBounds(workspace: WorkspaceSvg) {\n  const metricsManager = workspace.getMetricsManager();\n  if (!metricsManager.hasFixedEdges() || workspace.isDragging()) {\n    return;\n  }\n\n  const scrollMetricsInWsCoords = metricsManager.getScrollMetrics(true);\n  const topBlocks = workspace.getTopBoundedElements();\n  for (let i = 0, block; (block = topBlocks[i]); i++) {\n    bumpObjectIntoBounds(workspace, scrollMetricsInWsCoords, block);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {BlockSvg} from './block_svg.js';\nimport {Coordinate} from './utils/coordinate.js';\n\n/** The set of all blocks in need of rendering which don't have parents. */\nconst rootBlocks = new Set<BlockSvg>();\n\n/** The set of all blocks in need of rendering. */\nlet dirtyBlocks = new WeakSet<BlockSvg>();\n\n/**\n * The promise which resolves after the current set of renders is completed. Or\n * null if there are no queued renders.\n *\n * Stored so that we can return it from afterQueuedRenders.\n */\nlet afterRendersPromise: Promise<void> | null = null;\n\n/**\n * Registers that the given block and all of its parents need to be rerendered,\n * and registers a callback to do so after a delay, to allowf or batching.\n *\n * @param block The block to rerender.\n * @returns A promise that resolves after the currently queued renders have been\n *     completed. Used for triggering other behavior that relies on updated\n *     size/position location for the block.\n * @internal\n */\nexport function queueRender(block: BlockSvg): Promise<void> {\n  queueBlock(block);\n  if (!afterRendersPromise) {\n    afterRendersPromise = new Promise((resolve) => {\n      window.requestAnimationFrame(() => {\n        doRenders();\n        resolve();\n      });\n    });\n  }\n  return afterRendersPromise;\n}\n\n/**\n * @returns A promise that resolves after the currently queued renders have\n *     been completed.\n */\nexport function finishQueuedRenders(): Promise<void> {\n  // If there are no queued renders, return a resolved promise so `then`\n  // callbacks trigger immediately.\n  return afterRendersPromise ? afterRendersPromise : Promise.resolve();\n}\n\n/**\n * Adds the given block and its parents to the render queue. Adds the root block\n * to the list of root blocks.\n *\n * @param block The block to queue.\n */\nfunction queueBlock(block: BlockSvg) {\n  dirtyBlocks.add(block);\n  const parent = block.getParent();\n  if (parent) {\n    queueBlock(parent);\n  } else {\n    rootBlocks.add(block);\n  }\n}\n\n/**\n * Rerenders all of the blocks in the queue.\n */\nfunction doRenders() {\n  const workspaces = new Set([...rootBlocks].map((block) => block.workspace));\n  for (const block of rootBlocks) {\n    // No need to render a dead block.\n    if (block.isDisposed()) continue;\n    // A render for this block may have been queued, and then the block was\n    // connected to a parent, so it is no longer a root block.\n    // Rendering will be triggered through the real root block.\n    if (block.getParent()) continue;\n\n    renderBlock(block);\n    const blockOrigin = block.getRelativeToSurfaceXY();\n    updateConnectionLocations(block, blockOrigin);\n    updateIconLocations(block, blockOrigin);\n  }\n  for (const workspace of workspaces) {\n    workspace.resizeContents();\n  }\n\n  rootBlocks.clear();\n  dirtyBlocks = new Set();\n  afterRendersPromise = null;\n}\n\n/**\n * Recursively renders all of the dirty children of the given block, and\n * then renders the block.\n *\n * @param block The block to rerender.\n */\nfunction renderBlock(block: BlockSvg) {\n  if (!dirtyBlocks.has(block)) return;\n  for (const child of block.getChildren(false)) {\n    renderBlock(child);\n  }\n  block.renderEfficiently();\n}\n\n/**\n * Updates the connection database with the new locations of all of the\n * connections that are children of the given block.\n *\n * @param block The block to update the connection locations of.\n * @param blockOrigin The top left of the given block in workspace coordinates.\n */\nfunction updateConnectionLocations(block: BlockSvg, blockOrigin: Coordinate) {\n  for (const conn of block.getConnections_(false)) {\n    const moved = conn.moveToOffset(blockOrigin);\n    const target = conn.targetBlock();\n    if (!conn.isSuperior()) continue;\n    if (!target) continue;\n    if (moved || dirtyBlocks.has(target)) {\n      updateConnectionLocations(\n        target,\n        Coordinate.sum(blockOrigin, target.relativeCoords)\n      );\n    }\n  }\n}\n\n/**\n * Updates all icons that are children of the given block with their new\n * locations.\n *\n * @param block The block to update the icon locations of.\n */\nfunction updateIconLocations(block: BlockSvg, blockOrigin: Coordinate) {\n  if (!block.getIcons) return;\n  for (const icon of block.getIcons()) {\n    icon.onLocationChange(blockOrigin);\n  }\n  for (const child of block.getChildren(false)) {\n    updateIconLocations(\n      child,\n      Coordinate.sum(blockOrigin, child.relativeCoords)\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for dragging a block visually.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.BlockDragger');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_drag.js';\n\nimport * as blockAnimation from './block_animations.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as common from './common.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Icon} from './icons/icon.js';\nimport {InsertionMarkerManager} from './insertion_marker_manager.js';\nimport type {IBlockDragger} from './interfaces/i_block_dragger.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport * as registry from './registry.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {hasBubble} from './interfaces/i_has_bubble.js';\n\n/**\n * Class for a block dragger.  It moves blocks around the workspace when they\n * are being dragged by a mouse or touch.\n */\nexport class BlockDragger implements IBlockDragger {\n  /** The top block in the stack that is being dragged. */\n  protected draggingBlock_: BlockSvg;\n  protected draggedConnectionManager_: InsertionMarkerManager;\n\n  /** The workspace on which the block is being dragged. */\n  protected workspace_: WorkspaceSvg;\n\n  /** Which drag area the mouse pointer is over, if any. */\n  private dragTarget_: IDragTarget | null = null;\n\n  /** Whether the block would be deleted if dropped immediately. */\n  protected wouldDeleteBlock_ = false;\n  protected startXY_: Coordinate;\n  protected dragIconData_: IconPositionData[];\n\n  /**\n   * @param block The block to drag.\n   * @param workspace The workspace to drag on.\n   */\n  constructor(block: BlockSvg, workspace: WorkspaceSvg) {\n    this.draggingBlock_ = block;\n\n    /** Object that keeps track of connections on dragged blocks. */\n    this.draggedConnectionManager_ = new InsertionMarkerManager(\n      this.draggingBlock_\n    );\n\n    this.workspace_ = workspace;\n\n    /**\n     * The location of the top left corner of the dragging block at the\n     * beginning of the drag in workspace coordinates.\n     */\n    this.startXY_ = this.draggingBlock_.getRelativeToSurfaceXY();\n\n    /**\n     * A list of all of the icons (comment, warning, and mutator) that are\n     * on this block and its descendants.  Moving an icon moves the bubble that\n     * extends from it if that bubble is open.\n     */\n    this.dragIconData_ = initIconData(block, this.startXY_);\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    this.dragIconData_.length = 0;\n\n    if (this.draggedConnectionManager_) {\n      this.draggedConnectionManager_.dispose();\n    }\n  }\n\n  /**\n   * Start dragging a block.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @param healStack Whether or not to heal the stack after disconnecting.\n   */\n  startDrag(currentDragDeltaXY: Coordinate, healStack: boolean) {\n    if (!eventUtils.getGroup()) {\n      eventUtils.setGroup(true);\n    }\n    this.fireDragStartEvent_();\n\n    // Mutators don't have the same type of z-ordering as the normal workspace\n    // during a drag.  They have to rely on the order of the blocks in the SVG.\n    // For performance reasons that usually happens at the end of a drag,\n    // but do it at the beginning for mutators.\n    if (this.workspace_.isMutator) {\n      this.draggingBlock_.bringToFront();\n    }\n\n    // During a drag there may be a lot of rerenders, but not field changes.\n    // Turn the cache on so we don't do spurious remeasures during the drag.\n    dom.startTextWidthCache();\n    this.workspace_.setResizesEnabled(false);\n    blockAnimation.disconnectUiStop();\n\n    if (this.shouldDisconnect_(healStack)) {\n      this.disconnectBlock_(healStack, currentDragDeltaXY);\n    }\n    this.draggingBlock_.setDragging(true);\n  }\n\n  /**\n   * Whether or not we should disconnect the block when a drag is started.\n   *\n   * @param healStack Whether or not to heal the stack after disconnecting.\n   * @returns True to disconnect the block, false otherwise.\n   */\n  protected shouldDisconnect_(healStack: boolean): boolean {\n    return !!(\n      this.draggingBlock_.getParent() ||\n      (healStack &&\n        this.draggingBlock_.nextConnection &&\n        this.draggingBlock_.nextConnection.targetBlock())\n    );\n  }\n\n  /**\n   * Disconnects the block and moves it to a new location.\n   *\n   * @param healStack Whether or not to heal the stack after disconnecting.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   */\n  protected disconnectBlock_(\n    healStack: boolean,\n    currentDragDeltaXY: Coordinate\n  ) {\n    this.draggingBlock_.unplug(healStack);\n    const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n    const newLoc = Coordinate.sum(this.startXY_, delta);\n\n    this.draggingBlock_.translate(newLoc.x, newLoc.y);\n    blockAnimation.disconnectUiEffect(this.draggingBlock_);\n    this.draggedConnectionManager_.updateAvailableConnections();\n  }\n\n  /** Fire a UI event at the start of a block drag. */\n  protected fireDragStartEvent_() {\n    const event = new (eventUtils.get(eventUtils.BLOCK_DRAG))(\n      this.draggingBlock_,\n      true,\n      this.draggingBlock_.getDescendants(false)\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Execute a step of block dragging, based on the given event.  Update the\n   * display accordingly.\n   *\n   * @param e The most recent move event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   */\n  drag(e: PointerEvent, currentDragDeltaXY: Coordinate) {\n    const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n    const newLoc = Coordinate.sum(this.startXY_, delta);\n    this.draggingBlock_.moveDuringDrag(newLoc);\n    this.dragIcons_(delta);\n\n    const oldDragTarget = this.dragTarget_;\n    this.dragTarget_ = this.workspace_.getDragTarget(e);\n\n    this.draggedConnectionManager_.update(delta, this.dragTarget_);\n    const oldWouldDeleteBlock = this.wouldDeleteBlock_;\n    this.wouldDeleteBlock_ = this.draggedConnectionManager_.wouldDeleteBlock;\n    if (oldWouldDeleteBlock !== this.wouldDeleteBlock_) {\n      // Prevent unnecessary add/remove class calls.\n      this.updateCursorDuringBlockDrag_();\n    }\n\n    // Call drag enter/exit/over after wouldDeleteBlock is called in\n    // InsertionMarkerManager.update.\n    if (this.dragTarget_ !== oldDragTarget) {\n      oldDragTarget && oldDragTarget.onDragExit(this.draggingBlock_);\n      this.dragTarget_ && this.dragTarget_.onDragEnter(this.draggingBlock_);\n    }\n    this.dragTarget_ && this.dragTarget_.onDragOver(this.draggingBlock_);\n  }\n\n  /**\n   * Finish a block drag and put the block back on the workspace.\n   *\n   * @param e The pointerup event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   */\n  endDrag(e: PointerEvent, currentDragDeltaXY: Coordinate) {\n    // Make sure internal state is fresh.\n    this.drag(e, currentDragDeltaXY);\n    this.dragIconData_ = [];\n    this.fireDragEndEvent_();\n\n    dom.stopTextWidthCache();\n\n    blockAnimation.disconnectUiStop();\n\n    const preventMove =\n      !!this.dragTarget_ &&\n      this.dragTarget_.shouldPreventMove(this.draggingBlock_);\n    let delta: Coordinate | null = null;\n    if (!preventMove) {\n      const newValues = this.getNewLocationAfterDrag_(currentDragDeltaXY);\n      delta = newValues.delta;\n    }\n\n    if (this.dragTarget_) {\n      this.dragTarget_.onDrop(this.draggingBlock_);\n    }\n\n    const deleted = this.maybeDeleteBlock_();\n    if (!deleted) {\n      // These are expensive and don't need to be done if we're deleting.\n      this.draggingBlock_.setDragging(false);\n      if (delta) {\n        // !preventMove\n        this.updateBlockAfterMove_();\n      } else {\n        // Blocks dragged directly from a flyout may need to be bumped into\n        // bounds.\n        bumpObjects.bumpIntoBounds(\n          this.draggingBlock_.workspace,\n          this.workspace_.getMetricsManager().getScrollMetrics(true),\n          this.draggingBlock_\n        );\n      }\n    }\n    this.workspace_.setResizesEnabled(true);\n\n    eventUtils.setGroup(false);\n  }\n\n  /**\n   * Calculates the drag delta and new location values after a block is dragged.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the start of\n   *     the drag, in pixel units.\n   * @returns New location after drag. delta is in workspace units. newLocation\n   *     is the new coordinate where the block should end up.\n   */\n  protected getNewLocationAfterDrag_(currentDragDeltaXY: Coordinate): {\n    delta: Coordinate;\n    newLocation: Coordinate;\n  } {\n    const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n    const newLocation = Coordinate.sum(this.startXY_, delta);\n    return {\n      delta,\n      newLocation,\n    };\n  }\n\n  /**\n   * May delete the dragging block, if allowed. If `this.wouldDeleteBlock_` is\n   * not true, the block will not be deleted. This should be called at the end\n   * of a block drag.\n   *\n   * @returns True if the block was deleted.\n   */\n  protected maybeDeleteBlock_(): boolean {\n    if (this.wouldDeleteBlock_) {\n      // Fire a move event, so we know where to go back to for an undo.\n      this.fireMoveEvent_();\n      this.draggingBlock_.dispose(false, true);\n      common.draggingConnections.length = 0;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Updates the necessary information to place a block at a certain location.\n   */\n  protected updateBlockAfterMove_() {\n    this.fireMoveEvent_();\n    if (this.draggedConnectionManager_.wouldConnectBlock()) {\n      // Applying connections also rerenders the relevant blocks.\n      this.draggedConnectionManager_.applyConnections();\n    } else {\n      this.draggingBlock_.queueRender();\n    }\n    this.draggingBlock_.scheduleSnapAndBump();\n  }\n\n  /** Fire a UI event at the end of a block drag. */\n  protected fireDragEndEvent_() {\n    const event = new (eventUtils.get(eventUtils.BLOCK_DRAG))(\n      this.draggingBlock_,\n      false,\n      this.draggingBlock_.getDescendants(false)\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Adds or removes the style of the cursor for the toolbox.\n   * This is what changes the cursor to display an x when a deletable block is\n   * held over the toolbox.\n   *\n   * @param isEnd True if we are at the end of a drag, false otherwise.\n   */\n  protected updateToolboxStyle_(isEnd: boolean) {\n    const toolbox = this.workspace_.getToolbox();\n\n    if (toolbox) {\n      const style = this.draggingBlock_.isDeletable()\n        ? 'blocklyToolboxDelete'\n        : 'blocklyToolboxGrab';\n\n      // AnyDuringMigration because:  Property 'removeStyle' does not exist on\n      // type 'IToolbox'.\n      if (\n        isEnd &&\n        typeof (toolbox as AnyDuringMigration).removeStyle === 'function'\n      ) {\n        // AnyDuringMigration because:  Property 'removeStyle' does not exist on\n        // type 'IToolbox'.\n        (toolbox as AnyDuringMigration).removeStyle(style);\n        // AnyDuringMigration because:  Property 'addStyle' does not exist on\n        // type 'IToolbox'.\n      } else if (\n        !isEnd &&\n        typeof (toolbox as AnyDuringMigration).addStyle === 'function'\n      ) {\n        // AnyDuringMigration because:  Property 'addStyle' does not exist on\n        // type 'IToolbox'.\n        (toolbox as AnyDuringMigration).addStyle(style);\n      }\n    }\n  }\n\n  /** Fire a move event at the end of a block drag. */\n  protected fireMoveEvent_() {\n    if (this.draggingBlock_.isDeadOrDying()) return;\n    const event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n      this.draggingBlock_\n    ) as BlockMove;\n    event.setReason(['drag']);\n    event.oldCoordinate = this.startXY_;\n    event.recordNew();\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Update the cursor (and possibly the trash can lid) to reflect whether the\n   * dragging block would be deleted if released immediately.\n   */\n  protected updateCursorDuringBlockDrag_() {\n    this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_);\n  }\n\n  /**\n   * Convert a coordinate object from pixels to workspace units, including a\n   * correction for mutator workspaces.\n   * This function does not consider differing origins.  It simply scales the\n   * input's x and y values.\n   *\n   * @param pixelCoord A coordinate with x and y values in CSS pixel units.\n   * @returns The input coordinate divided by the workspace scale.\n   */\n  protected pixelsToWorkspaceUnits_(pixelCoord: Coordinate): Coordinate {\n    const result = new Coordinate(\n      pixelCoord.x / this.workspace_.scale,\n      pixelCoord.y / this.workspace_.scale\n    );\n    if (this.workspace_.isMutator) {\n      // If we're in a mutator, its scale is always 1, purely because of some\n      // oddities in our rendering optimizations.  The actual scale is the same\n      // as the scale on the parent workspace. Fix that for dragging.\n      const mainScale = this.workspace_.options.parentWorkspace!.scale;\n      result.scale(1 / mainScale);\n    }\n    return result;\n  }\n\n  /**\n   * Move all of the icons connected to this drag.\n   *\n   * @param dxy How far to move the icons from their original positions, in\n   *     workspace units.\n   */\n  protected dragIcons_(dxy: Coordinate) {\n    // Moving icons moves their associated bubbles.\n    for (const data of this.dragIconData_) {\n      data.icon.onLocationChange(Coordinate.sum(data.location, dxy));\n    }\n  }\n\n  /**\n   * Get a list of the insertion markers that currently exist.  Drags have 0, 1,\n   * or 2 insertion markers.\n   *\n   * @returns A possibly empty list of insertion marker blocks.\n   */\n  getInsertionMarkers(): BlockSvg[] {\n    // No insertion markers with the old style of dragged connection managers.\n    if (\n      this.draggedConnectionManager_ &&\n      this.draggedConnectionManager_.getInsertionMarkers\n    ) {\n      return this.draggedConnectionManager_.getInsertionMarkers();\n    }\n    return [];\n  }\n}\n\n/** Data about the position of a given icon. */\nexport interface IconPositionData {\n  location: Coordinate;\n  icon: Icon;\n}\n\n/**\n * Make a list of all of the icons (comment, warning, and mutator) that are\n * on this block and its descendants.  Moving an icon moves the bubble that\n * extends from it if that bubble is open.\n *\n * @param block The root block that is being dragged.\n * @param blockOrigin The top left of the given block in workspace coordinates.\n * @returns The list of all icons and their locations.\n */\nfunction initIconData(\n  block: BlockSvg,\n  blockOrigin: Coordinate\n): IconPositionData[] {\n  // Build a list of icons that need to be moved and where they started.\n  const dragIconData = [];\n\n  for (const icon of block.getIcons()) {\n    // Only bother to track icons whose bubble is visible.\n    if (hasBubble(icon) && !icon.bubbleIsVisible()) continue;\n\n    dragIconData.push({location: blockOrigin, icon: icon});\n    icon.onLocationChange(blockOrigin);\n  }\n\n  for (const child of block.getChildren(false)) {\n    dragIconData.push(\n      ...initIconData(child, Coordinate.sum(blockOrigin, child.relativeCoords))\n    );\n  }\n  // AnyDuringMigration because:  Type '{ location: Coordinate | null; icon:\n  // Icon; }[]' is not assignable to type 'IconPositionData[]'.\n  return dragIconData as AnyDuringMigration;\n}\n\nregistry.register(registry.Type.BLOCK_DRAGGER, registry.DEFAULT, BlockDragger);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.clipboard');\n\nimport type {CopyData, ICopyable} from './interfaces/i_copyable.js';\n\n/** Metadata about the object that is currently on the clipboard. */\nlet copyData: CopyData | null = null;\n\n/**\n * Copy a block or workspace comment onto the local clipboard.\n *\n * @param toCopy Block or Workspace Comment to be copied.\n * @internal\n */\nexport function copy(toCopy: ICopyable) {\n  TEST_ONLY.copyInternal(toCopy);\n}\n\n/**\n * Private version of copy for stubbing in tests.\n */\nfunction copyInternal(toCopy: ICopyable) {\n  copyData = toCopy.toCopyData();\n}\n\n/**\n * Paste a block or workspace comment on to the main workspace.\n *\n * @returns The pasted thing if the paste was successful, null otherwise.\n * @internal\n */\nexport function paste(): ICopyable | null {\n  if (!copyData) {\n    return null;\n  }\n  // Pasting always pastes to the main workspace, even if the copy\n  // started in a flyout workspace.\n  let workspace = copyData.source;\n  if (workspace.isFlyout) {\n    workspace = workspace.targetWorkspace!;\n  }\n  if (\n    copyData.typeCounts &&\n    workspace.isCapacityAvailable(copyData.typeCounts)\n  ) {\n    return workspace.paste(copyData.saveInfo);\n  }\n  return null;\n}\n\n/**\n * Duplicate this block and its children, or a workspace comment.\n *\n * @param toDuplicate Block or Workspace Comment to be duplicated.\n * @returns The block or workspace comment that was duplicated, or null if the\n *     duplication failed.\n * @internal\n */\nexport function duplicate(toDuplicate: ICopyable): ICopyable | null {\n  return TEST_ONLY.duplicateInternal(toDuplicate);\n}\n\n/**\n * Private version of duplicate for stubbing in tests.\n */\nfunction duplicateInternal(toDuplicate: ICopyable): ICopyable | null {\n  const oldCopyData = copyData;\n  copy(toDuplicate);\n  const pastedThing =\n    toDuplicate.toCopyData()?.source?.paste(copyData!.saveInfo) ?? null;\n  copyData = oldCopyData;\n  return pastedThing;\n}\n\nexport const TEST_ONLY = {\n  duplicateInternal,\n  copyInternal,\n};\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ContextMenu');\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as clipboard from './clipboard.js';\nimport {config} from './config.js';\nimport * as dom from './utils/dom.js';\nimport type {\n  ContextMenuOption,\n  LegacyContextMenuOption,\n} from './contextmenu_registry.js';\nimport * as eventUtils from './events/utils.js';\nimport {Menu} from './menu.js';\nimport {MenuItem} from './menuitem.js';\nimport {Msg} from './msg.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport {Rect} from './utils/rect.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as Xml from './xml.js';\n\n/**\n * Which block is the context menu attached to?\n */\nlet currentBlock: Block | null = null;\n\nconst dummyOwner = {};\n\n/**\n * Gets the block the context menu is currently attached to.\n *\n * @returns The block the context menu is attached to.\n */\nexport function getCurrentBlock(): Block | null {\n  return currentBlock;\n}\n\n/**\n * Sets the block the context menu is currently attached to.\n *\n * @param block The block the context menu is attached to.\n */\nexport function setCurrentBlock(block: Block | null) {\n  currentBlock = block;\n}\n\n/**\n * Menu object.\n */\nlet menu_: Menu | null = null;\n\n/**\n * Construct the menu based on the list of options and show the menu.\n *\n * @param e Mouse event.\n * @param options Array of menu options.\n * @param rtl True if RTL, false if LTR.\n */\nexport function show(\n  e: Event,\n  options: (ContextMenuOption | LegacyContextMenuOption)[],\n  rtl: boolean\n) {\n  WidgetDiv.show(dummyOwner, rtl, dispose);\n  if (!options.length) {\n    hide();\n    return;\n  }\n  const menu = populate_(options, rtl);\n  menu_ = menu;\n\n  position_(menu, e, rtl);\n  // 1ms delay is required for focusing on context menus because some other\n  // mouse event is still waiting in the queue and clears focus.\n  setTimeout(function () {\n    menu.focus();\n  }, 1);\n  currentBlock = null; // May be set by Blockly.Block.\n}\n\n/**\n * Create the context menu object and populate it with the given options.\n *\n * @param options Array of menu options.\n * @param rtl True if RTL, false if LTR.\n * @returns The menu that will be shown on right click.\n */\nfunction populate_(\n  options: (ContextMenuOption | LegacyContextMenuOption)[],\n  rtl: boolean\n): Menu {\n  /* Here's what one option object looks like:\n      {text: 'Make It So',\n       enabled: true,\n       callback: Blockly.MakeItSo}\n    */\n  const menu = new Menu();\n  menu.setRole(aria.Role.MENU);\n  for (let i = 0; i < options.length; i++) {\n    const option = options[i];\n    const menuItem = new MenuItem(option.text);\n    menuItem.setRightToLeft(rtl);\n    menuItem.setRole(aria.Role.MENUITEM);\n    menu.addChild(menuItem);\n    menuItem.setEnabled(option.enabled);\n    if (option.enabled) {\n      const actionHandler = function () {\n        hide();\n        requestAnimationFrame(() => {\n          setTimeout(() => {\n            // If .scope does not exist on the option, then the callback\n            // will not be expecting a scope parameter, so there should be\n            // no problems. Just assume it is a ContextMenuOption and we'll\n            // pass undefined if it's not.\n            option.callback((option as ContextMenuOption).scope);\n          }, 0);\n        });\n      };\n      menuItem.onAction(actionHandler, {});\n    }\n  }\n  return menu;\n}\n\n/**\n * Add the menu to the page and position it correctly.\n *\n * @param menu The menu to add and position.\n * @param e Mouse event for the right click that is making the context\n *     menu appear.\n * @param rtl True if RTL, false if LTR.\n */\nfunction position_(menu: Menu, e: Event, rtl: boolean) {\n  // Record windowSize and scrollOffset before adding menu.\n  const viewportBBox = svgMath.getViewportBBox();\n  const mouseEvent = e as MouseEvent;\n  // This one is just a point, but we'll pretend that it's a rect so we can use\n  // some helper functions.\n  const anchorBBox = new Rect(\n    mouseEvent.clientY + viewportBBox.top,\n    mouseEvent.clientY + viewportBBox.top,\n    mouseEvent.clientX + viewportBBox.left,\n    mouseEvent.clientX + viewportBBox.left\n  );\n\n  createWidget_(menu);\n  const menuSize = menu.getSize();\n\n  if (rtl) {\n    anchorBBox.left += menuSize.width;\n    anchorBBox.right += menuSize.width;\n    viewportBBox.left += menuSize.width;\n    viewportBBox.right += menuSize.width;\n  }\n\n  WidgetDiv.positionWithAnchor(viewportBBox, anchorBBox, menuSize, rtl);\n  // Calling menuDom.focus() has to wait until after the menu has been placed\n  // correctly.  Otherwise it will cause a page scroll to get the misplaced menu\n  // in view.  See issue #1329.\n  menu.focus();\n}\n\n/**\n * Create and render the menu widget inside Blockly's widget div.\n *\n * @param menu The menu to add to the widget div.\n */\nfunction createWidget_(menu: Menu) {\n  const div = WidgetDiv.getDiv();\n  if (!div) {\n    throw Error('Attempting to create a context menu when widget div is null');\n  }\n  const menuDom = menu.render(div);\n  dom.addClass(menuDom, 'blocklyContextMenu');\n  // Prevent system context menu when right-clicking a Blockly context menu.\n  browserEvents.conditionalBind(\n    menuDom as EventTarget,\n    'contextmenu',\n    null,\n    haltPropagation\n  );\n  // Focus only after the initial render to avoid issue #1329.\n  menu.focus();\n}\n/**\n * Halts the propagation of the event without doing anything else.\n *\n * @param e An event.\n */\nfunction haltPropagation(e: Event) {\n  // This event has been handled.  No need to bubble up to the document.\n  e.preventDefault();\n  e.stopPropagation();\n}\n\n/**\n * Hide the context menu.\n */\nexport function hide() {\n  WidgetDiv.hideIfOwner(dummyOwner);\n  currentBlock = null;\n}\n\n/**\n * Dispose of the menu.\n */\nexport function dispose() {\n  if (menu_) {\n    menu_.dispose();\n    menu_ = null;\n  }\n}\n\n/**\n * Create a callback function that creates and configures a block,\n *   then places the new block next to the original.\n *\n * @param block Original block.\n * @param xml XML representation of new block.\n * @returns Function that creates a block.\n */\nexport function callbackFactory(block: Block, xml: Element): () => void {\n  return () => {\n    eventUtils.disable();\n    let newBlock;\n    try {\n      newBlock = Xml.domToBlock(xml, block.workspace!) as BlockSvg;\n      // Move the new block next to the old block.\n      const xy = block.getRelativeToSurfaceXY();\n      if (block.RTL) {\n        xy.x -= config.snapRadius;\n      } else {\n        xy.x += config.snapRadius;\n      }\n      xy.y += config.snapRadius * 2;\n      newBlock.moveBy(xy.x, xy.y);\n    } finally {\n      eventUtils.enable();\n    }\n    if (eventUtils.isEnabled() && !newBlock.isShadow()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(newBlock));\n    }\n    newBlock.select();\n  };\n}\n\n// Helper functions for creating context menu options.\n\n/**\n * Make a context menu option for deleting the current workspace comment.\n *\n * @param comment The workspace comment where the\n *     right-click originated.\n * @returns A menu option,\n *     containing text, enabled, and a callback.\n * @internal\n */\nexport function commentDeleteOption(\n  comment: WorkspaceCommentSvg\n): LegacyContextMenuOption {\n  const deleteOption = {\n    text: Msg['REMOVE_COMMENT'],\n    enabled: true,\n    callback: function () {\n      eventUtils.setGroup(true);\n      comment.dispose();\n      eventUtils.setGroup(false);\n    },\n  };\n  return deleteOption;\n}\n\n/**\n * Make a context menu option for duplicating the current workspace comment.\n *\n * @param comment The workspace comment where the\n *     right-click originated.\n * @returns A menu option,\n *     containing text, enabled, and a callback.\n * @internal\n */\nexport function commentDuplicateOption(\n  comment: WorkspaceCommentSvg\n): LegacyContextMenuOption {\n  const duplicateOption = {\n    text: Msg['DUPLICATE_COMMENT'],\n    enabled: true,\n    callback: function () {\n      clipboard.duplicate(comment);\n    },\n  };\n  return duplicateOption;\n}\n\n/**\n * Make a context menu option for adding a comment on the workspace.\n *\n * @param ws The workspace where the right-click\n *     originated.\n * @param e The right-click mouse event.\n * @returns A menu option, containing text, enabled, and a callback.\n *     comments are not bundled in.\n * @internal\n */\nexport function workspaceCommentOption(\n  ws: WorkspaceSvg,\n  e: Event\n): ContextMenuOption {\n  /**\n   * Helper function to create and position a comment correctly based on the\n   * location of the mouse event.\n   */\n  function addWsComment() {\n    const comment = new WorkspaceCommentSvg(\n      ws,\n      Msg['WORKSPACE_COMMENT_DEFAULT_TEXT'],\n      WorkspaceCommentSvg.DEFAULT_SIZE,\n      WorkspaceCommentSvg.DEFAULT_SIZE\n    );\n\n    const injectionDiv = ws.getInjectionDiv();\n    // Bounding rect coordinates are in client coordinates, meaning that they\n    // are in pixels relative to the upper left corner of the visible browser\n    // window.  These coordinates change when you scroll the browser window.\n    const boundingRect = injectionDiv.getBoundingClientRect();\n\n    // The client coordinates offset by the injection div's upper left corner.\n    const mouseEvent = e as MouseEvent;\n    const clientOffsetPixels = new Coordinate(\n      mouseEvent.clientX - boundingRect.left,\n      mouseEvent.clientY - boundingRect.top\n    );\n\n    // The offset in pixels between the main workspace's origin and the upper\n    // left corner of the injection div.\n    const mainOffsetPixels = ws.getOriginOffsetInPixels();\n\n    // The position of the new comment in pixels relative to the origin of the\n    // main workspace.\n    const finalOffset = Coordinate.difference(\n      clientOffsetPixels,\n      mainOffsetPixels\n    );\n    // The position of the new comment in main workspace coordinates.\n    finalOffset.scale(1 / ws.scale);\n\n    const commentX = finalOffset.x;\n    const commentY = finalOffset.y;\n    comment.moveBy(commentX, commentY);\n    if (ws.rendered) {\n      comment.initSvg();\n      comment.render();\n      comment.select();\n    }\n  }\n\n  const wsCommentOption = {\n    enabled: true,\n  } as ContextMenuOption;\n  wsCommentOption.text = Msg['ADD_COMMENT'];\n  wsCommentOption.callback = function () {\n    addWsComment();\n  };\n  return wsCommentOption;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing an AST node.\n * Used to traverse the Blockly AST.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ASTNode');\n\nimport type {Block} from '../block.js';\nimport type {Connection} from '../connection.js';\nimport {ConnectionType} from '../connection_type.js';\nimport type {Field} from '../field.js';\nimport type {Input} from '../inputs/input.js';\nimport type {IASTNodeLocation} from '../interfaces/i_ast_node_location.js';\nimport type {IASTNodeLocationWithBlock} from '../interfaces/i_ast_node_location_with_block.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Class for an AST node.\n * It is recommended that you use one of the createNode methods instead of\n * creating a node directly.\n */\nexport class ASTNode {\n  /**\n   * True to navigate to all fields. False to only navigate to clickable fields.\n   */\n  static NAVIGATE_ALL_FIELDS = false;\n\n  /**\n   * The default y offset to use when moving the cursor from a stack to the\n   * workspace.\n   */\n  private static readonly DEFAULT_OFFSET_Y: number = -20;\n  private readonly type: string;\n  private readonly isConnectionLocation: boolean;\n  private readonly location: IASTNodeLocation;\n\n  /** The coordinate on the workspace. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'Coordinate'.\n  private wsCoordinate: Coordinate = null as AnyDuringMigration;\n\n  /**\n   * @param type The type of the location.\n   *     Must be in ASTNode.types.\n   * @param location The position in the AST.\n   * @param opt_params Optional dictionary of options.\n   */\n  constructor(type: string, location: IASTNodeLocation, opt_params?: Params) {\n    if (!location) {\n      throw Error('Cannot create a node without a location.');\n    }\n\n    /**\n     * The type of the location.\n     * One of ASTNode.types\n     */\n    this.type = type;\n\n    /** Whether the location points to a connection. */\n    this.isConnectionLocation = ASTNode.isConnectionType(type);\n\n    /** The location of the AST node. */\n    this.location = location;\n\n    this.processParams(opt_params || null);\n  }\n\n  /**\n   * Parse the optional parameters.\n   *\n   * @param params The user specified parameters.\n   */\n  private processParams(params: Params | null) {\n    if (!params) {\n      return;\n    }\n    if (params.wsCoordinate) {\n      this.wsCoordinate = params.wsCoordinate;\n    }\n  }\n\n  /**\n   * Gets the value pointed to by this node.\n   * It is the callers responsibility to check the node type to figure out what\n   * type of object they get back from this.\n   *\n   * @returns The current field, connection, workspace, or block the cursor is\n   *     on.\n   */\n  getLocation(): IASTNodeLocation {\n    return this.location;\n  }\n\n  /**\n   * The type of the current location.\n   * One of ASTNode.types\n   *\n   * @returns The type of the location.\n   */\n  getType(): string {\n    return this.type;\n  }\n\n  /**\n   * The coordinate on the workspace.\n   *\n   * @returns The workspace coordinate or null if the location is not a\n   *     workspace.\n   */\n  getWsCoordinate(): Coordinate {\n    return this.wsCoordinate;\n  }\n\n  /**\n   * Whether the node points to a connection.\n   *\n   * @returns [description]\n   * @internal\n   */\n  isConnection(): boolean {\n    return this.isConnectionLocation;\n  }\n\n  /**\n   * Given an input find the next editable field or an input with a non null\n   * connection in the same block. The current location must be an input\n   * connection.\n   *\n   * @returns The AST node holding the next field or connection or null if there\n   *     is no editable field or input connection after the given input.\n   */\n  private findNextForInput(): ASTNode | null {\n    const location = this.location as Connection;\n    const parentInput = location.getParentInput();\n    const block = parentInput!.getSourceBlock();\n    // AnyDuringMigration because:  Argument of type 'Input | null' is not\n    // assignable to parameter of type 'Input'.\n    const curIdx = block!.inputList.indexOf(parentInput as AnyDuringMigration);\n    for (let i = curIdx + 1; i < block!.inputList.length; i++) {\n      const input = block!.inputList[i];\n      const fieldRow = input.fieldRow;\n      for (let j = 0; j < fieldRow.length; j++) {\n        const field = fieldRow[j];\n        if (field.isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(field);\n        }\n      }\n      if (input.connection) {\n        return ASTNode.createInputNode(input);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Given a field find the next editable field or an input with a non null\n   * connection in the same block. The current location must be a field.\n   *\n   * @returns The AST node pointing to the next field or connection or null if\n   *     there is no editable field or input connection after the given input.\n   */\n  private findNextForField(): ASTNode | null {\n    const location = this.location as Field;\n    const input = location.getParentInput();\n    const block = location.getSourceBlock();\n    if (!block) {\n      throw new Error(\n        'The current AST location is not associated with a block'\n      );\n    }\n    const curIdx = block.inputList.indexOf(input);\n    let fieldIdx = input.fieldRow.indexOf(location) + 1;\n    for (let i = curIdx; i < block.inputList.length; i++) {\n      const newInput = block.inputList[i];\n      const fieldRow = newInput.fieldRow;\n      while (fieldIdx < fieldRow.length) {\n        if (fieldRow[fieldIdx].isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(fieldRow[fieldIdx]);\n        }\n        fieldIdx++;\n      }\n      fieldIdx = 0;\n      if (newInput.connection) {\n        return ASTNode.createInputNode(newInput);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Given an input find the previous editable field or an input with a non null\n   * connection in the same block. The current location must be an input\n   * connection.\n   *\n   * @returns The AST node holding the previous field or connection.\n   */\n  private findPrevForInput(): ASTNode | null {\n    const location = this.location as Connection;\n    const parentInput = location.getParentInput();\n    const block = parentInput!.getSourceBlock();\n    // AnyDuringMigration because:  Argument of type 'Input | null' is not\n    // assignable to parameter of type 'Input'.\n    const curIdx = block!.inputList.indexOf(parentInput as AnyDuringMigration);\n    for (let i = curIdx; i >= 0; i--) {\n      const input = block!.inputList[i];\n      if (input.connection && input !== parentInput) {\n        return ASTNode.createInputNode(input);\n      }\n      const fieldRow = input.fieldRow;\n      for (let j = fieldRow.length - 1; j >= 0; j--) {\n        const field = fieldRow[j];\n        if (field.isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(field);\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Given a field find the previous editable field or an input with a non null\n   * connection in the same block. The current location must be a field.\n   *\n   * @returns The AST node holding the previous input or field.\n   */\n  private findPrevForField(): ASTNode | null {\n    const location = this.location as Field;\n    const parentInput = location.getParentInput();\n    const block = location.getSourceBlock();\n    if (!block) {\n      throw new Error(\n        'The current AST location is not associated with a block'\n      );\n    }\n    const curIdx = block.inputList.indexOf(parentInput);\n    let fieldIdx = parentInput.fieldRow.indexOf(location) - 1;\n    for (let i = curIdx; i >= 0; i--) {\n      const input = block.inputList[i];\n      if (input.connection && input !== parentInput) {\n        return ASTNode.createInputNode(input);\n      }\n      const fieldRow = input.fieldRow;\n      while (fieldIdx > -1) {\n        if (fieldRow[fieldIdx].isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(fieldRow[fieldIdx]);\n        }\n        fieldIdx--;\n      }\n      // Reset the fieldIdx to the length of the field row of the previous\n      // input.\n      if (i - 1 >= 0) {\n        fieldIdx = block.inputList[i - 1].fieldRow.length - 1;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Navigate between stacks of blocks on the workspace.\n   *\n   * @param forward True to go forward. False to go backwards.\n   * @returns The first block of the next stack or null if there are no blocks\n   *     on the workspace.\n   */\n  private navigateBetweenStacks(forward: boolean): ASTNode | null {\n    let curLocation = this.getLocation();\n    // TODO(#6097): Use instanceof checks to exit early for values of\n    // curLocation that don't make sense.\n    if ((curLocation as IASTNodeLocationWithBlock).getSourceBlock) {\n      const block = (curLocation as IASTNodeLocationWithBlock).getSourceBlock();\n      if (block) {\n        curLocation = block;\n      }\n    }\n    // TODO(#6097): Use instanceof checks to exit early for values of\n    // curLocation that don't make sense.\n    const curLocationAsBlock = curLocation as Block;\n    if (!curLocationAsBlock || curLocationAsBlock.isDeadOrDying()) {\n      return null;\n    }\n    const curRoot = curLocationAsBlock.getRootBlock();\n    const topBlocks = curRoot.workspace.getTopBlocks(true);\n    for (let i = 0; i < topBlocks.length; i++) {\n      const topBlock = topBlocks[i];\n      if (curRoot.id === topBlock.id) {\n        const offset = forward ? 1 : -1;\n        const resultIndex = i + offset;\n        if (resultIndex === -1 || resultIndex === topBlocks.length) {\n          return null;\n        }\n        return ASTNode.createStackNode(topBlocks[resultIndex]);\n      }\n    }\n    throw Error(\n      \"Couldn't find \" + (forward ? 'next' : 'previous') + ' stack?!'\n    );\n  }\n\n  /**\n   * Finds the top most AST node for a given block.\n   * This is either the previous connection, output connection or block\n   * depending on what kind of connections the block has.\n   *\n   * @param block The block that we want to find the top connection on.\n   * @returns The AST node containing the top connection.\n   */\n  private findTopASTNodeForBlock(block: Block): ASTNode | null {\n    const topConnection = getParentConnection(block);\n    if (topConnection) {\n      return ASTNode.createConnectionNode(topConnection);\n    } else {\n      return ASTNode.createBlockNode(block);\n    }\n  }\n\n  /**\n   * Get the AST node pointing to the input that the block is nested under or if\n   * the block is not nested then get the stack AST node.\n   *\n   * @param block The source block of the current location.\n   * @returns The AST node pointing to the input connection or the top block of\n   *     the stack this block is in.\n   */\n  private getOutAstNodeForBlock(block: Block): ASTNode | null {\n    if (!block) {\n      return null;\n    }\n    // If the block doesn't have a previous connection then it is the top of the\n    // substack.\n    const topBlock = block.getTopStackBlock();\n    const topConnection = getParentConnection(topBlock);\n    // If the top connection has a parentInput, create an AST node pointing to\n    // that input.\n    if (\n      topConnection &&\n      topConnection.targetConnection &&\n      topConnection.targetConnection.getParentInput()\n    ) {\n      // AnyDuringMigration because:  Argument of type 'Input | null' is not\n      // assignable to parameter of type 'Input'.\n      return ASTNode.createInputNode(\n        topConnection.targetConnection.getParentInput() as AnyDuringMigration\n      );\n    } else {\n      // Go to stack level if you are not underneath an input.\n      return ASTNode.createStackNode(topBlock);\n    }\n  }\n\n  /**\n   * Find the first editable field or input with a connection on a given block.\n   *\n   * @param block The source block of the current location.\n   * @returns An AST node pointing to the first field or input.\n   * Null if there are no editable fields or inputs with connections on the\n   * block.\n   */\n  private findFirstFieldOrInput(block: Block): ASTNode | null {\n    const inputs = block.inputList;\n    for (let i = 0; i < inputs.length; i++) {\n      const input = inputs[i];\n      const fieldRow = input.fieldRow;\n      for (let j = 0; j < fieldRow.length; j++) {\n        const field = fieldRow[j];\n        if (field.isClickable() || ASTNode.NAVIGATE_ALL_FIELDS) {\n          return ASTNode.createFieldNode(field);\n        }\n      }\n      if (input.connection) {\n        return ASTNode.createInputNode(input);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Finds the source block of the location of this node.\n   *\n   * @returns The source block of the location, or null if the node is of type\n   *     workspace.\n   */\n  getSourceBlock(): Block | null {\n    if (this.getType() === ASTNode.types.BLOCK) {\n      return this.getLocation() as Block;\n    } else if (this.getType() === ASTNode.types.STACK) {\n      return this.getLocation() as Block;\n    } else if (this.getType() === ASTNode.types.WORKSPACE) {\n      return null;\n    } else {\n      return (this.getLocation() as IASTNodeLocationWithBlock).getSourceBlock();\n    }\n  }\n\n  /**\n   * Find the element to the right of the current element in the AST.\n   *\n   * @returns An AST node that wraps the next field, connection, block, or\n   *     workspace. Or null if there is no node to the right.\n   */\n  next(): ASTNode | null {\n    switch (this.type) {\n      case ASTNode.types.STACK:\n        return this.navigateBetweenStacks(true);\n\n      case ASTNode.types.OUTPUT: {\n        const connection = this.location as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.FIELD:\n        return this.findNextForField();\n\n      case ASTNode.types.INPUT:\n        return this.findNextForInput();\n\n      case ASTNode.types.BLOCK: {\n        const block = this.location as Block;\n        const nextConnection = block.nextConnection;\n        if (!nextConnection) return null;\n        return ASTNode.createConnectionNode(nextConnection);\n      }\n      case ASTNode.types.PREVIOUS: {\n        const connection = this.location as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.NEXT: {\n        const connection = this.location as Connection;\n        const targetConnection = connection.targetConnection;\n        return ASTNode.createConnectionNode(targetConnection!);\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Find the element one level below and all the way to the left of the current\n   * location.\n   *\n   * @returns An AST node that wraps the next field, connection, workspace, or\n   *     block. Or null if there is nothing below this node.\n   */\n  in(): ASTNode | null {\n    switch (this.type) {\n      case ASTNode.types.WORKSPACE: {\n        const workspace = this.location as Workspace;\n        const topBlocks = workspace.getTopBlocks(true);\n        if (topBlocks.length > 0) {\n          return ASTNode.createStackNode(topBlocks[0]);\n        }\n        break;\n      }\n      case ASTNode.types.STACK: {\n        const block = this.location as Block;\n        return this.findTopASTNodeForBlock(block);\n      }\n      case ASTNode.types.BLOCK: {\n        const block = this.location as Block;\n        return this.findFirstFieldOrInput(block);\n      }\n      case ASTNode.types.INPUT: {\n        const connection = this.location as Connection;\n        const targetConnection = connection.targetConnection;\n        return ASTNode.createConnectionNode(targetConnection!);\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Find the element to the left of the current element in the AST.\n   *\n   * @returns An AST node that wraps the previous field, connection, workspace\n   *     or block. Or null if no node exists to the left. null.\n   */\n  prev(): ASTNode | null {\n    switch (this.type) {\n      case ASTNode.types.STACK:\n        return this.navigateBetweenStacks(false);\n\n      case ASTNode.types.OUTPUT:\n        return null;\n\n      case ASTNode.types.FIELD:\n        return this.findPrevForField();\n\n      case ASTNode.types.INPUT:\n        return this.findPrevForInput();\n\n      case ASTNode.types.BLOCK: {\n        const block = this.location as Block;\n        const topConnection = getParentConnection(block);\n        if (!topConnection) return null;\n        return ASTNode.createConnectionNode(topConnection);\n      }\n      case ASTNode.types.PREVIOUS: {\n        const connection = this.location as Connection;\n        const targetConnection = connection.targetConnection;\n        if (targetConnection && !targetConnection.getParentInput()) {\n          return ASTNode.createConnectionNode(targetConnection);\n        }\n        break;\n      }\n      case ASTNode.types.NEXT: {\n        const connection = this.location as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Find the next element that is one position above and all the way to the\n   * left of the current location.\n   *\n   * @returns An AST node that wraps the next field, connection, workspace or\n   *     block. Or null if we are at the workspace level.\n   */\n  out(): ASTNode | null {\n    switch (this.type) {\n      case ASTNode.types.STACK: {\n        const block = this.location as Block;\n        const blockPos = block.getRelativeToSurfaceXY();\n        // TODO: Make sure this is in the bounds of the workspace.\n        const wsCoordinate = new Coordinate(\n          blockPos.x,\n          blockPos.y + ASTNode.DEFAULT_OFFSET_Y\n        );\n        return ASTNode.createWorkspaceNode(block.workspace, wsCoordinate);\n      }\n      case ASTNode.types.OUTPUT: {\n        const connection = this.location as Connection;\n        const target = connection.targetConnection;\n        if (target) {\n          return ASTNode.createConnectionNode(target);\n        }\n        return ASTNode.createStackNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.FIELD: {\n        const field = this.location as Field;\n        const block = field.getSourceBlock();\n        if (!block) {\n          throw new Error(\n            'The current AST location is not associated with a block'\n          );\n        }\n        return ASTNode.createBlockNode(block);\n      }\n      case ASTNode.types.INPUT: {\n        const connection = this.location as Connection;\n        return ASTNode.createBlockNode(connection.getSourceBlock());\n      }\n      case ASTNode.types.BLOCK: {\n        const block = this.location as Block;\n        return this.getOutAstNodeForBlock(block);\n      }\n      case ASTNode.types.PREVIOUS: {\n        const connection = this.location as Connection;\n        return this.getOutAstNodeForBlock(connection.getSourceBlock());\n      }\n      case ASTNode.types.NEXT: {\n        const connection = this.location as Connection;\n        return this.getOutAstNodeForBlock(connection.getSourceBlock());\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Whether an AST node of the given type points to a connection.\n   *\n   * @param type The type to check.  One of ASTNode.types.\n   * @returns True if a node of the given type points to a connection.\n   */\n  private static isConnectionType(type: string): boolean {\n    switch (type) {\n      case ASTNode.types.PREVIOUS:\n      case ASTNode.types.NEXT:\n      case ASTNode.types.INPUT:\n      case ASTNode.types.OUTPUT:\n        return true;\n    }\n    return false;\n  }\n\n  /**\n   * Create an AST node pointing to a field.\n   *\n   * @param field The location of the AST node.\n   * @returns An AST node pointing to a field.\n   */\n  static createFieldNode(field: Field): ASTNode | null {\n    if (!field) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.FIELD, field);\n  }\n\n  /**\n   * Creates an AST node pointing to a connection. If the connection has a\n   * parent input then create an AST node of type input that will hold the\n   * connection.\n   *\n   * @param connection This is the connection the node will point to.\n   * @returns An AST node pointing to a connection.\n   */\n  static createConnectionNode(connection: Connection): ASTNode | null {\n    if (!connection) {\n      return null;\n    }\n    const type = connection.type;\n    if (type === ConnectionType.INPUT_VALUE) {\n      // AnyDuringMigration because:  Argument of type 'Input | null' is not\n      // assignable to parameter of type 'Input'.\n      return ASTNode.createInputNode(\n        connection.getParentInput() as AnyDuringMigration\n      );\n    } else if (\n      type === ConnectionType.NEXT_STATEMENT &&\n      connection.getParentInput()\n    ) {\n      // AnyDuringMigration because:  Argument of type 'Input | null' is not\n      // assignable to parameter of type 'Input'.\n      return ASTNode.createInputNode(\n        connection.getParentInput() as AnyDuringMigration\n      );\n    } else if (type === ConnectionType.NEXT_STATEMENT) {\n      return new ASTNode(ASTNode.types.NEXT, connection);\n    } else if (type === ConnectionType.OUTPUT_VALUE) {\n      return new ASTNode(ASTNode.types.OUTPUT, connection);\n    } else if (type === ConnectionType.PREVIOUS_STATEMENT) {\n      return new ASTNode(ASTNode.types.PREVIOUS, connection);\n    }\n    return null;\n  }\n\n  /**\n   * Creates an AST node pointing to an input. Stores the input connection as\n   * the location.\n   *\n   * @param input The input used to create an AST node.\n   * @returns An AST node pointing to a input.\n   */\n  static createInputNode(input: Input): ASTNode | null {\n    if (!input || !input.connection) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.INPUT, input.connection);\n  }\n\n  /**\n   * Creates an AST node pointing to a block.\n   *\n   * @param block The block used to create an AST node.\n   * @returns An AST node pointing to a block.\n   */\n  static createBlockNode(block: Block): ASTNode | null {\n    if (!block) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.BLOCK, block);\n  }\n\n  /**\n   * Create an AST node of type stack. A stack, represented by its top block, is\n   *     the set of all blocks connected to a top block, including the top\n   * block.\n   *\n   * @param topBlock A top block has no parent and can be found in the list\n   *     returned by workspace.getTopBlocks().\n   * @returns An AST node of type stack that points to the top block on the\n   *     stack.\n   */\n  static createStackNode(topBlock: Block): ASTNode | null {\n    if (!topBlock) {\n      return null;\n    }\n    return new ASTNode(ASTNode.types.STACK, topBlock);\n  }\n\n  /**\n   * Creates an AST node pointing to a workspace.\n   *\n   * @param workspace The workspace that we are on.\n   * @param wsCoordinate The position on the workspace for this node.\n   * @returns An AST node pointing to a workspace and a position on the\n   *     workspace.\n   */\n  static createWorkspaceNode(\n    workspace: Workspace | null,\n    wsCoordinate: Coordinate | null\n  ): ASTNode | null {\n    if (!wsCoordinate || !workspace) {\n      return null;\n    }\n    const params = {wsCoordinate};\n    return new ASTNode(ASTNode.types.WORKSPACE, workspace, params);\n  }\n\n  /**\n   * Creates an AST node for the top position on a block.\n   * This is either an output connection, previous connection, or block.\n   *\n   * @param block The block to find the top most AST node on.\n   * @returns The AST node holding the top most position on the block.\n   */\n  static createTopNode(block: Block): ASTNode | null {\n    let astNode;\n    const topConnection = getParentConnection(block);\n    if (topConnection) {\n      astNode = ASTNode.createConnectionNode(topConnection);\n    } else {\n      astNode = ASTNode.createBlockNode(block);\n    }\n    return astNode;\n  }\n}\n\nexport namespace ASTNode {\n  export interface Params {\n    wsCoordinate: Coordinate;\n  }\n\n  export enum types {\n    FIELD = 'field',\n    BLOCK = 'block',\n    INPUT = 'input',\n    OUTPUT = 'output',\n    NEXT = 'next',\n    PREVIOUS = 'previous',\n    STACK = 'stack',\n    WORKSPACE = 'workspace',\n  }\n}\n\nexport type Params = ASTNode.Params;\n// No need to export ASTNode.types from the module at this time because (1) it\n// wasn't automatically converted by the automatic migration script, (2) the\n// name doesn't follow the styleguide.\n\n/**\n * Gets the parent connection on a block.\n * This is either an output connection, previous connection or undefined.\n * If both connections exist return the one that is actually connected\n * to another block.\n *\n * @param block The block to find the parent connection on.\n * @returns The connection connecting to the parent of the block.\n */\nfunction getParentConnection(block: Block): Connection | null {\n  let topConnection = block.outputConnection;\n  if (\n    !topConnection ||\n    (block.previousConnection && block.previousConnection.isConnected())\n  ) {\n    topConnection = block.previousConnection;\n  }\n  return topConnection;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.ConstantProvider');\n\nimport {ConnectionType} from '../../connection_type.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle, Theme} from '../../theme.js';\nimport * as colour from '../../utils/colour.js';\nimport * as dom from '../../utils/dom.js';\nimport * as parsing from '../../utils/parsing.js';\nimport {Svg} from '../../utils/svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\n\n/** An object containing sizing and path information about outside corners. */\nexport interface OutsideCorners {\n  topLeft: string;\n  topRight: string;\n  bottomRight: string;\n  bottomLeft: string;\n  rightHeight: number;\n}\n\n/** An object containing sizing and path information about inside corners. */\nexport interface InsideCorners {\n  width: number;\n  height: number;\n  pathTop: string;\n  pathBottom: string;\n}\n\n/** An object containing sizing and path information about a start hat. */\nexport interface StartHat {\n  height: number;\n  width: number;\n  path: string;\n}\n\n/** An object containing sizing and path information about a notch. */\nexport interface Notch {\n  type: number;\n  width: number;\n  height: number;\n  pathLeft: string;\n  pathRight: string;\n}\n\n/** An object containing sizing and path information about a puzzle tab. */\nexport interface PuzzleTab {\n  type: number;\n  width: number;\n  height: number;\n  pathDown: string | ((p1: number) => string);\n  pathUp: string | ((p1: number) => string);\n}\n\n/**\n * An object containing sizing and path information about collapsed block\n * indicators.\n */\nexport interface JaggedTeeth {\n  height: number;\n  width: number;\n  path: string;\n}\n\nexport type BaseShape = {\n  type: number;\n  width: number;\n  height: number;\n};\n\n/** An object containing sizing and type information about a dynamic shape. */\nexport type DynamicShape = {\n  type: number;\n  width: (p1: number) => number;\n  height: (p1: number) => number;\n  isDynamic: true;\n  connectionOffsetY: (p1: number) => number;\n  connectionOffsetX: (p1: number) => number;\n  pathDown: (p1: number) => string;\n  pathUp: (p1: number) => string;\n  pathRightDown: (p1: number) => string;\n  pathRightUp: (p1: number) => string;\n};\n\n/** An object containing sizing and type information about a shape. */\nexport type Shape = BaseShape | DynamicShape;\n\n/**\n * Returns whether the shape is dynamic or not.\n *\n * @param shape The shape to check for dynamic-ness.\n * @returns Whether the shape is a dynamic shape or not.\n */\nexport function isDynamicShape(shape: Shape): shape is DynamicShape {\n  return (shape as DynamicShape).isDynamic;\n}\n\n/**\n * An object that provides constants for rendering blocks.\n */\nexport class ConstantProvider {\n  /** The size of an empty spacer. */\n  NO_PADDING = 0;\n\n  /** The size of small padding. */\n  SMALL_PADDING = 3;\n\n  /** The size of medium padding. */\n  MEDIUM_PADDING = 5;\n\n  /** The size of medium-large padding. */\n  MEDIUM_LARGE_PADDING = 8;\n\n  /** The size of large padding. */\n  LARGE_PADDING = 10;\n  TALL_INPUT_FIELD_OFFSET_Y: number;\n\n  /** The height of the puzzle tab used for input and output connections. */\n  TAB_HEIGHT = 15;\n\n  /**\n   * The offset from the top of the block at which a puzzle tab is positioned.\n   */\n  TAB_OFFSET_FROM_TOP = 5;\n\n  /**\n   * Vertical overlap of the puzzle tab, used to make it look more like a\n   * puzzle piece.\n   */\n  TAB_VERTICAL_OVERLAP = 2.5;\n\n  /** The width of the puzzle tab used for input and output connections. */\n  TAB_WIDTH = 8;\n\n  /** The width of the notch used for previous and next connections. */\n  NOTCH_WIDTH = 15;\n\n  /** The height of the notch used for previous and next connections. */\n  NOTCH_HEIGHT = 4;\n\n  /** The minimum width of the block. */\n  MIN_BLOCK_WIDTH = 12;\n  EMPTY_BLOCK_SPACER_HEIGHT = 16;\n  DUMMY_INPUT_MIN_HEIGHT: number;\n  DUMMY_INPUT_SHADOW_MIN_HEIGHT: number;\n\n  /** Rounded corner radius. */\n  CORNER_RADIUS = 8;\n\n  /**\n   * Offset from the left side of a block or the inside of a statement input\n   * to the left side of the notch.\n   */\n  NOTCH_OFFSET_LEFT = 15;\n  STATEMENT_INPUT_NOTCH_OFFSET: number;\n\n  STATEMENT_BOTTOM_SPACER = 0;\n  STATEMENT_INPUT_PADDING_LEFT = 20;\n\n  /** Vertical padding between consecutive statement inputs. */\n  BETWEEN_STATEMENT_PADDING_Y = 4;\n  TOP_ROW_MIN_HEIGHT: number;\n  TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT: number;\n  BOTTOM_ROW_MIN_HEIGHT: number;\n  BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT: number;\n\n  /**\n   * Whether to add a 'hat' on top of all blocks with no previous or output\n   * connections. Can be overridden by 'hat' property on Theme.BlockStyle.\n   */\n  ADD_START_HATS = false;\n\n  /** Height of the top hat. */\n  START_HAT_HEIGHT = 15;\n\n  /** Width of the top hat. */\n  START_HAT_WIDTH = 100;\n\n  SPACER_DEFAULT_HEIGHT = 15;\n\n  MIN_BLOCK_HEIGHT = 24;\n\n  EMPTY_INLINE_INPUT_PADDING = 14.5;\n  EMPTY_INLINE_INPUT_HEIGHT: number;\n\n  EXTERNAL_VALUE_INPUT_PADDING = 2;\n  EMPTY_STATEMENT_INPUT_HEIGHT: number;\n  START_POINT: string;\n\n  /** Height of SVG path for jagged teeth at the end of collapsed blocks. */\n  JAGGED_TEETH_HEIGHT = 12;\n\n  /** Width of SVG path for jagged teeth at the end of collapsed blocks. */\n  JAGGED_TEETH_WIDTH = 6;\n\n  /** Point size of text. */\n  FIELD_TEXT_FONTSIZE = 11;\n\n  /** Text font weight. */\n  FIELD_TEXT_FONTWEIGHT = 'normal';\n\n  /** Text font family. */\n  FIELD_TEXT_FONTFAMILY = 'sans-serif';\n\n  /**\n   * Height of text.  This constant is dynamically set in\n   * `setFontConstants_` to be the height of the text based on the font\n   * used.\n   */\n  FIELD_TEXT_HEIGHT = -1; // Dynamically set.\n\n  /**\n   * Text baseline.  This constant is dynamically set in `setFontConstants_`\n   * to be the baseline of the text based on the font used.\n   */\n  FIELD_TEXT_BASELINE = -1; // Dynamically set.\n\n  /** A field's border rect corner radius. */\n  FIELD_BORDER_RECT_RADIUS = 4;\n\n  /** A field's border rect default height. */\n  FIELD_BORDER_RECT_HEIGHT = 16;\n\n  /** A field's border rect X padding. */\n  FIELD_BORDER_RECT_X_PADDING = 5;\n\n  /** A field's border rect Y padding. */\n  FIELD_BORDER_RECT_Y_PADDING = 3;\n\n  /**\n   * The backing colour of a field's border rect.\n   */\n  FIELD_BORDER_RECT_COLOUR = '#fff';\n  FIELD_TEXT_BASELINE_CENTER: boolean;\n  FIELD_DROPDOWN_BORDER_RECT_HEIGHT: number;\n\n  /**\n   * Whether or not a dropdown field should add a border rect when in a shadow\n   * block.\n   */\n  FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW = false;\n\n  /**\n   * Whether or not a dropdown field's div should be coloured to match the\n   * block colours.\n   */\n  FIELD_DROPDOWN_COLOURED_DIV = false;\n\n  /** Whether or not a dropdown field uses a text or SVG arrow. */\n  FIELD_DROPDOWN_SVG_ARROW = false;\n  FIELD_DROPDOWN_SVG_ARROW_PADDING: number;\n\n  /** A dropdown field's SVG arrow size. */\n  FIELD_DROPDOWN_SVG_ARROW_SIZE = 12;\n  FIELD_DROPDOWN_SVG_ARROW_DATAURI: string;\n\n  /**\n   * Whether or not to show a box shadow around the widget div. This is only a\n   * feature of full block fields.\n   */\n  FIELD_TEXTINPUT_BOX_SHADOW = false;\n\n  /**\n   * Whether or not the colour field should display its colour value on the\n   * entire block.\n   */\n  FIELD_COLOUR_FULL_BLOCK = false;\n\n  /** A colour field's default width. */\n  FIELD_COLOUR_DEFAULT_WIDTH = 26;\n  FIELD_COLOUR_DEFAULT_HEIGHT: number;\n  FIELD_CHECKBOX_X_OFFSET: number;\n  randomIdentifier: string;\n\n  /**\n   * The defs tag that contains all filters and patterns for this Blockly\n   * instance.\n   */\n  private defs: SVGElement | null = null;\n\n  /**\n   * The ID of the emboss filter, or the empty string if no filter is set.\n   */\n  embossFilterId = '';\n\n  /** The <filter> element to use for highlighting, or null if not set. */\n  private embossFilter: SVGElement | null = null;\n\n  /**\n   * The ID of the disabled pattern, or the empty string if no pattern is set.\n   */\n  disabledPatternId = '';\n\n  /**\n   * The <pattern> element to use for disabled blocks, or null if not set.\n   */\n  private disabledPattern: SVGElement | null = null;\n\n  /**\n   * The ID of the debug filter, or the empty string if no pattern is set.\n   */\n  debugFilterId = '';\n\n  /**\n   * The <filter> element to use for a debug highlight, or null if not set.\n   */\n  private debugFilter: SVGElement | null = null;\n\n  /** The <style> element to use for injecting renderer specific CSS. */\n  private cssNode: HTMLStyleElement | null = null;\n\n  /**\n   * Cursor colour.\n   */\n  CURSOR_COLOUR = '#cc0a0a';\n\n  /**\n   * Immovable marker colour.\n   */\n  MARKER_COLOUR = '#4286f4';\n\n  /**\n   * Width of the horizontal cursor.\n   */\n  CURSOR_WS_WIDTH = 100;\n\n  /**\n   * Height of the horizontal cursor.\n   */\n  WS_CURSOR_HEIGHT = 5;\n\n  /**\n   * Padding around a stack.\n   */\n  CURSOR_STACK_PADDING = 10;\n\n  /**\n   * Padding around a block.\n   */\n  CURSOR_BLOCK_PADDING = 2;\n\n  /**\n   * Stroke of the cursor.\n   */\n  CURSOR_STROKE_WIDTH = 4;\n\n  /**\n   * Whether text input and colour fields fill up the entire source block.\n   */\n  FULL_BLOCK_FIELDS = false;\n\n  /**\n   * The main colour of insertion markers, in hex.  The block is rendered a\n   * transparent grey by changing the fill opacity in CSS.\n   */\n  INSERTION_MARKER_COLOUR = '#000000';\n\n  /**\n   * The insertion marker opacity.\n   */\n  INSERTION_MARKER_OPACITY = 0.2;\n\n  SHAPES: {[key: string]: number} = {PUZZLE: 1, NOTCH: 2};\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  JAGGED_TEETH!: JaggedTeeth;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  NOTCH!: Notch;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  START_HAT!: StartHat;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  PUZZLE_TAB!: PuzzleTab;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  INSIDE_CORNERS!: InsideCorners;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  OUTSIDE_CORNERS!: OutsideCorners;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n\n  blockStyles!: {[key: string]: BlockStyle};\n\n  constructor() {\n    /**\n     * Offset from the top of the row for placing fields on inline input rows\n     * and statement input rows.\n     * Matches existing rendering (in 2019).\n     */\n    this.TALL_INPUT_FIELD_OFFSET_Y = this.MEDIUM_PADDING;\n\n    /** The minimum height of a dummy input row. */\n    this.DUMMY_INPUT_MIN_HEIGHT = this.TAB_HEIGHT;\n\n    /** The minimum height of a dummy input row in a shadow block. */\n    this.DUMMY_INPUT_SHADOW_MIN_HEIGHT = this.TAB_HEIGHT;\n\n    /**\n     * Additional offset added to the statement input's width to account for the\n     * notch.\n     */\n    this.STATEMENT_INPUT_NOTCH_OFFSET = this.NOTCH_OFFSET_LEFT;\n\n    /** The top row's minimum height. */\n    this.TOP_ROW_MIN_HEIGHT = this.MEDIUM_PADDING;\n\n    /** The top row's minimum height if it precedes a statement. */\n    this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT = this.LARGE_PADDING;\n\n    /** The bottom row's minimum height. */\n    this.BOTTOM_ROW_MIN_HEIGHT = this.MEDIUM_PADDING;\n\n    /** The bottom row's minimum height if it follows a statement input. */\n    this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT = this.LARGE_PADDING;\n\n    /** The height of an empty inline input. */\n    this.EMPTY_INLINE_INPUT_HEIGHT = this.TAB_HEIGHT + 11;\n\n    /**\n     * The height of an empty statement input.  Note that in the old rendering\n     * this varies slightly depending on whether the block has external or\n     * inline inputs. In the new rendering this is consistent.  It seems\n     * unlikely that the old behaviour was intentional.\n     */\n    this.EMPTY_STATEMENT_INPUT_HEIGHT = this.MIN_BLOCK_HEIGHT;\n\n    this.START_POINT = svgPaths.moveBy(0, 0);\n\n    /**\n     * A field's text element's dominant baseline. Pre-2022 this could be false\n     * for certain browsers.\n     */\n    this.FIELD_TEXT_BASELINE_CENTER = true;\n\n    /** A dropdown field's border rect height. */\n    this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT = this.FIELD_BORDER_RECT_HEIGHT;\n\n    /** A dropdown field's SVG arrow padding. */\n    this.FIELD_DROPDOWN_SVG_ARROW_PADDING = this.FIELD_BORDER_RECT_X_PADDING;\n\n    /** A dropdown field's SVG arrow datauri. */\n    this.FIELD_DROPDOWN_SVG_ARROW_DATAURI =\n      'data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllci' +\n      'AxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaG' +\n      'VpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLW' +\n      'Fycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuND' +\n      'EsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTD' +\n      'AuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNz' +\n      'FDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMC' +\n      'wxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNz' +\n      'lhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYz' +\n      'AuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMz' +\n      'dBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=';\n\n    /** A colour field's default height. */\n    this.FIELD_COLOUR_DEFAULT_HEIGHT = this.FIELD_BORDER_RECT_HEIGHT;\n\n    /** A checkbox field's X offset. */\n    this.FIELD_CHECKBOX_X_OFFSET = this.FIELD_BORDER_RECT_X_PADDING - 3;\n\n    /**\n     * A random identifier used to ensure a unique ID is used for each\n     * filter/pattern for the case of multiple Blockly instances on a page.\n     */\n    this.randomIdentifier = String(Math.random()).substring(2);\n  }\n\n  /**\n   * Initialize shape objects based on the constants set in the constructor.\n   */\n  init() {\n    /**\n     * An object containing sizing and path information about collapsed block\n     * indicators.\n     */\n    this.JAGGED_TEETH = this.makeJaggedTeeth();\n\n    /** An object containing sizing and path information about notches. */\n    this.NOTCH = this.makeNotch();\n\n    /** An object containing sizing and path information about start hats */\n    this.START_HAT = this.makeStartHat();\n\n    /**\n     * An object containing sizing and path information about puzzle tabs.\n     */\n    this.PUZZLE_TAB = this.makePuzzleTab();\n\n    /**\n     * An object containing sizing and path information about inside corners\n     */\n    this.INSIDE_CORNERS = this.makeInsideCorners();\n\n    /**\n     * An object containing sizing and path information about outside corners.\n     */\n    this.OUTSIDE_CORNERS = this.makeOutsideCorners();\n  }\n\n  /**\n   * Refresh constants properties that depend on the theme.\n   *\n   * @param theme The current workspace theme.\n   */\n  setTheme(theme: Theme) {\n    /** The block styles map. */\n    this.blockStyles = Object.create(null);\n\n    const blockStyles = theme.blockStyles;\n    for (const key in blockStyles) {\n      this.blockStyles[key] = this.validatedBlockStyle_(blockStyles[key]);\n    }\n\n    this.setDynamicProperties_(theme);\n  }\n\n  /**\n   * Sets dynamic properties that depend on other values or theme properties.\n   *\n   * @param theme The current workspace theme.\n   */\n  protected setDynamicProperties_(theme: Theme) {\n    this.setFontConstants_(theme);\n    this.setComponentConstants_(theme);\n\n    this.ADD_START_HATS =\n      theme.startHats !== undefined ? theme.startHats : this.ADD_START_HATS;\n  }\n\n  /**\n   * Set constants related to fonts.\n   *\n   * @param theme The current workspace theme.\n   */\n  protected setFontConstants_(theme: Theme) {\n    if (theme.fontStyle && theme.fontStyle['family']) {\n      this.FIELD_TEXT_FONTFAMILY = theme.fontStyle['family'];\n    }\n\n    if (theme.fontStyle && theme.fontStyle['weight']) {\n      this.FIELD_TEXT_FONTWEIGHT = theme.fontStyle['weight'];\n    }\n\n    if (theme.fontStyle && theme.fontStyle['size']) {\n      this.FIELD_TEXT_FONTSIZE = theme.fontStyle['size'];\n    }\n\n    const fontMetrics = dom.measureFontMetrics(\n      'Hg',\n      this.FIELD_TEXT_FONTSIZE + 'pt',\n      this.FIELD_TEXT_FONTWEIGHT,\n      this.FIELD_TEXT_FONTFAMILY\n    );\n\n    this.FIELD_TEXT_HEIGHT = fontMetrics.height;\n    this.FIELD_TEXT_BASELINE = fontMetrics.baseline;\n  }\n\n  /**\n   * Set constants from a theme's component styles.\n   *\n   * @param theme The current workspace theme.\n   */\n  protected setComponentConstants_(theme: Theme) {\n    this.CURSOR_COLOUR =\n      theme.getComponentStyle('cursorColour') || this.CURSOR_COLOUR;\n    this.MARKER_COLOUR =\n      theme.getComponentStyle('markerColour') || this.MARKER_COLOUR;\n    this.INSERTION_MARKER_COLOUR =\n      theme.getComponentStyle('insertionMarkerColour') ||\n      this.INSERTION_MARKER_COLOUR;\n    this.INSERTION_MARKER_OPACITY =\n      Number(theme.getComponentStyle('insertionMarkerOpacity')) ||\n      this.INSERTION_MARKER_OPACITY;\n  }\n\n  /**\n   * Get or create a block style based on a single colour value.  Generate a\n   * name for the style based on the colour.\n   *\n   * @param colour #RRGGBB colour string.\n   * @returns An object containing the style and an autogenerated name for that\n   *     style.\n   */\n  getBlockStyleForColour(colour: string): {style: BlockStyle; name: string} {\n    const name = 'auto_' + colour;\n    if (!this.blockStyles[name]) {\n      this.blockStyles[name] = this.createBlockStyle_(colour);\n    }\n    return {style: this.blockStyles[name], name};\n  }\n\n  /**\n   * Gets the BlockStyle for the given block style name.\n   *\n   * @param blockStyleName The name of the block style.\n   * @returns The named block style, or a default style if no style with the\n   *     given name was found.\n   */\n  getBlockStyle(blockStyleName: string | null): BlockStyle {\n    return (\n      this.blockStyles[blockStyleName || ''] ||\n      (blockStyleName && blockStyleName.indexOf('auto_') === 0\n        ? this.getBlockStyleForColour(blockStyleName.substring(5)).style\n        : this.createBlockStyle_('#000000'))\n    );\n  }\n\n  /**\n   * Create a block style object based on the given colour.\n   *\n   * @param colour #RRGGBB colour string.\n   * @returns A populated block style based on the given colour.\n   */\n  protected createBlockStyle_(colour: string): BlockStyle {\n    return this.validatedBlockStyle_({'colourPrimary': colour});\n  }\n\n  /**\n   * Get a full block style object based on the input style object.  Populate\n   * any missing values.\n   *\n   * @param blockStyle A full or partial block style object.\n   * @returns A full block style object, with all required properties populated.\n   */\n  protected validatedBlockStyle_(blockStyle: Partial<BlockStyle>): BlockStyle {\n    // Make a new object with all of the same properties.\n    const valid = {} as BlockStyle;\n    if (blockStyle) {\n      Object.assign(valid, blockStyle);\n    }\n    // Validate required properties.\n    const parsedColour = parsing.parseBlockColour(\n      valid['colourPrimary'] || '#000'\n    );\n    valid.colourPrimary = parsedColour.hex;\n    valid.colourSecondary = valid['colourSecondary']\n      ? parsing.parseBlockColour(valid['colourSecondary']).hex\n      : this.generateSecondaryColour_(valid.colourPrimary);\n    valid.colourTertiary = valid['colourTertiary']\n      ? parsing.parseBlockColour(valid['colourTertiary']).hex\n      : this.generateTertiaryColour_(valid.colourPrimary);\n\n    valid.hat = valid['hat'] || '';\n    return valid;\n  }\n\n  /**\n   * Generate a secondary colour from the passed in primary colour.\n   *\n   * @param inputColour Primary colour.\n   * @returns The generated secondary colour.\n   */\n  protected generateSecondaryColour_(inputColour: string): string {\n    return colour.blend('#fff', inputColour, 0.6) || inputColour;\n  }\n\n  /**\n   * Generate a tertiary colour from the passed in primary colour.\n   *\n   * @param inputColour Primary colour.\n   * @returns The generated tertiary colour.\n   */\n  protected generateTertiaryColour_(inputColour: string): string {\n    return colour.blend('#fff', inputColour, 0.3) || inputColour;\n  }\n\n  /**\n   * Dispose of this constants provider.\n   * Delete all DOM elements that this provider created.\n   */\n  dispose() {\n    if (this.embossFilter) {\n      dom.removeNode(this.embossFilter);\n    }\n    if (this.disabledPattern) {\n      dom.removeNode(this.disabledPattern);\n    }\n    if (this.debugFilter) {\n      dom.removeNode(this.debugFilter);\n    }\n    this.cssNode = null;\n  }\n\n  /**\n   * @returns An object containing sizing and path information about collapsed\n   *     block indicators.\n   */\n  protected makeJaggedTeeth(): JaggedTeeth {\n    const height = this.JAGGED_TEETH_HEIGHT;\n    const width = this.JAGGED_TEETH_WIDTH;\n\n    const mainPath = svgPaths.line([\n      svgPaths.point(width, height / 4),\n      svgPaths.point(-width * 2, height / 2),\n      svgPaths.point(width, height / 4),\n    ]);\n    return {height, width, path: mainPath};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about start hats.\n   */\n  protected makeStartHat(): StartHat {\n    const height = this.START_HAT_HEIGHT;\n    const width = this.START_HAT_WIDTH;\n\n    const mainPath = svgPaths.curve('c', [\n      svgPaths.point(30, -height),\n      svgPaths.point(70, -height),\n      svgPaths.point(width, 0),\n    ]);\n    return {height, width, path: mainPath};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about puzzle\n   *     tabs.\n   */\n  protected makePuzzleTab(): PuzzleTab {\n    const width = this.TAB_WIDTH;\n    const height = this.TAB_HEIGHT;\n\n    /**\n     * Make the main path for the puzzle tab made out of a few curves (c and s).\n     * Those curves are defined with relative positions.  The 'up' and 'down'\n     * versions of the paths are the same, but the Y sign flips.  Forward and\n     * back are the signs to use to move the cursor in the direction that the\n     * path is being drawn.\n     *\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @returns A path fragment describing a puzzle tab.\n     */\n    function makeMainPath(up: boolean): string {\n      const forward = up ? -1 : 1;\n      const back = -forward;\n\n      const overlap = 2.5;\n      const halfHeight = height / 2;\n      const control1Y = halfHeight + overlap;\n      const control2Y = halfHeight + 0.5;\n      const control3Y = overlap; // 2.5\n\n      const endPoint1 = svgPaths.point(-width, forward * halfHeight);\n      const endPoint2 = svgPaths.point(width, forward * halfHeight);\n\n      return (\n        svgPaths.curve('c', [\n          svgPaths.point(0, forward * control1Y),\n          svgPaths.point(-width, back * control2Y),\n          endPoint1,\n        ]) +\n        svgPaths.curve('s', [\n          svgPaths.point(width, back * control3Y),\n          endPoint2,\n        ])\n      );\n    }\n\n    // c 0,-10  -8,8  -8,-7.5  s 8,2.5  8,-7.5\n    const pathUp = makeMainPath(true);\n    // c 0,10  -8,-8  -8,7.5  s 8,-2.5  8,7.5\n    const pathDown = makeMainPath(false);\n\n    return {\n      type: this.SHAPES.PUZZLE,\n      width,\n      height,\n      pathDown,\n      pathUp,\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about notches.\n   */\n  protected makeNotch(): Notch {\n    const width = this.NOTCH_WIDTH;\n    const height = this.NOTCH_HEIGHT;\n    const innerWidth = 3;\n    const outerWidth = (width - innerWidth) / 2;\n\n    /**\n     * Make the main path for the notch.\n     *\n     * @param dir Direction multiplier to apply to horizontal offsets along the\n     *     path. Either 1 or -1.\n     * @returns A path fragment describing a notch.\n     */\n    function makeMainPath(dir: number): string {\n      return svgPaths.line([\n        svgPaths.point(dir * outerWidth, height),\n        svgPaths.point(dir * innerWidth, 0),\n        svgPaths.point(dir * outerWidth, -height),\n      ]);\n    }\n    const pathLeft = makeMainPath(1);\n    const pathRight = makeMainPath(-1);\n\n    return {\n      type: this.SHAPES.NOTCH,\n      width,\n      height,\n      pathLeft,\n      pathRight,\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about inside\n   *     corners.\n   */\n  protected makeInsideCorners(): InsideCorners {\n    const radius = this.CORNER_RADIUS;\n\n    const innerTopLeftCorner = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius,\n      svgPaths.point(-radius, radius)\n    );\n\n    const innerBottomLeftCorner = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius,\n      svgPaths.point(radius, radius)\n    );\n\n    return {\n      width: radius,\n      height: radius,\n      pathTop: innerTopLeftCorner,\n      pathBottom: innerBottomLeftCorner,\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about outside\n   *     corners.\n   */\n  protected makeOutsideCorners(): OutsideCorners {\n    const radius = this.CORNER_RADIUS;\n    /** SVG path for drawing the rounded top-left corner. */\n    const topLeft =\n      svgPaths.moveBy(0, radius) +\n      svgPaths.arc('a', '0 0,1', radius, svgPaths.point(radius, -radius));\n\n    /** SVG path for drawing the rounded top-right corner. */\n    const topRight = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(radius, radius)\n    );\n\n    /** SVG path for drawing the rounded bottom-left corner. */\n    const bottomLeft = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(-radius, -radius)\n    );\n\n    /** SVG path for drawing the rounded bottom-right corner. */\n    const bottomRight = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(-radius, radius)\n    );\n\n    return {\n      topLeft,\n      topRight,\n      bottomRight,\n      bottomLeft,\n      rightHeight: radius,\n    };\n  }\n\n  /**\n   * Get an object with connection shape and sizing information based on the\n   * type of the connection.\n   *\n   * @param connection The connection to find a shape object for\n   * @returns The shape object for the connection.\n   */\n  shapeFor(connection: RenderedConnection): Shape {\n    switch (connection.type) {\n      case ConnectionType.INPUT_VALUE:\n      case ConnectionType.OUTPUT_VALUE:\n        return this.PUZZLE_TAB;\n      case ConnectionType.PREVIOUS_STATEMENT:\n      case ConnectionType.NEXT_STATEMENT:\n        return this.NOTCH;\n      default:\n        throw Error('Unknown connection type');\n    }\n  }\n\n  /**\n   * Create any DOM elements that this renderer needs (filters, patterns, etc).\n   *\n   * @param svg The root of the workspace's SVG.\n   * @param tagName The name to use for the CSS style tag.\n   * @param selector The CSS selector to use.\n   */\n  createDom(svg: SVGElement, tagName: string, selector: string) {\n    this.injectCSS_(tagName, selector);\n\n    /*\n        <defs>\n          ... filters go here ...\n        </defs>\n        */\n    this.defs = dom.createSvgElement(Svg.DEFS, {}, svg);\n    /*\n          <filter id=\"blocklyEmbossFilter837493\">\n            <feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"1\" result=\"blur\" />\n            <feSpecularLighting in=\"blur\" surfaceScale=\"1\"\n       specularConstant=\"0.5\" specularExponent=\"10\" lighting-color=\"white\"\n                                result=\"specOut\">\n              <fePointLight x=\"-5000\" y=\"-10000\" z=\"20000\" />\n            </feSpecularLighting>\n            <feComposite in=\"specOut\" in2=\"SourceAlpha\" operator=\"in\"\n                         result=\"specOut\" />\n            <feComposite in=\"SourceGraphic\" in2=\"specOut\" operator=\"arithmetic\"\n                         k1=\"0\" k2=\"1\" k3=\"1\" k4=\"0\" />\n          </filter>\n        */\n    const embossFilter = dom.createSvgElement(\n      Svg.FILTER,\n      {'id': 'blocklyEmbossFilter' + this.randomIdentifier},\n      this.defs\n    );\n    dom.createSvgElement(\n      Svg.FEGAUSSIANBLUR,\n      {'in': 'SourceAlpha', 'stdDeviation': 1, 'result': 'blur'},\n      embossFilter\n    );\n    const feSpecularLighting = dom.createSvgElement(\n      Svg.FESPECULARLIGHTING,\n      {\n        'in': 'blur',\n        'surfaceScale': 1,\n        'specularConstant': 0.5,\n        'specularExponent': 10,\n        'lighting-color': 'white',\n        'result': 'specOut',\n      },\n      embossFilter\n    );\n    dom.createSvgElement(\n      Svg.FEPOINTLIGHT,\n      {'x': -5000, 'y': -10000, 'z': 20000},\n      feSpecularLighting\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'specOut',\n        'in2': 'SourceAlpha',\n        'operator': 'in',\n        'result': 'specOut',\n      },\n      embossFilter\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'SourceGraphic',\n        'in2': 'specOut',\n        'operator': 'arithmetic',\n        'k1': 0,\n        'k2': 1,\n        'k3': 1,\n        'k4': 0,\n      },\n      embossFilter\n    );\n    this.embossFilterId = embossFilter.id;\n    this.embossFilter = embossFilter;\n\n    /*\n          <pattern id=\"blocklyDisabledPattern837493\"\n       patternUnits=\"userSpaceOnUse\" width=\"10\" height=\"10\"> <rect width=\"10\"\n       height=\"10\" fill=\"#aaa\" /> <path d=\"M 0 0 L 10 10 M 10 0 L 0 10\"\n       stroke=\"#cc0\" />\n          </pattern>\n        */\n    const disabledPattern = dom.createSvgElement(\n      Svg.PATTERN,\n      {\n        'id': 'blocklyDisabledPattern' + this.randomIdentifier,\n        'patternUnits': 'userSpaceOnUse',\n        'width': 10,\n        'height': 10,\n      },\n      this.defs\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {'width': 10, 'height': 10, 'fill': '#aaa'},\n      disabledPattern\n    );\n    dom.createSvgElement(\n      Svg.PATH,\n      {'d': 'M 0 0 L 10 10 M 10 0 L 0 10', 'stroke': '#cc0'},\n      disabledPattern\n    );\n    this.disabledPatternId = disabledPattern.id;\n    this.disabledPattern = disabledPattern;\n\n    this.createDebugFilter();\n  }\n\n  /**\n   * Create a filter for highlighting the currently rendering block during\n   * render debugging.\n   */\n  private createDebugFilter() {\n    // Only create the debug filter once.\n    if (!this.debugFilter) {\n      const debugFilter = dom.createSvgElement(\n        Svg.FILTER,\n        {\n          'id': 'blocklyDebugFilter' + this.randomIdentifier,\n          'height': '160%',\n          'width': '180%',\n          'y': '-30%',\n          'x': '-40%',\n        },\n        this.defs\n      );\n      // Set all gaussian blur pixels to 1 opacity before applying flood\n      const debugComponentTransfer = dom.createSvgElement(\n        Svg.FECOMPONENTTRANSFER,\n        {'result': 'outBlur'},\n        debugFilter\n      );\n      dom.createSvgElement(\n        Svg.FEFUNCA,\n        {'type': 'table', 'tableValues': '0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1'},\n        debugComponentTransfer\n      );\n      // Color the highlight\n      dom.createSvgElement(\n        Svg.FEFLOOD,\n        {\n          'flood-color': '#ff0000',\n          'flood-opacity': 0.5,\n          'result': 'outColor',\n        },\n        debugFilter\n      );\n      dom.createSvgElement(\n        Svg.FECOMPOSITE,\n        {\n          'in': 'outColor',\n          'in2': 'outBlur',\n          'operator': 'in',\n          'result': 'outGlow',\n        },\n        debugFilter\n      );\n      this.debugFilterId = debugFilter.id;\n      this.debugFilter = debugFilter;\n    }\n  }\n\n  /**\n   * Inject renderer specific CSS into the page.\n   *\n   * @param tagName The name of the style tag to use.\n   * @param selector The CSS selector to use.\n   */\n  protected injectCSS_(tagName: string, selector: string) {\n    const cssArray = this.getCSS_(selector);\n    const cssNodeId = 'blockly-renderer-style-' + tagName;\n    this.cssNode = document.getElementById(cssNodeId) as HTMLStyleElement;\n    const text = cssArray.join('\\n');\n    if (this.cssNode) {\n      // Already injected, update if the theme changed.\n      this.cssNode.firstChild!.textContent = text;\n      return;\n    }\n    // Inject CSS tag at start of head.\n    const cssNode = document.createElement('style');\n    cssNode.id = cssNodeId;\n    const cssTextNode = document.createTextNode(text);\n    cssNode.appendChild(cssTextNode);\n    document.head.insertBefore(cssNode, document.head.firstChild);\n    this.cssNode = cssNode;\n  }\n\n  /**\n   * Get any renderer specific CSS to inject when the renderer is initialized.\n   *\n   * @param selector CSS selector to use.\n   * @returns Array of CSS strings.\n   */\n  protected getCSS_(selector: string): string[] {\n    // prettier-ignore\n    return [\n      // Text.\n      `${selector} .blocklyText, `,\n      `${selector} .blocklyFlyoutLabelText {`,\n        `font: ${this.FIELD_TEXT_FONTWEIGHT} ` +\n            `${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,\n      `}`,\n\n      // Fields.\n      `${selector} .blocklyText {`,\n        `fill: #fff;`,\n      `}`,\n      `${selector} .blocklyNonEditableText>rect,`,\n      `${selector} .blocklyEditableText>rect {`,\n        `fill: ${this.FIELD_BORDER_RECT_COLOUR};`,\n        `fill-opacity: .6;`,\n        `stroke: none;`,\n      `}`,\n      `${selector} .blocklyNonEditableText>text,`,\n      `${selector} .blocklyEditableText>text {`,\n        `fill: #000;`,\n      `}`,\n\n      // Flyout labels.\n      `${selector} .blocklyFlyoutLabelText {`,\n        `fill: #000;`,\n      `}`,\n\n      // Bubbles.\n      `${selector} .blocklyText.blocklyBubbleText {`,\n        `fill: #000;`,\n      `}`,\n\n      // Editable field hover.\n      `${selector} .blocklyEditableText:not(.editing):hover>rect {`,\n        `stroke: #fff;`,\n        `stroke-width: 2;`,\n      `}`,\n\n      // Text field input.\n      `${selector} .blocklyHtmlInput {`,\n        `font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\n        `font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,\n      `}`,\n\n      // Selection highlight.\n      `${selector} .blocklySelected>.blocklyPath {`,\n        `stroke: #fc3;`,\n        `stroke-width: 3px;`,\n      `}`,\n\n      // Connection highlight.\n      `${selector} .blocklyHighlightedConnectionPath {`,\n        `stroke: #fc3;`,\n      `}`,\n\n      // Replaceable highlight.\n      `${selector} .blocklyReplaceable .blocklyPath {`,\n        `fill-opacity: .5;`,\n      `}`,\n      `${selector} .blocklyReplaceable .blocklyPathLight,`,\n      `${selector} .blocklyReplaceable .blocklyPathDark {`,\n        `display: none;`,\n      `}`,\n\n      // Insertion marker.\n      `${selector} .blocklyInsertionMarker>.blocklyPath {`,\n        `fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n        `stroke: none;`,\n      `}`,\n    ];\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering');\n\nimport * as registry from '../../registry.js';\nimport type {Theme} from '../../theme.js';\nimport {Measurable} from '../measurables/base.js';\nimport {BottomRow} from '../measurables/bottom_row.js';\nimport {Connection} from '../measurables/connection.js';\nimport {ExternalValueInput} from '../measurables/external_value_input.js';\nimport {Field} from '../measurables/field.js';\nimport {Hat} from '../measurables/hat.js';\nimport {Icon} from '../measurables/icon.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InlineInput} from '../measurables/inline_input.js';\nimport {InputConnection} from '../measurables/input_connection.js';\nimport {InputRow} from '../measurables/input_row.js';\nimport {JaggedEdge} from '../measurables/jagged_edge.js';\nimport {NextConnection} from '../measurables/next_connection.js';\nimport {OutputConnection} from '../measurables/output_connection.js';\nimport {PreviousConnection} from '../measurables/previous_connection.js';\nimport {RoundCorner} from '../measurables/round_corner.js';\nimport {Row} from '../measurables/row.js';\nimport {SpacerRow} from '../measurables/spacer_row.js';\nimport {SquareCorner} from '../measurables/square_corner.js';\nimport {StatementInput} from '../measurables/statement_input.js';\nimport {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport type {IPathObject} from './i_path_object.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {PathObject} from './path_object.js';\nimport {Renderer} from './renderer.js';\n\n/**\n * Registers a new renderer.\n *\n * @param name The name of the renderer.\n * @param rendererClass The new renderer class to register.\n * @throws {Error} if a renderer with the same name has already been registered.\n */\nexport function register(name: string, rendererClass: Function) {\n  registry.register(registry.Type.RENDERER, name, rendererClass);\n}\n\n/**\n * Unregisters the renderer registered with the given name.\n *\n * @param name The name of the renderer.\n */\nexport function unregister(name: string) {\n  registry.unregister(registry.Type.RENDERER, name);\n}\n\n/**\n * Initialize anything needed for rendering (constants, etc).\n *\n * @param name Name of the renderer to initialize.\n * @param theme The workspace theme object.\n * @param opt_rendererOverrides Rendering constant overrides.\n * @returns The new instance of a renderer.\n *     Already initialized.\n * @internal\n */\nexport function init(\n  name: string,\n  theme: Theme,\n  opt_rendererOverrides?: {[rendererConstant: string]: any}\n): Renderer {\n  const rendererClass = registry.getClass(registry.Type.RENDERER, name);\n  const renderer = new rendererClass!(name);\n  renderer.init(theme, opt_rendererOverrides);\n  return renderer;\n}\nexport {BottomRow};\nexport {Connection};\nexport {ConstantProvider};\nexport {Drawer};\nexport {ExternalValueInput};\nexport {Field};\nexport {Hat};\nexport {Icon};\nexport {InRowSpacer};\nexport {InlineInput};\nexport {InputConnection};\nexport {InputRow};\nexport {IPathObject};\nexport {JaggedEdge};\nexport {MarkerSvg};\nexport {Measurable};\nexport {NextConnection};\nexport {OutputConnection};\nexport {PathObject};\nexport {PreviousConnection};\nexport {Renderer};\nexport {RenderInfo};\nexport {RoundCorner};\nexport {Row};\nexport {SpacerRow};\nexport {SquareCorner};\nexport {StatementInput};\nexport {TopRow};\nexport {Types};\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ContextMenuItems');\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as clipboard from './clipboard.js';\nimport {\n  ContextMenuRegistry,\n  RegistryItem,\n  Scope,\n} from './contextmenu_registry.js';\nimport * as dialog from './dialog.js';\nimport * as Events from './events/events.js';\nimport * as eventUtils from './events/utils.js';\nimport {CommentIcon} from './icons/comment_icon.js';\nimport {Msg} from './msg.js';\nimport {StatementInput} from './renderers/zelos/zelos.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Option to undo previous action.\n */\nexport function registerUndo() {\n  const undoOption: RegistryItem = {\n    displayText() {\n      return Msg['UNDO'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.getUndoStack().length > 0) {\n        return 'enabled';\n      }\n      return 'disabled';\n    },\n    callback(scope: Scope) {\n      scope.workspace!.undo(false);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'undoWorkspace',\n    weight: 1,\n  };\n  ContextMenuRegistry.registry.register(undoOption);\n}\n\n/**\n * Option to redo previous action.\n */\nexport function registerRedo() {\n  const redoOption: RegistryItem = {\n    displayText() {\n      return Msg['REDO'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.getRedoStack().length > 0) {\n        return 'enabled';\n      }\n      return 'disabled';\n    },\n    callback(scope: Scope) {\n      scope.workspace!.undo(true);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'redoWorkspace',\n    weight: 2,\n  };\n  ContextMenuRegistry.registry.register(redoOption);\n}\n\n/**\n * Option to clean up blocks.\n */\nexport function registerCleanup() {\n  const cleanOption: RegistryItem = {\n    displayText() {\n      return Msg['CLEAN_UP'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.isMovable()) {\n        if (scope.workspace!.getTopBlocks(false).length > 1) {\n          return 'enabled';\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.workspace!.cleanUp();\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'cleanWorkspace',\n    weight: 3,\n  };\n  ContextMenuRegistry.registry.register(cleanOption);\n}\n/**\n * Creates a callback to collapse or expand top blocks.\n *\n * @param shouldCollapse Whether a block should collapse.\n * @param topBlocks Top blocks in the workspace.\n */\nfunction toggleOption_(shouldCollapse: boolean, topBlocks: BlockSvg[]) {\n  const DELAY = 10;\n  let ms = 0;\n  let timeoutCounter = 0;\n  function timeoutFn(block: BlockSvg) {\n    timeoutCounter--;\n    block.setCollapsed(shouldCollapse);\n    if (timeoutCounter === 0) {\n      Events.setGroup(false);\n    }\n  }\n  Events.setGroup(true);\n  for (let i = 0; i < topBlocks.length; i++) {\n    let block: BlockSvg | null = topBlocks[i];\n    while (block) {\n      timeoutCounter++;\n      setTimeout(timeoutFn.bind(null, block), ms);\n      block = block.getNextBlock();\n      ms += DELAY;\n    }\n  }\n}\n\n/**\n * Option to collapse all blocks.\n */\nexport function registerCollapse() {\n  const collapseOption: RegistryItem = {\n    displayText() {\n      return Msg['COLLAPSE_ALL'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.options.collapse) {\n        const topBlocks = scope.workspace!.getTopBlocks(false);\n        for (let i = 0; i < topBlocks.length; i++) {\n          let block: BlockSvg | null = topBlocks[i];\n          while (block) {\n            if (!block.isCollapsed()) {\n              return 'enabled';\n            }\n            block = block.getNextBlock();\n          }\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      toggleOption_(true, scope.workspace!.getTopBlocks(true));\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'collapseWorkspace',\n    weight: 4,\n  };\n  ContextMenuRegistry.registry.register(collapseOption);\n}\n\n/**\n * Option to expand all blocks.\n */\nexport function registerExpand() {\n  const expandOption: RegistryItem = {\n    displayText() {\n      return Msg['EXPAND_ALL'];\n    },\n    preconditionFn(scope: Scope) {\n      if (scope.workspace!.options.collapse) {\n        const topBlocks = scope.workspace!.getTopBlocks(false);\n        for (let i = 0; i < topBlocks.length; i++) {\n          let block: BlockSvg | null = topBlocks[i];\n          while (block) {\n            if (block.isCollapsed()) {\n              return 'enabled';\n            }\n            block = block.getNextBlock();\n          }\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      toggleOption_(false, scope.workspace!.getTopBlocks(true));\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'expandWorkspace',\n    weight: 5,\n  };\n  ContextMenuRegistry.registry.register(expandOption);\n}\n/**\n * Adds a block and its children to a list of deletable blocks.\n *\n * @param block to delete.\n * @param deleteList list of blocks that can be deleted.\n *     This will be modified in place with the given block and its descendants.\n */\nfunction addDeletableBlocks_(block: BlockSvg, deleteList: BlockSvg[]) {\n  if (block.isDeletable()) {\n    Array.prototype.push.apply(deleteList, block.getDescendants(false));\n  } else {\n    const children = block.getChildren(false);\n    for (let i = 0; i < children.length; i++) {\n      addDeletableBlocks_(children[i], deleteList);\n    }\n  }\n}\n\n/**\n * Constructs a list of blocks that can be deleted in the given workspace.\n *\n * @param workspace to delete all blocks from.\n * @returns list of blocks to delete.\n */\nfunction getDeletableBlocks_(workspace: WorkspaceSvg): BlockSvg[] {\n  const deleteList: BlockSvg[] = [];\n  const topBlocks = workspace.getTopBlocks(true);\n  for (let i = 0; i < topBlocks.length; i++) {\n    addDeletableBlocks_(topBlocks[i], deleteList);\n  }\n  return deleteList;\n}\n\n/**\n * Deletes the given blocks. Used to delete all blocks in the workspace.\n *\n * @param deleteList List of blocks to delete.\n * @param eventGroup Event group ID with which all delete events should be\n *     associated.  If not specified, create a new group.\n */\nfunction deleteNext_(deleteList: BlockSvg[], eventGroup?: string) {\n  const DELAY = 10;\n  if (eventGroup) {\n    eventUtils.setGroup(eventGroup);\n  } else {\n    eventUtils.setGroup(true);\n    eventGroup = eventUtils.getGroup();\n  }\n  const block = deleteList.shift();\n  if (block) {\n    if (!block.isDeadOrDying()) {\n      block.dispose(false, true);\n      setTimeout(deleteNext_, DELAY, deleteList, eventGroup);\n    } else {\n      deleteNext_(deleteList, eventGroup);\n    }\n  }\n  eventUtils.setGroup(false);\n}\n\n/**\n * Option to delete all blocks.\n */\nexport function registerDeleteAll() {\n  const deleteOption: RegistryItem = {\n    displayText(scope: Scope) {\n      if (!scope.workspace) {\n        return '';\n      }\n      const deletableBlocksLength = getDeletableBlocks_(scope.workspace).length;\n      if (deletableBlocksLength === 1) {\n        return Msg['DELETE_BLOCK'];\n      }\n      return Msg['DELETE_X_BLOCKS'].replace('%1', `${deletableBlocksLength}`);\n    },\n    preconditionFn(scope: Scope) {\n      if (!scope.workspace) {\n        return 'disabled';\n      }\n      const deletableBlocksLength = getDeletableBlocks_(scope.workspace).length;\n      return deletableBlocksLength > 0 ? 'enabled' : 'disabled';\n    },\n    callback(scope: Scope) {\n      if (!scope.workspace) {\n        return;\n      }\n      scope.workspace.cancelCurrentGesture();\n      const deletableBlocks = getDeletableBlocks_(scope.workspace);\n      if (deletableBlocks.length < 2) {\n        deleteNext_(deletableBlocks);\n      } else {\n        dialog.confirm(\n          Msg['DELETE_ALL_BLOCKS'].replace(\n            '%1',\n            String(deletableBlocks.length)\n          ),\n          function (ok) {\n            if (ok) {\n              deleteNext_(deletableBlocks);\n            }\n          }\n        );\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.WORKSPACE,\n    id: 'workspaceDelete',\n    weight: 6,\n  };\n  ContextMenuRegistry.registry.register(deleteOption);\n}\n/** Registers all workspace-scoped context menu items. */\nfunction registerWorkspaceOptions_() {\n  registerUndo();\n  registerRedo();\n  registerCleanup();\n  registerCollapse();\n  registerExpand();\n  registerDeleteAll();\n}\n\n/**\n * Option to duplicate a block.\n */\nexport function registerDuplicate() {\n  const duplicateOption: RegistryItem = {\n    displayText() {\n      return Msg['DUPLICATE_BLOCK'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (!block!.isInFlyout && block!.isDeletable() && block!.isMovable()) {\n        if (block!.isDuplicatable()) {\n          return 'enabled';\n        }\n        return 'disabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      if (scope.block) {\n        clipboard.duplicate(scope.block);\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockDuplicate',\n    weight: 1,\n  };\n  ContextMenuRegistry.registry.register(duplicateOption);\n}\n\n/**\n * Option to add or remove block-level comment.\n */\nexport function registerComment() {\n  const commentOption: RegistryItem = {\n    displayText(scope: Scope) {\n      if (scope.block!.hasIcon(CommentIcon.TYPE)) {\n        // If there's already a comment,  option is to remove.\n        return Msg['REMOVE_COMMENT'];\n      }\n      // If there's no comment yet, option is to add.\n      return Msg['ADD_COMMENT'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (\n        !block!.isInFlyout &&\n        block!.workspace.options.comments &&\n        !block!.isCollapsed() &&\n        block!.isEditable()\n      ) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      const block = scope.block;\n      if (block!.hasIcon(CommentIcon.TYPE)) {\n        block!.setCommentText(null);\n      } else {\n        block!.setCommentText('');\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockComment',\n    weight: 2,\n  };\n  ContextMenuRegistry.registry.register(commentOption);\n}\n\n/**\n * Option to inline variables.\n */\nexport function registerInline() {\n  const inlineOption: RegistryItem = {\n    displayText(scope: Scope) {\n      return scope.block!.getInputsInline()\n        ? Msg['EXTERNAL_INPUTS']\n        : Msg['INLINE_INPUTS'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (!block!.isInFlyout && block!.isMovable() && !block!.isCollapsed()) {\n        for (let i = 1; i < block!.inputList.length; i++) {\n          // Only display this option if there are two value or dummy inputs\n          // next to each other.\n          if (\n            !(block!.inputList[i - 1] instanceof StatementInput) &&\n            !(block!.inputList[i] instanceof StatementInput)\n          ) {\n            return 'enabled';\n          }\n        }\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.block!.setInputsInline(!scope.block!.getInputsInline());\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockInline',\n    weight: 3,\n  };\n  ContextMenuRegistry.registry.register(inlineOption);\n}\n\n/**\n * Option to collapse or expand a block.\n */\nexport function registerCollapseExpandBlock() {\n  const collapseExpandOption: RegistryItem = {\n    displayText(scope: Scope) {\n      return scope.block!.isCollapsed()\n        ? Msg['EXPAND_BLOCK']\n        : Msg['COLLAPSE_BLOCK'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (\n        !block!.isInFlyout &&\n        block!.isMovable() &&\n        block!.workspace.options.collapse\n      ) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.block!.setCollapsed(!scope.block!.isCollapsed());\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockCollapseExpand',\n    weight: 4,\n  };\n  ContextMenuRegistry.registry.register(collapseExpandOption);\n}\n\n/**\n * Option to disable or enable a block.\n */\nexport function registerDisable() {\n  const disableOption: RegistryItem = {\n    displayText(scope: Scope) {\n      return scope.block!.isEnabled()\n        ? Msg['DISABLE_BLOCK']\n        : Msg['ENABLE_BLOCK'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      if (\n        !block!.isInFlyout &&\n        block!.workspace.options.disable &&\n        block!.isEditable()\n      ) {\n        if (block!.getInheritedDisabled()) {\n          return 'disabled';\n        }\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      const block = scope.block;\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      block!.setEnabled(!block!.isEnabled());\n      eventUtils.setGroup(existingGroup);\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockDisable',\n    weight: 5,\n  };\n  ContextMenuRegistry.registry.register(disableOption);\n}\n\n/**\n * Option to delete a block.\n */\nexport function registerDelete() {\n  const deleteOption: RegistryItem = {\n    displayText(scope: Scope) {\n      const block = scope.block;\n      // Count the number of blocks that are nested in this block.\n      let descendantCount = block!.getDescendants(false).length;\n      const nextBlock = block!.getNextBlock();\n      if (nextBlock) {\n        // Blocks in the current stack would survive this block's deletion.\n        descendantCount -= nextBlock.getDescendants(false).length;\n      }\n      return descendantCount === 1\n        ? Msg['DELETE_BLOCK']\n        : Msg['DELETE_X_BLOCKS'].replace('%1', `${descendantCount}`);\n    },\n    preconditionFn(scope: Scope) {\n      if (!scope.block!.isInFlyout && scope.block!.isDeletable()) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      if (scope.block) {\n        scope.block.checkAndDelete();\n      }\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockDelete',\n    weight: 6,\n  };\n  ContextMenuRegistry.registry.register(deleteOption);\n}\n\n/**\n * Option to open help for a block.\n */\nexport function registerHelp() {\n  const helpOption: RegistryItem = {\n    displayText() {\n      return Msg['HELP'];\n    },\n    preconditionFn(scope: Scope) {\n      const block = scope.block;\n      const url =\n        typeof block!.helpUrl === 'function'\n          ? block!.helpUrl()\n          : block!.helpUrl;\n      if (url) {\n        return 'enabled';\n      }\n      return 'hidden';\n    },\n    callback(scope: Scope) {\n      scope.block!.showHelp();\n    },\n    scopeType: ContextMenuRegistry.ScopeType.BLOCK,\n    id: 'blockHelp',\n    weight: 7,\n  };\n  ContextMenuRegistry.registry.register(helpOption);\n}\n\n/** Registers all block-scoped context menu items. */\nfunction registerBlockOptions_() {\n  registerDuplicate();\n  registerComment();\n  registerInline();\n  registerCollapseExpandBlock();\n  registerDisable();\n  registerDelete();\n  registerHelp();\n}\n\n/**\n * Registers all default context menu items. This should be called once per\n * instance of ContextMenuRegistry.\n *\n * @internal\n */\nexport function registerDefaultOptions() {\n  registerWorkspaceOptions_();\n  registerBlockOptions_();\n}\n\nregisterDefaultOptions();\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport {IProcedureModel} from './i_procedure_model.js';\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.procedures.IProcedureBlock');\n\n/** The interface for a block which models a procedure. */\nexport interface IProcedureBlock {\n  getProcedureModel(): IProcedureModel;\n  doProcedureUpdate(): void;\n  isProcedureDef(): boolean;\n}\n\n/** A type guard which checks if the given block is a procedure block. */\nexport function isProcedureBlock(\n  block: Block | IProcedureBlock\n): block is IProcedureBlock {\n  return (\n    (block as IProcedureBlock).getProcedureModel !== undefined &&\n    (block as IProcedureBlock).doProcedureUpdate !== undefined &&\n    (block as IProcedureBlock).isProcedureDef !== undefined\n  );\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that fires events optionally.\n *\n * @internal\n */\nexport interface IObservable {\n  startPublishing(): void;\n  stopPublishing(): void;\n}\n\n/**\n * Type guard for checking if an object fulfills IObservable.\n *\n * @internal\n */\nexport function isObservable(obj: any): obj is IObservable {\n  return obj.startPublishing !== undefined && obj.stopPublishing !== undefined;\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Procedures');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport {Blocks} from './blocks.js';\nimport * as common from './common.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BubbleOpen} from './events/events_bubble_open.js';\nimport * as eventUtils from './events/utils.js';\nimport {Field, UnattachedFieldError} from './field.js';\nimport {Msg} from './msg.js';\nimport {Names} from './names.js';\nimport {IParameterModel} from './interfaces/i_parameter_model.js';\nimport {IProcedureMap} from './interfaces/i_procedure_map.js';\nimport {IProcedureModel} from './interfaces/i_procedure_model.js';\nimport {\n  IProcedureBlock,\n  isProcedureBlock,\n} from './interfaces/i_procedure_block.js';\nimport {\n  isLegacyProcedureCallBlock,\n  isLegacyProcedureDefBlock,\n  ProcedureBlock,\n  ProcedureTuple,\n} from './interfaces/i_legacy_procedure_blocks.js';\nimport {ObservableProcedureMap} from './observable_procedure_map.js';\nimport * as utilsXml from './utils/xml.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {MutatorIcon} from './icons.js';\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * procedure blocks.\n * See also Blockly.Variables.CATEGORY_NAME and\n * Blockly.VariablesDynamic.CATEGORY_NAME.\n */\nexport const CATEGORY_NAME = 'PROCEDURE';\n\n/**\n * The default argument for a procedures_mutatorarg block.\n */\nexport const DEFAULT_ARG = 'x';\n\n/**\n * Find all user-created procedure definitions in a workspace.\n *\n * @param root Root workspace.\n * @returns Pair of arrays, the first contains procedures without return\n *     variables, the second with. Each procedure is defined by a three-element\n *     list of name, parameter list, and return value boolean.\n */\nexport function allProcedures(\n  root: Workspace\n): [ProcedureTuple[], ProcedureTuple[]] {\n  const proceduresNoReturn: ProcedureTuple[] = root\n    .getProcedureMap()\n    .getProcedures()\n    .filter((p) => !p.getReturnTypes())\n    .map((p) => [\n      p.getName(),\n      p.getParameters().map((pa) => pa.getName()),\n      false,\n    ]);\n  root.getBlocksByType('procedures_defnoreturn', false).forEach((b) => {\n    if (!isProcedureBlock(b) && isLegacyProcedureDefBlock(b)) {\n      proceduresNoReturn.push(b.getProcedureDef());\n    }\n  });\n\n  const proceduresReturn: ProcedureTuple[] = root\n    .getProcedureMap()\n    .getProcedures()\n    .filter((p) => !!p.getReturnTypes())\n    .map((p) => [\n      p.getName(),\n      p.getParameters().map((pa) => pa.getName()),\n      true,\n    ]);\n  root.getBlocksByType('procedures_defreturn', false).forEach((b) => {\n    if (!isProcedureBlock(b) && isLegacyProcedureDefBlock(b)) {\n      proceduresReturn.push(b.getProcedureDef());\n    }\n  });\n  proceduresNoReturn.sort(procTupleComparator);\n  proceduresReturn.sort(procTupleComparator);\n  return [proceduresNoReturn, proceduresReturn];\n}\n\n/**\n * Comparison function for case-insensitive sorting of the first element of\n * a tuple.\n *\n * @param ta First tuple.\n * @param tb Second tuple.\n * @returns -1, 0, or 1 to signify greater than, equality, or less than.\n */\nfunction procTupleComparator(ta: ProcedureTuple, tb: ProcedureTuple): number {\n  return ta[0].localeCompare(tb[0], undefined, {sensitivity: 'base'});\n}\n\n/**\n * Ensure two identically-named procedures don't exist.\n * Take the proposed procedure name, and return a legal name i.e. one that\n * is not empty and doesn't collide with other procedures.\n *\n * @param name Proposed procedure name.\n * @param block Block to disambiguate.\n * @returns Non-colliding name.\n */\nexport function findLegalName(name: string, block: Block): string {\n  if (block.isInFlyout) {\n    // Flyouts can have multiple procedures called 'do something'.\n    return name;\n  }\n  name = name || Msg['UNNAMED_KEY'] || 'unnamed';\n  while (!isLegalName(name, block.workspace, block)) {\n    // Collision with another procedure.\n    const r = name.match(/^(.*?)(\\d+)$/);\n    if (!r) {\n      name += '2';\n    } else {\n      name = r[1] + (parseInt(r[2]) + 1);\n    }\n  }\n  return name;\n}\n/**\n * Does this procedure have a legal name?  Illegal names include names of\n * procedures already defined.\n *\n * @param name The questionable name.\n * @param workspace The workspace to scan for collisions.\n * @param opt_exclude Optional block to exclude from comparisons (one doesn't\n *     want to collide with oneself).\n * @returns True if the name is legal.\n */\nfunction isLegalName(\n  name: string,\n  workspace: Workspace,\n  opt_exclude?: Block\n): boolean {\n  return !isNameUsed(name, workspace, opt_exclude);\n}\n\n/**\n * Return if the given name is already a procedure name.\n *\n * @param name The questionable name.\n * @param workspace The workspace to scan for collisions.\n * @param opt_exclude Optional block to exclude from comparisons (one doesn't\n *     want to collide with oneself).\n * @returns True if the name is used, otherwise return false.\n */\nexport function isNameUsed(\n  name: string,\n  workspace: Workspace,\n  opt_exclude?: Block\n): boolean {\n  for (const block of workspace.getAllBlocks(false)) {\n    if (block === opt_exclude) continue;\n\n    if (\n      isLegacyProcedureDefBlock(block) &&\n      Names.equals(block.getProcedureDef()[0], name)\n    ) {\n      return true;\n    }\n  }\n\n  const excludeModel =\n    opt_exclude && isProcedureBlock(opt_exclude)\n      ? opt_exclude?.getProcedureModel()\n      : undefined;\n  for (const model of workspace.getProcedureMap().getProcedures()) {\n    if (model === excludeModel) continue;\n    if (Names.equals(model.getName(), name)) return true;\n  }\n  return false;\n}\n\n/**\n * Rename a procedure.  Called by the editable field.\n *\n * @param name The proposed new name.\n * @returns The accepted name.\n */\nexport function rename(this: Field, name: string): string {\n  const block = this.getSourceBlock();\n  if (!block) {\n    throw new UnattachedFieldError();\n  }\n\n  // Strip leading and trailing whitespace.  Beyond this, all names are legal.\n  name = name.trim();\n\n  const legalName = findLegalName(name, block);\n  if (isProcedureBlock(block) && !block.isInsertionMarker()) {\n    block.getProcedureModel().setName(legalName);\n  }\n  const oldName = this.getValue();\n  if (oldName !== name && oldName !== legalName) {\n    // Rename any callers.\n    const blocks = block.workspace.getAllBlocks(false);\n    for (let i = 0; i < blocks.length; i++) {\n      // Assume it is a procedure so we can check.\n      const procedureBlock = blocks[i] as unknown as ProcedureBlock;\n      if (procedureBlock.renameProcedure) {\n        procedureBlock.renameProcedure(oldName as string, legalName);\n      }\n    }\n  }\n  return legalName;\n}\n\n/**\n * Construct the blocks required by the flyout for the procedure category.\n *\n * @param workspace The workspace containing procedures.\n * @returns Array of XML block elements.\n */\nexport function flyoutCategory(workspace: WorkspaceSvg): Element[] {\n  const xmlList = [];\n  if (Blocks['procedures_defnoreturn']) {\n    // <block type=\"procedures_defnoreturn\" gap=\"16\">\n    //     <field name=\"NAME\">do something</field>\n    // </block>\n    const block = utilsXml.createElement('block');\n    block.setAttribute('type', 'procedures_defnoreturn');\n    block.setAttribute('gap', '16');\n    const nameField = utilsXml.createElement('field');\n    nameField.setAttribute('name', 'NAME');\n    nameField.appendChild(\n      utilsXml.createTextNode(Msg['PROCEDURES_DEFNORETURN_PROCEDURE'])\n    );\n    block.appendChild(nameField);\n    xmlList.push(block);\n  }\n  if (Blocks['procedures_defreturn']) {\n    // <block type=\"procedures_defreturn\" gap=\"16\">\n    //     <field name=\"NAME\">do something</field>\n    // </block>\n    const block = utilsXml.createElement('block');\n    block.setAttribute('type', 'procedures_defreturn');\n    block.setAttribute('gap', '16');\n    const nameField = utilsXml.createElement('field');\n    nameField.setAttribute('name', 'NAME');\n    nameField.appendChild(\n      utilsXml.createTextNode(Msg['PROCEDURES_DEFRETURN_PROCEDURE'])\n    );\n    block.appendChild(nameField);\n    xmlList.push(block);\n  }\n  if (Blocks['procedures_ifreturn']) {\n    // <block type=\"procedures_ifreturn\" gap=\"16\"></block>\n    const block = utilsXml.createElement('block');\n    block.setAttribute('type', 'procedures_ifreturn');\n    block.setAttribute('gap', '16');\n    xmlList.push(block);\n  }\n  if (xmlList.length) {\n    // Add slightly larger gap between system blocks and user calls.\n    xmlList[xmlList.length - 1].setAttribute('gap', '24');\n  }\n\n  /**\n   * Add items to xmlList for each listed procedure.\n   *\n   * @param procedureList A list of procedures, each of which is defined by a\n   *     three-element list of name, parameter list, and return value boolean.\n   * @param templateName The type of the block to generate.\n   */\n  function populateProcedures(\n    procedureList: ProcedureTuple[],\n    templateName: string\n  ) {\n    for (let i = 0; i < procedureList.length; i++) {\n      const name = procedureList[i][0];\n      const args = procedureList[i][1];\n      // <block type=\"procedures_callnoreturn\" gap=\"16\">\n      //   <mutation name=\"do something\">\n      //     <arg name=\"x\"></arg>\n      //   </mutation>\n      // </block>\n      const block = utilsXml.createElement('block');\n      block.setAttribute('type', templateName);\n      block.setAttribute('gap', '16');\n      const mutation = utilsXml.createElement('mutation');\n      mutation.setAttribute('name', name);\n      block.appendChild(mutation);\n      for (let j = 0; j < args.length; j++) {\n        const arg = utilsXml.createElement('arg');\n        arg.setAttribute('name', args[j]);\n        mutation.appendChild(arg);\n      }\n      xmlList.push(block);\n    }\n  }\n\n  const tuple = allProcedures(workspace);\n  populateProcedures(tuple[0], 'procedures_callnoreturn');\n  populateProcedures(tuple[1], 'procedures_callreturn');\n  return xmlList;\n}\n\n/**\n * Updates the procedure mutator's flyout so that the arg block is not a\n * duplicate of another arg.\n *\n * @param workspace The procedure mutator's workspace. This workspace's flyout\n *     is what is being updated.\n */\nfunction updateMutatorFlyout(workspace: WorkspaceSvg) {\n  const usedNames = [];\n  const blocks = workspace.getBlocksByType('procedures_mutatorarg', false);\n  for (let i = 0, block; (block = blocks[i]); i++) {\n    usedNames.push(block.getFieldValue('NAME'));\n  }\n\n  const xmlElement = utilsXml.createElement('xml');\n  const argBlock = utilsXml.createElement('block');\n  argBlock.setAttribute('type', 'procedures_mutatorarg');\n  const nameField = utilsXml.createElement('field');\n  nameField.setAttribute('name', 'NAME');\n  const argValue = Variables.generateUniqueNameFromOptions(\n    DEFAULT_ARG,\n    usedNames\n  );\n  const fieldContent = utilsXml.createTextNode(argValue);\n\n  nameField.appendChild(fieldContent);\n  argBlock.appendChild(nameField);\n  xmlElement.appendChild(argBlock);\n\n  workspace.updateToolbox(xmlElement);\n}\n\n/**\n * Listens for when a procedure mutator is opened. Then it triggers a flyout\n * update and adds a mutator change listener to the mutator workspace.\n *\n * @param e The event that triggered this listener.\n * @internal\n */\nexport function mutatorOpenListener(e: Abstract) {\n  if (e.type !== eventUtils.BUBBLE_OPEN) {\n    return;\n  }\n  const bubbleEvent = e as BubbleOpen;\n  if (\n    !(bubbleEvent.bubbleType === 'mutator' && bubbleEvent.isOpen) ||\n    !bubbleEvent.blockId\n  ) {\n    return;\n  }\n  const workspaceId = bubbleEvent.workspaceId;\n  const block = common\n    .getWorkspaceById(workspaceId)!\n    .getBlockById(bubbleEvent.blockId) as BlockSvg;\n  const type = block.type;\n  if (type !== 'procedures_defnoreturn' && type !== 'procedures_defreturn') {\n    return;\n  }\n  const workspace = (\n    block.getIcon(MutatorIcon.TYPE) as MutatorIcon\n  ).getWorkspace()!;\n  updateMutatorFlyout(workspace);\n  workspace.addChangeListener(mutatorChangeListener);\n}\n/**\n * Listens for changes in a procedure mutator and triggers flyout updates when\n * necessary.\n *\n * @param e The event that triggered this listener.\n */\nfunction mutatorChangeListener(e: Abstract) {\n  if (\n    e.type !== eventUtils.BLOCK_CREATE &&\n    e.type !== eventUtils.BLOCK_DELETE &&\n    e.type !== eventUtils.BLOCK_CHANGE\n  ) {\n    return;\n  }\n  const workspaceId = e.workspaceId as string;\n  const workspace = common.getWorkspaceById(workspaceId) as WorkspaceSvg;\n  updateMutatorFlyout(workspace);\n}\n\n/**\n * Find all the callers of a named procedure.\n *\n * @param name Name of procedure.\n * @param workspace The workspace to find callers in.\n * @returns Array of caller blocks.\n */\nexport function getCallers(name: string, workspace: Workspace): Block[] {\n  return workspace.getAllBlocks(false).filter((block) => {\n    return (\n      blockIsModernCallerFor(block, name) ||\n      (isLegacyProcedureCallBlock(block) &&\n        Names.equals(block.getProcedureCall(), name))\n    );\n  });\n}\n\n/**\n * @returns True if the given block is a modern-style caller block of the given\n *     procedure name.\n */\nfunction blockIsModernCallerFor(block: Block, procName: string): boolean {\n  return (\n    isProcedureBlock(block) &&\n    !block.isProcedureDef() &&\n    block.getProcedureModel() &&\n    Names.equals(block.getProcedureModel().getName(), procName)\n  );\n}\n\n/**\n * When a procedure definition changes its parameters, find and edit all its\n * callers.\n *\n * @param defBlock Procedure definition block.\n */\nexport function mutateCallers(defBlock: Block) {\n  const oldRecordUndo = eventUtils.getRecordUndo();\n  const procedureBlock = defBlock as unknown as ProcedureBlock;\n  const name = procedureBlock.getProcedureDef()[0];\n  const xmlElement = defBlock.mutationToDom!(true);\n  const callers = getCallers(name, defBlock.workspace);\n  for (let i = 0, caller; (caller = callers[i]); i++) {\n    const oldMutationDom = caller.mutationToDom!();\n    const oldMutation = oldMutationDom && utilsXml.domToText(oldMutationDom);\n    if (caller.domToMutation) {\n      caller.domToMutation(xmlElement);\n    }\n    const newMutationDom = caller.mutationToDom!();\n    const newMutation = newMutationDom && utilsXml.domToText(newMutationDom);\n    if (oldMutation !== newMutation) {\n      // Fire a mutation on every caller block.  But don't record this as an\n      // undo action since it is deterministically tied to the procedure's\n      // definition mutation.\n      eventUtils.setRecordUndo(false);\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          caller,\n          'mutation',\n          null,\n          oldMutation,\n          newMutation\n        )\n      );\n      eventUtils.setRecordUndo(oldRecordUndo);\n    }\n  }\n}\n\n/**\n * Find the definition block for the named procedure.\n *\n * @param name Name of procedure.\n * @param workspace The workspace to search.\n * @returns The procedure definition block, or null not found.\n */\nexport function getDefinition(\n  name: string,\n  workspace: Workspace\n): Block | null {\n  // Do not assume procedure is a top block. Some languages allow nested\n  // procedures. Also do not assume it is one of the built-in blocks. Only\n  // rely on isProcedureDef and getProcedureDef.\n  for (const block of workspace.getAllBlocks(false)) {\n    if (\n      isProcedureBlock(block) &&\n      block.isProcedureDef() &&\n      Names.equals(block.getProcedureModel().getName(), name)\n    ) {\n      return block;\n    }\n    if (\n      isLegacyProcedureDefBlock(block) &&\n      Names.equals(block.getProcedureDef()[0], name)\n    ) {\n      return block;\n    }\n  }\n  return null;\n}\n\nexport {\n  ObservableProcedureMap,\n  IParameterModel,\n  IProcedureBlock,\n  isProcedureBlock,\n  IProcedureMap,\n  IProcedureModel,\n  ProcedureTuple,\n};\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.VariablesDynamic');\n\nimport {Blocks} from './blocks.js';\nimport {Msg} from './msg.js';\nimport * as xml from './utils/xml.js';\nimport {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport type {FlyoutButton} from './flyout_button.js';\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n * See also Blockly.Variables.CATEGORY_NAME and\n * Blockly.Procedures.CATEGORY_NAME.\n */\nexport const CATEGORY_NAME = 'VARIABLE_DYNAMIC';\n\n/**\n * Click handler for a button that creates String variables.\n *\n * @param button\n */\nfunction stringButtonClickHandler(button: FlyoutButton) {\n  Variables.createVariableButtonHandler(\n    button.getTargetWorkspace(),\n    undefined,\n    'String'\n  );\n}\n// eslint-disable-next-line camelcase\nexport const onCreateVariableButtonClick_String = stringButtonClickHandler;\n\n/**\n * Click handler for a button that creates Number variables.\n *\n * @param button\n */\nfunction numberButtonClickHandler(button: FlyoutButton) {\n  Variables.createVariableButtonHandler(\n    button.getTargetWorkspace(),\n    undefined,\n    'Number'\n  );\n}\n// eslint-disable-next-line camelcase\nexport const onCreateVariableButtonClick_Number = numberButtonClickHandler;\n\n/**\n * Click handler for a button that creates Colour variables.\n *\n * @param button\n */\nfunction colourButtonClickHandler(button: FlyoutButton) {\n  Variables.createVariableButtonHandler(\n    button.getTargetWorkspace(),\n    undefined,\n    'Colour'\n  );\n}\n// eslint-disable-next-line camelcase\nexport const onCreateVariableButtonClick_Colour = colourButtonClickHandler;\n\n/**\n * Construct the elements (blocks and button) required by the flyout for the\n * variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML elements.\n */\nexport function flyoutCategory(workspace: WorkspaceSvg): Element[] {\n  let xmlList = new Array<Element>();\n  let button = document.createElement('button');\n  button.setAttribute('text', Msg['NEW_STRING_VARIABLE']);\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE_STRING');\n  xmlList.push(button);\n  button = document.createElement('button');\n  button.setAttribute('text', Msg['NEW_NUMBER_VARIABLE']);\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE_NUMBER');\n  xmlList.push(button);\n  button = document.createElement('button');\n  button.setAttribute('text', Msg['NEW_COLOUR_VARIABLE']);\n  button.setAttribute('callbackKey', 'CREATE_VARIABLE_COLOUR');\n  xmlList.push(button);\n\n  workspace.registerButtonCallback(\n    'CREATE_VARIABLE_STRING',\n    stringButtonClickHandler\n  );\n  workspace.registerButtonCallback(\n    'CREATE_VARIABLE_NUMBER',\n    numberButtonClickHandler\n  );\n  workspace.registerButtonCallback(\n    'CREATE_VARIABLE_COLOUR',\n    colourButtonClickHandler\n  );\n\n  const blockList = flyoutCategoryBlocks(workspace);\n  xmlList = xmlList.concat(blockList);\n  return xmlList;\n}\n\n/**\n * Construct the blocks required by the flyout for the variable category.\n *\n * @param workspace The workspace containing variables.\n * @returns Array of XML block elements.\n */\nexport function flyoutCategoryBlocks(workspace: Workspace): Element[] {\n  const variableModelList = workspace.getAllVariables();\n\n  const xmlList = [];\n  if (variableModelList.length > 0) {\n    if (Blocks['variables_set_dynamic']) {\n      const firstVariable = variableModelList[variableModelList.length - 1];\n      const block = xml.createElement('block');\n      block.setAttribute('type', 'variables_set_dynamic');\n      block.setAttribute('gap', '24');\n      block.appendChild(Variables.generateVariableFieldDom(firstVariable));\n      xmlList.push(block);\n    }\n    if (Blocks['variables_get_dynamic']) {\n      variableModelList.sort(VariableModel.compareByName);\n      for (let i = 0, variable; (variable = variableModelList[i]); i++) {\n        const block = xml.createElement('block');\n        block.setAttribute('type', 'variables_get_dynamic');\n        block.setAttribute('gap', '8');\n        block.appendChild(Variables.generateVariableFieldDom(variable));\n        xmlList.push(block);\n      }\n    }\n  }\n  return xmlList;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.uiPosition');\n\nimport type {UiMetrics} from './metrics_manager.js';\nimport {Scrollbar} from './scrollbar.js';\nimport {Rect} from './utils/rect.js';\nimport type {Size} from './utils/size.js';\nimport * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Enum for vertical positioning.\n *\n * @internal\n */\nexport enum verticalPosition {\n  TOP,\n  BOTTOM,\n}\n\n/**\n * Enum for horizontal positioning.\n *\n * @internal\n */\nexport enum horizontalPosition {\n  LEFT,\n  RIGHT,\n}\n\n/**\n * An object defining a horizontal and vertical positioning.\n *\n * @internal\n */\nexport interface Position {\n  horizontal: horizontalPosition;\n  vertical: verticalPosition;\n}\n\n/**\n * Enum for bump rules to use for dealing with collisions.\n *\n * @internal\n */\nexport enum bumpDirection {\n  UP,\n  DOWN,\n}\n\n/**\n * Returns a rectangle representing reasonable position for where to place a UI\n * element of the specified size given the restraints and locations of the\n * scrollbars. This method does not take into account any already placed UI\n * elements.\n *\n * @param position The starting horizontal and vertical position.\n * @param size the size of the UI element to get a start position for.\n * @param horizontalPadding The horizontal padding to use.\n * @param verticalPadding The vertical padding to use.\n * @param metrics The workspace UI metrics.\n * @param workspace The workspace.\n * @returns The suggested start position.\n * @internal\n */\nexport function getStartPositionRect(\n  position: Position,\n  size: Size,\n  horizontalPadding: number,\n  verticalPadding: number,\n  metrics: UiMetrics,\n  workspace: WorkspaceSvg\n): Rect {\n  // Horizontal positioning.\n  let left = 0;\n  const hasVerticalScrollbar =\n    workspace.scrollbar && workspace.scrollbar.canScrollVertically();\n  if (position.horizontal === horizontalPosition.LEFT) {\n    left = metrics.absoluteMetrics.left + horizontalPadding;\n    if (hasVerticalScrollbar && workspace.RTL) {\n      left += Scrollbar.scrollbarThickness;\n    }\n  } else {\n    // position.horizontal === horizontalPosition.RIGHT\n    left =\n      metrics.absoluteMetrics.left +\n      metrics.viewMetrics.width -\n      size.width -\n      horizontalPadding;\n    if (hasVerticalScrollbar && !workspace.RTL) {\n      left -= Scrollbar.scrollbarThickness;\n    }\n  }\n  // Vertical positioning.\n  let top = 0;\n  if (position.vertical === verticalPosition.TOP) {\n    top = metrics.absoluteMetrics.top + verticalPadding;\n  } else {\n    // position.vertical === verticalPosition.BOTTOM\n    top =\n      metrics.absoluteMetrics.top +\n      metrics.viewMetrics.height -\n      size.height -\n      verticalPadding;\n    if (workspace.scrollbar && workspace.scrollbar.canScrollHorizontally()) {\n      // The scrollbars are always positioned on the bottom if they exist.\n      top -= Scrollbar.scrollbarThickness;\n    }\n  }\n  return new Rect(top, top + size.height, left, left + size.width);\n}\n\n/**\n * Returns a corner position that is on the opposite side of the workspace from\n * the toolbox.\n * If in horizontal orientation, defaults to the bottom corner. If in vertical\n * orientation, defaults to the right corner.\n *\n * @param workspace The workspace.\n * @param metrics The workspace metrics.\n * @returns The suggested corner position.\n * @internal\n */\nexport function getCornerOppositeToolbox(\n  workspace: WorkspaceSvg,\n  metrics: UiMetrics\n): Position {\n  const leftCorner =\n    metrics.toolboxMetrics.position !== toolbox.Position.LEFT &&\n    (!workspace.horizontalLayout || workspace.RTL);\n  const topCorner = metrics.toolboxMetrics.position === toolbox.Position.BOTTOM;\n  const hPosition = leftCorner\n    ? horizontalPosition.LEFT\n    : horizontalPosition.RIGHT;\n  const vPosition = topCorner ? verticalPosition.TOP : verticalPosition.BOTTOM;\n  return {horizontal: hPosition, vertical: vPosition};\n}\n\n/**\n * Returns a position Rect based on a starting position that is bumped\n * so that it doesn't intersect with any of the provided savedPositions. This\n * method does not check that the bumped position is still within bounds.\n *\n * @param startRect The starting position to use.\n * @param margin The margin to use between elements when bumping.\n * @param bumpDir The direction to bump if there is a collision with an existing\n *     UI element.\n * @param savedPositions List of rectangles that represent the positions of UI\n *     elements already placed.\n * @returns The suggested position rectangle.\n * @internal\n */\nexport function bumpPositionRect(\n  startRect: Rect,\n  margin: number,\n  bumpDir: bumpDirection,\n  savedPositions: Rect[]\n): Rect {\n  let top = startRect.top;\n  const left = startRect.left;\n  const width = startRect.right - startRect.left;\n  const height = startRect.bottom - startRect.top;\n\n  // Check for collision and bump if needed.\n  let boundingRect = startRect;\n  for (let i = 0; i < savedPositions.length; i++) {\n    const otherEl = savedPositions[i];\n    if (boundingRect.intersects(otherEl)) {\n      if (bumpDir === bumpDirection.UP) {\n        top = otherEl.top - height - margin;\n      } else {\n        // bumpDir === bumpDirection.DOWN\n        top = otherEl.bottom + margin;\n      }\n      // Recheck other savedPositions\n      boundingRect = new Rect(top, top + height, left, left + width);\n      i = -1;\n    }\n  }\n  return boundingRect;\n}\n","/**\n * @license\n * Copyright 2014 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a workspace rendered as SVG.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WorkspaceSvg');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_create.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_theme_change.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_viewport.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {config} from './config.js';\nimport {ConnectionDB} from './connection_db.js';\nimport * as ContextMenu from './contextmenu.js';\nimport {ContextMenuRegistry} from './contextmenu_registry.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport type {FlyoutButton} from './flyout_button.js';\nimport {Gesture} from './gesture.js';\nimport {Grid} from './grid.js';\nimport type {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {ICopyable} from './interfaces/i_copyable.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport type {IToolbox} from './interfaces/i_toolbox.js';\nimport type {Cursor} from './keyboard_nav/cursor.js';\nimport type {Marker} from './keyboard_nav/marker.js';\nimport {MarkerManager} from './marker_manager.js';\nimport {Options} from './options.js';\nimport * as Procedures from './procedures.js';\nimport * as registry from './registry.js';\nimport * as blockRendering from './renderers/common/block_rendering.js';\nimport type {Renderer} from './renderers/common/renderer.js';\nimport type {ScrollbarPair} from './scrollbar_pair.js';\nimport * as blocks from './serialization/blocks.js';\nimport type {Theme} from './theme.js';\nimport {Classic} from './theme/classic.js';\nimport {ThemeManager} from './theme_manager.js';\nimport * as Tooltip from './tooltip.js';\nimport type {Trashcan} from './trashcan.js';\nimport * as arrayUtils from './utils/array.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as userAgent from './utils/useragent.js';\nimport type {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport * as VariablesDynamic from './variables_dynamic.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {Workspace} from './workspace.js';\nimport {WorkspaceAudio} from './workspace_audio.js';\nimport {WorkspaceComment} from './workspace_comment.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport * as Xml from './xml.js';\nimport {ZoomControls} from './zoom_controls.js';\nimport {ContextMenuOption} from './contextmenu_registry.js';\n\n/** Margin around the top/bottom/left/right after a zoomToFit call. */\nconst ZOOM_TO_FIT_MARGIN = 20;\n\n/**\n * Class for a workspace.  This is an onscreen area with optional trashcan,\n * scrollbars, bubbles, and dragging.\n */\nexport class WorkspaceSvg extends Workspace implements IASTNodeLocationSvg {\n  /**\n   * A wrapper function called when a resize event occurs.\n   * You can pass the result to `eventHandling.unbind`.\n   */\n  private resizeHandlerWrapper: browserEvents.Data | null = null;\n\n  /**\n   * The render status of an SVG workspace.\n   * Returns `false` for headless workspaces and true for instances of\n   * `WorkspaceSvg`.\n   */\n  override rendered = true;\n\n  /**\n   * Whether the workspace is visible.  False if the workspace has been hidden\n   * by calling `setVisible(false)`.\n   */\n  private isVisible_ = true;\n\n  /**\n   * Whether this workspace has resizes enabled.\n   * Disable during batch operations for a performance improvement.\n   */\n  private resizesEnabled = true;\n\n  /**\n   * Current horizontal scrolling offset in pixel units, relative to the\n   * workspace origin.\n   *\n   * It is useful to think about a view, and a canvas moving beneath that\n   * view. As the canvas moves right, this value becomes more positive, and\n   * the view is now \"seeing\" the left side of the canvas. As the canvas moves\n   * left, this value becomes more negative, and the view is now \"seeing\" the\n   * right side of the canvas.\n   *\n   * The confusing thing about this value is that it does not, and must not\n   * include the absoluteLeft offset. This is because it is used to calculate\n   * the viewLeft value.\n   *\n   * The viewLeft is relative to the workspace origin (although in pixel\n   * units). The workspace origin is the top-left corner of the workspace (at\n   * least when it is enabled). It is shifted from the top-left of the\n   * blocklyDiv so as not to be beneath the toolbox.\n   *\n   * When the workspace is enabled the viewLeft and workspace origin are at\n   * the same X location. As the canvas slides towards the right beneath the\n   * view this value (scrollX) becomes more positive, and the viewLeft becomes\n   * more negative relative to the workspace origin (imagine the workspace\n   * origin as a dot on the canvas sliding to the right as the canvas moves).\n   *\n   * So if the scrollX were to include the absoluteLeft this would in a way\n   * \"unshift\" the workspace origin. This means that the viewLeft would be\n   * representing the left edge of the blocklyDiv, rather than the left edge\n   * of the workspace.\n   */\n  scrollX = 0;\n\n  /**\n   * Current vertical scrolling offset in pixel units, relative to the\n   * workspace origin.\n   *\n   * It is useful to think about a view, and a canvas moving beneath that\n   * view. As the canvas moves down, this value becomes more positive, and the\n   * view is now \"seeing\" the upper part of the canvas. As the canvas moves\n   * up, this value becomes more negative, and the view is \"seeing\" the lower\n   * part of the canvas.\n   *\n   * This confusing thing about this value is that it does not, and must not\n   * include the absoluteTop offset. This is because it is used to calculate\n   * the viewTop value.\n   *\n   * The viewTop is relative to the workspace origin (although in pixel\n   * units). The workspace origin is the top-left corner of the workspace (at\n   * least when it is enabled). It is shifted from the top-left of the\n   * blocklyDiv so as not to be beneath the toolbox.\n   *\n   * When the workspace is enabled the viewTop and workspace origin are at the\n   * same Y location. As the canvas slides towards the bottom this value\n   * (scrollY) becomes more positive, and the viewTop becomes more negative\n   * relative to the workspace origin (image in the workspace origin as a dot\n   * on the canvas sliding downwards as the canvas moves).\n   *\n   * So if the scrollY were to include the absoluteTop this would in a way\n   * \"unshift\" the workspace origin. This means that the viewTop would be\n   * representing the top edge of the blocklyDiv, rather than the top edge of\n   * the workspace.\n   */\n  scrollY = 0;\n\n  /** Horizontal scroll value when scrolling started in pixel units. */\n  startScrollX = 0;\n\n  /** Vertical scroll value when scrolling started in pixel units. */\n  startScrollY = 0;\n\n  /** Distance from mouse to object being dragged. */\n  private dragDeltaXY: Coordinate | null = null;\n\n  /** Current scale. */\n  scale = 1;\n\n  /** Cached scale value. Used to detect changes in viewport. */\n  private oldScale = 1;\n\n  /** Cached viewport top value. Used to detect changes in viewport. */\n  private oldTop = 0;\n\n  /** Cached viewport left value. Used to detect changes in viewport. */\n  private oldLeft = 0;\n\n  /** The workspace's trashcan (if any). */\n  trashcan: Trashcan | null = null;\n\n  /** This workspace's scrollbars, if they exist. */\n  scrollbar: ScrollbarPair | null = null;\n\n  /**\n   * Fixed flyout providing blocks which may be dragged into this workspace.\n   */\n  private flyout: IFlyout | null = null;\n\n  /**\n   * Category-based toolbox providing blocks which may be dragged into this\n   * workspace.\n   */\n  private toolbox_: IToolbox | null = null;\n\n  /**\n   * The current gesture in progress on this workspace, if any.\n   *\n   * @internal\n   */\n  currentGesture_: Gesture | null = null;\n\n  /**\n   * The first parent div with 'injectionDiv' in the name, or null if not set.\n   * Access this with getInjectionDiv.\n   */\n  private injectionDiv: Element | null = null;\n\n  /**\n   * Last known position of the page scroll.\n   * This is used to determine whether we have recalculated screen coordinate\n   * stuff since the page scrolled.\n   */\n  private lastRecordedPageScroll: Coordinate | null = null;\n\n  /**\n   * Developers may define this function to add custom menu options to the\n   * workspace's context menu or edit the workspace-created set of menu\n   * options.\n   *\n   * @param options List of menu options to add to.\n   * @param e The right-click event that triggered the context menu.\n   */\n  configureContextMenu:\n    | ((menuOptions: ContextMenuOption[], e: Event) => void)\n    | null = null;\n\n  /**\n   * In a flyout, the target workspace where blocks should be placed after a\n   * drag. Otherwise null.\n   *\n   * @internal\n   */\n  targetWorkspace: WorkspaceSvg | null = null;\n\n  /** Inverted screen CTM, for use in mouseToSvg. */\n  private inverseScreenCTM: SVGMatrix | null = null;\n\n  /** Inverted screen CTM is dirty, recalculate it. */\n  private inverseScreenCTMDirty = true;\n  private metricsManager: IMetricsManager;\n  /** @internal */\n  getMetrics: () => Metrics;\n  /** @internal */\n  setMetrics: (p1: {x?: number; y?: number}) => void;\n  private readonly componentManager: ComponentManager;\n\n  /**\n   * List of currently highlighted blocks.  Block highlighting is often used\n   * to visually mark blocks currently being executed.\n   */\n  private readonly highlightedBlocks: BlockSvg[] = [];\n  private audioManager: WorkspaceAudio;\n  private grid: Grid | null;\n  private markerManager: MarkerManager;\n\n  /**\n   * Map from function names to callbacks, for deciding what to do when a\n   * custom toolbox category is opened.\n   */\n  private toolboxCategoryCallbacks = new Map<\n    string,\n    (p1: WorkspaceSvg) => toolbox.FlyoutDefinition\n  >();\n\n  /**\n   * Map from function names to callbacks, for deciding what to do when a\n   * button is clicked.\n   */\n  private flyoutButtonCallbacks = new Map<string, (p1: FlyoutButton) => void>();\n  protected themeManager_: ThemeManager;\n  private readonly renderer: Renderer;\n\n  /** Cached parent SVG. */\n  private cachedParentSvg: SVGElement | null = null;\n\n  /** True if keyboard accessibility mode is on, false otherwise. */\n  keyboardAccessibilityMode = false;\n\n  /** The list of top-level bounded elements on the workspace. */\n  private topBoundedElements: IBoundedElement[] = [];\n\n  /** The recorded drag targets. */\n  private dragTargetAreas: Array<{component: IDragTarget; clientRect: Rect}> =\n    [];\n  private readonly cachedParentSvgSize: Size;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgGroup_!: SVGElement;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgBackground_!: SVGElement;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgBlockCanvas_!: SVGElement;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  svgBubbleCanvas_!: SVGElement;\n  zoomControls_: ZoomControls | null = null;\n\n  /**\n   * @param options Dictionary of options.\n   */\n  constructor(options: Options) {\n    super(options);\n\n    const MetricsManagerClass = registry.getClassFromOptions(\n      registry.Type.METRICS_MANAGER,\n      options,\n      true\n    );\n    /** Object in charge of calculating metrics for the workspace. */\n    this.metricsManager = new MetricsManagerClass!(this);\n\n    /** Method to get all the metrics that have to do with a workspace. */\n    this.getMetrics =\n      options.getMetrics ||\n      this.metricsManager.getMetrics.bind(this.metricsManager);\n\n    /** Translates the workspace. */\n    this.setMetrics =\n      options.setMetrics || WorkspaceSvg.setTopLevelWorkspaceMetrics_;\n\n    this.componentManager = new ComponentManager();\n\n    this.connectionDBList = ConnectionDB.init(this.connectionChecker);\n\n    /**\n     * Object in charge of loading, storing, and playing audio for a workspace.\n     */\n    this.audioManager = new WorkspaceAudio(\n      options.parentWorkspace as WorkspaceSvg\n    );\n\n    /** This workspace's grid object or null. */\n    this.grid = this.options.gridPattern\n      ? new Grid(this.options.gridPattern, options.gridOptions)\n      : null;\n\n    /** Manager in charge of markers and cursors. */\n    this.markerManager = new MarkerManager(this);\n\n    if (Variables && Variables.flyoutCategory) {\n      this.registerToolboxCategoryCallback(\n        Variables.CATEGORY_NAME,\n        Variables.flyoutCategory\n      );\n    }\n\n    if (VariablesDynamic && VariablesDynamic.flyoutCategory) {\n      this.registerToolboxCategoryCallback(\n        VariablesDynamic.CATEGORY_NAME,\n        VariablesDynamic.flyoutCategory\n      );\n    }\n\n    if (Procedures && Procedures.flyoutCategory) {\n      this.registerToolboxCategoryCallback(\n        Procedures.CATEGORY_NAME,\n        Procedures.flyoutCategory\n      );\n      this.addChangeListener(Procedures.mutatorOpenListener);\n    }\n\n    /** Object in charge of storing and updating the workspace theme. */\n    this.themeManager_ = this.options.parentWorkspace\n      ? this.options.parentWorkspace.getThemeManager()\n      : new ThemeManager(this, this.options.theme || Classic);\n    this.themeManager_.subscribeWorkspace(this);\n\n    /** The block renderer used for rendering blocks on this workspace. */\n    this.renderer = blockRendering.init(\n      this.options.renderer || 'geras',\n      this.getTheme(),\n      this.options.rendererOverrides ?? undefined\n    );\n\n    /**\n     * The cached size of the parent svg element.\n     * Used to compute svg metrics.\n     */\n    this.cachedParentSvgSize = new Size(0, 0);\n  }\n\n  /**\n   * Get the marker manager for this workspace.\n   *\n   * @returns The marker manager.\n   */\n  getMarkerManager(): MarkerManager {\n    return this.markerManager;\n  }\n\n  /**\n   * Gets the metrics manager for this workspace.\n   *\n   * @returns The metrics manager.\n   */\n  getMetricsManager(): IMetricsManager {\n    return this.metricsManager;\n  }\n\n  /**\n   * Sets the metrics manager for the workspace.\n   *\n   * @param metricsManager The metrics manager.\n   * @internal\n   */\n  setMetricsManager(metricsManager: IMetricsManager) {\n    this.metricsManager = metricsManager;\n    this.getMetrics = this.metricsManager.getMetrics.bind(this.metricsManager);\n  }\n\n  /**\n   * Gets the component manager for this workspace.\n   *\n   * @returns The component manager.\n   */\n  getComponentManager(): ComponentManager {\n    return this.componentManager;\n  }\n\n  /**\n   * Add the cursor SVG to this workspaces SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    this.markerManager.setCursorSvg(cursorSvg);\n  }\n\n  /**\n   * Add the marker SVG to this workspaces SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    this.markerManager.setMarkerSvg(markerSvg);\n  }\n\n  /**\n   * Get the marker with the given ID.\n   *\n   * @param id The ID of the marker.\n   * @returns The marker with the given ID or null if no marker with the given\n   *     ID exists.\n   * @internal\n   */\n  getMarker(id: string): Marker | null {\n    if (this.markerManager) {\n      return this.markerManager.getMarker(id);\n    }\n    return null;\n  }\n\n  /**\n   * The cursor for this workspace.\n   *\n   * @returns The cursor for the workspace.\n   */\n  getCursor(): Cursor | null {\n    if (this.markerManager) {\n      return this.markerManager.getCursor();\n    }\n    return null;\n  }\n\n  /**\n   * Get the block renderer attached to this workspace.\n   *\n   * @returns The renderer attached to this workspace.\n   */\n  getRenderer(): Renderer {\n    return this.renderer;\n  }\n\n  /**\n   * Get the theme manager for this workspace.\n   *\n   * @returns The theme manager for this workspace.\n   * @internal\n   */\n  getThemeManager(): ThemeManager {\n    return this.themeManager_;\n  }\n\n  /**\n   * Get the workspace theme object.\n   *\n   * @returns The workspace theme object.\n   */\n  getTheme(): Theme {\n    return this.themeManager_.getTheme();\n  }\n\n  /**\n   * Set the workspace theme object.\n   * If no theme is passed, default to the `Classic` theme.\n   *\n   * @param theme The workspace theme object.\n   */\n  setTheme(theme: Theme) {\n    if (!theme) {\n      theme = Classic as Theme;\n    }\n    this.themeManager_.setTheme(theme);\n  }\n\n  /**\n   * Refresh all blocks on the workspace after a theme update.\n   */\n  refreshTheme() {\n    if (this.svgGroup_) {\n      this.renderer.refreshDom(this.svgGroup_, this.getTheme());\n    }\n\n    // Update all blocks in workspace that have a style name.\n    this.updateBlockStyles_(\n      this.getAllBlocks(false).filter(function (block) {\n        return !!block.getStyleName();\n      })\n    );\n\n    // Update current toolbox selection.\n    this.refreshToolboxSelection();\n    if (this.toolbox_) {\n      this.toolbox_.refreshTheme();\n    }\n\n    // Re-render if workspace is visible\n    if (this.isVisible()) {\n      this.setVisible(true);\n    }\n\n    const event = new (eventUtils.get(eventUtils.THEME_CHANGE))(\n      this.getTheme().name,\n      this.id\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Updates all the blocks with new style.\n   *\n   * @param blocks List of blocks to update the style on.\n   */\n  private updateBlockStyles_(blocks: Block[]) {\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      const blockStyleName = block.getStyleName();\n      if (blockStyleName) {\n        const blockSvg = block as BlockSvg;\n        blockSvg.setStyle(blockStyleName);\n      }\n    }\n  }\n\n  /**\n   * Getter for the inverted screen CTM.\n   *\n   * @returns The matrix to use in mouseToSvg\n   */\n  getInverseScreenCTM(): SVGMatrix | null {\n    // Defer getting the screen CTM until we actually need it, this should\n    // avoid forced reflows from any calls to updateInverseScreenCTM.\n    if (this.inverseScreenCTMDirty) {\n      const ctm = this.getParentSvg().getScreenCTM();\n      if (ctm) {\n        this.inverseScreenCTM = ctm.inverse();\n        this.inverseScreenCTMDirty = false;\n      }\n    }\n\n    return this.inverseScreenCTM;\n  }\n\n  /** Mark the inverse screen CTM as dirty. */\n  updateInverseScreenCTM() {\n    this.inverseScreenCTMDirty = true;\n  }\n\n  /**\n   * Getter for isVisible\n   *\n   * @returns Whether the workspace is visible.\n   *     False if the workspace has been hidden by calling `setVisible(false)`.\n   */\n  isVisible(): boolean {\n    return this.isVisible_;\n  }\n\n  /**\n   * Return the absolute coordinates of the top-left corner of this element,\n   * scales that after canvas SVG element, if it's a descendant.\n   * The origin (0,0) is the top-left corner of the Blockly SVG.\n   *\n   * @param element SVG element to find the coordinates of.\n   * @returns Object with .x and .y properties.\n   * @internal\n   */\n  getSvgXY(element: SVGElement): Coordinate {\n    let x = 0;\n    let y = 0;\n    let scale = 1;\n    if (\n      this.getCanvas().contains(element) ||\n      this.getBubbleCanvas().contains(element)\n    ) {\n      // Before the SVG canvas, scale the coordinates.\n      scale = this.scale;\n    }\n    do {\n      // Loop through this block and every parent.\n      const xy = svgMath.getRelativeXY(element);\n      if (element === this.getCanvas() || element === this.getBubbleCanvas()) {\n        // After the SVG canvas, don't scale the coordinates.\n        scale = 1;\n      }\n      x += xy.x * scale;\n      y += xy.y * scale;\n      element = element.parentNode as SVGElement;\n    } while (element && element !== this.getParentSvg());\n    return new Coordinate(x, y);\n  }\n\n  /**\n   * Gets the size of the workspace's parent SVG element.\n   *\n   * @returns The cached width and height of the workspace's parent SVG element.\n   * @internal\n   */\n  getCachedParentSvgSize(): Size {\n    const size = this.cachedParentSvgSize;\n    return new Size(size.width, size.height);\n  }\n\n  /**\n   * Return the position of the workspace origin relative to the injection div\n   * origin in pixels.\n   * The workspace origin is where a block would render at position (0, 0).\n   * It is not the upper left corner of the workspace SVG.\n   *\n   * @returns Offset in pixels.\n   * @internal\n   */\n  getOriginOffsetInPixels(): Coordinate {\n    return svgMath.getInjectionDivXY(this.getCanvas());\n  }\n\n  /**\n   * Return the injection div that is a parent of this workspace.\n   * Walks the DOM the first time it's called, then returns a cached value.\n   * Note: We assume this is only called after the workspace has been injected\n   * into the DOM.\n   *\n   * @returns The first parent div with 'injectionDiv' in the name.\n   * @internal\n   */\n  getInjectionDiv(): Element {\n    // NB: it would be better to pass this in at createDom, but is more likely\n    // to break existing uses of Blockly.\n    if (!this.injectionDiv) {\n      let element: Element = this.svgGroup_;\n      while (element) {\n        const classes = element.getAttribute('class') || '';\n        if ((' ' + classes + ' ').indexOf(' injectionDiv ') !== -1) {\n          this.injectionDiv = element;\n          break;\n        }\n        element = element.parentNode as Element;\n      }\n    }\n    return this.injectionDiv!;\n  }\n\n  /**\n   * Get the SVG block canvas for the workspace.\n   *\n   * @returns The SVG group for the workspace.\n   * @internal\n   */\n  getBlockCanvas(): SVGElement | null {\n    return this.svgBlockCanvas_;\n  }\n\n  /**\n   * Save resize handler data so we can delete it later in dispose.\n   *\n   * @param handler Data that can be passed to eventHandling.unbind.\n   */\n  setResizeHandlerWrapper(handler: browserEvents.Data) {\n    this.resizeHandlerWrapper = handler;\n  }\n\n  /**\n   * Create the workspace DOM elements.\n   *\n   * @param opt_backgroundClass Either 'blocklyMainBackground' or\n   *     'blocklyMutatorBackground'.\n   * @returns The workspace's SVG group.\n   */\n  createDom(opt_backgroundClass?: string): Element {\n    /**\n     * <g class=\"blocklyWorkspace\">\n     *   <rect class=\"blocklyMainBackground\" height=\"100%\" width=\"100%\"></rect>\n     *   [Trashcan and/or flyout may go here]\n     *   <g class=\"blocklyBlockCanvas\"></g>\n     *   <g class=\"blocklyBubbleCanvas\"></g>\n     * </g>\n     */\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {'class': 'blocklyWorkspace'});\n\n    // Note that a <g> alone does not receive mouse events--it must have a\n    // valid target inside it.  If no background class is specified, as in the\n    // flyout, the workspace will not receive mouse events.\n    if (opt_backgroundClass) {\n      this.svgBackground_ = dom.createSvgElement(\n        Svg.RECT,\n        {'height': '100%', 'width': '100%', 'class': opt_backgroundClass},\n        this.svgGroup_\n      );\n\n      if (opt_backgroundClass === 'blocklyMainBackground' && this.grid) {\n        this.svgBackground_.style.fill =\n          'url(#' + this.grid.getPatternId() + ')';\n      } else {\n        this.themeManager_.subscribe(\n          this.svgBackground_,\n          'workspaceBackgroundColour',\n          'fill'\n        );\n      }\n    }\n    this.svgBlockCanvas_ = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyBlockCanvas'},\n      this.svgGroup_\n    );\n    this.svgBubbleCanvas_ = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyBubbleCanvas'},\n      this.svgGroup_\n    );\n\n    if (!this.isFlyout) {\n      browserEvents.conditionalBind(\n        this.svgGroup_,\n        'pointerdown',\n        this,\n        this.onMouseDown_,\n        false\n      );\n      // This no-op works around https://bugs.webkit.org/show_bug.cgi?id=226683,\n      // which otherwise prevents zoom/scroll events from being observed in\n      // Safari. Once that bug is fixed it should be removed.\n      document.body.addEventListener('wheel', function () {});\n      browserEvents.conditionalBind(\n        this.svgGroup_,\n        'wheel',\n        this,\n        this.onMouseWheel_\n      );\n    }\n\n    // Determine if there needs to be a category tree, or a simple list of\n    // blocks.  This cannot be changed later, since the UI is very different.\n    if (this.options.hasCategories) {\n      const ToolboxClass = registry.getClassFromOptions(\n        registry.Type.TOOLBOX,\n        this.options,\n        true\n      );\n      this.toolbox_ = new ToolboxClass!(this);\n    }\n    if (this.grid) {\n      this.grid.update(this.scale);\n    }\n    this.recordDragTargets();\n    const CursorClass = registry.getClassFromOptions(\n      registry.Type.CURSOR,\n      this.options\n    );\n\n    CursorClass && this.markerManager.setCursor(new CursorClass());\n\n    this.renderer.createDom(this.svgGroup_, this.getTheme());\n    return this.svgGroup_;\n  }\n\n  /**\n   * Dispose of this workspace.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  override dispose() {\n    // Stop rerendering.\n    this.rendered = false;\n    if (this.currentGesture_) {\n      this.currentGesture_.cancel();\n    }\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n    }\n    if (this.toolbox_) {\n      this.toolbox_.dispose();\n      this.toolbox_ = null;\n    }\n    if (this.flyout) {\n      this.flyout.dispose();\n      this.flyout = null;\n    }\n    if (this.trashcan) {\n      this.trashcan.dispose();\n      this.trashcan = null;\n    }\n    if (this.scrollbar) {\n      this.scrollbar.dispose();\n      this.scrollbar = null;\n    }\n    if (this.zoomControls_) {\n      this.zoomControls_.dispose();\n    }\n\n    if (this.audioManager) {\n      this.audioManager.dispose();\n    }\n\n    if (this.grid) {\n      this.grid = null;\n    }\n\n    this.renderer.dispose();\n\n    if (this.markerManager) {\n      this.markerManager.dispose();\n    }\n\n    super.dispose();\n\n    // Dispose of theme manager after all blocks and mutators are disposed of.\n    if (this.themeManager_) {\n      this.themeManager_.unsubscribeWorkspace(this);\n      this.themeManager_.unsubscribe(this.svgBackground_);\n      if (!this.options.parentWorkspace) {\n        this.themeManager_.dispose();\n      }\n    }\n\n    this.connectionDBList.length = 0;\n\n    this.toolboxCategoryCallbacks.clear();\n    this.flyoutButtonCallbacks.clear();\n\n    if (!this.options.parentWorkspace) {\n      // Top-most workspace.  Dispose of the div that the\n      // SVG is injected into (i.e. injectionDiv).\n      const parentSvg = this.getParentSvg();\n      if (parentSvg && parentSvg.parentNode) {\n        dom.removeNode(parentSvg.parentNode);\n      }\n    }\n    if (this.resizeHandlerWrapper) {\n      browserEvents.unbind(this.resizeHandlerWrapper);\n      this.resizeHandlerWrapper = null;\n    }\n  }\n\n  /**\n   * Add a trashcan.\n   *\n   * @internal\n   */\n  addTrashcan() {\n    this.trashcan = WorkspaceSvg.newTrashcan(this);\n    const svgTrashcan = this.trashcan.createDom();\n    this.svgGroup_.insertBefore(svgTrashcan, this.svgBlockCanvas_);\n  }\n\n  /**\n   * @param _workspace\n   * @internal\n   */\n  static newTrashcan(_workspace: WorkspaceSvg): Trashcan {\n    throw new Error(\n      'The implementation of newTrashcan should be ' +\n        'monkey-patched in by blockly.ts'\n    );\n  }\n\n  /**\n   * Add zoom controls.\n   *\n   * @internal\n   */\n  addZoomControls() {\n    this.zoomControls_ = new ZoomControls(this);\n    const svgZoomControls = this.zoomControls_.createDom();\n    this.svgGroup_.appendChild(svgZoomControls);\n  }\n\n  /**\n   * Add a flyout element in an element with the given tag name.\n   *\n   * @param tagName What type of tag the flyout belongs in.\n   * @returns The element containing the flyout DOM.\n   * @internal\n   */\n  addFlyout(tagName: string | Svg<SVGSVGElement> | Svg<SVGGElement>): Element {\n    const workspaceOptions = new Options({\n      'parentWorkspace': this,\n      'rtl': this.RTL,\n      'oneBasedIndex': this.options.oneBasedIndex,\n      'horizontalLayout': this.horizontalLayout,\n      'renderer': this.options.renderer,\n      'rendererOverrides': this.options.rendererOverrides,\n      'move': {\n        'scrollbars': true,\n      },\n    } as BlocklyOptions);\n    workspaceOptions.toolboxPosition = this.options.toolboxPosition;\n    if (this.horizontalLayout) {\n      const HorizontalFlyout = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,\n        this.options,\n        true\n      );\n      this.flyout = new HorizontalFlyout!(workspaceOptions);\n    } else {\n      const VerticalFlyout = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_VERTICAL_TOOLBOX,\n        this.options,\n        true\n      );\n      this.flyout = new VerticalFlyout!(workspaceOptions);\n    }\n    this.flyout.autoClose = false;\n    this.flyout.getWorkspace().setVisible(true);\n\n    // Return the element so that callers can place it in their desired\n    // spot in the DOM.  For example, mutator flyouts do not go in the same\n    // place as main workspace flyouts.\n    return this.flyout.createDom(tagName);\n  }\n\n  /**\n   * Getter for the flyout associated with this workspace.  This flyout may be\n   * owned by either the toolbox or the workspace, depending on toolbox\n   * configuration.  It will be null if there is no flyout.\n   *\n   * @param opt_own Whether to only return the workspace's own flyout.\n   * @returns The flyout on this workspace.\n   */\n  getFlyout(opt_own?: boolean): IFlyout | null {\n    if (this.flyout || opt_own) {\n      return this.flyout;\n    }\n    if (this.toolbox_) {\n      return this.toolbox_.getFlyout();\n    }\n    return null;\n  }\n\n  /**\n   * Getter for the toolbox associated with this workspace, if one exists.\n   *\n   * @returns The toolbox on this workspace.\n   */\n  getToolbox(): IToolbox | null {\n    return this.toolbox_;\n  }\n\n  /**\n   * Update items that use screen coordinate calculations\n   * because something has changed (e.g. scroll position, window size).\n   */\n  private updateScreenCalculations_() {\n    this.updateInverseScreenCTM();\n    this.recordDragTargets();\n  }\n\n  /**\n   * If enabled, resize the parts of the workspace that change when the\n   * workspace contents (e.g. block positions) change.  This will also scroll\n   * the workspace contents if needed.\n   *\n   * @internal\n   */\n  resizeContents() {\n    if (!this.resizesEnabled || !this.rendered) {\n      return;\n    }\n    if (this.scrollbar) {\n      this.scrollbar.resize();\n    }\n    this.updateInverseScreenCTM();\n  }\n\n  /**\n   * Resize and reposition all of the workspace chrome (toolbox,\n   * trash, scrollbars etc.)\n   * This should be called when something changes that\n   * requires recalculating dimensions and positions of the\n   * trash, zoom, toolbox, etc. (e.g. window resize).\n   */\n  resize() {\n    if (this.toolbox_) {\n      this.toolbox_.position();\n    }\n    if (this.flyout) {\n      this.flyout.position();\n    }\n\n    const positionables = this.componentManager.getComponents(\n      ComponentManager.Capability.POSITIONABLE,\n      true\n    );\n    const metrics = this.getMetricsManager().getUiMetrics();\n    const savedPositions = [];\n    for (let i = 0, positionable; (positionable = positionables[i]); i++) {\n      positionable.position(metrics, savedPositions);\n      const boundingRect = positionable.getBoundingRectangle();\n      if (boundingRect) {\n        savedPositions.push(boundingRect);\n      }\n    }\n\n    if (this.scrollbar) {\n      this.scrollbar.resize();\n    }\n    this.updateScreenCalculations_();\n  }\n\n  /**\n   * Resizes and repositions workspace chrome if the page has a new\n   * scroll position.\n   *\n   * @internal\n   */\n  updateScreenCalculationsIfScrolled() {\n    /* eslint-disable indent */\n    const currScroll = svgMath.getDocumentScroll();\n    if (!Coordinate.equals(this.lastRecordedPageScroll, currScroll)) {\n      this.lastRecordedPageScroll = currScroll;\n      this.updateScreenCalculations_();\n    }\n  }\n  /* eslint-enable indent */\n\n  /**\n   * Get the SVG element that forms the drawing surface.\n   *\n   * @returns SVG group element.\n   */\n  getCanvas(): SVGGElement {\n    return this.svgBlockCanvas_ as SVGGElement;\n  }\n\n  /**\n   * Caches the width and height of the workspace's parent SVG element for use\n   * with getSvgMetrics.\n   *\n   * @param width The width of the parent SVG element.\n   * @param height The height of the parent SVG element\n   * @internal\n   */\n  setCachedParentSvgSize(width: number | null, height: number | null) {\n    const svg = this.getParentSvg();\n    if (width != null) {\n      this.cachedParentSvgSize.width = width;\n      // This is set to support the public (but deprecated) Blockly.svgSize\n      // method.\n      svg.setAttribute('data-cached-width', `${width}`);\n    }\n    if (height != null) {\n      this.cachedParentSvgSize.height = height;\n      // This is set to support the public (but deprecated) Blockly.svgSize\n      // method.\n      svg.setAttribute('data-cached-height', `${height}`);\n    }\n  }\n\n  /**\n   * Get the SVG element that forms the bubble surface.\n   *\n   * @returns SVG group element.\n   */\n  getBubbleCanvas(): SVGGElement {\n    return this.svgBubbleCanvas_ as SVGGElement;\n  }\n\n  /**\n   * Get the SVG element that contains this workspace.\n   * Note: We assume this is only called after the workspace has been injected\n   * into the DOM.\n   *\n   * @returns SVG element.\n   */\n  getParentSvg(): SVGSVGElement {\n    if (!this.cachedParentSvg) {\n      let element = this.svgGroup_;\n      while (element) {\n        if (element.tagName === 'svg') {\n          this.cachedParentSvg = element;\n          break;\n        }\n        element = element.parentNode as SVGSVGElement;\n      }\n    }\n    return this.cachedParentSvg as SVGSVGElement;\n  }\n\n  /**\n   * Fires a viewport event if events are enabled and there is a change in\n   * viewport values.\n   *\n   * @internal\n   */\n  maybeFireViewportChangeEvent() {\n    if (!eventUtils.isEnabled()) {\n      return;\n    }\n    const scale = this.scale;\n    const top = -this.scrollY;\n    const left = -this.scrollX;\n    if (\n      scale === this.oldScale &&\n      Math.abs(top - this.oldTop) < 1 &&\n      Math.abs(left - this.oldLeft) < 1\n    ) {\n      // Ignore sub-pixel changes in top and left. Due to #4192 there are a lot\n      // of negligible changes in viewport top/left.\n      return;\n    }\n    const event = new (eventUtils.get(eventUtils.VIEWPORT_CHANGE))(\n      top,\n      left,\n      scale,\n      this.id,\n      this.oldScale\n    );\n    this.oldScale = scale;\n    this.oldTop = top;\n    this.oldLeft = left;\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Translate this workspace to new coordinates.\n   *\n   * @param x Horizontal translation, in pixel units relative to the top left of\n   *     the Blockly div.\n   * @param y Vertical translation, in pixel units relative to the top left of\n   *     the Blockly div.\n   */\n  translate(x: number, y: number) {\n    const translation =\n      'translate(' + x + ',' + y + ') ' + 'scale(' + this.scale + ')';\n    this.svgBlockCanvas_.setAttribute('transform', translation);\n    this.svgBubbleCanvas_.setAttribute('transform', translation);\n    // And update the grid if we're using one.\n    if (this.grid) {\n      this.grid.moveTo(x, y);\n    }\n\n    this.maybeFireViewportChangeEvent();\n  }\n\n  /**\n   * Returns the horizontal offset of the workspace.\n   * Intended for LTR/RTL compatibility in XML.\n   *\n   * @returns Width.\n   */\n  override getWidth(): number {\n    const metrics = this.getMetrics();\n    return metrics ? metrics.viewWidth / this.scale : 0;\n  }\n\n  /**\n   * Toggles the visibility of the workspace.\n   * Currently only intended for main workspace.\n   *\n   * @param isVisible True if workspace should be visible.\n   */\n  setVisible(isVisible: boolean) {\n    this.isVisible_ = isVisible;\n    if (!this.svgGroup_) {\n      return;\n    }\n\n    // Tell the scrollbar whether its container is visible so it can\n    // tell when to hide itself.\n    if (this.scrollbar) {\n      this.scrollbar.setContainerVisible(isVisible);\n    }\n\n    // Tell the flyout whether its container is visible so it can\n    // tell when to hide itself.\n    if (this.getFlyout()) {\n      this.getFlyout()!.setContainerVisible(isVisible);\n    }\n\n    this.getParentSvg().style.display = isVisible ? 'block' : 'none';\n    if (this.toolbox_) {\n      // Currently does not support toolboxes in mutators.\n      this.toolbox_.setVisible(isVisible);\n    }\n    if (isVisible) {\n      const blocks = this.getAllBlocks(false);\n      // Tell each block on the workspace to mark its fields as dirty.\n      for (let i = blocks.length - 1; i >= 0; i--) {\n        blocks[i].markDirty();\n      }\n\n      this.render();\n      if (this.toolbox_) {\n        this.toolbox_.position();\n      }\n    } else {\n      this.hideChaff(true);\n    }\n  }\n\n  /** Render all blocks in workspace. */\n  render() {\n    // Generate list of all blocks.\n    const blocks = this.getAllBlocks(false);\n    // Render each block.\n    for (let i = blocks.length - 1; i >= 0; i--) {\n      blocks[i].queueRender();\n    }\n\n    if (this.currentGesture_) {\n      const imList = this.currentGesture_.getInsertionMarkers();\n      for (let i = 0; i < imList.length; i++) {\n        imList[i].render(false);\n      }\n    }\n\n    this.markerManager.updateMarkers();\n  }\n\n  /**\n   * Highlight or unhighlight a block in the workspace.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param id ID of block to highlight/unhighlight, or null for no block (used\n   *     to unhighlight all blocks).\n   * @param opt_state If undefined, highlight specified block and automatically\n   *     unhighlight all others.  If true or false, manually\n   *     highlight/unhighlight the specified block.\n   */\n  highlightBlock(id: string | null, opt_state?: boolean) {\n    if (opt_state === undefined) {\n      // Unhighlight all blocks.\n      for (let i = 0, block; (block = this.highlightedBlocks[i]); i++) {\n        block.setHighlighted(false);\n      }\n      this.highlightedBlocks.length = 0;\n    }\n    // Highlight/unhighlight the specified block.\n    const block = id ? this.getBlockById(id) : null;\n    if (block) {\n      const state = opt_state === undefined || opt_state;\n      // Using Set here would be great, but at the cost of IE10 support.\n      if (!state) {\n        arrayUtils.removeElem(this.highlightedBlocks, block);\n      } else if (this.highlightedBlocks.indexOf(block) === -1) {\n        this.highlightedBlocks.push(block);\n      }\n      block.setHighlighted(state);\n    }\n  }\n\n  /**\n   * Pastes the provided block or workspace comment onto the workspace.\n   * Does not check whether there is remaining capacity for the object, that\n   * should be done before calling this method.\n   *\n   * @param state The representation of the thing to paste.\n   * @returns The pasted thing, or null if the paste was not successful.\n   */\n  paste(\n    state: AnyDuringMigration | Element | DocumentFragment\n  ): ICopyable | null {\n    if (!this.rendered || (!state['type'] && !state['tagName'])) {\n      return null;\n    }\n    if (this.currentGesture_) {\n      // Dragging while pasting?  No.\n      this.currentGesture_.cancel();\n    }\n\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    let pastedThing;\n    try {\n      // Checks if this is JSON. JSON has a type property, while elements don't.\n      if (state['type']) {\n        pastedThing = this.pasteBlock_(null, state as blocks.State);\n      } else {\n        const xmlBlock = state as Element;\n        if (xmlBlock.tagName.toLowerCase() === 'comment') {\n          pastedThing = this.pasteWorkspaceComment_(xmlBlock);\n        } else {\n          pastedThing = this.pasteBlock_(xmlBlock, null);\n        }\n      }\n    } finally {\n      eventUtils.setGroup(existingGroup);\n    }\n    return pastedThing;\n  }\n\n  /**\n   * Paste the provided block onto the workspace.\n   *\n   * @param xmlBlock XML block element.\n   * @param jsonBlock JSON block representation.\n   * @returns The pasted block.\n   */\n  private pasteBlock_(\n    xmlBlock: Element | null,\n    jsonBlock: blocks.State | null\n  ): BlockSvg {\n    eventUtils.disable();\n    let block: BlockSvg;\n    try {\n      let blockX = 0;\n      let blockY = 0;\n      if (xmlBlock) {\n        block = Xml.domToBlock(xmlBlock, this) as BlockSvg;\n        blockX = parseInt(xmlBlock.getAttribute('x') ?? '0');\n        if (this.RTL) {\n          blockX = -blockX;\n        }\n        blockY = parseInt(xmlBlock.getAttribute('y') ?? '0');\n      } else if (jsonBlock) {\n        block = blocks.append(jsonBlock, this) as BlockSvg;\n        blockX = jsonBlock['x'] || 10;\n        if (this.RTL) {\n          blockX = this.getWidth() - blockX;\n        }\n        blockY = jsonBlock['y'] || 10;\n      }\n\n      // Move the duplicate to original position.\n      if (!isNaN(blockX) && !isNaN(blockY)) {\n        // Offset block until not clobbering another block and not in connection\n        // distance with neighbouring blocks.\n        let collide;\n        do {\n          collide = false;\n          const allBlocks = this.getAllBlocks(false);\n          for (let i = 0, otherBlock; (otherBlock = allBlocks[i]); i++) {\n            const otherXY = otherBlock.getRelativeToSurfaceXY();\n            if (\n              Math.abs(blockX - otherXY.x) <= 1 &&\n              Math.abs(blockY - otherXY.y) <= 1\n            ) {\n              collide = true;\n              break;\n            }\n          }\n          if (!collide) {\n            // Check for blocks in snap range to any of its connections.\n            const connections = block!.getConnections_(false);\n            for (let i = 0, connection; (connection = connections[i]); i++) {\n              const neighbour = connection.closest(\n                config.snapRadius,\n                new Coordinate(blockX, blockY)\n              );\n              if (neighbour.connection) {\n                collide = true;\n                break;\n              }\n            }\n          }\n          if (collide) {\n            if (this.RTL) {\n              blockX -= config.snapRadius;\n            } else {\n              blockX += config.snapRadius;\n            }\n            blockY += config.snapRadius * 2;\n          }\n        } while (collide);\n        // No 'reason' provided since events are disabled.\n        block!.moveTo(new Coordinate(blockX, blockY));\n      }\n    } finally {\n      eventUtils.enable();\n    }\n    if (eventUtils.isEnabled() && !block!.isShadow()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(block!));\n    }\n    block!.select();\n    return block!;\n  }\n\n  /**\n   * Paste the provided comment onto the workspace.\n   *\n   * @param xmlComment XML workspace comment element.\n   * @returns The pasted workspace comment.\n   */\n  private pasteWorkspaceComment_(xmlComment: Element): WorkspaceCommentSvg {\n    eventUtils.disable();\n    let comment: WorkspaceCommentSvg;\n    try {\n      comment = WorkspaceCommentSvg.fromXmlRendered(xmlComment, this);\n      // Move the duplicate to original position.\n      let commentX = parseInt(xmlComment.getAttribute('x') ?? '0');\n      let commentY = parseInt(xmlComment.getAttribute('y') ?? '0');\n      if (!isNaN(commentX) && !isNaN(commentY)) {\n        if (this.RTL) {\n          commentX = -commentX;\n        }\n        // Offset workspace comment.\n        // TODO (#1719): Properly offset comment such that it's not interfering\n        // with any blocks.\n        commentX += 50;\n        commentY += 50;\n        comment.moveBy(commentX, commentY);\n      }\n    } finally {\n      eventUtils.enable();\n    }\n    if (eventUtils.isEnabled()) {\n      WorkspaceComment.fireCreateEvent(comment);\n    }\n    comment.select();\n    return comment;\n  }\n\n  /**\n   * Refresh the toolbox unless there's a drag in progress.\n   *\n   * @internal\n   */\n  refreshToolboxSelection() {\n    const ws = this.isFlyout ? this.targetWorkspace : this;\n    if (ws && !ws.currentGesture_ && ws.toolbox_ && ws.toolbox_.getFlyout()) {\n      ws.toolbox_.refreshSelection();\n    }\n  }\n\n  /**\n   * Rename a variable by updating its name in the variable map.  Update the\n   *     flyout to show the renamed variable immediately.\n   *\n   * @param id ID of the variable to rename.\n   * @param newName New variable name.\n   */\n  override renameVariableById(id: string, newName: string) {\n    super.renameVariableById(id, newName);\n    this.refreshToolboxSelection();\n  }\n\n  /**\n   * Delete a variable by the passed in ID.   Update the flyout to show\n   *     immediately that the variable is deleted.\n   *\n   * @param id ID of variable to delete.\n   */\n  override deleteVariableById(id: string) {\n    super.deleteVariableById(id);\n    this.refreshToolboxSelection();\n  }\n\n  /**\n   * Create a new variable with the given name.  Update the flyout to show the\n   *     new variable immediately.\n   *\n   * @param name The new variable's name.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   * @returns The newly created variable.\n   */\n  override createVariable(\n    name: string,\n    opt_type?: string | null,\n    opt_id?: string | null\n  ): VariableModel {\n    const newVar = super.createVariable(name, opt_type, opt_id);\n    this.refreshToolboxSelection();\n    return newVar;\n  }\n\n  /** Make a list of all the delete areas for this workspace. */\n  recordDragTargets() {\n    const dragTargets = this.componentManager.getComponents(\n      ComponentManager.Capability.DRAG_TARGET,\n      true\n    );\n\n    this.dragTargetAreas = [];\n    for (let i = 0, targetArea; (targetArea = dragTargets[i]); i++) {\n      const rect = targetArea.getClientRect();\n      if (rect) {\n        this.dragTargetAreas.push({\n          component: targetArea,\n          clientRect: rect,\n        });\n      }\n    }\n  }\n  /* eslint-disable jsdoc/require-returns-check */\n  /* eslint-disable @typescript-eslint/no-unused-vars */\n  /**\n   * Obtain a newly created block.\n   *\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @returns The created block.\n   */\n  override newBlock(prototypeName: string, opt_id?: string): BlockSvg {\n    throw new Error(\n      'The implementation of newBlock should be ' +\n        'monkey-patched in by blockly.ts'\n    );\n  }\n  /* eslint-enable */\n\n  /**\n   * Returns the drag target the pointer event is over.\n   *\n   * @param e Pointer move event.\n   * @returns Null if not over a drag target, or the drag target the event is\n   *     over.\n   */\n  getDragTarget(e: PointerEvent): IDragTarget | null {\n    for (let i = 0, targetArea; (targetArea = this.dragTargetAreas[i]); i++) {\n      if (targetArea.clientRect.contains(e.clientX, e.clientY)) {\n        return targetArea.component;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Handle a pointerdown on SVG drawing surface.\n   *\n   * @param e Pointer down event.\n   */\n  private onMouseDown_(e: PointerEvent) {\n    const gesture = this.getGesture(e);\n    if (gesture) {\n      gesture.handleWsStart(e, this);\n    }\n  }\n\n  /**\n   * Start tracking a drag of an object on this workspace.\n   *\n   * @param e Pointer down event.\n   * @param xy Starting location of object.\n   */\n  startDrag(e: PointerEvent, xy: Coordinate) {\n    // Record the starting offset between the bubble's location and the mouse.\n    const point = browserEvents.mouseToSvg(\n      e,\n      this.getParentSvg(),\n      this.getInverseScreenCTM()\n    );\n    // Fix scale of mouse event.\n    point.x /= this.scale;\n    point.y /= this.scale;\n    this.dragDeltaXY = Coordinate.difference(xy, point);\n  }\n\n  /**\n   * Track a drag of an object on this workspace.\n   *\n   * @param e Pointer move event.\n   * @returns New location of object.\n   */\n  moveDrag(e: PointerEvent): Coordinate {\n    const point = browserEvents.mouseToSvg(\n      e,\n      this.getParentSvg(),\n      this.getInverseScreenCTM()\n    );\n    // Fix scale of mouse event.\n    point.x /= this.scale;\n    point.y /= this.scale;\n    return Coordinate.sum(this.dragDeltaXY!, point);\n  }\n\n  /**\n   * Is the user currently dragging a block or scrolling the flyout/workspace?\n   *\n   * @returns True if currently dragging or scrolling.\n   */\n  isDragging(): boolean {\n    return this.currentGesture_ !== null && this.currentGesture_.isDragging();\n  }\n\n  /**\n   * Is this workspace draggable?\n   *\n   * @returns True if this workspace may be dragged.\n   */\n  isDraggable(): boolean {\n    return this.options.moveOptions && this.options.moveOptions.drag;\n  }\n\n  /**\n   * Is this workspace movable?\n   *\n   * This means the user can reposition the X Y coordinates of the workspace\n   * through input. This can be through scrollbars, scroll wheel, dragging, or\n   * through zooming with the scroll wheel or pinch (since the zoom is centered\n   * on the mouse position). This does not include zooming with the zoom\n   * controls since the X Y coordinates are decided programmatically.\n   *\n   * @returns True if the workspace is movable, false otherwise.\n   */\n  isMovable(): boolean {\n    return (\n      (this.options.moveOptions && !!this.options.moveOptions.scrollbars) ||\n      (this.options.moveOptions && this.options.moveOptions.wheel) ||\n      (this.options.moveOptions && this.options.moveOptions.drag) ||\n      (this.options.zoomOptions && this.options.zoomOptions.wheel) ||\n      (this.options.zoomOptions && this.options.zoomOptions.pinch)\n    );\n  }\n\n  /**\n   * Is this workspace movable horizontally?\n   *\n   * @returns True if the workspace is movable horizontally, false otherwise.\n   */\n  isMovableHorizontally(): boolean {\n    const hasScrollbars = !!this.scrollbar;\n    return (\n      this.isMovable() &&\n      (!hasScrollbars ||\n        (hasScrollbars && this.scrollbar!.canScrollHorizontally()))\n    );\n  }\n\n  /**\n   * Is this workspace movable vertically?\n   *\n   * @returns True if the workspace is movable vertically, false otherwise.\n   */\n  isMovableVertically(): boolean {\n    const hasScrollbars = !!this.scrollbar;\n    return (\n      this.isMovable() &&\n      (!hasScrollbars ||\n        (hasScrollbars && this.scrollbar!.canScrollVertically()))\n    );\n  }\n\n  /**\n   * Handle a mouse-wheel on SVG drawing surface.\n   *\n   * @param e Mouse wheel event.\n   */\n  private onMouseWheel_(e: WheelEvent) {\n    // Don't scroll or zoom anything if drag is in progress.\n    if (Gesture.inProgress()) {\n      e.preventDefault();\n      e.stopPropagation();\n      return;\n    }\n    const canWheelZoom =\n      this.options.zoomOptions && this.options.zoomOptions.wheel;\n    const canWheelMove =\n      this.options.moveOptions && this.options.moveOptions.wheel;\n    if (!canWheelZoom && !canWheelMove) {\n      return;\n    }\n\n    const scrollDelta = browserEvents.getScrollDeltaPixels(e);\n\n    // Zoom should also be enabled by the command key on Mac devices,\n    // but not super on Unix.\n    let commandKey;\n    if (userAgent.MAC) {\n      commandKey = e.metaKey;\n    }\n\n    if (canWheelZoom && (e.ctrlKey || commandKey || !canWheelMove)) {\n      // Zoom.\n      // The vertical scroll distance that corresponds to a click of a zoom\n      // button.\n      const PIXELS_PER_ZOOM_STEP = 50;\n      const delta = -scrollDelta.y / PIXELS_PER_ZOOM_STEP;\n      const position = browserEvents.mouseToSvg(\n        e,\n        this.getParentSvg(),\n        this.getInverseScreenCTM()\n      );\n      this.zoom(position.x, position.y, delta);\n    } else {\n      // Scroll.\n      let x = this.scrollX - scrollDelta.x;\n      let y = this.scrollY - scrollDelta.y;\n\n      if (e.shiftKey && !scrollDelta.x) {\n        // Scroll horizontally (based on vertical scroll delta).\n        // This is needed as for some browser/system combinations which do not\n        // set deltaX.\n        x = this.scrollX - scrollDelta.y;\n        y = this.scrollY; // Don't scroll vertically.\n      }\n      this.scroll(x, y);\n    }\n    e.preventDefault();\n  }\n\n  /**\n   * Calculate the bounding box for the blocks on the workspace.\n   * Coordinate system: workspace coordinates.\n   *\n   * @returns Contains the position and size of the bounding box containing the\n   *     blocks on the workspace.\n   */\n  getBlocksBoundingBox(): Rect {\n    const topElements = this.getTopBoundedElements();\n    // There are no blocks, return empty rectangle.\n    if (!topElements.length) {\n      return new Rect(0, 0, 0, 0);\n    }\n\n    // Initialize boundary using the first block.\n    const boundary = topElements[0].getBoundingRectangle();\n\n    // Start at 1 since the 0th block was used for initialization.\n    for (let i = 1; i < topElements.length; i++) {\n      const topElement = topElements[i];\n      if (\n        (topElement as any).isInsertionMarker &&\n        (topElement as any).isInsertionMarker()\n      ) {\n        continue;\n      }\n      const blockBoundary = topElement.getBoundingRectangle();\n      if (blockBoundary.top < boundary.top) {\n        boundary.top = blockBoundary.top;\n      }\n      if (blockBoundary.bottom > boundary.bottom) {\n        boundary.bottom = blockBoundary.bottom;\n      }\n      if (blockBoundary.left < boundary.left) {\n        boundary.left = blockBoundary.left;\n      }\n      if (blockBoundary.right > boundary.right) {\n        boundary.right = blockBoundary.right;\n      }\n    }\n    return boundary;\n  }\n\n  /** Clean up the workspace by ordering all the blocks in a column. */\n  cleanUp() {\n    this.setResizesEnabled(false);\n    eventUtils.setGroup(true);\n    const topBlocks = this.getTopBlocks(true);\n    let cursorY = 0;\n    for (let i = 0, block; (block = topBlocks[i]); i++) {\n      if (!block.isMovable()) {\n        continue;\n      }\n      const xy = block.getRelativeToSurfaceXY();\n      block.moveBy(-xy.x, cursorY - xy.y, ['cleanup']);\n      block.snapToGrid();\n      cursorY =\n        block.getRelativeToSurfaceXY().y +\n        block.getHeightWidth().height +\n        this.renderer.getConstants().MIN_BLOCK_HEIGHT;\n    }\n    eventUtils.setGroup(false);\n    this.setResizesEnabled(true);\n  }\n\n  /**\n   * Show the context menu for the workspace.\n   *\n   * @param e Mouse event.\n   * @internal\n   */\n  showContextMenu(e: Event) {\n    if (this.options.readOnly || this.isFlyout) {\n      return;\n    }\n    const menuOptions = ContextMenuRegistry.registry.getContextMenuOptions(\n      ContextMenuRegistry.ScopeType.WORKSPACE,\n      {workspace: this}\n    );\n\n    // Allow the developer to add or modify menuOptions.\n    if (this.configureContextMenu) {\n      this.configureContextMenu(menuOptions, e);\n    }\n\n    ContextMenu.show(e, menuOptions, this.RTL);\n  }\n\n  /**\n   * Modify the block tree on the existing toolbox.\n   *\n   * @param toolboxDef DOM tree of toolbox contents, string of toolbox contents,\n   *     or JSON representing toolbox definition.\n   */\n  updateToolbox(toolboxDef: toolbox.ToolboxDefinition | null) {\n    const parsedToolboxDef = toolbox.convertToolboxDefToJson(toolboxDef);\n\n    if (!parsedToolboxDef) {\n      if (this.options.languageTree) {\n        throw Error(\"Can't nullify an existing toolbox.\");\n      }\n      return; // No change (null to null).\n    }\n    if (!this.options.languageTree) {\n      throw Error(\"Existing toolbox is null.  Can't create new toolbox.\");\n    }\n\n    if (toolbox.hasCategories(parsedToolboxDef)) {\n      if (!this.toolbox_) {\n        throw Error(\"Existing toolbox has no categories.  Can't change mode.\");\n      }\n      this.options.languageTree = parsedToolboxDef;\n      this.toolbox_.render(parsedToolboxDef);\n    } else {\n      if (!this.flyout) {\n        throw Error(\"Existing toolbox has categories.  Can't change mode.\");\n      }\n      this.options.languageTree = parsedToolboxDef;\n      this.flyout.show(parsedToolboxDef);\n    }\n  }\n\n  /** Mark this workspace as the currently focused main workspace. */\n  markFocused() {\n    if (this.options.parentWorkspace) {\n      this.options.parentWorkspace.markFocused();\n    } else {\n      common.setMainWorkspace(this);\n      // We call e.preventDefault in many event handlers which means we\n      // need to explicitly grab focus (e.g from a textarea) because\n      // the browser will not do it for us.\n      this.getParentSvg().focus({preventScroll: true});\n    }\n  }\n\n  /**\n   * Zooms the workspace in or out relative to/centered on the given (x, y)\n   * coordinate.\n   *\n   * @param x X coordinate of center, in pixel units relative to the top-left\n   *     corner of the parentSVG.\n   * @param y Y coordinate of center, in pixel units relative to the top-left\n   *     corner of the parentSVG.\n   * @param amount Amount of zooming. The formula for the new scale is newScale\n   *     = currentScale * (scaleSpeed^amount). scaleSpeed is set in the\n   *     workspace options. Negative amount values zoom out, and positive amount\n   *     values zoom in.\n   */\n  zoom(x: number, y: number, amount: number) {\n    // Scale factor.\n    const speed = this.options.zoomOptions.scaleSpeed;\n    let scaleChange = Math.pow(speed, amount);\n    const newScale = this.scale * scaleChange;\n    if (this.scale === newScale) {\n      return; // No change in zoom.\n    }\n\n    // Clamp scale within valid range.\n    if (newScale > this.options.zoomOptions.maxScale) {\n      scaleChange = this.options.zoomOptions.maxScale / this.scale;\n    } else if (newScale < this.options.zoomOptions.minScale) {\n      scaleChange = this.options.zoomOptions.minScale / this.scale;\n    }\n\n    // Transform the x/y coordinates from the parentSVG's space into the\n    // canvas' space, so that they are in workspace units relative to the top\n    // left of the visible portion of the workspace.\n    let matrix = this.getCanvas().getCTM();\n    let center = this.getParentSvg().createSVGPoint();\n    center.x = x;\n    center.y = y;\n    center = center.matrixTransform(matrix!.inverse());\n    x = center.x;\n    y = center.y;\n\n    // Find the new scrollX/scrollY so that the center remains in the same\n    // position (relative to the center) after we zoom.\n    // newScale and matrix.a should be identical (within a rounding error).\n    matrix = matrix!\n      .translate(x * (1 - scaleChange), y * (1 - scaleChange))\n      .scale(scaleChange);\n    // scrollX and scrollY are in pixels.\n    // The scrollX and scrollY still need to have absoluteLeft and absoluteTop\n    // subtracted from them, but we'll leave that for setScale so that they're\n    // correctly updated for the new flyout size if we have a simple toolbox.\n    this.scrollX = matrix.e;\n    this.scrollY = matrix.f;\n    this.setScale(newScale);\n  }\n\n  /**\n   * Zooming the blocks centered in the center of view with zooming in or out.\n   *\n   * @param type Type of zooming (-1 zooming out and 1 zooming in).\n   */\n  zoomCenter(type: number) {\n    const metrics = this.getMetrics();\n    let x;\n    let y;\n    if (this.flyout) {\n      // If you want blocks in the center of the view (visible portion of the\n      // workspace) to stay centered when the size of the view decreases (i.e.\n      // when the size of the flyout increases) you need the center of the\n      // *blockly div* to stay in the same pixel-position.\n      // Note: This only works because of how scrollCenter positions blocks.\n      x = metrics.svgWidth ? metrics.svgWidth / 2 : 0;\n      y = metrics.svgHeight ? metrics.svgHeight / 2 : 0;\n    } else {\n      x = metrics.viewWidth / 2 + metrics.absoluteLeft;\n      y = metrics.viewHeight / 2 + metrics.absoluteTop;\n    }\n    this.zoom(x, y, type);\n  }\n\n  /** Zoom the blocks to fit in the workspace if possible. */\n  zoomToFit() {\n    if (!this.isMovable()) {\n      console.warn(\n        'Tried to move a non-movable workspace. This could result' +\n          ' in blocks becoming inaccessible.'\n      );\n      return;\n    }\n\n    const metrics = this.getMetrics();\n    let workspaceWidth = metrics.viewWidth;\n    let workspaceHeight = metrics.viewHeight;\n    const blocksBox = this.getBlocksBoundingBox();\n    const doubleMargin = ZOOM_TO_FIT_MARGIN * 2;\n    let blocksWidth = blocksBox.right - blocksBox.left + doubleMargin;\n    let blocksHeight = blocksBox.bottom - blocksBox.top + doubleMargin;\n    if (!blocksWidth) {\n      return; // Prevents zooming to infinity.\n    }\n    if (this.flyout) {\n      // We have to add the flyout size to both the workspace size and the\n      // block size because the blocks we want to resize include the blocks in\n      // the flyout, and the area we want to fit them includes the portion of\n      // the workspace that is behind the flyout.\n      if (this.horizontalLayout) {\n        workspaceHeight += this.flyout.getHeight();\n        // Convert from pixels to workspace coordinates.\n        blocksHeight += this.flyout.getHeight() / this.scale;\n      } else {\n        workspaceWidth += this.flyout.getWidth();\n        // Convert from pixels to workspace coordinates.\n        blocksWidth += this.flyout.getWidth() / this.scale;\n      }\n    }\n\n    // Scale Units: (pixels / workspaceUnit)\n    const ratioX = workspaceWidth / blocksWidth;\n    const ratioY = workspaceHeight / blocksHeight;\n    eventUtils.disable();\n    try {\n      this.setScale(Math.min(ratioX, ratioY));\n      this.scrollCenter();\n    } finally {\n      eventUtils.enable();\n    }\n    this.maybeFireViewportChangeEvent();\n  }\n\n  /**\n   * Add a transition class to the block and bubble canvas, to animate any\n   * transform changes.\n   *\n   * @internal\n   */\n  beginCanvasTransition() {\n    dom.addClass(this.svgBlockCanvas_, 'blocklyCanvasTransitioning');\n    dom.addClass(this.svgBubbleCanvas_, 'blocklyCanvasTransitioning');\n  }\n\n  /**\n   * Remove transition class from the block and bubble canvas.\n   *\n   * @internal\n   */\n  endCanvasTransition() {\n    dom.removeClass(this.svgBlockCanvas_, 'blocklyCanvasTransitioning');\n    dom.removeClass(this.svgBubbleCanvas_, 'blocklyCanvasTransitioning');\n  }\n\n  /** Center the workspace. */\n  scrollCenter() {\n    if (!this.isMovable()) {\n      console.warn(\n        'Tried to move a non-movable workspace. This could result' +\n          ' in blocks becoming inaccessible.'\n      );\n      return;\n    }\n\n    const metrics = this.getMetrics();\n    let x = (metrics.scrollWidth - metrics.viewWidth) / 2;\n    let y = (metrics.scrollHeight - metrics.viewHeight) / 2;\n\n    // Convert from workspace directions to canvas directions.\n    x = -x - metrics.scrollLeft;\n    y = -y - metrics.scrollTop;\n    this.scroll(x, y);\n  }\n\n  /**\n   * Scroll the workspace to center on the given block. If the block has other\n   * blocks stacked below it, the workspace will be centered on the stack,\n   * unless blockOnly is true.\n   *\n   * @param id ID of block center on.\n   * @param blockOnly True to center only on the block itself, not its stack.\n   */\n  centerOnBlock(id: string | null, blockOnly?: boolean) {\n    if (!this.isMovable()) {\n      console.warn(\n        'Tried to move a non-movable workspace. This could result' +\n          ' in blocks becoming inaccessible.'\n      );\n      return;\n    }\n\n    const block = id ? this.getBlockById(id) : null;\n    if (!block) {\n      return;\n    }\n\n    // XY is in workspace coordinates.\n    const xy = block.getRelativeToSurfaceXY();\n    // Height/width is in workspace units.\n    const heightWidth = blockOnly\n      ? {height: block.height, width: block.width}\n      : block.getHeightWidth();\n\n    // Find the enter of the block in workspace units.\n    const blockCenterY = xy.y + heightWidth.height / 2;\n\n    // In RTL the block's position is the top right of the block, not top left.\n    const multiplier = this.RTL ? -1 : 1;\n    const blockCenterX = xy.x + (multiplier * heightWidth.width) / 2;\n\n    // Workspace scale, used to convert from workspace coordinates to pixels.\n    const scale = this.scale;\n\n    // Center of block in pixels, relative to workspace origin (center 0,0).\n    // Scrolling to here would put the block in the top-left corner of the\n    // visible workspace.\n    const pixelX = blockCenterX * scale;\n    const pixelY = blockCenterY * scale;\n\n    const metrics = this.getMetrics();\n\n    // viewHeight and viewWidth are in pixels.\n    const halfViewWidth = metrics.viewWidth / 2;\n    const halfViewHeight = metrics.viewHeight / 2;\n\n    // Put the block in the center of the visible workspace instead.\n    const scrollToCenterX = pixelX - halfViewWidth;\n    const scrollToCenterY = pixelY - halfViewHeight;\n\n    // Convert from workspace directions to canvas directions.\n    const x = -scrollToCenterX;\n    const y = -scrollToCenterY;\n\n    this.scroll(x, y);\n  }\n\n  /**\n   * Set the workspace's zoom factor.\n   *\n   * @param newScale Zoom factor. Units: (pixels / workspaceUnit).\n   */\n  setScale(newScale: number) {\n    if (\n      this.options.zoomOptions.maxScale &&\n      newScale > this.options.zoomOptions.maxScale\n    ) {\n      newScale = this.options.zoomOptions.maxScale;\n    } else if (\n      this.options.zoomOptions.minScale &&\n      newScale < this.options.zoomOptions.minScale\n    ) {\n      newScale = this.options.zoomOptions.minScale;\n    }\n    this.scale = newScale;\n\n    this.hideChaff(false);\n    // Get the flyout, if any, whether our own or owned by the toolbox.\n    const flyout = this.getFlyout(false);\n    if (flyout && flyout.isVisible()) {\n      flyout.reflow();\n      this.recordDragTargets();\n    }\n    if (this.grid) {\n      this.grid.update(this.scale);\n    }\n\n    // We call scroll instead of scrollbar.resize() so that we can center the\n    // zoom correctly without scrollbars, but scroll does not resize the\n    // scrollbars so we have to call resizeView/resizeContent as well.\n    const metrics = this.getMetrics();\n\n    this.scrollX -= metrics.absoluteLeft;\n    this.scrollY -= metrics.absoluteTop;\n    // The scroll values and the view values are additive inverses of\n    // each other, so when we subtract from one we have to add to the other.\n    metrics.viewLeft += metrics.absoluteLeft;\n    metrics.viewTop += metrics.absoluteTop;\n\n    this.scroll(this.scrollX, this.scrollY);\n    if (this.scrollbar) {\n      if (this.flyout) {\n        this.scrollbar.resizeView(metrics);\n      } else {\n        this.scrollbar.resizeContent(metrics);\n      }\n    }\n  }\n\n  /**\n   * Get the workspace's zoom factor.  If the workspace has a parent, we call\n   * into the parent to get the workspace scale.\n   *\n   * @returns The workspace zoom factor. Units: (pixels / workspaceUnit).\n   */\n  getScale(): number {\n    if (this.options.parentWorkspace) {\n      return this.options.parentWorkspace.getScale();\n    }\n    return this.scale;\n  }\n\n  /**\n   * Scroll the workspace to a specified offset (in pixels), keeping in the\n   * workspace bounds. See comment on workspaceSvg.scrollX for more detail on\n   * the meaning of these values.\n   *\n   * @param x Target X to scroll to.\n   * @param y Target Y to scroll to.\n   * @internal\n   */\n  scroll(x: number, y: number) {\n    this.hideChaff(/* opt_onlyClosePopups= */ true);\n\n    // Keep scrolling within the bounds of the content.\n    const metrics = this.getMetrics();\n    // Canvas coordinates (aka scroll coordinates) have inverse directionality\n    // to workspace coordinates so we have to inverse them.\n    x = Math.min(x, -metrics.scrollLeft);\n    y = Math.min(y, -metrics.scrollTop);\n    const maxXDisplacement = Math.max(\n      0,\n      metrics.scrollWidth - metrics.viewWidth\n    );\n    const maxXScroll = metrics.scrollLeft + maxXDisplacement;\n    const maxYDisplacement = Math.max(\n      0,\n      metrics.scrollHeight - metrics.viewHeight\n    );\n    const maxYScroll = metrics.scrollTop + maxYDisplacement;\n    x = Math.max(x, -maxXScroll);\n    y = Math.max(y, -maxYScroll);\n    this.scrollX = x;\n    this.scrollY = y;\n\n    if (this.scrollbar) {\n      // The content position (displacement from the content's top-left to the\n      // origin) plus the scroll position (displacement from the view's top-left\n      // to the origin) gives us the distance from the view's top-left to the\n      // content's top-left. Then we negate this so we get the displacement from\n      // the content's top-left to the view's top-left, matching the\n      // directionality of the scrollbars.\n      this.scrollbar.set(\n        -(x + metrics.scrollLeft),\n        -(y + metrics.scrollTop),\n        false\n      );\n    }\n    // We have to shift the translation so that when the canvas is at 0, 0 the\n    // workspace origin is not underneath the toolbox.\n    x += metrics.absoluteLeft;\n    y += metrics.absoluteTop;\n    this.translate(x, y);\n  }\n\n  /**\n   * Find the block on this workspace with the specified ID.\n   *\n   * @param id ID of block to find.\n   * @returns The sought after block, or null if not found.\n   */\n  override getBlockById(id: string): BlockSvg | null {\n    return super.getBlockById(id) as BlockSvg;\n  }\n\n  /**\n   * Find all blocks in workspace.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  override getAllBlocks(ordered: boolean): BlockSvg[] {\n    return super.getAllBlocks(ordered) as BlockSvg[];\n  }\n\n  /**\n   * Finds the top-level blocks and returns them.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns The top-level block objects.\n   */\n  override getTopBlocks(ordered: boolean): BlockSvg[] {\n    return super.getTopBlocks(ordered) as BlockSvg[];\n  }\n\n  /**\n   * Adds a block to the list of top blocks.\n   *\n   * @param block Block to add.\n   */\n  override addTopBlock(block: Block) {\n    this.addTopBoundedElement(block as BlockSvg);\n    super.addTopBlock(block);\n  }\n\n  /**\n   * Removes a block from the list of top blocks.\n   *\n   * @param block Block to remove.\n   */\n  override removeTopBlock(block: Block) {\n    this.removeTopBoundedElement(block as BlockSvg);\n    super.removeTopBlock(block);\n  }\n\n  /**\n   * Adds a comment to the list of top comments.\n   *\n   * @param comment comment to add.\n   */\n  override addTopComment(comment: WorkspaceComment) {\n    this.addTopBoundedElement(comment as WorkspaceCommentSvg);\n    super.addTopComment(comment);\n  }\n\n  /**\n   * Removes a comment from the list of top comments.\n   *\n   * @param comment comment to remove.\n   */\n  override removeTopComment(comment: WorkspaceComment) {\n    this.removeTopBoundedElement(comment as WorkspaceCommentSvg);\n    super.removeTopComment(comment);\n  }\n\n  override getRootWorkspace(): WorkspaceSvg | null {\n    return super.getRootWorkspace() as WorkspaceSvg | null;\n  }\n\n  /**\n   * Adds a bounded element to the list of top bounded elements.\n   *\n   * @param element Bounded element to add.\n   */\n  addTopBoundedElement(element: IBoundedElement) {\n    this.topBoundedElements.push(element);\n  }\n\n  /**\n   * Removes a bounded element from the list of top bounded elements.\n   *\n   * @param element Bounded element to remove.\n   */\n  removeTopBoundedElement(element: IBoundedElement) {\n    arrayUtils.removeElem(this.topBoundedElements, element);\n  }\n\n  /**\n   * Finds the top-level bounded elements and returns them.\n   *\n   * @returns The top-level bounded elements.\n   */\n  getTopBoundedElements(): IBoundedElement[] {\n    return new Array<IBoundedElement>().concat(this.topBoundedElements);\n  }\n\n  /**\n   * Update whether this workspace has resizes enabled.\n   * If enabled, workspace will resize when appropriate.\n   * If disabled, workspace will not resize until re-enabled.\n   * Use to avoid resizing during a batch operation, for performance.\n   *\n   * @param enabled Whether resizes should be enabled.\n   */\n  setResizesEnabled(enabled: boolean) {\n    const reenabled = !this.resizesEnabled && enabled;\n    this.resizesEnabled = enabled;\n    if (reenabled) {\n      // Newly enabled.  Trigger a resize.\n      this.resizeContents();\n    }\n  }\n\n  /**\n   * Dispose of all blocks in workspace, with an optimization to prevent\n   * resizes.\n   */\n  override clear() {\n    this.setResizesEnabled(false);\n    super.clear();\n    this.topBoundedElements = [];\n    this.setResizesEnabled(true);\n  }\n\n  /**\n   * Register a callback function associated with a given key, for clicks on\n   * buttons and labels in the flyout.\n   * For instance, a button specified by the XML\n   * <button text=\"create variable\" callbackKey=\"CREATE_VARIABLE\"></button>\n   * should be matched by a call to\n   * registerButtonCallback(\"CREATE_VARIABLE\", yourCallbackFunction).\n   *\n   * @param key The name to use to look up this function.\n   * @param func The function to call when the given button is clicked.\n   */\n  registerButtonCallback(key: string, func: (p1: FlyoutButton) => void) {\n    if (typeof func !== 'function') {\n      throw TypeError('Button callbacks must be functions.');\n    }\n    this.flyoutButtonCallbacks.set(key, func);\n  }\n\n  /**\n   * Get the callback function associated with a given key, for clicks on\n   * buttons and labels in the flyout.\n   *\n   * @param key The name to use to look up the function.\n   * @returns The function corresponding to the given key for this workspace;\n   *     null if no callback is registered.\n   */\n  getButtonCallback(key: string): ((p1: FlyoutButton) => void) | null {\n    return this.flyoutButtonCallbacks.get(key) ?? null;\n  }\n\n  /**\n   * Remove a callback for a click on a button in the flyout.\n   *\n   * @param key The name associated with the callback function.\n   */\n  removeButtonCallback(key: string) {\n    this.flyoutButtonCallbacks.delete(key);\n  }\n\n  /**\n   * Register a callback function associated with a given key, for populating\n   * custom toolbox categories in this workspace.  See the variable and\n   * procedure categories as an example.\n   *\n   * @param key The name to use to look up this function.\n   * @param func The function to call when the given toolbox category is opened.\n   */\n  registerToolboxCategoryCallback(\n    key: string,\n    func: (p1: WorkspaceSvg) => toolbox.FlyoutDefinition\n  ) {\n    if (typeof func !== 'function') {\n      throw TypeError('Toolbox category callbacks must be functions.');\n    }\n    this.toolboxCategoryCallbacks.set(key, func);\n  }\n\n  /**\n   * Get the callback function associated with a given key, for populating\n   * custom toolbox categories in this workspace.\n   *\n   * @param key The name to use to look up the function.\n   * @returns The function corresponding to the given key for this workspace, or\n   *     null if no function is registered.\n   */\n  getToolboxCategoryCallback(\n    key: string\n  ): ((p1: WorkspaceSvg) => toolbox.FlyoutDefinition) | null {\n    return this.toolboxCategoryCallbacks.get(key) || null;\n  }\n\n  /**\n   * Remove a callback for a click on a custom category's name in the toolbox.\n   *\n   * @param key The name associated with the callback function.\n   */\n  removeToolboxCategoryCallback(key: string) {\n    this.toolboxCategoryCallbacks.delete(key);\n  }\n\n  /**\n   * Look up the gesture that is tracking this touch stream on this workspace.\n   * May create a new gesture.\n   *\n   * @param e Pointer event.\n   * @returns The gesture that is tracking this touch stream, or null if no\n   *     valid gesture exists.\n   * @internal\n   */\n  getGesture(e: PointerEvent): Gesture | null {\n    const isStart = e.type === 'pointerdown';\n\n    const gesture = this.currentGesture_;\n    if (gesture) {\n      if (isStart && gesture.hasStarted()) {\n        console.warn('Tried to start the same gesture twice.');\n        // That's funny.  We must have missed a mouse up.\n        // Cancel it, rather than try to retrieve all of the state we need.\n        gesture.cancel();\n        return null;\n      }\n      return gesture;\n    }\n\n    // No gesture existed on this workspace, but this looks like the start of a\n    // new gesture.\n    if (isStart) {\n      this.currentGesture_ = new Gesture(e, this);\n      return this.currentGesture_;\n    }\n    // No gesture existed and this event couldn't be the start of a new gesture.\n    return null;\n  }\n\n  /**\n   * Clear the reference to the current gesture.\n   *\n   * @internal\n   */\n  clearGesture() {\n    this.currentGesture_ = null;\n  }\n\n  /**\n   * Cancel the current gesture, if one exists.\n   *\n   * @internal\n   */\n  cancelCurrentGesture() {\n    if (this.currentGesture_) {\n      this.currentGesture_.cancel();\n    }\n  }\n\n  /**\n   * Get the audio manager for this workspace.\n   *\n   * @returns The audio manager for this workspace.\n   */\n  getAudioManager(): WorkspaceAudio {\n    return this.audioManager;\n  }\n\n  /**\n   * Get the grid object for this workspace, or null if there is none.\n   *\n   * @returns The grid object for this workspace.\n   * @internal\n   */\n  getGrid(): Grid | null {\n    return this.grid;\n  }\n\n  /**\n   * Close tooltips, context menus, dropdown selections, etc.\n   *\n   * @param onlyClosePopups Whether only popups should be closed. Defaults to\n   *     false.\n   */\n  hideChaff(onlyClosePopups = false) {\n    Tooltip.hide();\n    WidgetDiv.hide();\n    dropDownDiv.hideWithoutAnimation();\n\n    this.hideComponents(onlyClosePopups);\n  }\n\n  /**\n   * Hide any autohideable components (like flyout, trashcan, and any\n   * user-registered components).\n   *\n   * @param onlyClosePopups Whether only popups should be closed. Defaults to\n   *     false.\n   */\n  hideComponents(onlyClosePopups = false) {\n    const autoHideables = this.getComponentManager().getComponents(\n      ComponentManager.Capability.AUTOHIDEABLE,\n      true\n    );\n    autoHideables.forEach((autoHideable) =>\n      autoHideable.autoHide(onlyClosePopups)\n    );\n  }\n\n  /**\n   * Sets the X/Y translations of a top level workspace.\n   *\n   * @param xyRatio Contains an x and/or y property which is a float between 0\n   *     and 1 specifying the degree of scrolling.\n   */\n  private static setTopLevelWorkspaceMetrics_(\n    this: WorkspaceSvg,\n    xyRatio: {x?: number; y?: number}\n  ) {\n    const metrics = this.getMetrics();\n\n    if (typeof xyRatio.x === 'number') {\n      this.scrollX = -(\n        metrics.scrollLeft +\n        (metrics.scrollWidth - metrics.viewWidth) * xyRatio.x\n      );\n    }\n    if (typeof xyRatio.y === 'number') {\n      this.scrollY = -(\n        metrics.scrollTop +\n        (metrics.scrollHeight - metrics.viewHeight) * xyRatio.y\n      );\n    }\n    // We have to shift the translation so that when the canvas is at 0, 0 the\n    // workspace origin is not underneath the toolbox.\n    const x = this.scrollX + metrics.absoluteLeft;\n    const y = this.scrollY + metrics.absoluteTop;\n    // We could call scroll here, but that has extra checks we don't need to do.\n    this.translate(x, y);\n  }\n}\n\n/**\n * Size the workspace when the contents change.  This also updates\n * scrollbars accordingly.\n *\n * @param workspace The workspace to resize.\n * @internal\n */\nexport function resizeSvgContents(workspace: WorkspaceSvg) {\n  workspace.resizeContents();\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.inject');\n\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as browserEvents from './browser_events.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as common from './common.js';\nimport * as Css from './css.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Grid} from './grid.js';\nimport {Msg} from './msg.js';\nimport {Options} from './options.js';\nimport {ScrollbarPair} from './scrollbar_pair.js';\nimport {ShortcutRegistry} from './shortcut_registry.js';\nimport * as Tooltip from './tooltip.js';\nimport * as Touch from './touch.js';\nimport * as aria from './utils/aria.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Inject a Blockly editor into the specified container element (usually a div).\n *\n * @param container Containing element, or its ID, or a CSS selector.\n * @param opt_options Optional dictionary of options.\n * @returns Newly created main workspace.\n */\nexport function inject(\n  container: Element | string,\n  opt_options?: BlocklyOptions\n): WorkspaceSvg {\n  let containerElement: Element | null = null;\n  if (typeof container === 'string') {\n    containerElement =\n      document.getElementById(container) || document.querySelector(container);\n  } else {\n    containerElement = container;\n  }\n  // Verify that the container is in document.\n  if (\n    !document.contains(containerElement) &&\n    document !== containerElement?.ownerDocument\n  ) {\n    throw Error('Error: container is not in current document');\n  }\n  const options = new Options(opt_options || ({} as BlocklyOptions));\n  const subContainer = document.createElement('div');\n  subContainer.className = 'injectionDiv';\n  subContainer.tabIndex = 0;\n  aria.setState(subContainer, aria.State.LABEL, Msg['WORKSPACE_ARIA_LABEL']);\n\n  containerElement!.appendChild(subContainer);\n  const svg = createDom(subContainer, options);\n\n  const workspace = createMainWorkspace(svg, options);\n\n  init(workspace);\n\n  // Keep focus on the first workspace so entering keyboard navigation looks\n  // correct.\n  common.setMainWorkspace(workspace);\n\n  common.svgResize(workspace);\n\n  subContainer.addEventListener('focusin', function () {\n    common.setMainWorkspace(workspace);\n  });\n\n  return workspace;\n}\n\n/**\n * Create the SVG image.\n *\n * @param container Containing element.\n * @param options Dictionary of options.\n * @returns Newly created SVG image.\n */\nfunction createDom(container: Element, options: Options): SVGElement {\n  // Sadly browsers (Chrome vs Firefox) are currently inconsistent in laying\n  // out content in RTL mode.  Therefore Blockly forces the use of LTR,\n  // then manually positions content in RTL as needed.\n  container.setAttribute('dir', 'LTR');\n\n  // Load CSS.\n  Css.inject(options.hasCss, options.pathToMedia);\n\n  // Build the SVG DOM.\n  /*\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlns:html=\"http://www.w3.org/1999/xhtml\"\n      xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n      version=\"1.1\"\n      class=\"blocklySvg\">\n      ...\n    </svg>\n    */\n  const svg = dom.createSvgElement(\n    Svg.SVG,\n    {\n      'xmlns': dom.SVG_NS,\n      'xmlns:html': dom.HTML_NS,\n      'xmlns:xlink': dom.XLINK_NS,\n      'version': '1.1',\n      'class': 'blocklySvg',\n      'tabindex': '0',\n    },\n    container\n  );\n  /*\n    <defs>\n      ... filters go here ...\n    </defs>\n    */\n  const defs = dom.createSvgElement(Svg.DEFS, {}, svg);\n  // Each filter/pattern needs a unique ID for the case of multiple Blockly\n  // instances on a page.  Browser behaviour becomes undefined otherwise.\n  // https://neil.fraser.name/news/2015/11/01/\n  const rnd = String(Math.random()).substring(2);\n\n  options.gridPattern = Grid.createDom(rnd, options.gridOptions, defs);\n  return svg;\n}\n\n/**\n * Create a main workspace and add it to the SVG.\n *\n * @param svg SVG element with pattern defined.\n * @param options Dictionary of options.\n * @returns Newly created main workspace.\n */\nfunction createMainWorkspace(svg: SVGElement, options: Options): WorkspaceSvg {\n  options.parentWorkspace = null;\n  const mainWorkspace = new WorkspaceSvg(options);\n  const wsOptions = mainWorkspace.options;\n  mainWorkspace.scale = wsOptions.zoomOptions.startScale;\n  svg.appendChild(mainWorkspace.createDom('blocklyMainBackground'));\n\n  // Set the theme name and renderer name onto the injection div.\n  const injectionDiv = mainWorkspace.getInjectionDiv();\n  const rendererClassName = mainWorkspace.getRenderer().getClassName();\n  if (rendererClassName) {\n    dom.addClass(injectionDiv, rendererClassName);\n  }\n  const themeClassName = mainWorkspace.getTheme().getClassName();\n  if (themeClassName) {\n    dom.addClass(injectionDiv, themeClassName);\n  }\n\n  if (!wsOptions.hasCategories && wsOptions.languageTree) {\n    // Add flyout as an <svg> that is a sibling of the workspace SVG.\n    const flyout = mainWorkspace.addFlyout(Svg.SVG);\n    dom.insertAfter(flyout, svg);\n  }\n  if (wsOptions.hasTrashcan) {\n    mainWorkspace.addTrashcan();\n  }\n  if (wsOptions.zoomOptions && wsOptions.zoomOptions.controls) {\n    mainWorkspace.addZoomControls();\n  }\n  // Register the workspace svg as a UI component.\n  mainWorkspace\n    .getThemeManager()\n    .subscribe(svg, 'workspaceBackgroundColour', 'background-color');\n\n  // A null translation will also apply the correct initial scale.\n  mainWorkspace.translate(0, 0);\n\n  mainWorkspace.addChangeListener(\n    bumpObjects.bumpIntoBoundsHandler(mainWorkspace)\n  );\n\n  // The SVG is now fully assembled.\n  common.svgResize(mainWorkspace);\n  WidgetDiv.createDom();\n  dropDownDiv.createDom();\n  Tooltip.createDom();\n  return mainWorkspace;\n}\n\n/**\n * Initialize Blockly with various handlers.\n *\n * @param mainWorkspace Newly created main workspace.\n */\nfunction init(mainWorkspace: WorkspaceSvg) {\n  const options = mainWorkspace.options;\n  const svg = mainWorkspace.getParentSvg();\n\n  // Suppress the browser's context menu.\n  browserEvents.conditionalBind(\n    svg.parentNode as Element,\n    'contextmenu',\n    null,\n    function (e: Event) {\n      if (!browserEvents.isTargetInput(e)) {\n        e.preventDefault();\n      }\n    }\n  );\n\n  const workspaceResizeHandler = browserEvents.conditionalBind(\n    window,\n    'resize',\n    null,\n    function () {\n      // Don't hide all the chaff. Leave the dropdown and widget divs open if\n      // possible.\n      Tooltip.hide();\n      mainWorkspace.hideComponents(true);\n      dropDownDiv.repositionForWindowResize();\n      WidgetDiv.repositionForWindowResize();\n      common.svgResize(mainWorkspace);\n      bumpObjects.bumpTopObjectsIntoBounds(mainWorkspace);\n    }\n  );\n  mainWorkspace.setResizeHandlerWrapper(workspaceResizeHandler);\n\n  bindDocumentEvents();\n\n  if (options.languageTree) {\n    const toolbox = mainWorkspace.getToolbox();\n    const flyout = mainWorkspace.getFlyout(true);\n    if (toolbox) {\n      toolbox.init();\n    } else if (flyout) {\n      // Build a fixed flyout with the root blocks.\n      flyout.init(mainWorkspace);\n      flyout.show(options.languageTree);\n      if (typeof flyout.scrollToStart === 'function') {\n        flyout.scrollToStart();\n      }\n    }\n  }\n\n  if (options.hasTrashcan) {\n    mainWorkspace.trashcan!.init();\n  }\n  if (options.zoomOptions && options.zoomOptions.controls) {\n    mainWorkspace.zoomControls_!.init();\n  }\n\n  if (options.moveOptions && options.moveOptions.scrollbars) {\n    const horizontalScroll =\n      options.moveOptions.scrollbars === true ||\n      !!options.moveOptions.scrollbars.horizontal;\n    const verticalScroll =\n      options.moveOptions.scrollbars === true ||\n      !!options.moveOptions.scrollbars.vertical;\n    mainWorkspace.scrollbar = new ScrollbarPair(\n      mainWorkspace,\n      horizontalScroll,\n      verticalScroll,\n      'blocklyMainWorkspaceScrollbar'\n    );\n    mainWorkspace.scrollbar.resize();\n  } else {\n    mainWorkspace.setMetrics({x: 0.5, y: 0.5});\n  }\n\n  // Load the sounds.\n  if (options.hasSounds) {\n    loadSounds(options.pathToMedia, mainWorkspace);\n  }\n}\n\n/**\n * Handle a key-down on SVG drawing surface. Does nothing if the main workspace\n * is not visible.\n *\n * @param e Key down event.\n */\n// TODO (https://github.com/google/blockly/issues/1998) handle cases where there\n// are multiple workspaces and non-main workspaces are able to accept input.\nfunction onKeyDown(e: KeyboardEvent) {\n  const mainWorkspace = common.getMainWorkspace() as WorkspaceSvg;\n  if (!mainWorkspace) {\n    return;\n  }\n\n  if (\n    browserEvents.isTargetInput(e) ||\n    (mainWorkspace.rendered && !mainWorkspace.isVisible())\n  ) {\n    // When focused on an HTML text input widget, don't trap any keys.\n    // Ignore keypresses on rendered workspaces that have been explicitly\n    // hidden.\n    return;\n  }\n  ShortcutRegistry.registry.onKeyDown(mainWorkspace, e);\n}\n\n/**\n * Whether event handlers have been bound. Document event handlers will only\n * be bound once, even if Blockly is destroyed and reinjected.\n */\nlet documentEventsBound = false;\n\n/**\n * Bind document events, but only once.  Destroying and reinjecting Blockly\n * should not bind again.\n * Bind events for scrolling the workspace.\n * Most of these events should be bound to the SVG's surface.\n * However, 'mouseup' has to be on the whole document so that a block dragged\n * out of bounds and released will know that it has been released.\n * Also, 'keydown' has to be on the whole document since the browser doesn't\n * understand a concept of focus on the SVG image.\n */\nfunction bindDocumentEvents() {\n  if (!documentEventsBound) {\n    browserEvents.conditionalBind(document, 'scroll', null, function () {\n      const workspaces = common.getAllWorkspaces();\n      for (let i = 0, workspace; (workspace = workspaces[i]); i++) {\n        if (workspace instanceof WorkspaceSvg) {\n          workspace.updateInverseScreenCTM();\n        }\n      }\n    });\n    browserEvents.conditionalBind(document, 'keydown', null, onKeyDown);\n    // longStop needs to run to stop the context menu from showing up.  It\n    // should run regardless of what other touch event handlers have run.\n    browserEvents.bind(document, 'touchend', null, Touch.longStop);\n    browserEvents.bind(document, 'touchcancel', null, Touch.longStop);\n    // Some iPad versions don't fire resize after portrait to landscape change.\n    if (userAgent.IPAD) {\n      browserEvents.conditionalBind(\n        window,\n        'orientationchange',\n        document,\n        function () {\n          // TODO (#397): Fix for multiple Blockly workspaces.\n          common.svgResize(common.getMainWorkspace() as WorkspaceSvg);\n        }\n      );\n    }\n  }\n  documentEventsBound = true;\n}\n\n/**\n * Load sounds for the given workspace.\n *\n * @param pathToMedia The path to the media directory.\n * @param workspace The workspace to load sounds for.\n */\nfunction loadSounds(pathToMedia: string, workspace: WorkspaceSvg) {\n  const audioMgr = workspace.getAudioManager();\n  audioMgr.load(\n    [\n      pathToMedia + 'click.mp3',\n      pathToMedia + 'click.wav',\n      pathToMedia + 'click.ogg',\n    ],\n    'click'\n  );\n  audioMgr.load(\n    [\n      pathToMedia + 'disconnect.wav',\n      pathToMedia + 'disconnect.mp3',\n      pathToMedia + 'disconnect.ogg',\n    ],\n    'disconnect'\n  );\n  audioMgr.load(\n    [\n      pathToMedia + 'delete.mp3',\n      pathToMedia + 'delete.ogg',\n      pathToMedia + 'delete.wav',\n    ],\n    'delete'\n  );\n\n  // Bind temporary hooks that preload the sounds.\n  const soundBinds: browserEvents.Data[] = [];\n  /**\n   *\n   */\n  function unbindSounds() {\n    while (soundBinds.length) {\n      const oldSoundBinding = soundBinds.pop();\n      if (oldSoundBinding) {\n        browserEvents.unbind(oldSoundBinding);\n      }\n    }\n    audioMgr.preload();\n  }\n\n  // These are bound on mouse/touch events with\n  // Blockly.browserEvents.conditionalBind, so they restrict the touch\n  // identifier that will be recognized.  But this is really something that\n  // happens on a click, not a drag, so that's not necessary.\n\n  // Android ignores any sound not loaded as a result of a user action.\n  soundBinds.push(\n    browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      null,\n      unbindSounds,\n      true\n    )\n  );\n  soundBinds.push(\n    browserEvents.conditionalBind(\n      document,\n      'touchstart',\n      null,\n      unbindSounds,\n      true\n    )\n  );\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IParameterModel} from '../interfaces/i_parameter_model.js';\nimport {IProcedureModel} from '../interfaces/i_procedure_model.js';\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as priorities from './priorities.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Representation of a procedure data model.\n */\nexport interface State {\n  // TODO: This should also handle enabled.\n  id: string;\n  name: string;\n  returnTypes: string[] | null;\n  parameters?: ParameterState[];\n}\n\n/**\n * Representation of a parameter data model.\n */\nexport interface ParameterState {\n  id: string;\n  name: string;\n  types?: string[];\n}\n\n/**\n * A newable signature for an IProcedureModel.\n *\n * Refer to\n * https://www.typescriptlang.org/docs/handbook/2/generics.html#using-class-types-in-generics\n * for what is going on with this.\n */\ntype ProcedureModelConstructor<ProcedureModel extends IProcedureModel> = new (\n  workspace: Workspace,\n  name: string,\n  id: string\n) => ProcedureModel;\n\n/**\n * A newable signature for an IParameterModel.\n *\n * Refer to\n * https://www.typescriptlang.org/docs/handbook/2/generics.html#using-class-types-in-generics\n * for what is going on with this.\n */\ntype ParameterModelConstructor<ParameterModel extends IParameterModel> = new (\n  workspace: Workspace,\n  name: string,\n  id: string\n) => ParameterModel;\n\n/**\n * Serializes the given IProcedureModel to JSON.\n *\n * @internal\n */\nexport function saveProcedure(proc: IProcedureModel): State {\n  const state: State = {\n    id: proc.getId(),\n    name: proc.getName(),\n    returnTypes: proc.getReturnTypes(),\n  };\n  if (!proc.getParameters().length) return state;\n  state.parameters = proc.getParameters().map((param) => saveParameter(param));\n  return state;\n}\n\n/**\n * Serializes the given IParameterModel to JSON.\n *\n * @internal\n */\nexport function saveParameter(param: IParameterModel): ParameterState {\n  const state: ParameterState = {\n    id: param.getId(),\n    name: param.getName(),\n  };\n  if (!param.getTypes().length) return state;\n  state.types = param.getTypes();\n  return state;\n}\n\n/**\n * Deserializes the given procedure model State from JSON.\n *\n * @internal\n */\nexport function loadProcedure<\n  ProcedureModel extends IProcedureModel,\n  ParameterModel extends IParameterModel\n>(\n  procedureModelClass: ProcedureModelConstructor<ProcedureModel>,\n  parameterModelClass: ParameterModelConstructor<ParameterModel>,\n  state: State,\n  workspace: Workspace\n): ProcedureModel {\n  const proc = new procedureModelClass(\n    workspace,\n    state.name,\n    state.id\n  ).setReturnTypes(state.returnTypes);\n  if (!state.parameters) return proc;\n  for (const [index, param] of state.parameters.entries()) {\n    proc.insertParameter(\n      loadParameter(parameterModelClass, param, workspace),\n      index\n    );\n  }\n  return proc;\n}\n\n/**\n * Deserializes the given ParameterState from JSON.\n *\n * @internal\n */\nexport function loadParameter<ParameterModel extends IParameterModel>(\n  parameterModelClass: ParameterModelConstructor<ParameterModel>,\n  state: ParameterState,\n  workspace: Workspace\n): ParameterModel {\n  const model = new parameterModelClass(workspace, state.name, state.id);\n  if (state.types) model.setTypes(state.types);\n  return model;\n}\n\n/** Serializer for saving and loading procedure state. */\nexport class ProcedureSerializer<\n  ProcedureModel extends IProcedureModel,\n  ParameterModel extends IParameterModel\n> implements ISerializer\n{\n  public priority = priorities.PROCEDURES;\n\n  /**\n   * Constructs the procedure serializer.\n   *\n   * Example usage:\n   *   new ProcedureSerializer(MyProcedureModelClass, MyParameterModelClass)\n   *\n   * @param procedureModelClass The class (implementing IProcedureModel) that\n   *     you want this serializer to deserialize.\n   * @param parameterModelClass The class (implementing IParameterModel) that\n   *     you want this serializer to deserialize.\n   */\n  constructor(\n    private readonly procedureModelClass: ProcedureModelConstructor<ProcedureModel>,\n    private readonly parameterModelClass: ParameterModelConstructor<ParameterModel>\n  ) {}\n\n  /** Serializes the procedure models of the given workspace. */\n  save(workspace: Workspace): State[] | null {\n    const save = workspace\n      .getProcedureMap()\n      .getProcedures()\n      .map((proc) => saveProcedure(proc));\n    return save.length ? save : null;\n  }\n\n  /**\n   * Deserializes the procedures models defined by the given state into the\n   * workspace.\n   */\n  load(state: State[], workspace: Workspace) {\n    const map = workspace.getProcedureMap();\n    for (const procState of state) {\n      map.add(\n        loadProcedure(\n          this.procedureModelClass,\n          this.parameterModelClass,\n          procState,\n          workspace\n        )\n      );\n    }\n  }\n\n  /** Disposes of any procedure models that exist on the workspace. */\n  clear(workspace: Workspace) {\n    workspace.getProcedureMap().clear();\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization.workspaces');\n\nimport * as eventUtils from '../events/utils.js';\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport * as registry from '../registry.js';\nimport * as dom from '../utils/dom.js';\n// eslint-disable-next-line no-unused-vars\nimport type {Workspace} from '../workspace.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * Returns the state of the workspace as a plain JavaScript object.\n *\n * @param workspace The workspace to serialize.\n * @returns The serialized state of the workspace.\n */\nexport function save(workspace: Workspace): {\n  [key: string]: AnyDuringMigration;\n} {\n  const state = Object.create(null);\n  const serializerMap = registry.getAllItems(registry.Type.SERIALIZER, true);\n  for (const key in serializerMap) {\n    const save = (serializerMap[key] as ISerializer)?.save(workspace);\n    if (save) {\n      state[key] = save;\n    }\n  }\n  return state;\n}\n\n/**\n * Loads the variable represented by the given state into the given workspace.\n *\n * @param state The state of the workspace to deserialize into the workspace.\n * @param workspace The workspace to add the new state to.\n * @param param1 recordUndo: If true, events triggered by this function will be\n *     undo-able by the user. False by default.\n */\nexport function load(\n  state: {[key: string]: AnyDuringMigration},\n  workspace: Workspace,\n  {recordUndo = false}: {recordUndo?: boolean} = {}\n) {\n  const serializerMap = registry.getAllItems(registry.Type.SERIALIZER, true);\n  if (!serializerMap) {\n    return;\n  }\n\n  const deserializers = Object.entries(serializerMap).sort(\n    (a, b) => (b[1] as ISerializer)!.priority - (a[1] as ISerializer)!.priority\n  );\n\n  const prevRecordUndo = eventUtils.getRecordUndo();\n  eventUtils.setRecordUndo(recordUndo);\n  const existingGroup = eventUtils.getGroup();\n  if (!existingGroup) {\n    eventUtils.setGroup(true);\n  }\n\n  dom.startTextWidthCache();\n  if (workspace instanceof WorkspaceSvg) {\n    workspace.setResizesEnabled(false);\n  }\n\n  // We want to trigger clearing in reverse priority order so plugins don't end\n  // up missing dependencies.\n  for (const [, deserializer] of deserializers.reverse()) {\n    (deserializer as ISerializer)?.clear(workspace);\n  }\n\n  // reverse() is destructive, so we have to re-reverse to correct the order.\n  for (let [name, deserializer] of deserializers.reverse()) {\n    name = name;\n    const pluginState = state[name];\n    if (pluginState) {\n      (deserializer as ISerializer)?.load(state[name], workspace);\n    }\n  }\n\n  if (workspace instanceof WorkspaceSvg) {\n    workspace.setResizesEnabled(true);\n  }\n  dom.stopTextWidthCache();\n\n  eventUtils.fire(new (eventUtils.get(eventUtils.FINISHED_LOADING))(workspace));\n\n  eventUtils.setGroup(existingGroup);\n  eventUtils.setRecordUndo(prevRecordUndo);\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ShortcutItems');\n\nimport {BlockSvg} from './block_svg.js';\nimport * as clipboard from './clipboard.js';\nimport * as common from './common.js';\nimport {Gesture} from './gesture.js';\nimport type {ICopyable} from './interfaces/i_copyable.js';\nimport {KeyboardShortcut, ShortcutRegistry} from './shortcut_registry.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Object holding the names of the default shortcut items.\n */\nexport enum names {\n  ESCAPE = 'escape',\n  DELETE = 'delete',\n  COPY = 'copy',\n  CUT = 'cut',\n  PASTE = 'paste',\n  UNDO = 'undo',\n  REDO = 'redo',\n}\n\n/**\n * Keyboard shortcut to hide chaff on escape.\n */\nexport function registerEscape() {\n  const escapeAction: KeyboardShortcut = {\n    name: names.ESCAPE,\n    preconditionFn(workspace) {\n      return !workspace.options.readOnly;\n    },\n    callback(workspace) {\n      // AnyDuringMigration because:  Property 'hideChaff' does not exist on\n      // type 'Workspace'.\n      (workspace as AnyDuringMigration).hideChaff();\n      return true;\n    },\n    keyCodes: [KeyCodes.ESC],\n  };\n  ShortcutRegistry.registry.register(escapeAction);\n}\n\n/**\n * Keyboard shortcut to delete a block on delete or backspace\n */\nexport function registerDelete() {\n  const deleteShortcut: KeyboardShortcut = {\n    name: names.DELETE,\n    preconditionFn(workspace) {\n      const selected = common.getSelected();\n      return (\n        !workspace.options.readOnly &&\n        selected != null &&\n        selected.isDeletable()\n      );\n    },\n    callback(workspace, e) {\n      // Delete or backspace.\n      // Stop the browser from going back to the previous page.\n      // Do this first to prevent an error in the delete code from resulting in\n      // data loss.\n      e.preventDefault();\n      // Don't delete while dragging.  Jeez.\n      if (Gesture.inProgress()) {\n        return false;\n      }\n      (common.getSelected() as BlockSvg).checkAndDelete();\n      return true;\n    },\n    keyCodes: [KeyCodes.DELETE, KeyCodes.BACKSPACE],\n  };\n  ShortcutRegistry.registry.register(deleteShortcut);\n}\n\n/**\n * Keyboard shortcut to copy a block on ctrl+c, cmd+c, or alt+c.\n */\nexport function registerCopy() {\n  const ctrlC = ShortcutRegistry.registry.createSerializedKey(KeyCodes.C, [\n    KeyCodes.CTRL,\n  ]);\n  const altC = ShortcutRegistry.registry.createSerializedKey(KeyCodes.C, [\n    KeyCodes.ALT,\n  ]);\n  const metaC = ShortcutRegistry.registry.createSerializedKey(KeyCodes.C, [\n    KeyCodes.META,\n  ]);\n\n  const copyShortcut: KeyboardShortcut = {\n    name: names.COPY,\n    preconditionFn(workspace) {\n      const selected = common.getSelected();\n      return (\n        !workspace.options.readOnly &&\n        !Gesture.inProgress() &&\n        selected != null &&\n        selected.isDeletable() &&\n        selected.isMovable()\n      );\n    },\n    callback(workspace, e) {\n      // Prevent the default copy behavior, which may beep or otherwise indicate\n      // an error due to the lack of a selection.\n      e.preventDefault();\n      // AnyDuringMigration because:  Property 'hideChaff' does not exist on\n      // type 'Workspace'.\n      (workspace as AnyDuringMigration).hideChaff();\n      clipboard.copy(common.getSelected() as ICopyable);\n      return true;\n    },\n    keyCodes: [ctrlC, altC, metaC],\n  };\n  ShortcutRegistry.registry.register(copyShortcut);\n}\n\n/**\n * Keyboard shortcut to copy and delete a block on ctrl+x, cmd+x, or alt+x.\n */\nexport function registerCut() {\n  const ctrlX = ShortcutRegistry.registry.createSerializedKey(KeyCodes.X, [\n    KeyCodes.CTRL,\n  ]);\n  const altX = ShortcutRegistry.registry.createSerializedKey(KeyCodes.X, [\n    KeyCodes.ALT,\n  ]);\n  const metaX = ShortcutRegistry.registry.createSerializedKey(KeyCodes.X, [\n    KeyCodes.META,\n  ]);\n\n  const cutShortcut: KeyboardShortcut = {\n    name: names.CUT,\n    preconditionFn(workspace) {\n      const selected = common.getSelected();\n      return (\n        !workspace.options.readOnly &&\n        !Gesture.inProgress() &&\n        selected != null &&\n        selected instanceof BlockSvg &&\n        selected.isDeletable() &&\n        selected.isMovable() &&\n        !selected.workspace!.isFlyout\n      );\n    },\n    callback() {\n      const selected = common.getSelected();\n      if (!selected) {\n        // Shouldn't happen but appeases the type system\n        return false;\n      }\n      clipboard.copy(selected);\n      (selected as BlockSvg).checkAndDelete();\n      return true;\n    },\n    keyCodes: [ctrlX, altX, metaX],\n  };\n\n  ShortcutRegistry.registry.register(cutShortcut);\n}\n\n/**\n * Keyboard shortcut to paste a block on ctrl+v, cmd+v, or alt+v.\n */\nexport function registerPaste() {\n  const ctrlV = ShortcutRegistry.registry.createSerializedKey(KeyCodes.V, [\n    KeyCodes.CTRL,\n  ]);\n  const altV = ShortcutRegistry.registry.createSerializedKey(KeyCodes.V, [\n    KeyCodes.ALT,\n  ]);\n  const metaV = ShortcutRegistry.registry.createSerializedKey(KeyCodes.V, [\n    KeyCodes.META,\n  ]);\n\n  const pasteShortcut: KeyboardShortcut = {\n    name: names.PASTE,\n    preconditionFn(workspace) {\n      return !workspace.options.readOnly && !Gesture.inProgress();\n    },\n    callback() {\n      return !!clipboard.paste();\n    },\n    keyCodes: [ctrlV, altV, metaV],\n  };\n\n  ShortcutRegistry.registry.register(pasteShortcut);\n}\n\n/**\n * Keyboard shortcut to undo the previous action on ctrl+z, cmd+z, or alt+z.\n */\nexport function registerUndo() {\n  const ctrlZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.CTRL,\n  ]);\n  const altZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.ALT,\n  ]);\n  const metaZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.META,\n  ]);\n\n  const undoShortcut: KeyboardShortcut = {\n    name: names.UNDO,\n    preconditionFn(workspace) {\n      return !workspace.options.readOnly && !Gesture.inProgress();\n    },\n    callback(workspace) {\n      // 'z' for undo 'Z' is for redo.\n      (workspace as WorkspaceSvg).hideChaff();\n      workspace.undo(false);\n      return true;\n    },\n    keyCodes: [ctrlZ, altZ, metaZ],\n  };\n  ShortcutRegistry.registry.register(undoShortcut);\n}\n\n/**\n * Keyboard shortcut to redo the previous action on ctrl+shift+z, cmd+shift+z,\n * or alt+shift+z.\n */\nexport function registerRedo() {\n  const ctrlShiftZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.SHIFT,\n    KeyCodes.CTRL,\n  ]);\n  const altShiftZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.SHIFT,\n    KeyCodes.ALT,\n  ]);\n  const metaShiftZ = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Z, [\n    KeyCodes.SHIFT,\n    KeyCodes.META,\n  ]);\n  // Ctrl-y is redo in Windows.  Command-y is never valid on Macs.\n  const ctrlY = ShortcutRegistry.registry.createSerializedKey(KeyCodes.Y, [\n    KeyCodes.CTRL,\n  ]);\n\n  const redoShortcut: KeyboardShortcut = {\n    name: names.REDO,\n    preconditionFn(workspace) {\n      return !Gesture.inProgress() && !workspace.options.readOnly;\n    },\n    callback(workspace) {\n      // 'z' for undo 'Z' is for redo.\n      (workspace as WorkspaceSvg).hideChaff();\n      workspace.undo(true);\n      return true;\n    },\n    keyCodes: [ctrlShiftZ, altShiftZ, metaShiftZ, ctrlY],\n  };\n  ShortcutRegistry.registry.register(redoShortcut);\n}\n\n/**\n * Registers all default keyboard shortcut item. This should be called once per\n * instance of KeyboardShortcutRegistry.\n *\n * @internal\n */\nexport function registerDefaultShortcuts() {\n  registerEscape();\n  registerDelete();\n  registerCopy();\n  registerCut();\n  registerPaste();\n  registerUndo();\n  registerRedo();\n}\n\nregisterDefaultShortcuts();\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\nimport type {FlyoutItemInfoArray} from '../utils/toolbox';\ngoog.declareModuleId('Blockly.ISelectableToolboxItem');\n\nimport type {IToolboxItem} from './i_toolbox_item.js';\n\n/**\n * Interface for an item in the toolbox that can be selected.\n */\nexport interface ISelectableToolboxItem extends IToolboxItem {\n  /**\n   * Gets the name of the toolbox item. Used for emitting events.\n   *\n   * @returns The name of the toolbox item.\n   */\n  getName(): string;\n\n  /**\n   * Gets the contents of the toolbox item. These are items that are meant to be\n   * displayed in the flyout.\n   *\n   * @returns The definition of items to be displayed in the flyout.\n   */\n  getContents(): FlyoutItemInfoArray | string;\n\n  /**\n   * Sets the current toolbox item as selected.\n   *\n   * @param _isSelected True if this category is selected, false otherwise.\n   */\n  setSelected(_isSelected: boolean): void;\n\n  /**\n   * Gets the HTML element that is clickable.\n   * The parent toolbox element receives clicks. The parent toolbox will add an\n   * ID to this element so it can pass the onClick event to the correct\n   * toolboxItem.\n   *\n   * @returns The HTML element that receives clicks.\n   */\n  getClickTarget(): Element;\n\n  /**\n   * Handles when the toolbox item is clicked.\n   *\n   * @param _e Click event to handle.\n   */\n  onClick(_e: Event): void;\n}\n\n/**\n * Type guard that checks whether an IToolboxItem is an ISelectableToolboxItem.\n */\nexport function isSelectableToolboxItem(\n  toolboxItem: IToolboxItem\n): toolboxItem is ISelectableToolboxItem {\n  return toolboxItem.isSelectable();\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_create.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/workspace_events.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_ui_base.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_create.js';\n\nimport {Block} from './block.js';\nimport * as blockAnimations from './block_animations.js';\nimport {BlockDragger} from './block_dragger.js';\nimport {BlockSvg} from './block_svg.js';\nimport {BlocklyOptions} from './blockly_options.js';\nimport {Blocks} from './blocks.js';\nimport * as browserEvents from './browser_events.js';\nimport {Bubble} from './bubble_old.js';\nimport {BubbleDragger} from './bubble_dragger.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as clipboard from './clipboard.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {config} from './config.js';\nimport {Connection} from './connection.js';\nimport {ConnectionChecker} from './connection_checker.js';\nimport {ConnectionDB} from './connection_db.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as ContextMenu from './contextmenu.js';\nimport * as ContextMenuItems from './contextmenu_items.js';\nimport {ContextMenuRegistry} from './contextmenu_registry.js';\nimport * as Css from './css.js';\nimport {DeleteArea} from './delete_area.js';\nimport * as dialog from './dialog.js';\nimport {DragTarget} from './drag_target.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as Events from './events/events.js';\nimport * as Extensions from './extensions.js';\nimport {\n  Field,\n  FieldConfig,\n  FieldValidator,\n  UnattachedFieldError,\n} from './field.js';\nimport {\n  FieldAngle,\n  FieldAngleConfig,\n  FieldAngleFromJsonConfig,\n  FieldAngleValidator,\n} from './field_angle.js';\nimport {\n  FieldCheckbox,\n  FieldCheckboxConfig,\n  FieldCheckboxFromJsonConfig,\n  FieldCheckboxValidator,\n} from './field_checkbox.js';\nimport {\n  FieldColour,\n  FieldColourConfig,\n  FieldColourFromJsonConfig,\n  FieldColourValidator,\n} from './field_colour.js';\nimport {\n  FieldDropdown,\n  FieldDropdownConfig,\n  FieldDropdownFromJsonConfig,\n  FieldDropdownValidator,\n  MenuGenerator,\n  MenuGeneratorFunction,\n  MenuOption,\n} from './field_dropdown.js';\nimport {\n  FieldImage,\n  FieldImageConfig,\n  FieldImageFromJsonConfig,\n} from './field_image.js';\nimport {\n  FieldLabel,\n  FieldLabelConfig,\n  FieldLabelFromJsonConfig,\n} from './field_label.js';\nimport {FieldLabelSerializable} from './field_label_serializable.js';\nimport {\n  FieldMultilineInput,\n  FieldMultilineInputConfig,\n  FieldMultilineInputFromJsonConfig,\n  FieldMultilineInputValidator,\n} from './field_multilineinput.js';\nimport {\n  FieldNumber,\n  FieldNumberConfig,\n  FieldNumberFromJsonConfig,\n  FieldNumberValidator,\n} from './field_number.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {\n  FieldTextInput,\n  FieldTextInputConfig,\n  FieldTextInputFromJsonConfig,\n  FieldTextInputValidator,\n} from './field_textinput.js';\nimport {\n  FieldVariable,\n  FieldVariableConfig,\n  FieldVariableFromJsonConfig,\n  FieldVariableValidator,\n} from './field_variable.js';\nimport {Flyout} from './flyout_base.js';\nimport {FlyoutButton} from './flyout_button.js';\nimport {HorizontalFlyout} from './flyout_horizontal.js';\nimport {FlyoutMetricsManager} from './flyout_metrics_manager.js';\nimport {VerticalFlyout} from './flyout_vertical.js';\nimport {CodeGenerator} from './generator.js';\nimport {Gesture} from './gesture.js';\nimport {Grid} from './grid.js';\nimport {Icon} from './icons/icon.js';\nimport * as icons from './icons.js';\nimport {inject} from './inject.js';\nimport {Align, Input} from './inputs/input.js';\nimport {inputTypes} from './inputs/input_types.js';\nimport {DummyInput} from './inputs/dummy_input.js';\nimport {StatementInput} from './inputs/statement_input.js';\nimport {ValueInput} from './inputs/value_input.js';\nimport {InsertionMarkerManager} from './insertion_marker_manager.js';\nimport {IASTNodeLocation} from './interfaces/i_ast_node_location.js';\nimport {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport {IASTNodeLocationWithBlock} from './interfaces/i_ast_node_location_with_block.js';\nimport {IAutoHideable} from './interfaces/i_autohideable.js';\nimport {IBlockDragger} from './interfaces/i_block_dragger.js';\nimport {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport {IBubble} from './interfaces/i_bubble.js';\nimport {ICollapsibleToolboxItem} from './interfaces/i_collapsible_toolbox_item.js';\nimport {IComponent} from './interfaces/i_component.js';\nimport {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport {IContextMenu} from './interfaces/i_contextmenu.js';\nimport {ICopyable} from './interfaces/i_copyable.js';\nimport {IDeletable} from './interfaces/i_deletable.js';\nimport {IDeleteArea} from './interfaces/i_delete_area.js';\nimport {IDragTarget} from './interfaces/i_drag_target.js';\nimport {IDraggable} from './interfaces/i_draggable.js';\nimport {IFlyout} from './interfaces/i_flyout.js';\nimport {IKeyboardAccessible} from './interfaces/i_keyboard_accessible.js';\nimport {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport {IMovable} from './interfaces/i_movable.js';\nimport {IObservable, isObservable} from './interfaces/i_observable.js';\nimport {IPositionable} from './interfaces/i_positionable.js';\nimport {IRegistrable} from './interfaces/i_registrable.js';\nimport {ISelectable} from './interfaces/i_selectable.js';\nimport {ISelectableToolboxItem} from './interfaces/i_selectable_toolbox_item.js';\nimport {IStyleable} from './interfaces/i_styleable.js';\nimport {IToolbox} from './interfaces/i_toolbox.js';\nimport {IToolboxItem} from './interfaces/i_toolbox_item.js';\nimport {\n  IVariableBackedParameterModel,\n  isVariableBackedParameterModel,\n} from './interfaces/i_variable_backed_parameter_model.js';\nimport * as internalConstants from './internal_constants.js';\nimport {ASTNode} from './keyboard_nav/ast_node.js';\nimport {BasicCursor} from './keyboard_nav/basic_cursor.js';\nimport {Cursor} from './keyboard_nav/cursor.js';\nimport {Marker} from './keyboard_nav/marker.js';\nimport {TabNavigateCursor} from './keyboard_nav/tab_navigate_cursor.js';\nimport {MarkerManager} from './marker_manager.js';\nimport {Menu} from './menu.js';\nimport {MenuItem} from './menuitem.js';\nimport {MetricsManager} from './metrics_manager.js';\nimport {Msg, setLocale} from './msg.js';\nimport {MiniWorkspaceBubble} from './bubbles/mini_workspace_bubble.js';\nimport {Names} from './names.js';\nimport {Options} from './options.js';\nimport * as uiPosition from './positionable_helpers.js';\nimport * as Procedures from './procedures.js';\nimport * as registry from './registry.js';\nimport {RenderedConnection} from './rendered_connection.js';\nimport * as renderManagement from './render_management.js';\nimport * as blockRendering from './renderers/common/block_rendering.js';\nimport * as constants from './constants.js';\nimport * as geras from './renderers/geras/geras.js';\nimport * as minimalist from './renderers/minimalist/minimalist.js';\nimport * as thrasos from './renderers/thrasos/thrasos.js';\nimport * as zelos from './renderers/zelos/zelos.js';\nimport {Scrollbar} from './scrollbar.js';\nimport {ScrollbarPair} from './scrollbar_pair.js';\nimport * as serialization from './serialization.js';\nimport * as ShortcutItems from './shortcut_items.js';\nimport {ShortcutRegistry} from './shortcut_registry.js';\nimport {Theme} from './theme.js';\nimport * as Themes from './theme/themes.js';\nimport {ThemeManager} from './theme_manager.js';\nimport {ToolboxCategory} from './toolbox/category.js';\nimport {CollapsibleToolboxCategory} from './toolbox/collapsible_category.js';\nimport {ToolboxSeparator} from './toolbox/separator.js';\nimport {Toolbox} from './toolbox/toolbox.js';\nimport {ToolboxItem} from './toolbox/toolbox_item.js';\nimport * as Tooltip from './tooltip.js';\nimport * as Touch from './touch.js';\nimport {Trashcan} from './trashcan.js';\nimport * as utils from './utils.js';\nimport * as toolbox from './utils/toolbox.js';\nimport {VariableMap} from './variable_map.js';\nimport {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport * as VariablesDynamic from './variables_dynamic.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport {Workspace} from './workspace.js';\nimport {WorkspaceAudio} from './workspace_audio.js';\nimport {WorkspaceComment} from './workspace_comment.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport {WorkspaceDragger} from './workspace_dragger.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as Xml from './xml.js';\nimport {ZoomControls} from './zoom_controls.js';\n\n/**\n * Blockly core version.\n * This constant is overridden by the build script (npm run build) to the value\n * of the version in package.json. This is done by the Closure Compiler in the\n * buildCompressed gulp task.\n * For local builds, you can pass --define='Blockly.VERSION=X.Y.Z' to the\n * compiler to override this constant.\n *\n * @define {string}\n */\nexport const VERSION = 'uncompiled';\n\n/*\n * Top-level functions and properties on the Blockly namespace.\n * These are used only in external code. Do not reference these\n * from internal code as importing from this file can cause circular\n * dependencies. Do not add new functions here. There is probably a better\n * namespace to put new functions on.\n */\n\n/*\n * Aliases for input alignments used in block defintions.\n */\n\n/**\n * @see Blockly.Input.Align.LEFT\n */\nexport const ALIGN_LEFT = Align.LEFT;\n\n/**\n * @see Blockly.Input.Align.CENTRE\n */\nexport const ALIGN_CENTRE = Align.CENTRE;\n\n/**\n * @see Blockly.Input.Align.RIGHT\n */\nexport const ALIGN_RIGHT = Align.RIGHT;\n/*\n * Aliases for constants used for connection and input types.\n */\n\n/**\n * @see ConnectionType.INPUT_VALUE\n */\nexport const INPUT_VALUE = ConnectionType.INPUT_VALUE;\n\n/**\n * @see ConnectionType.OUTPUT_VALUE\n */\nexport const OUTPUT_VALUE = ConnectionType.OUTPUT_VALUE;\n\n/**\n * @see ConnectionType.NEXT_STATEMENT\n */\nexport const NEXT_STATEMENT = ConnectionType.NEXT_STATEMENT;\n\n/**\n * @see ConnectionType.PREVIOUS_STATEMENT\n */\nexport const PREVIOUS_STATEMENT = ConnectionType.PREVIOUS_STATEMENT;\n\n/**\n * @see inputTypes.DUMMY_INPUT\n */\nexport const DUMMY_INPUT = inputTypes.DUMMY;\n\n/** Aliases for toolbox positions. */\n\n/**\n * @see toolbox.Position.TOP\n */\nexport const TOOLBOX_AT_TOP = toolbox.Position.TOP;\n\n/**\n * @see toolbox.Position.BOTTOM\n */\nexport const TOOLBOX_AT_BOTTOM = toolbox.Position.BOTTOM;\n\n/**\n * @see toolbox.Position.LEFT\n */\nexport const TOOLBOX_AT_LEFT = toolbox.Position.LEFT;\n\n/**\n * @see toolbox.Position.RIGHT\n */\nexport const TOOLBOX_AT_RIGHT = toolbox.Position.RIGHT;\n\n/*\n * Other aliased functions.\n */\n\n/**\n * Size the SVG image to completely fill its container. Call this when the view\n * actually changes sizes (e.g. on a window resize/device orientation change).\n * See workspace.resizeContents to resize the workspace when the contents\n * change (e.g. when a block is added or removed).\n * Record the height/width of the SVG image.\n *\n * @param workspace Any workspace in the SVG.\n * @see Blockly.common.svgResize\n */\nexport const svgResize = common.svgResize;\n\n/**\n * Close tooltips, context menus, dropdown selections, etc.\n *\n * @param opt_onlyClosePopups Whether only popups should be closed.\n * @see Blockly.WorkspaceSvg.hideChaff\n */\nexport function hideChaff(opt_onlyClosePopups?: boolean) {\n  (common.getMainWorkspace() as WorkspaceSvg).hideChaff(opt_onlyClosePopups);\n}\n\n/**\n * Returns the main workspace.  Returns the last used main workspace (based on\n * focus).  Try not to use this function, particularly if there are multiple\n * Blockly instances on a page.\n *\n * @see Blockly.common.getMainWorkspace\n */\nexport const getMainWorkspace = common.getMainWorkspace;\n\n/**\n * Returns the currently selected copyable object.\n */\nexport const getSelected = common.getSelected;\n\n/**\n * Define blocks from an array of JSON block definitions, as might be generated\n * by the Blockly Developer Tools.\n *\n * @param jsonArray An array of JSON block definitions.\n * @see Blockly.common.defineBlocksWithJsonArray\n */\nexport const defineBlocksWithJsonArray = common.defineBlocksWithJsonArray;\n\n/**\n * Set the parent container.  This is the container element that the WidgetDiv,\n * dropDownDiv, and Tooltip are rendered into the first time `Blockly.inject`\n * is called.\n * This method is a NOP if called after the first `Blockly.inject`.\n *\n * @param container The container element.\n * @see Blockly.common.setParentContainer\n */\nexport const setParentContainer = common.setParentContainer;\n\n// Aliases to allow external code to access these values for legacy reasons.\nexport const COLLAPSE_CHARS = internalConstants.COLLAPSE_CHARS;\nexport const DRAG_STACK = internalConstants.DRAG_STACK;\nexport const OPPOSITE_TYPE = internalConstants.OPPOSITE_TYPE;\nexport const RENAME_VARIABLE_ID = internalConstants.RENAME_VARIABLE_ID;\nexport const DELETE_VARIABLE_ID = internalConstants.DELETE_VARIABLE_ID;\nexport const COLLAPSED_INPUT_NAME = constants.COLLAPSED_INPUT_NAME;\nexport const COLLAPSED_FIELD_NAME = constants.COLLAPSED_FIELD_NAME;\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n */\nexport const VARIABLE_CATEGORY_NAME: string = Variables.CATEGORY_NAME;\n\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * variable blocks.\n */\nexport const VARIABLE_DYNAMIC_CATEGORY_NAME: string =\n  VariablesDynamic.CATEGORY_NAME;\n/**\n * String for use in the \"custom\" attribute of a category in toolbox XML.\n * This string indicates that the category should be dynamically populated with\n * procedure blocks.\n */\nexport const PROCEDURE_CATEGORY_NAME: string = Procedures.CATEGORY_NAME;\n\n// Context for why we need to monkey-patch in these functions (internal):\n//   https://docs.google.com/document/d/1MbO0LEA-pAyx1ErGLJnyUqTLrcYTo-5zga9qplnxeXo/edit?usp=sharing&resourcekey=0-5h_32-i-dHwHjf_9KYEVKg\n\n// clang-format off\nWorkspace.prototype.newBlock = function (\n  prototypeName: string,\n  opt_id?: string\n): Block {\n  return new Block(this, prototypeName, opt_id);\n};\n\nWorkspaceSvg.prototype.newBlock = function (\n  prototypeName: string,\n  opt_id?: string\n): BlockSvg {\n  return new BlockSvg(this, prototypeName, opt_id);\n};\n\nWorkspaceSvg.newTrashcan = function (workspace: WorkspaceSvg): Trashcan {\n  return new Trashcan(workspace);\n};\n\nWorkspaceCommentSvg.prototype.showContextMenu = function (\n  this: WorkspaceCommentSvg,\n  e: Event\n) {\n  if (this.workspace.options.readOnly) {\n    return;\n  }\n  const menuOptions = [];\n\n  if (this.isDeletable() && this.isMovable()) {\n    menuOptions.push(ContextMenu.commentDuplicateOption(this));\n    menuOptions.push(ContextMenu.commentDeleteOption(this));\n  }\n\n  ContextMenu.show(e, menuOptions, this.RTL);\n};\n\nMiniWorkspaceBubble.prototype.newWorkspaceSvg = function (\n  options: Options\n): WorkspaceSvg {\n  return new WorkspaceSvg(options);\n};\n\nNames.prototype.populateProcedures = function (\n  this: Names,\n  workspace: Workspace\n) {\n  const procedures = Procedures.allProcedures(workspace);\n  // Flatten the return vs no-return procedure lists.\n  const flattenedProcedures = procedures[0].concat(procedures[1]);\n  for (let i = 0; i < flattenedProcedures.length; i++) {\n    this.getName(flattenedProcedures[i][0], Names.NameType.PROCEDURE);\n  }\n};\n// clang-format on\n\n// Re-export submodules that no longer declareLegacyNamespace.\nexport {browserEvents};\nexport {ContextMenu};\nexport {ContextMenuItems};\nexport {Css};\nexport {Events};\nexport {Extensions};\nexport {Procedures};\nexport {Procedures as procedures};\nexport {ShortcutItems};\nexport {Themes};\nexport {Tooltip};\nexport {Touch};\nexport {Variables};\nexport {VariablesDynamic};\nexport {WidgetDiv};\nexport {Xml};\nexport {blockAnimations};\nexport {blockRendering};\nexport {bumpObjects};\nexport {clipboard};\nexport {common};\nexport {constants};\nexport {dialog};\nexport {fieldRegistry};\nexport {geras};\nexport {minimalist};\nexport {registry};\nexport {thrasos};\nexport {uiPosition};\nexport {utils};\nexport {zelos};\nexport {ASTNode};\nexport {BasicCursor};\nexport {Block};\nexport {BlocklyOptions};\nexport {BlockDragger};\nexport {BlockSvg};\nexport {Blocks};\nexport {Bubble};\nexport {BubbleDragger};\nexport {CollapsibleToolboxCategory};\nexport {ComponentManager};\nexport {Connection};\nexport {ConnectionType};\nexport {ConnectionChecker};\nexport {ConnectionDB};\nexport {ContextMenuRegistry};\nexport {Cursor};\nexport {DeleteArea};\nexport {DragTarget};\nexport const DropDownDiv = dropDownDiv;\nexport {Field, FieldConfig, FieldValidator, UnattachedFieldError};\nexport {\n  FieldAngle,\n  FieldAngleConfig,\n  FieldAngleFromJsonConfig,\n  FieldAngleValidator,\n};\nexport {\n  FieldCheckbox,\n  FieldCheckboxConfig,\n  FieldCheckboxFromJsonConfig,\n  FieldCheckboxValidator,\n};\nexport {\n  FieldColour,\n  FieldColourConfig,\n  FieldColourFromJsonConfig,\n  FieldColourValidator,\n};\nexport {\n  FieldDropdown,\n  FieldDropdownConfig,\n  FieldDropdownFromJsonConfig,\n  FieldDropdownValidator,\n  MenuGenerator,\n  MenuGeneratorFunction,\n  MenuOption,\n};\nexport {FieldImage, FieldImageConfig, FieldImageFromJsonConfig};\nexport {FieldLabel, FieldLabelConfig, FieldLabelFromJsonConfig};\nexport {FieldLabelSerializable};\nexport {\n  FieldMultilineInput,\n  FieldMultilineInputConfig,\n  FieldMultilineInputFromJsonConfig,\n  FieldMultilineInputValidator,\n};\nexport {\n  FieldNumber,\n  FieldNumberConfig,\n  FieldNumberFromJsonConfig,\n  FieldNumberValidator,\n};\nexport {\n  FieldTextInput,\n  FieldTextInputConfig,\n  FieldTextInputFromJsonConfig,\n  FieldTextInputValidator,\n};\nexport {\n  FieldVariable,\n  FieldVariableConfig,\n  FieldVariableFromJsonConfig,\n  FieldVariableValidator,\n};\nexport {Flyout};\nexport {FlyoutButton};\nexport {FlyoutMetricsManager};\nexport {CodeGenerator};\nexport {CodeGenerator as Generator}; // Deprecated name, October 2022.\nexport {Gesture};\nexport {Grid};\nexport {HorizontalFlyout};\nexport {IASTNodeLocation};\nexport {IASTNodeLocationSvg};\nexport {IASTNodeLocationWithBlock};\nexport {IAutoHideable};\nexport {IBlockDragger};\nexport {IBoundedElement};\nexport {IBubble};\nexport {ICollapsibleToolboxItem};\nexport {IComponent};\nexport {IConnectionChecker};\nexport {IContextMenu};\nexport {Icon};\nexport {icons};\nexport {ICopyable};\nexport {IDeletable};\nexport {IDeleteArea};\nexport {IDragTarget};\nexport {IDraggable};\nexport {IFlyout};\nexport {IKeyboardAccessible};\nexport {IMetricsManager};\nexport {IMovable};\nexport {Input};\nexport const inputs = {\n  Input,\n  inputTypes,\n  DummyInput,\n  StatementInput,\n  ValueInput,\n};\nexport {InsertionMarkerManager};\nexport {IObservable, isObservable};\nexport {IPositionable};\nexport {IRegistrable};\nexport {ISelectable};\nexport {ISelectableToolboxItem};\nexport {IStyleable};\nexport {IToolbox};\nexport {IToolboxItem};\nexport {IVariableBackedParameterModel, isVariableBackedParameterModel};\nexport {Marker};\nexport {MarkerManager};\nexport {Menu};\nexport {MenuItem};\nexport {MetricsManager};\nexport {Msg, setLocale};\nexport {Names};\nexport {Options};\nexport {RenderedConnection};\nexport {renderManagement};\nexport {Scrollbar};\nexport {ScrollbarPair};\nexport {ShortcutRegistry};\nexport {TabNavigateCursor};\nexport {Theme};\nexport {ThemeManager};\nexport {Toolbox};\nexport {ToolboxCategory};\nexport {ToolboxItem};\nexport {ToolboxSeparator};\nexport {Trashcan};\nexport {VariableMap};\nexport {VariableModel};\nexport {VerticalFlyout};\nexport {Workspace};\nexport {WorkspaceAudio};\nexport {WorkspaceComment};\nexport {WorkspaceCommentSvg};\nexport {WorkspaceDragger};\nexport {WorkspaceSvg};\nexport {ZoomControls};\nexport {config};\n/** @deprecated Use Blockly.ConnectionType instead. */\nexport const connectionTypes = ConnectionType;\nexport {inject};\nexport {inputTypes};\nexport {serialization};\n",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"/**\n * @license\n * Copyright The Closure Library Authors.\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview A minimal implementation of base.js.\n *\n * This file is used in place of base.js (Closure library bootstrap\n * code) when building Blockly using the Closure Compiler.  Refer to\n * base.js for more information about items defined here.\n *\n * @provideGoog\n */\n\n/** @define {boolean} Overridden to true by the compiler. */\nvar COMPILED = false;\n\n/** @const */\nvar goog = goog || {};\n\n/**\n * Reference to the global object.  This is provided as 'root' by the\n * UMD wrapper, but prefer globalThis if it is defined.\n *\n * https://www.ecma-international.org/ecma-262/9.0/index.html#sec-global-object\n *\n * @const\n * @type {!Global}\n * @suppress {undefinedVars}\n */\ngoog.global = globalThis || root;\n\n/** @type {Object<string, (string|number|boolean)>|undefined} */\ngoog.global.CLOSURE_DEFINES;\n\n/**\n * Defines a named value.\n * When compiled the default can be overridden using the compiler options or the\n * value set in the CLOSURE_DEFINES object. Returns the defined value so that it\n * can be used safely in modules. Note that the value type MUST be either\n * boolean, number, or string.\n *\n * @param {string} name\n * @param {T} defaultValue\n * @return {T}\n * @template T\n */\ngoog.define = function(name, defaultValue) {\n  return defaultValue;\n};\n\n/** @define {boolean} */\ngoog.DEBUG = goog.define('goog.DEBUG', false);\n\n/** @define {boolean} */\ngoog.DISALLOW_TEST_ONLY_CODE =\n    goog.define('goog.DISALLOW_TEST_ONLY_CODE', COMPILED && !goog.DEBUG);\n\n/**\n * @param {string} name\n */\ngoog.provide = function(name) {};\n\n/**\n * @param {string} name\n * @return {void}\n */\ngoog.module = function(name) {};\n\n/**\n * @param {string} name\n * @return {?}\n * @suppress {missingProvide}\n */\ngoog.module.get = function(name) {};\n\n/** @suppress {missingProvide} */\ngoog.module.declareLegacyNamespace = function() {};\n\n/**\n * Marks that the current file should only be used for testing, and never for\n * live code in production.\n *\n * In the case of unit tests, the message may optionally be an exact namespace\n * for the test (e.g. 'goog.stringTest'). The linter will then ignore the extra\n * provide (if not explicitly defined in the code).\n *\n * @param {string=} opt_message Optional message to add to the error that's\n *     raised when used in production code.\n */\ngoog.setTestOnly = function(opt_message) {\n  if (goog.DISALLOW_TEST_ONLY_CODE) {\n    opt_message = opt_message || '';\n    throw new Error(\n        'Importing test-only code into non-debug environment' +\n        (opt_message ? ': ' + opt_message : '.'));\n  }\n};\n\n/**\n * @param {string} namespace\n * @return {?}\n */\ngoog.require = function(namespace) {};\n\n/**\n * @param {string} namespace\n * @return {?}\n */\ngoog.requireType = function(namespace) {};\n","// Copyright 2018 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview ES6 module that exports symbols from base.js so that ES6\n * modules do not need to use globals and so that is clear if a project is using\n * Closure's base.js file. It is also a subset of properties in base.js, meaning\n * it should be clearer what should not be used in ES6 modules\n * (goog.module/provide are not exported here, for example). Though that is not\n * to say that everything in this file should be used in an ES6 module; some\n * depreciated functions are exported to make migration easier (e.g.\n * goog.scope).\n *\n * Note that this does not load Closure's base.js file, it is still up to the\n * programmer to include it. Nor does the fact that this is an ES6 module mean\n * that projects no longer require deps.js files for debug loading - they do.\n * Closure will need to load your ES6 modules for you if you have any Closure\n * file (goog.provide/goog.module) dependencies, as they need to be available\n * before the ES6 module evaluates.\n *\n * Also note that this file has special compiler handling! It is okay to export\n * anything from this file, but the name also needs to exist on the global goog.\n * This special compiler pass enforces that you always import this file as\n * `import * as goog`, as many tools use regex based parsing to find\n * goog.require calls.\n */\n\nexport const global = globalThis;\n// export const require = goog.require;\n// export const define = goog.define;\n// export const DEBUG = goog.DEBUG;\n// export const LOCALE = goog.LOCALE;\n// export const TRUSTED_SITE = goog.TRUSTED_SITE;\n// export const DISALLOW_TEST_ONLY_CODE = goog.DISALLOW_TEST_ONLY_CODE;\n// export const getGoogModule = goog.module.get;\n// export const setTestOnly = goog.setTestOnly;\n// export const forwardDeclare = goog.forwardDeclare;\n// export const getObjectByName = goog.getObjectByName;\n// export const basePath = goog.basePath;\n// export const addSingletonGetter = goog.addSingletonGetter;\n// export const typeOf = goog.typeOf;\n// export const isArrayLike = goog.isArrayLike;\n// export const isDateLike = goog.isDateLike;\n// export const isObject = goog.isObject;\n// export const getUid = goog.getUid;\n// export const hasUid = goog.hasUid;\n// export const removeUid = goog.removeUid;\n// export const now = Date.now;\n// export const globalEval = goog.globalEval;\n// export const getCssName = goog.getCssName;\n// export const setCssNameMapping = goog.setCssNameMapping;\n// export const getMsg = goog.getMsg;\n// export const getMsgWithFallback = goog.getMsgWithFallback;\n// export const exportSymbol = goog.exportSymbol;\n// export const exportProperty = goog.exportProperty;\n// export const abstractMethod = goog.abstractMethod;\n// export const cloneObject = goog.cloneObject;\n// export const bind = goog.bind;\n// export const partial = goog.partial;\n// export const inherits = goog.inherits;\n// export const scope = goog.scope;\n// export const defineClass = goog.defineClass;\nexport const declareModuleId = function(namespace) {\n  if (window.goog && window.goog.declareModuleId) {\n    window.goog.declareModuleId.call(this, namespace);\n  }\n};\n\n\n// Export select properties of module. Do not export the function itself or\n// goog.module.declareLegacyNamespace.\n// export const module = {\n//   get: goog.module.get,\n// };\n\n// Omissions include:\n// goog.ENABLE_DEBUG_LOADER - define only used in base.\n// goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING - define only used in base.\n// goog.provide - ES6 modules do not provide anything.\n// goog.module - ES6 modules cannot be goog.modules.\n// goog.module.declareLegacyNamespace - ES6 modules cannot declare namespaces.\n// goog.addDependency - meant to only be used by dependency files.\n// goog.DEPENDENCIES_ENABLED - constant only used in base.\n// goog.TRANSPILE - define only used in base.\n// goog.TRANSPILER - define only used in base.\n// goog.loadModule - should not be called by any ES6 module; exists for\n//   generated bundles.\n// goog.LOAD_MODULE_USING_EVAL - define only used in base.\n// goog.SEAL_MODULE_EXPORTS - define only used in base.\n// goog.DebugLoader - used rarely, only outside of compiled code.\n// goog.Transpiler - used rarely, only outside of compiled code.\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blocks');\n\n/**\n * A block definition.  For now this very loose, but it can potentially\n * be refined e.g. by replacing this typedef with a class definition.\n */\nexport type BlockDefinition = AnyDuringMigration;\n\n/**\n * A mapping of block type names to block prototype objects.\n */\nexport const Blocks: {[key: string]: BlockDefinition} = Object.create(null);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.inputTypes');\n\nimport {ConnectionType} from '../connection_type.js';\n\n/**\n * Enum for the type of a connection or input.\n */\nexport enum inputTypes {\n  // A right-facing value input.  E.g. 'set item to' or 'return'.\n  VALUE = ConnectionType.INPUT_VALUE,\n  // A down-facing block stack.  E.g. 'if-do' or 'else'.\n  STATEMENT = ConnectionType.NEXT_STATEMENT,\n  // A dummy input.  Used to add field(s) with no input.\n  DUMMY = 5,\n  // An unknown type of input defined by an external developer.\n  CUSTOM = 6,\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IIcon} from '../interfaces/i_icon.js';\nimport {CommentIcon} from './comment_icon.js';\nimport {MutatorIcon} from './mutator_icon.js';\nimport {WarningIcon} from './warning_icon.js';\n\nexport class IconType<_T extends IIcon> {\n  /** @param name The name of the registry type. */\n  constructor(private readonly name: string) {}\n\n  /** @returns the name of the type. */\n  toString(): string {\n    return this.name;\n  }\n\n  /** @returns true if this icon type is equivalent to the given icon type. */\n  equals(type: IconType<IIcon>): boolean {\n    return this.name === type.toString();\n  }\n\n  static MUTATOR = new IconType<MutatorIcon>('mutator');\n  static WARNING = new IconType<WarningIcon>('warning');\n  static COMMENT = new IconType<CommentIcon>('comment');\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for size calculation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.Size');\n\n/**\n * Class for representing sizes consisting of a width and height.\n */\nexport class Size {\n  /**\n   * @param width Width.\n   * @param height Height.\n   */\n  constructor(public width: number, public height: number) {}\n\n  /**\n   * Compares sizes for equality.\n   *\n   * @param a A Size.\n   * @param b A Size.\n   * @returns True iff the sizes have equal widths and equal heights, or if both\n   *     are null.\n   */\n  static equals(a: Size | null, b: Size | null): boolean {\n    if (a === b) {\n      return true;\n    }\n    if (!a || !b) {\n      return false;\n    }\n    return a.width === b.width && a.height === b.height;\n  }\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Msg');\n\n/** A dictionary of localised messages. */\nexport const Msg: {[key: string]: string} = Object.create(null);\n\n/**\n * Sets the locale (i.e. the localized messages/block-text/etc) to the given\n * locale.\n *\n * This is not useful/necessary when loading from a script tag, because the\n * messages are automatically cluged into the Blockly.Msg object. But we provide\n * it in both the script-tag and non-script-tag contexts so that the tscompiler\n * can properly create our type definition files.\n *\n * @param locale An object defining the messages for a given language.\n */\nexport const setLocale = function (locale: {[key: string]: string}) {\n  Object.keys(locale).forEach(function (k) {\n    Msg[k] = locale[k];\n  });\n};\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Abstract class for events fired as a result of actions in\n * Blockly's editor.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.Abstract');\n\nimport * as common from '../common.js';\nimport type {Workspace} from '../workspace.js';\n\nimport * as eventUtils from './utils.js';\n\n/**\n * Abstract class for an event.\n */\nexport abstract class Abstract {\n  /**\n   * Whether or not the event was constructed without necessary parameters\n   * (to be populated by fromJson).\n   */\n  abstract isBlank: boolean;\n\n  /** The workspace identifier for this event. */\n  workspaceId?: string = undefined;\n\n  /**\n   * An ID for the group of events this block is associated with.\n   *\n   * Groups define events that should be treated as an single action from the\n   * user's perspective, and should be undone together.\n   */\n  group: string;\n\n  /** Whether this event is undoable or not. */\n  recordUndo: boolean;\n\n  /** Whether or not the event is a UI event. */\n  isUiEvent = false;\n\n  /** Type of this event. */\n  type = '';\n\n  constructor() {\n    this.group = eventUtils.getGroup();\n    this.recordUndo = eventUtils.getRecordUndo();\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  toJson(): AbstractEventJson {\n    return {\n      'type': this.type,\n      'group': this.group,\n    };\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of Abstract (like all events), but we can't specify that due to the\n   *     fact that parameters to static methods in subclasses must be\n   *     supertypes of parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: AbstractEventJson,\n    workspace: Workspace,\n    event: any\n  ): Abstract {\n    event.isBlank = false;\n    event.group = json['group'] || '';\n    event.workspaceId = workspace.id;\n    return event;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns True if null, false if something changed.\n   */\n  isNull(): boolean {\n    return false;\n  }\n\n  /**\n   * Run an event.\n   *\n   * @param _forward True if run forward, false if run backward (undo).\n   */\n  run(_forward: boolean) {\n    // Defined by subclasses. Cannot be abstract b/c UI events do /not/ define\n    // this.\n  }\n\n  /**\n   * Get workspace the event belongs to.\n   *\n   * @returns The workspace the event belongs to.\n   * @throws {Error} if workspace is null.\n   * @internal\n   */\n  getEventWorkspace_(): Workspace {\n    let workspace;\n    if (this.workspaceId) {\n      workspace = common.getWorkspaceById(this.workspaceId);\n    }\n    if (!workspace) {\n      throw Error(\n        'Workspace is null. Event must have been generated from real' +\n          ' Blockly events.'\n      );\n    }\n    return workspace;\n  }\n}\n\nexport interface AbstractEventJson {\n  type: string;\n  group: string;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Abstract class for a variable event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.VarBase');\n\nimport type {VariableModel} from '../variable_model.js';\n\nimport {\n  Abstract as AbstractEvent,\n  AbstractEventJson,\n} from './events_abstract.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Abstract class for a variable event.\n */\nexport class VarBase extends AbstractEvent {\n  override isBlank = true;\n  /** The ID of the variable this event references. */\n  varId?: string;\n\n  /**\n   * @param opt_variable The variable this event corresponds to.  Undefined for\n   *     a blank event.\n   */\n  constructor(opt_variable?: VariableModel) {\n    super();\n    this.isBlank = typeof opt_variable === 'undefined';\n    if (!opt_variable) return;\n\n    this.varId = opt_variable.getId();\n    this.workspaceId = opt_variable.workspace.id;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): VarBaseJson {\n    const json = super.toJson() as VarBaseJson;\n    if (!this.varId) {\n      throw new Error(\n        'The var ID is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['varId'] = this.varId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of VarBase, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: VarBaseJson,\n    workspace: Workspace,\n    event?: any\n  ): VarBase {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new VarBase()\n    ) as VarBase;\n    newEvent.varId = json['varId'];\n    return newEvent;\n  }\n}\n\nexport interface VarBaseJson extends AbstractEventJson {\n  varId: string;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a variable creation event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.VarCreate');\n\nimport * as registry from '../registry.js';\nimport type {VariableModel} from '../variable_model.js';\n\nimport {VarBase, VarBaseJson} from './events_var_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a variable model has been created.\n */\nexport class VarCreate extends VarBase {\n  override type = eventUtils.VAR_CREATE;\n\n  /** The type of the variable that was created. */\n  varType?: string;\n\n  /** The name of the variable that was created. */\n  varName?: string;\n\n  /**\n   * @param opt_variable The created variable. Undefined for a blank event.\n   */\n  constructor(opt_variable?: VariableModel) {\n    super(opt_variable);\n\n    if (!opt_variable) {\n      return; // Blank event to be populated by fromJson.\n    }\n    this.varType = opt_variable.type;\n    this.varName = opt_variable.name;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): VarCreateJson {\n    const json = super.toJson() as VarCreateJson;\n    if (this.varType === undefined) {\n      throw new Error(\n        'The var type is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.varName) {\n      throw new Error(\n        'The var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['varType'] = this.varType;\n    json['varName'] = this.varName;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of VarCreate, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: VarCreateJson,\n    workspace: Workspace,\n    event?: any\n  ): VarCreate {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new VarCreate()\n    ) as VarCreate;\n    newEvent.varType = json['varType'];\n    newEvent.varName = json['varName'];\n    return newEvent;\n  }\n\n  /**\n   * Run a variable creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.varId) {\n      throw new Error(\n        'The var ID is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.varName) {\n      throw new Error(\n        'The var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (forward) {\n      workspace.createVariable(this.varName, this.varType, this.varId);\n    } else {\n      workspace.deleteVariableById(this.varId);\n    }\n  }\n}\n\nexport interface VarCreateJson extends VarBaseJson {\n  varType: string;\n  varName: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.VAR_CREATE, VarCreate);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Components for the variable model.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.VariableModel');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_create.js';\n\nimport * as idGenerator from './utils/idgenerator.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Class for a variable model.\n * Holds information for the variable including name, ID, and type.\n *\n * @see {Blockly.FieldVariable}\n */\nexport class VariableModel {\n  type: string;\n  private readonly id_: string;\n\n  /**\n   * @param workspace The variable's workspace.\n   * @param name The name of the variable.  This is the user-visible name (e.g.\n   *     'my var' or '私の変数'), not the generated name.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   */\n  constructor(\n    public workspace: Workspace,\n    public name: string,\n    opt_type?: string,\n    opt_id?: string\n  ) {\n    /**\n     * The type of the variable, such as 'int' or 'sound_effect'. This may be\n     * used to build a list of variables of a specific type. By default this is\n     * the empty string '', which is a specific type.\n     *\n     * @see {Blockly.FieldVariable}\n     */\n    this.type = opt_type || '';\n\n    /**\n     * A unique ID for the variable. This should be defined at creation and\n     * not change, even if the name changes. In most cases this should be a\n     * UUID.\n     */\n    this.id_ = opt_id || idGenerator.genUid();\n  }\n\n  /** @returns The ID for the variable. */\n  getId(): string {\n    return this.id_;\n  }\n\n  /**\n   * A custom compare function for the VariableModel objects.\n   *\n   * @param var1 First variable to compare.\n   * @param var2 Second variable to compare.\n   * @returns -1 if name of var1 is less than name of var2, 0 if equal, and 1 if\n   *     greater.\n   * @internal\n   */\n  static compareByName(var1: VariableModel, var2: VariableModel): number {\n    return var1.name.localeCompare(var2.name, undefined, {sensitivity: 'base'});\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for coordinate manipulation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.Coordinate');\n\n/**\n * Class for representing coordinates and positions.\n */\nexport class Coordinate {\n  /**\n   * @param x Left.\n   * @param y Top.\n   */\n  constructor(public x: number, public y: number) {}\n\n  /**\n   * Creates a new copy of this coordinate.\n   *\n   * @returns A copy of this coordinate.\n   */\n  clone(): Coordinate {\n    return new Coordinate(this.x, this.y);\n  }\n\n  /**\n   * Scales this coordinate by the given scale factor.\n   *\n   * @param s The scale factor to use for both x and y dimensions.\n   * @returns This coordinate after scaling.\n   */\n  scale(s: number): Coordinate {\n    this.x *= s;\n    this.y *= s;\n    return this;\n  }\n\n  /**\n   * Translates this coordinate by the given offsets.\n   * respectively.\n   *\n   * @param tx The value to translate x by.\n   * @param ty The value to translate y by.\n   * @returns This coordinate after translating.\n   */\n  translate(tx: number, ty: number): Coordinate {\n    this.x += tx;\n    this.y += ty;\n    return this;\n  }\n\n  /**\n   * Compares coordinates for equality.\n   *\n   * @param a A Coordinate.\n   * @param b A Coordinate.\n   * @returns True iff the coordinates are equal, or if both are null.\n   */\n  static equals(a?: Coordinate | null, b?: Coordinate | null): boolean {\n    if (a === b) {\n      return true;\n    }\n    if (!a || !b) {\n      return false;\n    }\n    return a.x === b.x && a.y === b.y;\n  }\n\n  /**\n   * Returns the distance between two coordinates.\n   *\n   * @param a A Coordinate.\n   * @param b A Coordinate.\n   * @returns The distance between `a` and `b`.\n   */\n  static distance(a: Coordinate, b: Coordinate): number {\n    const dx = a.x - b.x;\n    const dy = a.y - b.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  /**\n   * Returns the magnitude of a coordinate.\n   *\n   * @param a A Coordinate.\n   * @returns The distance between the origin and `a`.\n   */\n  static magnitude(a: Coordinate): number {\n    return Math.sqrt(a.x * a.x + a.y * a.y);\n  }\n\n  /**\n   * Returns the difference between two coordinates as a new\n   * Coordinate.\n   *\n   * @param a An x/y coordinate.\n   * @param b An x/y coordinate.\n   * @returns A Coordinate representing the difference between `a` and `b`.\n   */\n  static difference(\n    a: Coordinate | SVGPoint,\n    b: Coordinate | SVGPoint\n  ): Coordinate {\n    return new Coordinate(a.x - b.x, a.y - b.y);\n  }\n\n  /**\n   * Returns the sum of two coordinates as a new Coordinate.\n   *\n   * @param a An x/y coordinate.\n   * @param b An x/y coordinate.\n   * @returns A Coordinate representing the sum of the two coordinates.\n   */\n  static sum(a: Coordinate | SVGPoint, b: Coordinate | SVGPoint): Coordinate {\n    return new Coordinate(a.x + b.x, a.y + b.y);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a code comment on the workspace.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WorkspaceComment');\n\nimport type {CommentMove} from './events/events_comment_move.js';\nimport * as eventUtils from './events/utils.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport * as xml from './utils/xml.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Class for a workspace comment.\n */\nexport class WorkspaceComment {\n  id: string;\n  protected xy_: Coordinate;\n  protected height_: number;\n  protected width_: number;\n  protected RTL: boolean;\n\n  private deletable = true;\n\n  private movable = true;\n\n  private editable = true;\n  protected content_: string;\n\n  /** Whether this comment has been disposed. */\n  protected disposed_ = false;\n  /** @internal */\n  isComment = true;\n\n  /**\n   * @param workspace The block's workspace.\n   * @param content The content of this workspace comment.\n   * @param height Height of the comment.\n   * @param width Width of the comment.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   */\n  constructor(\n    public workspace: Workspace,\n    content: string,\n    height: number,\n    width: number,\n    opt_id?: string\n  ) {\n    this.id =\n      opt_id && !workspace.getCommentById(opt_id)\n        ? opt_id\n        : idGenerator.genUid();\n\n    workspace.addTopComment(this);\n\n    /**\n     * The comment's position in workspace units.  (0, 0) is at the workspace's\n     * origin; scale does not change this value.\n     */\n    this.xy_ = new Coordinate(0, 0);\n\n    /**\n     * The comment's height in workspace units.  Scale does not change this\n     * value.\n     */\n    this.height_ = height;\n\n    /**\n     * The comment's width in workspace units.  Scale does not change this\n     * value.\n     */\n    this.width_ = width;\n\n    this.RTL = workspace.RTL;\n\n    this.content_ = content;\n\n    WorkspaceComment.fireCreateEvent(this);\n  }\n\n  /**\n   * Dispose of this comment.\n   *\n   * @internal\n   */\n  dispose() {\n    if (this.disposed_) {\n      return;\n    }\n\n    if (eventUtils.isEnabled()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.COMMENT_DELETE))(this));\n    }\n    // Remove from the list of top comments and the comment database.\n    this.workspace.removeTopComment(this);\n    this.disposed_ = true;\n  }\n\n  // Height, width, x, and y are all stored on even non-rendered comments, to\n  // preserve state if you pass the contents through a headless workspace.\n\n  /**\n   * Get comment height.\n   *\n   * @returns Comment height.\n   * @internal\n   */\n  getHeight(): number {\n    return this.height_;\n  }\n\n  /**\n   * Set comment height.\n   *\n   * @param height Comment height.\n   * @internal\n   */\n  setHeight(height: number) {\n    this.height_ = height;\n  }\n\n  /**\n   * Get comment width.\n   *\n   * @returns Comment width.\n   * @internal\n   */\n  getWidth(): number {\n    return this.width_;\n  }\n\n  /**\n   * Set comment width.\n   *\n   * @param width comment width.\n   * @internal\n   */\n  setWidth(width: number) {\n    this.width_ = width;\n  }\n\n  /**\n   * Get stored location.\n   *\n   * @returns The comment's stored location.\n   *   This is not valid if the comment is currently being dragged.\n   * @internal\n   */\n  getRelativeToSurfaceXY(): Coordinate {\n    return new Coordinate(this.xy_.x, this.xy_.y);\n  }\n\n  /**\n   * Move a comment by a relative offset.\n   *\n   * @param dx Horizontal offset, in workspace units.\n   * @param dy Vertical offset, in workspace units.\n   * @internal\n   */\n  moveBy(dx: number, dy: number) {\n    const event = new (eventUtils.get(eventUtils.COMMENT_MOVE))(\n      this\n    ) as CommentMove;\n    this.xy_.translate(dx, dy);\n    event.recordNew();\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Get whether this comment is deletable or not.\n   *\n   * @returns True if deletable.\n   * @internal\n   */\n  isDeletable(): boolean {\n    return (\n      this.deletable && !(this.workspace && this.workspace.options.readOnly)\n    );\n  }\n\n  /**\n   * Set whether this comment is deletable or not.\n   *\n   * @param deletable True if deletable.\n   * @internal\n   */\n  setDeletable(deletable: boolean) {\n    this.deletable = deletable;\n  }\n\n  /**\n   * Get whether this comment is movable or not.\n   *\n   * @returns True if movable.\n   * @internal\n   */\n  isMovable(): boolean {\n    return this.movable && !(this.workspace && this.workspace.options.readOnly);\n  }\n\n  /**\n   * Set whether this comment is movable or not.\n   *\n   * @param movable True if movable.\n   * @internal\n   */\n  setMovable(movable: boolean) {\n    this.movable = movable;\n  }\n\n  /**\n   * Get whether this comment is editable or not.\n   *\n   * @returns True if editable.\n   */\n  isEditable(): boolean {\n    return (\n      this.editable && !(this.workspace && this.workspace.options.readOnly)\n    );\n  }\n\n  /**\n   * Set whether this comment is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  setEditable(editable: boolean) {\n    this.editable = editable;\n  }\n\n  /**\n   * Returns this comment's text.\n   *\n   * @returns Comment text.\n   * @internal\n   */\n  getContent(): string {\n    return this.content_;\n  }\n\n  /**\n   * Set this comment's content.\n   *\n   * @param content Comment content.\n   * @internal\n   */\n  setContent(content: string) {\n    if (this.content_ !== content) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.COMMENT_CHANGE))(\n          this,\n          this.content_,\n          content\n        )\n      );\n      this.content_ = content;\n    }\n  }\n\n  /**\n   * Encode a comment subtree as XML with XY coordinates.\n   *\n   * @param opt_noId True if the encoder should skip the comment ID.\n   * @returns Tree of XML elements.\n   * @internal\n   */\n  toXmlWithXY(opt_noId?: boolean): Element {\n    const element = this.toXml(opt_noId);\n    element.setAttribute('x', String(Math.round(this.xy_.x)));\n    element.setAttribute('y', String(Math.round(this.xy_.y)));\n    element.setAttribute('h', String(this.height_));\n    element.setAttribute('w', String(this.width_));\n    return element;\n  }\n\n  /**\n   * Encode a comment subtree as XML, but don't serialize the XY coordinates.\n   * This method avoids some expensive metrics-related calls that are made in\n   * toXmlWithXY().\n   *\n   * @param opt_noId True if the encoder should skip the comment ID.\n   * @returns Tree of XML elements.\n   * @internal\n   */\n  toXml(opt_noId?: boolean): Element {\n    const commentElement = xml.createElement('comment');\n    if (!opt_noId) {\n      commentElement.id = this.id;\n    }\n    commentElement.textContent = this.getContent();\n    return commentElement;\n  }\n\n  /**\n   * Fire a create event for the given workspace comment, if comments are\n   * enabled.\n   *\n   * @param comment The comment that was just created.\n   * @internal\n   */\n  static fireCreateEvent(comment: WorkspaceComment) {\n    if (eventUtils.isEnabled()) {\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      try {\n        eventUtils.fire(\n          new (eventUtils.get(eventUtils.COMMENT_CREATE))(comment)\n        );\n      } finally {\n        eventUtils.setGroup(existingGroup);\n      }\n    }\n  }\n\n  /**\n   * Decode an XML comment tag and create a comment on the workspace.\n   *\n   * @param xmlComment XML comment element.\n   * @param workspace The workspace.\n   * @returns The created workspace comment.\n   * @internal\n   */\n  static fromXml(xmlComment: Element, workspace: Workspace): WorkspaceComment {\n    const info = WorkspaceComment.parseAttributes(xmlComment);\n\n    const comment = new WorkspaceComment(\n      workspace,\n      info.content,\n      info.h,\n      info.w,\n      info.id\n    );\n\n    const xmlX = xmlComment.getAttribute('x');\n    const xmlY = xmlComment.getAttribute('y');\n    const commentX = xmlX ? parseInt(xmlX, 10) : NaN;\n    const commentY = xmlY ? parseInt(xmlY, 10) : NaN;\n    if (!isNaN(commentX) && !isNaN(commentY)) {\n      comment.moveBy(commentX, commentY);\n    }\n\n    WorkspaceComment.fireCreateEvent(comment);\n    return comment;\n  }\n\n  /**\n   * Decode an XML comment tag and return the results in an object.\n   *\n   * @param xml XML comment element.\n   * @returns An object containing the id, size, position, and comment string.\n   * @internal\n   */\n  static parseAttributes(xml: Element): {\n    id: string;\n    w: number;\n    h: number;\n    x: number;\n    y: number;\n    content: string;\n  } {\n    const xmlH = xml.getAttribute('h');\n    const xmlW = xml.getAttribute('w');\n    const xmlX = xml.getAttribute('x');\n    const xmlY = xml.getAttribute('y');\n    const xmlId = xml.getAttribute('id');\n\n    if (!xmlId) {\n      throw new Error('No ID present in XML comment definition.');\n    }\n\n    return {\n      id: xmlId,\n      // The height of the comment in workspace units, or 100 if not specified.\n      h: xmlH ? parseInt(xmlH) : 100,\n      // The width of the comment in workspace units, or 100 if not specified.\n      w: xmlW ? parseInt(xmlW) : 100,\n      // The x position of the comment in workspace coordinates, or NaN if not\n      // specified in the XML.\n      x: xmlX ? parseInt(xmlX) : NaN,\n      // The y position of the comment in workspace coordinates, or NaN if not\n      // specified in the XML.\n      y: xmlY ? parseInt(xmlY) : NaN,\n      content: xml.textContent ?? '',\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class for events fired as a result of UI actions in\n * Blockly's editor.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.UiBase');\n\nimport {Abstract as AbstractEvent} from './events_abstract.js';\n\n/**\n * Base class for a UI event.\n * UI events are events that don't need to be sent over the wire for multi-user\n * editing to work (e.g. scrolling the workspace, zooming, opening toolbox\n * categories).\n * UI events do not undo or redo.\n */\nexport class UiBase extends AbstractEvent {\n  override isBlank = true;\n  override workspaceId: string;\n\n  // UI events do not undo or redo.\n  override recordUndo = false;\n\n  /** Whether or not the event is a UI event. */\n  override isUiEvent = true;\n\n  /**\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   */\n  constructor(opt_workspaceId?: string) {\n    super();\n\n    /** Whether or not the event is blank (to be populated by fromJson). */\n    this.isBlank = typeof opt_workspaceId === 'undefined';\n\n    /** The workspace identifier for this event. */\n    this.workspaceId = opt_workspaceId ? opt_workspaceId : '';\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of element select action.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.Selected');\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Class for a selected event.\n * Notifies listeners that a new element has been selected.\n */\nexport class Selected extends UiBase {\n  /** The id of the last selected selectable element. */\n  oldElementId?: string;\n\n  /**\n   * The id of the newly selected selectable element,\n   * or undefined if unselected.\n   */\n  newElementId?: string;\n\n  override type = eventUtils.SELECTED;\n\n  /**\n   * @param opt_oldElementId The ID of the previously selected element. Null if\n   *     no element last selected. Undefined for a blank event.\n   * @param opt_newElementId The ID of the selected element. Null if no element\n   *     currently selected (deselect). Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Null if no element previously selected. Undefined for a blank event.\n   */\n  constructor(\n    opt_oldElementId?: string | null,\n    opt_newElementId?: string | null,\n    opt_workspaceId?: string\n  ) {\n    super(opt_workspaceId);\n\n    this.oldElementId = opt_oldElementId ?? undefined;\n    this.newElementId = opt_newElementId ?? undefined;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): SelectedJson {\n    const json = super.toJson() as SelectedJson;\n    json['oldElementId'] = this.oldElementId;\n    json['newElementId'] = this.newElementId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of Selected, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: SelectedJson,\n    workspace: Workspace,\n    event?: any\n  ): Selected {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new Selected()\n    ) as Selected;\n    newEvent.oldElementId = json['oldElementId'];\n    newEvent.newElementId = json['newElementId'];\n    return newEvent;\n  }\n}\n\nexport interface SelectedJson extends AbstractEventJson {\n  oldElementId?: string;\n  newElementId?: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.SELECTED, Selected);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.userAgent');\n\n/** The raw useragent string. */\nlet rawUserAgent: string;\n\nlet isJavaFx: boolean;\n\nlet isWebKit: boolean;\n\nlet isGecko: boolean;\n\nlet isAndroid: boolean;\n\nlet isIPad: boolean;\n\nlet isIPhone: boolean;\n\nlet isMac: boolean;\n\nlet isTablet: boolean;\n\nlet isMobile: boolean;\n\n(function (raw) {\n  rawUserAgent = raw;\n  const rawUpper = rawUserAgent.toUpperCase();\n  /**\n   * Case-insensitive test of whether name is in the useragent string.\n   *\n   * @param name Name to test.\n   * @returns True if name is present.\n   */\n  function has(name: string): boolean {\n    return rawUpper.indexOf(name.toUpperCase()) !== -1;\n  }\n\n  // Browsers.  Logic from:\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/browser.js\n  // Useragent for JavaFX:\n  // Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.44\n  //     (KHTML, like Gecko) JavaFX/8.0 Safari/537.44\n  isJavaFx = has('JavaFX');\n\n  // Engines.  Logic from:\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/engine.js\n  isWebKit = has('WebKit');\n  isGecko = has('Gecko') && !isWebKit;\n\n  // Platforms.  Logic from:\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/platform.js\n  // and\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/extra.js\n  isAndroid = has('Android');\n  const maxTouchPoints =\n    globalThis['navigator'] && globalThis['navigator']['maxTouchPoints'];\n  isIPad = has('iPad') || (has('Macintosh') && maxTouchPoints > 0);\n  isIPhone = has('iPhone') && !isIPad;\n  isMac = has('Macintosh');\n\n  // Devices.  Logic from:\n  // https://github.com/google/closure-library/blob/master/closure/goog/labs/useragent/device.js\n  isTablet = isIPad || (isAndroid && !has('Mobile')) || has('Silk');\n  isMobile = !isTablet && (isIPhone || isAndroid);\n})((globalThis['navigator'] && globalThis['navigator']['userAgent']) || '');\n\nexport const raw: string = rawUserAgent;\n\nexport const JavaFx: boolean = isJavaFx;\n\nexport const GECKO: boolean = isGecko;\n\nexport const ANDROID: boolean = isAndroid;\n\nexport const IPAD: boolean = isIPad;\n\nexport const IPHONE: boolean = isIPhone;\n\nexport const MAC: boolean = isMac;\n\nexport const MOBILE: boolean = isMobile;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility methods for rectangle manipulation.\n * These methods are not specific to Blockly, and could be factored out into\n * a JavaScript framework such as Closure.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.Rect');\n\n/**\n * Class for representing rectangular regions.\n */\nexport class Rect {\n  /**\n   * @param top Top.\n   * @param bottom Bottom.\n   * @param left Left.\n   * @param right Right.\n   */\n  constructor(\n    public top: number,\n    public bottom: number,\n    public left: number,\n    public right: number\n  ) {}\n\n  getHeight(): number {\n    return this.bottom - this.top;\n  }\n\n  getWidth(): number {\n    return this.right - this.left;\n  }\n\n  /**\n   * Tests whether this rectangle contains a x/y coordinate.\n   *\n   * @param x The x coordinate to test for containment.\n   * @param y The y coordinate to test for containment.\n   * @returns Whether this rectangle contains given coordinate.\n   */\n  contains(x: number, y: number): boolean {\n    return (\n      x >= this.left && x <= this.right && y >= this.top && y <= this.bottom\n    );\n  }\n\n  /**\n   * Tests whether this rectangle intersects the provided rectangle.\n   * Assumes that the coordinate system increases going down and left.\n   *\n   * @param other The other rectangle to check for intersection with.\n   * @returns Whether this rectangle intersects the provided rectangle.\n   */\n  intersects(other: Rect): boolean {\n    return !(\n      this.left > other.right ||\n      this.right < other.left ||\n      this.top > other.bottom ||\n      this.bottom < other.top\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Defines the Svg class. Its constants enumerate\n * all SVG tag names used by Blockly.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.Svg');\n\n/**\n * A name with the type of the SVG element stored in the generic.\n */\nexport class Svg<_T> {\n  /** @internal */\n  static ANIMATE = new Svg<SVGAnimateElement>('animate');\n  /** @internal */\n  static CIRCLE = new Svg<SVGCircleElement>('circle');\n  /** @internal */\n  static CLIPPATH = new Svg<SVGClipPathElement>('clipPath');\n  /** @internal */\n  static DEFS = new Svg<SVGDefsElement>('defs');\n  /** @internal */\n  static FECOMPOSITE = new Svg<SVGFECompositeElement>('feComposite');\n  /** @internal */\n  static FECOMPONENTTRANSFER = new Svg<SVGFEComponentTransferElement>(\n    'feComponentTransfer'\n  );\n  /** @internal */\n  static FEFLOOD = new Svg<SVGFEFloodElement>('feFlood');\n  /** @internal */\n  static FEFUNCA = new Svg<SVGFEFuncAElement>('feFuncA');\n  /** @internal */\n  static FEGAUSSIANBLUR = new Svg<SVGFEGaussianBlurElement>('feGaussianBlur');\n  /** @internal */\n  static FEPOINTLIGHT = new Svg<SVGFEPointLightElement>('fePointLight');\n  /** @internal */\n  static FESPECULARLIGHTING = new Svg<SVGFESpecularLightingElement>(\n    'feSpecularLighting'\n  );\n  /** @internal */\n  static FILTER = new Svg<SVGFilterElement>('filter');\n  /** @internal */\n  static FOREIGNOBJECT = new Svg<SVGForeignObjectElement>('foreignObject');\n  /** @internal */\n  static G = new Svg<SVGGElement>('g');\n  /** @internal */\n  static IMAGE = new Svg<SVGImageElement>('image');\n  /** @internal */\n  static LINE = new Svg<SVGLineElement>('line');\n  /** @internal */\n  static PATH = new Svg<SVGPathElement>('path');\n  /** @internal */\n  static PATTERN = new Svg<SVGPatternElement>('pattern');\n  /** @internal */\n  static POLYGON = new Svg<SVGPolygonElement>('polygon');\n  /** @internal */\n  static RECT = new Svg<SVGRectElement>('rect');\n  /** @internal */\n  static SVG = new Svg<SVGSVGElement>('svg');\n  /** @internal */\n  static TEXT = new Svg<SVGTextElement>('text');\n  /** @internal */\n  static TSPAN = new Svg<SVGTSpanElement>('tspan');\n\n  /**\n   * @param tagName The SVG element tag name.\n   * @internal\n   */\n  constructor(private readonly tagName: string) {}\n\n  /**\n   * Returns the SVG element tag name.\n   *\n   * @returns The name.\n   */\n  toString(): string {\n    return this.tagName;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a code comment on a rendered workspace.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WorkspaceCommentSvg');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_selected.js';\n\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\n// import * as ContextMenu from './contextmenu.js';\nimport * as Css from './css.js';\nimport type {CommentMove} from './events/events_comment_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {IBubble} from './interfaces/i_bubble.js';\nimport type {CopyData, ICopyable} from './interfaces/i_copyable.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport {WorkspaceComment} from './workspace_comment.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/** Size of the resize icon. */\nconst RESIZE_SIZE = 8;\n\n/** Radius of the border around the comment. */\nconst BORDER_RADIUS = 3;\n\n/** Offset from the foreignobject edge to the textarea edge. */\nconst TEXTAREA_OFFSET = 2;\n\n/**\n * Class for a workspace comment's SVG representation.\n */\nexport class WorkspaceCommentSvg\n  extends WorkspaceComment\n  implements IBoundedElement, IBubble, ICopyable\n{\n  /**\n   * The width and height to use to size a workspace comment when it is first\n   * added, before it has been edited by the user.\n   *\n   * @internal\n   */\n  static DEFAULT_SIZE = 100;\n\n  /** Offset from the top to make room for a top bar. */\n  private static readonly TOP_OFFSET = 10;\n  override workspace: WorkspaceSvg;\n\n  /** Mouse up event data. */\n  private onMouseUpWrapper: browserEvents.Data | null = null;\n\n  /** Mouse move event data. */\n  private onMouseMoveWrapper: browserEvents.Data | null = null;\n\n  /** Whether event handlers have been initialized. */\n  private eventsInit = false;\n  private textarea: HTMLTextAreaElement | null = null;\n\n  private svgRectTarget: SVGRectElement | null = null;\n\n  private svgHandleTarget: SVGRectElement | null = null;\n\n  private foreignObject: SVGForeignObjectElement | null = null;\n\n  private resizeGroup: SVGGElement | null = null;\n\n  private deleteGroup: SVGGElement | null = null;\n\n  private deleteIconBorder: SVGCircleElement | null = null;\n\n  private focused = false;\n  private autoLayout = false;\n\n  // Create core elements for the block.\n  private readonly svgGroup: SVGElement;\n  svgRect_: SVGRectElement;\n\n  /** Whether the comment is rendered onscreen and is a part of the DOM. */\n  private rendered = false;\n\n  /**\n   * @param workspace The block's workspace.\n   * @param content The content of this workspace comment.\n   * @param height Height of the comment.\n   * @param width Width of the comment.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   */\n  constructor(\n    workspace: WorkspaceSvg,\n    content: string,\n    height: number,\n    width: number,\n    opt_id?: string\n  ) {\n    super(workspace, content, height, width, opt_id);\n    this.svgGroup = dom.createSvgElement(Svg.G, {'class': 'blocklyComment'});\n    this.workspace = workspace;\n\n    this.svgRect_ = dom.createSvgElement(Svg.RECT, {\n      'class': 'blocklyCommentRect',\n      'x': 0,\n      'y': 0,\n      'rx': BORDER_RADIUS,\n      'ry': BORDER_RADIUS,\n    });\n    this.svgGroup.appendChild(this.svgRect_);\n\n    this.render();\n  }\n\n  /**\n   * Dispose of this comment.\n   *\n   * @internal\n   */\n  override dispose() {\n    if (this.disposed_) {\n      return;\n    }\n    // If this comment is being dragged, unlink the mouse events.\n    if (common.getSelected() === this) {\n      this.unselect();\n      this.workspace.cancelCurrentGesture();\n    }\n\n    if (eventUtils.isEnabled()) {\n      eventUtils.fire(new (eventUtils.get(eventUtils.COMMENT_DELETE))(this));\n    }\n\n    dom.removeNode(this.svgGroup);\n    // Dispose of any rendered components\n    this.disposeInternal();\n\n    eventUtils.disable();\n    super.dispose();\n    eventUtils.enable();\n  }\n\n  /**\n   * Create and initialize the SVG representation of a workspace comment.\n   * May be called more than once.\n   *\n   * @param opt_noSelect Text inside text area will be selected if false\n   * @internal\n   */\n  initSvg(opt_noSelect?: boolean) {\n    if (!this.workspace.rendered) {\n      throw TypeError('Workspace is headless.');\n    }\n    if (!this.workspace.options.readOnly && !this.eventsInit) {\n      browserEvents.conditionalBind(\n        this.svgRectTarget as SVGRectElement,\n        'pointerdown',\n        this,\n        this.pathMouseDown\n      );\n      browserEvents.conditionalBind(\n        this.svgHandleTarget as SVGRectElement,\n        'pointerdown',\n        this,\n        this.pathMouseDown\n      );\n    }\n    this.eventsInit = true;\n\n    this.updateMovable();\n    if (!this.getSvgRoot().parentNode) {\n      this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot());\n    }\n\n    if (!opt_noSelect && this.textarea) {\n      this.textarea.select();\n    }\n  }\n\n  /**\n   * Handle a pointerdown on an SVG comment.\n   *\n   * @param e Pointer down event.\n   */\n  private pathMouseDown(e: PointerEvent) {\n    const gesture = this.workspace.getGesture(e);\n    if (gesture) {\n      gesture.handleBubbleStart(e, this);\n    }\n  }\n\n  /**\n   * Show the context menu for this workspace comment.\n   *\n   * @param e Pointer event.\n   * @internal\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  showContextMenu(e: PointerEvent) {\n    throw new Error(\n      'The implementation of showContextMenu should be ' +\n        'monkey-patched in by blockly.ts'\n    );\n  }\n\n  /**\n   * Select this comment.  Highlight it visually.\n   *\n   * @internal\n   */\n  select() {\n    if (common.getSelected() === this) {\n      return;\n    }\n    let oldId = null;\n    if (common.getSelected()) {\n      oldId = common.getSelected()!.id;\n      // Unselect any previously selected block.\n      eventUtils.disable();\n      try {\n        common.getSelected()!.unselect();\n      } finally {\n        eventUtils.enable();\n      }\n    }\n    const event = new (eventUtils.get(eventUtils.SELECTED))(\n      oldId,\n      this.id,\n      this.workspace.id\n    );\n    eventUtils.fire(event);\n    common.setSelected(this);\n    this.addSelect();\n  }\n\n  /**\n   * Unselect this comment.  Remove its highlighting.\n   *\n   * @internal\n   */\n  unselect() {\n    if (common.getSelected() !== this) {\n      return;\n    }\n    const event = new (eventUtils.get(eventUtils.SELECTED))(\n      this.id,\n      null,\n      this.workspace.id\n    );\n    eventUtils.fire(event);\n    common.setSelected(null);\n    this.removeSelect();\n    this.blurFocus();\n  }\n\n  /**\n   * Select this comment.  Highlight it visually.\n   *\n   * @internal\n   */\n  addSelect() {\n    dom.addClass(this.svgGroup, 'blocklySelected');\n    this.setFocus();\n  }\n\n  /**\n   * Unselect this comment.  Remove its highlighting.\n   *\n   * @internal\n   */\n  removeSelect() {\n    dom.addClass(this.svgGroup, 'blocklySelected');\n    this.blurFocus();\n  }\n\n  /**\n   * Focus this comment.  Highlight it visually.\n   *\n   * @internal\n   */\n  addFocus() {\n    dom.addClass(this.svgGroup, 'blocklyFocused');\n  }\n\n  /**\n   * Unfocus this comment.  Remove its highlighting.\n   *\n   * @internal\n   */\n  removeFocus() {\n    dom.removeClass(this.svgGroup, 'blocklyFocused');\n  }\n\n  /**\n   * Return the coordinates of the top-left corner of this comment relative to\n   * the drawing surface's origin (0,0), in workspace units.\n   * If the comment is on the workspace, (0, 0) is the origin of the workspace\n   * coordinate system.\n   * This does not change with workspace scale.\n   *\n   * @returns Object with .x and .y properties in workspace coordinates.\n   * @internal\n   */\n  override getRelativeToSurfaceXY(): Coordinate {\n    let x = 0;\n    let y = 0;\n\n    let element: Node | null = this.getSvgRoot();\n    if (element) {\n      do {\n        // Loop through this comment and every parent.\n        const xy = svgMath.getRelativeXY(element as Element);\n        x += xy.x;\n        y += xy.y;\n        element = element.parentNode;\n      } while (\n        element &&\n        element !== this.workspace.getBubbleCanvas() &&\n        element !== null\n      );\n    }\n    this.xy_ = new Coordinate(x, y);\n    return this.xy_;\n  }\n\n  /**\n   * Move a comment by a relative offset.\n   *\n   * @param dx Horizontal offset, in workspace units.\n   * @param dy Vertical offset, in workspace units.\n   * @internal\n   */\n  override moveBy(dx: number, dy: number) {\n    const event = new (eventUtils.get(eventUtils.COMMENT_MOVE))(\n      this\n    ) as CommentMove;\n    // TODO: Do I need to look up the relative to surface XY position here?\n    const xy = this.getRelativeToSurfaceXY();\n    this.translate(xy.x + dx, xy.y + dy);\n    this.xy_ = new Coordinate(xy.x + dx, xy.y + dy);\n    event.recordNew();\n    eventUtils.fire(event);\n    this.workspace.resizeContents();\n  }\n\n  /**\n   * Transforms a comment by setting the translation on the transform attribute\n   * of the block's SVG.\n   *\n   * @param x The x coordinate of the translation in workspace units.\n   * @param y The y coordinate of the translation in workspace units.\n   * @internal\n   */\n  translate(x: number, y: number) {\n    this.xy_ = new Coordinate(x, y);\n    this.getSvgRoot().setAttribute(\n      'transform',\n      'translate(' + x + ',' + y + ')'\n    );\n  }\n\n  /**\n   * Move this comment during a drag.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate) {\n    const translation = `translate(${newLoc.x}, ${newLoc.y})`;\n    this.getSvgRoot().setAttribute('transform', translation);\n  }\n\n  /**\n   * Move the bubble group to the specified location in workspace coordinates.\n   *\n   * @param x The x position to move to.\n   * @param y The y position to move to.\n   * @internal\n   */\n  moveTo(x: number, y: number) {\n    this.translate(x, y);\n  }\n\n  /**\n   * Clear the comment of transform=\"...\" attributes.\n   * Used when the comment is switching from 3d to 2d transform or vice versa.\n   */\n  private clearTransformAttributes() {\n    this.getSvgRoot().removeAttribute('transform');\n  }\n\n  /**\n   * Returns the coordinates of a bounding box describing the dimensions of this\n   * comment.\n   * Coordinate system: workspace coordinates.\n   *\n   * @returns Object with coordinates of the bounding box.\n   * @internal\n   */\n  getBoundingRectangle(): Rect {\n    const blockXY = this.getRelativeToSurfaceXY();\n    const commentBounds = this.getHeightWidth();\n    const top = blockXY.y;\n    const bottom = blockXY.y + commentBounds.height;\n    let left;\n    let right;\n    if (this.RTL) {\n      left = blockXY.x - commentBounds.width;\n      // Add the width of the tab/puzzle piece knob to the x coordinate\n      // since X is the corner of the rectangle, not the whole puzzle piece.\n      right = blockXY.x;\n    } else {\n      // Subtract the width of the tab/puzzle piece knob to the x coordinate\n      // since X is the corner of the rectangle, not the whole puzzle piece.\n      left = blockXY.x;\n      right = blockXY.x + commentBounds.width;\n    }\n    return new Rect(top, bottom, left, right);\n  }\n\n  /**\n   * Add or remove the UI indicating if this comment is movable or not.\n   *\n   * @internal\n   */\n  updateMovable() {\n    if (this.isMovable()) {\n      dom.addClass(this.svgGroup, 'blocklyDraggable');\n    } else {\n      dom.removeClass(this.svgGroup, 'blocklyDraggable');\n    }\n  }\n\n  /**\n   * Set whether this comment is movable or not.\n   *\n   * @param movable True if movable.\n   * @internal\n   */\n  override setMovable(movable: boolean) {\n    super.setMovable(movable);\n    this.updateMovable();\n  }\n\n  /**\n   * Set whether this comment is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  override setEditable(editable: boolean) {\n    super.setEditable(editable);\n    if (this.textarea) {\n      this.textarea.readOnly = !editable;\n    }\n  }\n\n  /**\n   * Recursively adds or removes the dragging class to this node and its\n   * children.\n   *\n   * @param adding True if adding, false if removing.\n   * @internal\n   */\n  setDragging(adding: boolean) {\n    if (adding) {\n      dom.addClass(this.getSvgRoot(), 'blocklyDragging');\n    } else {\n      dom.removeClass(this.getSvgRoot(), 'blocklyDragging');\n    }\n  }\n\n  /**\n   * Return the root node of the SVG or null if none exists.\n   *\n   * @returns The root SVG node (probably a group).\n   * @internal\n   */\n  getSvgRoot(): SVGElement {\n    return this.svgGroup;\n  }\n\n  /**\n   * Returns this comment's text.\n   *\n   * @returns Comment text.\n   * @internal\n   */\n  override getContent(): string {\n    return this.textarea ? this.textarea.value : this.content_;\n  }\n\n  /**\n   * Set this comment's content.\n   *\n   * @param content Comment content.\n   * @internal\n   */\n  override setContent(content: string) {\n    super.setContent(content);\n    if (this.textarea) {\n      this.textarea.value = content;\n    }\n  }\n\n  /**\n   * Update the cursor over this comment by adding or removing a class.\n   *\n   * @param enable True if the delete cursor should be shown, false otherwise.\n   * @internal\n   */\n  setDeleteStyle(enable: boolean) {\n    if (enable) {\n      dom.addClass(this.svgGroup, 'blocklyDraggingDelete');\n    } else {\n      dom.removeClass(this.svgGroup, 'blocklyDraggingDelete');\n    }\n  }\n\n  /**\n   * Set whether auto-layout of this bubble is enabled.  The first time a bubble\n   * is shown it positions itself to not cover any blocks.  Once a user has\n   * dragged it to reposition, it renders where the user put it.\n   *\n   * @param _enable True if auto-layout should be enabled, false otherwise.\n   * @internal\n   */\n  setAutoLayout(_enable: boolean) {}\n  // NOP for compatibility with the bubble dragger.\n\n  /**\n   * Encode a comment subtree as XML with XY coordinates.\n   *\n   * @param opt_noId True if the encoder should skip the comment ID.\n   * @returns Tree of XML elements.\n   * @internal\n   */\n  override toXmlWithXY(opt_noId?: boolean): Element {\n    let width = 0; // Not used in LTR.\n    if (this.workspace.RTL) {\n      // Here be performance dragons: This calls getMetrics().\n      width = this.workspace.getWidth();\n    }\n    const element = this.toXml(opt_noId);\n    const xy = this.getRelativeToSurfaceXY();\n    element.setAttribute(\n      'x',\n      String(Math.round(this.workspace.RTL ? width - xy.x : xy.x))\n    );\n    element.setAttribute('y', String(Math.round(xy.y)));\n    element.setAttribute('h', String(this.getHeight()));\n    element.setAttribute('w', String(this.getWidth()));\n    return element;\n  }\n\n  /**\n   * Encode a comment for copying.\n   *\n   * @returns Copy metadata.\n   * @internal\n   */\n  toCopyData(): CopyData {\n    return {\n      saveInfo: this.toXmlWithXY(),\n      source: this.workspace,\n      typeCounts: null,\n    };\n  }\n\n  /**\n   * Returns a bounding box describing the dimensions of this comment.\n   *\n   * @returns Object with height and width properties in workspace units.\n   * @internal\n   */\n  getHeightWidth(): {height: number; width: number} {\n    return {width: this.getWidth(), height: this.getHeight()};\n  }\n\n  /**\n   * Renders the workspace comment.\n   *\n   * @internal\n   */\n  render() {\n    if (this.rendered) {\n      return;\n    }\n\n    const size = this.getHeightWidth();\n\n    // Add text area\n    const foreignObject = this.createEditor();\n    this.svgGroup.appendChild(foreignObject);\n\n    this.svgHandleTarget = dom.createSvgElement(Svg.RECT, {\n      'class': 'blocklyCommentHandleTarget',\n      'x': 0,\n      'y': 0,\n    });\n    this.svgGroup.appendChild(this.svgHandleTarget);\n    this.svgRectTarget = dom.createSvgElement(Svg.RECT, {\n      'class': 'blocklyCommentTarget',\n      'x': 0,\n      'y': 0,\n      'rx': BORDER_RADIUS,\n      'ry': BORDER_RADIUS,\n    });\n    this.svgGroup.appendChild(this.svgRectTarget);\n\n    // Add the resize icon\n    this.addResizeDom();\n    if (this.isDeletable()) {\n      // Add the delete icon\n      this.addDeleteDom();\n    }\n\n    this.setSize(size.width, size.height);\n\n    // Set the content\n    this.textarea!.value = this.content_;\n\n    this.rendered = true;\n\n    if (this.resizeGroup) {\n      browserEvents.conditionalBind(\n        this.resizeGroup,\n        'pointerdown',\n        this,\n        this.resizeMouseDown\n      );\n    }\n\n    if (this.isDeletable()) {\n      browserEvents.conditionalBind(\n        this.deleteGroup as SVGGElement,\n        'pointerdown',\n        this,\n        this.deleteMouseDown\n      );\n      browserEvents.conditionalBind(\n        this.deleteGroup as SVGGElement,\n        'pointerout',\n        this,\n        this.deleteMouseOut\n      );\n      browserEvents.conditionalBind(\n        this.deleteGroup as SVGGElement,\n        'pointerup',\n        this,\n        this.deleteMouseUp\n      );\n    }\n  }\n\n  /**\n   * Create the text area for the comment.\n   *\n   * @returns The top-level node of the editor.\n   */\n  private createEditor(): Element {\n    /* Create the editor.  Here's the markup that will be generated:\n          <foreignObject class=\"blocklyCommentForeignObject\" x=\"0\" y=\"10\"\n          width=\"164\" height=\"164\"> <body xmlns=\"http://www.w3.org/1999/xhtml\"\n          class=\"blocklyMinimalBody\"> <textarea\n       xmlns=\"http://www.w3.org/1999/xhtml\" class=\"blocklyCommentTextarea\"\n                  style=\"height: 164px; width: 164px;\"></textarea>\n            </body>\n          </foreignObject>\n        */\n    this.foreignObject = dom.createSvgElement(Svg.FOREIGNOBJECT, {\n      'x': 0,\n      'y': WorkspaceCommentSvg.TOP_OFFSET,\n      'class': 'blocklyCommentForeignObject',\n    });\n    const body = document.createElementNS(dom.HTML_NS, 'body');\n    body.setAttribute('xmlns', dom.HTML_NS);\n    body.className = 'blocklyMinimalBody';\n    const textarea = document.createElementNS(\n      dom.HTML_NS,\n      'textarea'\n    ) as HTMLTextAreaElement;\n    textarea.className = 'blocklyCommentTextarea';\n    textarea.setAttribute('dir', this.RTL ? 'RTL' : 'LTR');\n    textarea.readOnly = !this.isEditable();\n    body.appendChild(textarea);\n    this.textarea = textarea;\n    this.foreignObject.appendChild(body);\n    // Don't zoom with mousewheel.\n    browserEvents.conditionalBind(\n      textarea,\n      'wheel',\n      this,\n      function (e: WheelEvent) {\n        e.stopPropagation();\n      }\n    );\n    browserEvents.conditionalBind(\n      textarea,\n      'change',\n      this,\n      function (this: WorkspaceCommentSvg, _e: Event) {\n        this.setContent(textarea.value);\n      }\n    );\n    return this.foreignObject;\n  }\n\n  /** Add the resize icon to the DOM */\n  private addResizeDom() {\n    this.resizeGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': this.RTL ? 'blocklyResizeSW' : 'blocklyResizeSE'},\n      this.svgGroup\n    );\n    dom.createSvgElement(\n      Svg.POLYGON,\n      {\n        'points': `0,${RESIZE_SIZE} ${RESIZE_SIZE},${RESIZE_SIZE} ${RESIZE_SIZE},0`,\n      },\n      this.resizeGroup\n    );\n    dom.createSvgElement(\n      Svg.LINE,\n      {\n        'class': 'blocklyResizeLine',\n        'x1': RESIZE_SIZE / 3,\n        'y1': RESIZE_SIZE - 1,\n        'x2': RESIZE_SIZE - 1,\n        'y2': RESIZE_SIZE / 3,\n      },\n      this.resizeGroup\n    );\n    dom.createSvgElement(\n      Svg.LINE,\n      {\n        'class': 'blocklyResizeLine',\n        'x1': (RESIZE_SIZE * 2) / 3,\n        'y1': RESIZE_SIZE - 1,\n        'x2': RESIZE_SIZE - 1,\n        'y2': (RESIZE_SIZE * 2) / 3,\n      },\n      this.resizeGroup\n    );\n  }\n\n  /** Add the delete icon to the DOM */\n  private addDeleteDom() {\n    this.deleteGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyCommentDeleteIcon'},\n      this.svgGroup\n    );\n    this.deleteIconBorder = dom.createSvgElement(\n      Svg.CIRCLE,\n      {'class': 'blocklyDeleteIconShape', 'r': '7', 'cx': '7.5', 'cy': '7.5'},\n      this.deleteGroup\n    );\n    // x icon.\n    dom.createSvgElement(\n      Svg.LINE,\n      {\n        'x1': '5',\n        'y1': '10',\n        'x2': '10',\n        'y2': '5',\n        'stroke': '#fff',\n        'stroke-width': '2',\n      },\n      this.deleteGroup\n    );\n    dom.createSvgElement(\n      Svg.LINE,\n      {\n        'x1': '5',\n        'y1': '5',\n        'x2': '10',\n        'y2': '10',\n        'stroke': '#fff',\n        'stroke-width': '2',\n      },\n      this.deleteGroup\n    );\n  }\n\n  /**\n   * Handle a pointerdown on comment's resize corner.\n   *\n   * @param e Pointer down event.\n   */\n  private resizeMouseDown(e: PointerEvent) {\n    this.unbindDragEvents();\n    if (browserEvents.isRightButton(e)) {\n      // No right-click.\n      e.stopPropagation();\n      return;\n    }\n    // Left-click (or middle click)\n    this.workspace.startDrag(\n      e,\n      new Coordinate(\n        this.workspace.RTL ? -this.width_ : this.width_,\n        this.height_\n      )\n    );\n\n    this.onMouseUpWrapper = browserEvents.conditionalBind(\n      document,\n      'pointerup',\n      this,\n      this.resizeMouseUp\n    );\n    this.onMouseMoveWrapper = browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      this,\n      this.resizeMouseMove\n    );\n    this.workspace.hideChaff();\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /**\n   * Handle a pointerdown on comment's delete icon.\n   *\n   * @param e Pointer down event.\n   */\n  private deleteMouseDown(e: PointerEvent) {\n    // Highlight the delete icon.\n    if (this.deleteIconBorder) {\n      dom.addClass(this.deleteIconBorder, 'blocklyDeleteIconHighlighted');\n    }\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /**\n   * Handle a pointerout on comment's delete icon.\n   *\n   * @param _e Pointer out event.\n   */\n  private deleteMouseOut(_e: PointerEvent) {\n    // Restore highlight on the delete icon.\n    if (this.deleteIconBorder) {\n      dom.removeClass(this.deleteIconBorder, 'blocklyDeleteIconHighlighted');\n    }\n  }\n\n  /**\n   * Handle a pointerup on comment's delete icon.\n   *\n   * @param e Pointer up event.\n   */\n  private deleteMouseUp(e: PointerEvent) {\n    // Delete this comment.\n    this.dispose();\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /** Stop binding to the global pointerup and pointermove events. */\n  private unbindDragEvents() {\n    if (this.onMouseUpWrapper) {\n      browserEvents.unbind(this.onMouseUpWrapper);\n      this.onMouseUpWrapper = null;\n    }\n    if (this.onMouseMoveWrapper) {\n      browserEvents.unbind(this.onMouseMoveWrapper);\n      this.onMouseMoveWrapper = null;\n    }\n  }\n\n  /**\n   * Handle a pointerup event while dragging a comment's border or resize\n   * handle.\n   *\n   * @param _e Pointer up event.\n   */\n  private resizeMouseUp(_e: PointerEvent) {\n    Touch.clearTouchIdentifier();\n    this.unbindDragEvents();\n  }\n\n  /**\n   * Resize this comment to follow the pointer.\n   *\n   * @param e Pointer move event.\n   */\n  private resizeMouseMove(e: PointerEvent) {\n    this.autoLayout = false;\n    const newXY = this.workspace.moveDrag(e);\n    this.setSize(this.RTL ? -newXY.x : newXY.x, newXY.y);\n  }\n\n  /**\n   * Callback function triggered when the comment has resized.\n   * Resize the text area accordingly.\n   */\n  private resizeComment() {\n    const size = this.getHeightWidth();\n    const topOffset = WorkspaceCommentSvg.TOP_OFFSET;\n    const textOffset = TEXTAREA_OFFSET * 2;\n\n    this.foreignObject?.setAttribute('width', String(size.width));\n    this.foreignObject?.setAttribute('height', String(size.height - topOffset));\n    if (this.RTL) {\n      this.foreignObject?.setAttribute('x', String(-size.width));\n    }\n\n    if (!this.textarea) return;\n    this.textarea.style.width = size.width - textOffset + 'px';\n    this.textarea.style.height = size.height - textOffset - topOffset + 'px';\n  }\n\n  /**\n   * Set size\n   *\n   * @param width width of the container\n   * @param height height of the container\n   */\n  private setSize(width: number, height: number) {\n    // Minimum size of a comment.\n    width = Math.max(width, 45);\n    height = Math.max(height, 20 + WorkspaceCommentSvg.TOP_OFFSET);\n    this.width_ = width;\n    this.height_ = height;\n    this.svgRect_.setAttribute('width', `${width}`);\n    this.svgRect_.setAttribute('height', `${height}`);\n    this.svgRectTarget?.setAttribute('width', `${width}`);\n    this.svgRectTarget?.setAttribute('height', `${height}`);\n    this.svgHandleTarget?.setAttribute('width', `${width}`);\n    this.svgHandleTarget?.setAttribute(\n      'height',\n      String(WorkspaceCommentSvg.TOP_OFFSET)\n    );\n    if (this.RTL) {\n      this.svgRect_.setAttribute('transform', 'scale(-1 1)');\n      this.svgRectTarget?.setAttribute('transform', 'scale(-1 1)');\n    }\n\n    if (this.resizeGroup) {\n      if (this.RTL) {\n        // Mirror the resize group.\n        this.resizeGroup.setAttribute(\n          'transform',\n          'translate(' +\n            (-width + RESIZE_SIZE) +\n            ',' +\n            (height - RESIZE_SIZE) +\n            ') scale(-1 1)'\n        );\n        this.deleteGroup?.setAttribute(\n          'transform',\n          'translate(' +\n            (-width + RESIZE_SIZE) +\n            ',' +\n            -RESIZE_SIZE +\n            ') scale(-1 1)'\n        );\n      } else {\n        this.resizeGroup.setAttribute(\n          'transform',\n          'translate(' +\n            (width - RESIZE_SIZE) +\n            ',' +\n            (height - RESIZE_SIZE) +\n            ')'\n        );\n        this.deleteGroup?.setAttribute(\n          'transform',\n          'translate(' + (width - RESIZE_SIZE) + ',' + -RESIZE_SIZE + ')'\n        );\n      }\n    }\n\n    // Allow the contents to resize.\n    this.resizeComment();\n  }\n\n  /** Dispose of any rendered comment components. */\n  private disposeInternal() {\n    this.disposed_ = true;\n  }\n\n  /**\n   * Set the focus on the text area.\n   *\n   * @internal\n   */\n  setFocus() {\n    this.focused = true;\n    // Defer CSS changes.\n    setTimeout(() => {\n      if (this.disposed_) {\n        return;\n      }\n      this.textarea!.focus();\n      this.addFocus();\n      if (this.svgRectTarget) {\n        dom.addClass(this.svgRectTarget, 'blocklyCommentTargetFocused');\n      }\n      if (this.svgHandleTarget) {\n        dom.addClass(this.svgHandleTarget, 'blocklyCommentHandleTargetFocused');\n      }\n    }, 0);\n  }\n\n  /**\n   * Remove focus from the text area.\n   *\n   * @internal\n   */\n  blurFocus() {\n    this.focused = false;\n    // Defer CSS changes.\n    setTimeout(() => {\n      if (this.disposed_) {\n        return;\n      }\n\n      this.textarea!.blur();\n      this.removeFocus();\n      if (this.svgRectTarget) {\n        dom.removeClass(this.svgRectTarget, 'blocklyCommentTargetFocused');\n      }\n      if (this.svgHandleTarget) {\n        dom.removeClass(\n          this.svgHandleTarget,\n          'blocklyCommentHandleTargetFocused'\n        );\n      }\n    }, 0);\n  }\n\n  /**\n   * Decode an XML comment tag and create a rendered comment on the workspace.\n   *\n   * @param xmlComment XML comment element.\n   * @param workspace The workspace.\n   * @param opt_wsWidth The width of the workspace, which is used to position\n   *     comments correctly in RTL.\n   * @returns The created workspace comment.\n   * @internal\n   */\n  static fromXmlRendered(\n    xmlComment: Element,\n    workspace: WorkspaceSvg,\n    opt_wsWidth?: number\n  ): WorkspaceCommentSvg {\n    eventUtils.disable();\n    let comment;\n    try {\n      const info = WorkspaceComment.parseAttributes(xmlComment);\n\n      comment = new WorkspaceCommentSvg(\n        workspace,\n        info.content,\n        info.h,\n        info.w,\n        info.id\n      );\n      if (workspace.rendered) {\n        comment.initSvg(true);\n        comment.render();\n      }\n      // Position the comment correctly, taking into account the width of a\n      // rendered RTL workspace.\n      if (!isNaN(info.x) && !isNaN(info.y)) {\n        if (workspace.RTL) {\n          const wsWidth = opt_wsWidth || workspace.getWidth();\n          comment.moveBy(wsWidth - info.x, info.y);\n        } else {\n          comment.moveBy(info.x, info.y);\n        }\n      }\n    } finally {\n      eventUtils.enable();\n    }\n\n    WorkspaceComment.fireCreateEvent(comment);\n    return comment;\n  }\n}\n\n/** CSS for workspace comment.  See css.js for use. */\nCss.register(`\n.blocklyCommentForeignObject {\n  position: relative;\n  z-index: 0;\n}\n\n.blocklyCommentRect {\n  fill: #E7DE8E;\n  stroke: #bcA903;\n  stroke-width: 1px;\n}\n\n.blocklyCommentTarget {\n  fill: transparent;\n  stroke: #bcA903;\n}\n\n.blocklyCommentTargetFocused {\n  fill: none;\n}\n\n.blocklyCommentHandleTarget {\n  fill: none;\n}\n\n.blocklyCommentHandleTargetFocused {\n  fill: transparent;\n}\n\n.blocklyFocused>.blocklyCommentRect {\n  fill: #B9B272;\n  stroke: #B9B272;\n}\n\n.blocklySelected>.blocklyCommentTarget {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCommentDeleteIcon {\n  cursor: pointer;\n  fill: #000;\n  display: none;\n}\n\n.blocklySelected > .blocklyCommentDeleteIcon {\n  display: block;\n}\n\n.blocklyDeleteIconShape {\n  fill: #000;\n  stroke: #000;\n  stroke-width: 1px;\n}\n\n.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {\n  stroke: #fc3;\n}\n`);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization.exceptions');\n\nimport type {Block} from '../block.js';\nimport type {State} from './blocks.js';\n\nexport class DeserializationError extends Error {}\n\n/**\n * Represents an error where the serialized state is expected to provide a\n * block type, but it is not provided.\n *\n */\nexport class MissingBlockType extends DeserializationError {\n  /**\n   * @param state The state object which is missing the block type.\n   * @internal\n   */\n  constructor(public state: State) {\n    super(`Expected to find a 'type' property, defining the block type`);\n  }\n}\n\n/**\n * Represents an error where deserialization encountered a block that did\n * not have a connection that was defined in the serialized state.\n */\nexport class MissingConnection extends DeserializationError {\n  /**\n   * @param connection The name of the connection that is missing. E.g.\n   *     'IF0', or 'next'.\n   * @param block The block missing the connection.\n   * @param state The state object containing the bad connection.\n   * @internal\n   */\n  constructor(connection: string, public block: Block, public state: State) {\n    super(`The block ${block.toDevString()} is missing a(n) ${connection}\nconnection`);\n  }\n}\n\n/**\n * Represents an error where deserialization tried to connect two connections\n * that were not compatible.\n */\nexport class BadConnectionCheck extends DeserializationError {\n  /**\n   * @param reason The reason the connections were not compatible.\n   * @param childConnection The name of the incompatible child connection. E.g.\n   *     'output' or 'previous'.\n   * @param childBlock The child block that could not connect to its parent.\n   * @param childState The state object representing the child block.\n   * @internal\n   */\n  constructor(\n    reason: string,\n    childConnection: string,\n    public childBlock: Block,\n    public childState: State\n  ) {\n    super(`The block ${childBlock.toDevString()} could not connect its\n${childConnection} to its parent, because: ${reason}`);\n  }\n}\n\n/**\n * Represents an error where deserialization encountered a real block as it\n * was deserializing children of a shadow.\n * This is an error because it is an invariant of Blockly that shadow blocks\n * do not have real children.\n */\nexport class RealChildOfShadow extends DeserializationError {\n  /**\n   * @param state The state object representing the real block.\n   * @internal\n   */\n  constructor(public state: State) {\n    super(`Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren`);\n  }\n}\n\nexport class UnregisteredIcon extends DeserializationError {\n  /**\n   * @param iconType The type of the unregistered icon we are attempting to\n   *     deserialize.\n   * @param block The block we are attempting to add the unregistered icon to.\n   * @param state The state object representing the block.\n   */\n  constructor(iconType: string, public block: Block, public state: State) {\n    super(\n      `Cannot add an icon of type '${iconType}' to the block ` +\n        `${block.toDevString()}, because there is no icon registered with ` +\n        `type '${iconType}'. Make sure that all of your icons have been ` +\n        `registered.`\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization.priorities');\n\n/**\n * The priority for deserializing variables.\n */\nexport const VARIABLES = 100;\n\n/**\n * The priority for deserializing variable data.\n */\nexport const PROCEDURES = 75;\n\n/**\n * The priority for deserializing blocks.\n */\nexport const BLOCKS = 50;\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class for all types of block events.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BlockBase');\n\nimport type {Block} from '../block.js';\nimport type {Workspace} from '../workspace.js';\n\nimport {\n  Abstract as AbstractEvent,\n  AbstractEventJson,\n} from './events_abstract.js';\n\n/**\n * Abstract class for any event related to blocks.\n */\nexport class BlockBase extends AbstractEvent {\n  override isBlank = true;\n\n  /** The ID of the block associated with this event. */\n  blockId?: string;\n\n  /**\n   * @param opt_block The block this event corresponds to.\n   *     Undefined for a blank event.\n   */\n  constructor(opt_block?: Block) {\n    super();\n    this.isBlank = !opt_block;\n\n    if (!opt_block) return;\n\n    this.blockId = opt_block.id;\n    this.workspaceId = opt_block.workspace.id;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockBaseJson {\n    const json = super.toJson() as BlockBaseJson;\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['blockId'] = this.blockId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockBase, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockBaseJson,\n    workspace: Workspace,\n    event?: any\n  ): BlockBase {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockBase()\n    ) as BlockBase;\n    newEvent.blockId = json['blockId'];\n    return newEvent;\n  }\n}\n\nexport interface BlockBaseJson extends AbstractEventJson {\n  blockId: string;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block creation event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BlockCreate');\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport * as blocks from '../serialization/blocks.js';\nimport * as utilsXml from '../utils/xml.js';\nimport * as Xml from '../xml.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\nimport {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners when a block (or connected stack of blocks) is\n * created.\n */\nexport class BlockCreate extends BlockBase {\n  override type = eventUtils.BLOCK_CREATE;\n\n  /** The XML representation of the created block(s). */\n  xml?: Element | DocumentFragment;\n\n  /** The JSON respresentation of the created block(s). */\n  json?: blocks.State;\n\n  /** All of the IDs of created blocks. */\n  ids?: string[];\n\n  /** @param opt_block The created block.  Undefined for a blank event. */\n  constructor(opt_block?: Block) {\n    super(opt_block);\n\n    if (!opt_block) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    if (opt_block.isShadow()) {\n      // Moving shadow blocks is handled via disconnection.\n      this.recordUndo = false;\n    }\n\n    this.xml = Xml.blockToDomWithXY(opt_block);\n    this.ids = eventUtils.getDescendantIds(opt_block);\n\n    this.json = blocks.save(opt_block, {addCoordinates: true}) as blocks.State;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockCreateJson {\n    const json = super.toJson() as BlockCreateJson;\n    if (!this.xml) {\n      throw new Error(\n        'The block XML is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.ids) {\n      throw new Error(\n        'The block IDs are undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.json) {\n      throw new Error(\n        'The block JSON is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['xml'] = Xml.domToText(this.xml);\n    json['ids'] = this.ids;\n    json['json'] = this.json;\n    if (!this.recordUndo) {\n      json['recordUndo'] = this.recordUndo;\n    }\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockCreate, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockCreateJson,\n    workspace: Workspace,\n    event?: any\n  ): BlockCreate {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockCreate()\n    ) as BlockCreate;\n    newEvent.xml = utilsXml.textToDom(json['xml']);\n    newEvent.ids = json['ids'];\n    newEvent.json = json['json'] as blocks.State;\n    if (json['recordUndo'] !== undefined) {\n      newEvent.recordUndo = json['recordUndo'];\n    }\n    return newEvent;\n  }\n\n  /**\n   * Run a creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.json) {\n      throw new Error(\n        'The block JSON is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.ids) {\n      throw new Error(\n        'The block IDs are undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (forward) {\n      blocks.append(this.json, workspace);\n    } else {\n      for (let i = 0; i < this.ids.length; i++) {\n        const id = this.ids[i];\n        const block = workspace.getBlockById(id);\n        if (block) {\n          block.dispose(false);\n        } else if (id === this.blockId) {\n          // Only complain about root-level block.\n          console.warn(\"Can't uncreate non-existent block: \" + id);\n        }\n      }\n    }\n  }\n}\n\nexport interface BlockCreateJson extends BlockBaseJson {\n  xml: string;\n  ids: string[];\n  json: object;\n  recordUndo?: boolean;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.CREATE, BlockCreate);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a finished loading workspace event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.FinishedLoading');\n\nimport * as registry from '../registry.js';\nimport type {Workspace} from '../workspace.js';\nimport {Abstract as AbstractEvent} from './events_abstract.js';\nimport * as eventUtils from './utils.js';\n\n/**\n * Notifies listeners when the workspace has finished deserializing from\n * JSON/XML.\n */\nexport class FinishedLoading extends AbstractEvent {\n  override isBlank = true;\n  override recordUndo = false;\n  override type = eventUtils.FINISHED_LOADING;\n\n  /**\n   * @param opt_workspace The workspace that has finished loading.  Undefined\n   *     for a blank event.\n   */\n  constructor(opt_workspace?: Workspace) {\n    super();\n    this.isBlank = !!opt_workspace;\n\n    if (!opt_workspace) return;\n\n    this.workspaceId = opt_workspace.id;\n  }\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.FINISHED_LOADING,\n  FinishedLoading\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block change event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BlockChange');\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport {IconType} from '../icons/icon_types.js';\nimport {hasBubble} from '../interfaces/i_has_bubble.js';\nimport * as registry from '../registry.js';\nimport * as utilsXml from '../utils/xml.js';\nimport {Workspace} from '../workspace.js';\nimport * as Xml from '../xml.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\n\n/**\n * Notifies listeners when some element of a block has changed (e.g.\n * field values, comments, etc).\n */\nexport class BlockChange extends BlockBase {\n  override type = eventUtils.BLOCK_CHANGE;\n  /**\n   * The element that changed; one of 'field', 'comment', 'collapsed',\n   * 'disabled', 'inline', or 'mutation'\n   */\n  element?: string;\n\n  /** The name of the field that changed, if this is a change to a field. */\n  name?: string;\n\n  /** The original value of the element. */\n  oldValue: unknown;\n\n  /** The new value of the element. */\n  newValue: unknown;\n\n  /**\n   * @param opt_block The changed block.  Undefined for a blank event.\n   * @param opt_element One of 'field', 'comment', 'disabled', etc.\n   * @param opt_name Name of input or field affected, or null.\n   * @param opt_oldValue Previous value of element.\n   * @param opt_newValue New value of element.\n   */\n  constructor(\n    opt_block?: Block,\n    opt_element?: string,\n    opt_name?: string | null,\n    opt_oldValue?: unknown,\n    opt_newValue?: unknown\n  ) {\n    super(opt_block);\n\n    if (!opt_block) {\n      return; // Blank event to be populated by fromJson.\n    }\n    this.element = opt_element;\n    this.name = opt_name || undefined;\n    this.oldValue = opt_oldValue;\n    this.newValue = opt_newValue;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockChangeJson {\n    const json = super.toJson() as BlockChangeJson;\n    if (!this.element) {\n      throw new Error(\n        'The changed element is undefined. Either pass an ' +\n          'element to the constructor, or call fromJson'\n      );\n    }\n    json['element'] = this.element;\n    json['name'] = this.name;\n    json['oldValue'] = this.oldValue;\n    json['newValue'] = this.newValue;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockChange, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockChangeJson,\n    workspace: Workspace,\n    event?: any\n  ): BlockChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockChange()\n    ) as BlockChange;\n    newEvent.element = json['element'];\n    newEvent.name = json['name'];\n    newEvent.oldValue = json['oldValue'];\n    newEvent.newValue = json['newValue'];\n    return newEvent;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return this.oldValue === this.newValue;\n  }\n\n  /**\n   * Run a change event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      throw new Error(\n        'The associated block is undefined. Either pass a ' +\n          'block to the constructor, or call fromJson'\n      );\n    }\n    // Assume the block is rendered so that then we can check.\n    const icon = block.getIcon(IconType.MUTATOR);\n    if (icon && hasBubble(icon) && icon.bubbleIsVisible()) {\n      // Close the mutator (if open) since we don't want to update it.\n      icon.setBubbleVisible(false);\n    }\n    const value = forward ? this.newValue : this.oldValue;\n    switch (this.element) {\n      case 'field': {\n        const field = block.getField(this.name!);\n        if (field) {\n          field.setValue(value);\n        } else {\n          console.warn(\"Can't set non-existent field: \" + this.name);\n        }\n        break;\n      }\n      case 'comment':\n        block.setCommentText((value as string) || null);\n        break;\n      case 'collapsed':\n        block.setCollapsed(!!value);\n        break;\n      case 'disabled':\n        block.setEnabled(!value);\n        break;\n      case 'inline':\n        block.setInputsInline(!!value);\n        break;\n      case 'mutation': {\n        const oldState = BlockChange.getExtraBlockState_(block as BlockSvg);\n        if (block.loadExtraState) {\n          block.loadExtraState(JSON.parse((value as string) || '{}'));\n        } else if (block.domToMutation) {\n          block.domToMutation(\n            utilsXml.textToDom((value as string) || '<mutation/>')\n          );\n        }\n        eventUtils.fire(\n          new BlockChange(block, 'mutation', null, oldState, value)\n        );\n        break;\n      }\n      default:\n        console.warn('Unknown change type: ' + this.element);\n    }\n  }\n\n  // TODO (#5397): Encapsulate this in the BlocklyMutationChange event when\n  //    refactoring change events.\n  /**\n   * Returns the extra state of the given block (either as XML or a JSO,\n   * depending on the block's definition).\n   *\n   * @param block The block to get the extra state of.\n   * @returns A stringified version of the extra state of the given block.\n   * @internal\n   */\n  static getExtraBlockState_(block: BlockSvg): string {\n    if (block.saveExtraState) {\n      const state = block.saveExtraState();\n      return state ? JSON.stringify(state) : '';\n    } else if (block.mutationToDom) {\n      const state = block.mutationToDom();\n      return state ? Xml.domToText(state) : '';\n    }\n    return '';\n  }\n}\n\nexport interface BlockChangeJson extends BlockBaseJson {\n  element: string;\n  name?: string;\n  newValue: unknown;\n  oldValue: unknown;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.CHANGE, BlockChange);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block delete event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BlockDelete');\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport * as blocks from '../serialization/blocks.js';\nimport * as utilsXml from '../utils/xml.js';\nimport * as Xml from '../xml.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\nimport {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners when a block (or connected stack of blocks) is\n * deleted.\n */\nexport class BlockDelete extends BlockBase {\n  /** The XML representation of the deleted block(s). */\n  oldXml?: Element | DocumentFragment;\n\n  /** The JSON respresentation of the deleted block(s). */\n  oldJson?: blocks.State;\n\n  /** All of the IDs of deleted blocks. */\n  ids?: string[];\n\n  /** True if the deleted block was a shadow block, false otherwise. */\n  wasShadow?: boolean;\n\n  override type = eventUtils.BLOCK_DELETE;\n\n  /** @param opt_block The deleted block.  Undefined for a blank event. */\n  constructor(opt_block?: Block) {\n    super(opt_block);\n\n    if (!opt_block) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    if (opt_block.getParent()) {\n      throw Error('Connected blocks cannot be deleted.');\n    }\n    if (opt_block.isShadow()) {\n      // Respawning shadow blocks is handled via disconnection.\n      this.recordUndo = false;\n    }\n\n    this.oldXml = Xml.blockToDomWithXY(opt_block);\n    this.ids = eventUtils.getDescendantIds(opt_block);\n    this.wasShadow = opt_block.isShadow();\n    this.oldJson = blocks.save(opt_block, {\n      addCoordinates: true,\n    }) as blocks.State;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockDeleteJson {\n    const json = super.toJson() as BlockDeleteJson;\n    if (!this.oldXml) {\n      throw new Error(\n        'The old block XML is undefined. Either pass a block ' +\n          'to the constructor, or call fromJson'\n      );\n    }\n    if (!this.ids) {\n      throw new Error(\n        'The block IDs are undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (this.wasShadow === undefined) {\n      throw new Error(\n        'Whether the block was a shadow is undefined. Either ' +\n          'pass a block to the constructor, or call fromJson'\n      );\n    }\n    if (!this.oldJson) {\n      throw new Error(\n        'The old block JSON is undefined. Either pass a block ' +\n          'to the constructor, or call fromJson'\n      );\n    }\n    json['oldXml'] = Xml.domToText(this.oldXml);\n    json['ids'] = this.ids;\n    json['wasShadow'] = this.wasShadow;\n    json['oldJson'] = this.oldJson;\n    if (!this.recordUndo) {\n      json['recordUndo'] = this.recordUndo;\n    }\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockDelete, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockDeleteJson,\n    workspace: Workspace,\n    event?: any\n  ): BlockDelete {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockDelete()\n    ) as BlockDelete;\n    newEvent.oldXml = utilsXml.textToDom(json['oldXml']);\n    newEvent.ids = json['ids'];\n    newEvent.wasShadow =\n      json['wasShadow'] || newEvent.oldXml.tagName.toLowerCase() === 'shadow';\n    newEvent.oldJson = json['oldJson'];\n    if (json['recordUndo'] !== undefined) {\n      newEvent.recordUndo = json['recordUndo'];\n    }\n    return newEvent;\n  }\n\n  /**\n   * Run a deletion event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.ids) {\n      throw new Error(\n        'The block IDs are undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.oldJson) {\n      throw new Error(\n        'The old block JSON is undefined. Either pass a block ' +\n          'to the constructor, or call fromJson'\n      );\n    }\n    if (forward) {\n      for (let i = 0; i < this.ids.length; i++) {\n        const id = this.ids[i];\n        const block = workspace.getBlockById(id);\n        if (block) {\n          block.dispose(false);\n        } else if (id === this.blockId) {\n          // Only complain about root-level block.\n          console.warn(\"Can't delete non-existent block: \" + id);\n        }\n      }\n    } else {\n      blocks.append(this.oldJson, workspace);\n    }\n  }\n}\n\nexport interface BlockDeleteJson extends BlockBaseJson {\n  oldXml: string;\n  ids: string[];\n  wasShadow: boolean;\n  oldJson: blocks.State;\n  recordUndo?: boolean;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.DELETE, BlockDelete);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ConnectionType');\n\n/**\n * Enum for the type of a connection or input.\n */\nexport enum ConnectionType {\n  // A right-facing value input.  E.g. 'set item to' or 'return'.\n  INPUT_VALUE = 1,\n  // A left-facing value output.  E.g. 'random fraction'.\n  OUTPUT_VALUE,\n  // A down-facing block stack.  E.g. 'if-do' or 'else'.\n  NEXT_STATEMENT,\n  // An up-facing block stack.  E.g. 'break out of loop'.\n  PREVIOUS_STATEMENT,\n}\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.constants');\n\n/**\n * The language-neutral ID given to the collapsed input.\n */\nexport const COLLAPSED_INPUT_NAME = '_TEMP_COLLAPSED_INPUT';\n\n/**\n * The language-neutral ID given to the collapsed field.\n */\nexport const COLLAPSED_FIELD_NAME = '_TEMP_COLLAPSED_FIELD';\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {IIcon} from '../interfaces/i_icon.js';\n\nexport class DuplicateIconType extends Error {\n  /**\n   * @internal\n   */\n  constructor(public icon: IIcon) {\n    super(\n      `Tried to append an icon of type ${icon.getType()} when an icon of ` +\n        `that type already exists on the block. ` +\n        `Use getIcon to access the existing icon.`\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object in charge of managing markers and the cursor.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.MarkerManager');\n\nimport type {Cursor} from './keyboard_nav/cursor.js';\nimport type {Marker} from './keyboard_nav/marker.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class to manage the multiple markers and the cursor on a workspace.\n */\nexport class MarkerManager {\n  /** The name of the local marker. */\n  static readonly LOCAL_MARKER = 'local_marker_1';\n\n  /** The cursor. */\n  private cursor_: Cursor | null = null;\n\n  /** The cursor's SVG element. */\n  private cursorSvg_: SVGElement | null = null;\n\n  /** The map of markers for the workspace. */\n  private markers = new Map<string, Marker>();\n\n  /** The marker's SVG element. */\n  private markerSvg_: SVGElement | null = null;\n\n  /**\n   * @param workspace The workspace for the marker manager.\n   * @internal\n   */\n  constructor(private readonly workspace: WorkspaceSvg) {}\n\n  /**\n   * Register the marker by adding it to the map of markers.\n   *\n   * @param id A unique identifier for the marker.\n   * @param marker The marker to register.\n   */\n  registerMarker(id: string, marker: Marker) {\n    if (this.markers.has(id)) {\n      this.unregisterMarker(id);\n    }\n    marker.setDrawer(\n      this.workspace.getRenderer().makeMarkerDrawer(this.workspace, marker)\n    );\n    this.setMarkerSvg(marker.getDrawer().createDom());\n    this.markers.set(id, marker);\n  }\n\n  /**\n   * Unregister the marker by removing it from the map of markers.\n   *\n   * @param id The ID of the marker to unregister.\n   */\n  unregisterMarker(id: string) {\n    const marker = this.markers.get(id);\n    if (marker) {\n      marker.dispose();\n      this.markers.delete(id);\n    } else {\n      throw Error(\n        'Marker with ID ' +\n          id +\n          ' does not exist. ' +\n          'Can only unregister markers that exist.'\n      );\n    }\n  }\n\n  /**\n   * Get the cursor for the workspace.\n   *\n   * @returns The cursor for this workspace.\n   */\n  getCursor(): Cursor | null {\n    return this.cursor_;\n  }\n\n  /**\n   * Get a single marker that corresponds to the given ID.\n   *\n   * @param id A unique identifier for the marker.\n   * @returns The marker that corresponds to the given ID, or null if none\n   *     exists.\n   */\n  getMarker(id: string): Marker | null {\n    return this.markers.get(id) || null;\n  }\n\n  /**\n   * Sets the cursor and initializes the drawer for use with keyboard\n   * navigation.\n   *\n   * @param cursor The cursor used to move around this workspace.\n   */\n  setCursor(cursor: Cursor) {\n    if (this.cursor_ && this.cursor_.getDrawer()) {\n      this.cursor_.getDrawer().dispose();\n    }\n    this.cursor_ = cursor;\n    if (this.cursor_) {\n      const drawer = this.workspace\n        .getRenderer()\n        .makeMarkerDrawer(this.workspace, this.cursor_);\n      this.cursor_.setDrawer(drawer);\n      this.setCursorSvg(this.cursor_.getDrawer().createDom());\n    }\n  }\n\n  /**\n   * Add the cursor SVG to this workspace SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement | null) {\n    if (!cursorSvg) {\n      this.cursorSvg_ = null;\n      return;\n    }\n\n    this.workspace.getBlockCanvas()!.appendChild(cursorSvg);\n    this.cursorSvg_ = cursorSvg;\n  }\n\n  /**\n   * Add the marker SVG to this workspaces SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the workspace\n   *     SVG group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement | null) {\n    if (!markerSvg) {\n      this.markerSvg_ = null;\n      return;\n    }\n\n    if (this.workspace.getBlockCanvas()) {\n      if (this.cursorSvg_) {\n        this.workspace\n          .getBlockCanvas()!\n          .insertBefore(markerSvg, this.cursorSvg_);\n      } else {\n        this.workspace.getBlockCanvas()!.appendChild(markerSvg);\n      }\n    }\n  }\n\n  /**\n   * Redraw the attached cursor SVG if needed.\n   *\n   * @internal\n   */\n  updateMarkers() {\n    if (this.workspace.keyboardAccessibilityMode && this.cursorSvg_) {\n      this.workspace.getCursor()!.draw();\n    }\n  }\n\n  /**\n   * Dispose of the marker manager.\n   * Go through and delete all markers associated with this marker manager.\n   *\n   * @internal\n   */\n  dispose() {\n    const markerIds = Object.keys(this.markers);\n    for (let i = 0, markerId; (markerId = markerIds[i]); i++) {\n      this.unregisterMarker(markerId);\n    }\n    this.markers.clear();\n    if (this.cursor_) {\n      this.cursor_.dispose();\n      this.cursor_ = null;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Field.  Used for editable titles, variables, etc.\n * This is an abstract class that defines the UI on the block.  Actual\n * instances would be FieldTextInput, FieldDropdown, etc.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Field');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Input} from './inputs/input.js';\nimport type {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport type {IASTNodeLocationWithBlock} from './interfaces/i_ast_node_location_with_block.js';\nimport type {IKeyboardAccessible} from './interfaces/i_keyboard_accessible.js';\nimport type {IRegistrable} from './interfaces/i_registrable.js';\nimport {MarkerManager} from './marker_manager.js';\nimport type {ConstantProvider} from './renderers/common/constants.js';\nimport type {KeyboardShortcut} from './shortcut_registry.js';\nimport * as Tooltip from './tooltip.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport * as style from './utils/style.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as utilsXml from './utils/xml.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {ISerializable} from './interfaces/i_serializable.js';\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldValidator<T = any> = (newValue: T) => T | null | undefined;\n\n/**\n * Abstract class for an editable field.\n *\n * @typeParam T - The value stored on the field.\n */\nexport abstract class Field<T = any>\n  implements\n    IASTNodeLocationSvg,\n    IASTNodeLocationWithBlock,\n    IKeyboardAccessible,\n    IRegistrable,\n    ISerializable\n{\n  /**\n   * To overwrite the default value which is set in **Field**, directly update\n   * the prototype.\n   *\n   * Example:\n   * ```typescript\n   * FieldImage.prototype.DEFAULT_VALUE = null;\n   * ```\n   */\n  DEFAULT_VALUE: T | null = null;\n\n  /** Non-breaking space. */\n  static readonly NBSP = '\\u00A0';\n\n  /**\n   * A value used to signal when a field's constructor should *not* set the\n   * field's value or run configure_, and should allow a subclass to do that\n   * instead.\n   */\n  static readonly SKIP_SETUP = Symbol('SKIP_SETUP');\n\n  /**\n   * Name of field.  Unique within each block.\n   * Static labels are usually unnamed.\n   */\n  name?: string = undefined;\n  protected value_: T | null;\n\n  /** Validation function called when user edits an editable field. */\n  protected validator_: FieldValidator<T> | null = null;\n\n  /**\n   * Used to cache the field's tooltip value if setTooltip is called when the\n   * field is not yet initialized. Is *not* guaranteed to be accurate.\n   */\n  private tooltip_: Tooltip.TipInfo | null = null;\n  protected size_: Size;\n\n  /**\n   * Holds the cursors svg element when the cursor is attached to the field.\n   * This is null if there is no cursor on the field.\n   */\n  private cursorSvg_: SVGElement | null = null;\n\n  /**\n   * Holds the markers svg element when the marker is attached to the field.\n   * This is null if there is no marker on the field.\n   */\n  private markerSvg_: SVGElement | null = null;\n\n  /** The rendered field's SVG group element. */\n  protected fieldGroup_: SVGGElement | null = null;\n\n  /** The rendered field's SVG border element. */\n  protected borderRect_: SVGRectElement | null = null;\n\n  /** The rendered field's SVG text element. */\n  protected textElement_: SVGTextElement | null = null;\n\n  /** The rendered field's text content element. */\n  protected textContent_: Text | null = null;\n\n  /** Mouse down event listener data. */\n  private mouseDownWrapper_: browserEvents.Data | null = null;\n\n  /** Constants associated with the source block's renderer. */\n  protected constants_: ConstantProvider | null = null;\n\n  /**\n   * Has this field been disposed of?\n   *\n   * @internal\n   */\n  disposed = false;\n\n  /** Maximum characters of text to display before adding an ellipsis. */\n  maxDisplayLength = 50;\n\n  /** Block this field is attached to.  Starts as null, then set in init. */\n  protected sourceBlock_: Block | null = null;\n\n  /** Does this block need to be re-rendered? */\n  protected isDirty_ = true;\n\n  /** Is the field visible, or hidden due to the block being collapsed? */\n  protected visible_ = true;\n\n  /**\n   * Can the field value be changed using the editor on an editable block?\n   */\n  protected enabled_ = true;\n\n  /** The element the click handler is bound to. */\n  protected clickTarget_: Element | null = null;\n\n  /**\n   * The prefix field.\n   *\n   * @internal\n   */\n  prefixField: string | null = null;\n\n  /**\n   * The suffix field.\n   *\n   * @internal\n   */\n  suffixField: string | null = null;\n\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. They will also be saved by the serializer.\n   */\n  EDITABLE = true;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable. This is not the\n   * case by default so that SERIALIZABLE is backwards compatible.\n   */\n  SERIALIZABLE = false;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  CURSOR = '';\n\n  /**\n   * @param value The initial value of the field.\n   *     Also accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   * subclasses that want to handle configuration and setting the field value\n   * after their own constructors have run).\n   * @param validator  A function that is called to validate changes to the\n   *     field's value. Takes in a value & returns a validated value, or null to\n   *     abort the change.\n   * @param config A map of options used to configure the field.\n   *    Refer to the individual field's documentation for a list of properties\n   * this parameter supports.\n   */\n  constructor(\n    value: T | typeof Field.SKIP_SETUP,\n    validator?: FieldValidator<T> | null,\n    config?: FieldConfig\n  ) {\n    /**\n     * A generic value possessed by the field.\n     * Should generally be non-null, only null when the field is created.\n     */\n    this.value_ =\n      'DEFAULT_VALUE' in new.target.prototype\n        ? new.target.prototype.DEFAULT_VALUE\n        : this.DEFAULT_VALUE;\n\n    /** The size of the area rendered by the field. */\n    this.size_ = new Size(0, 0);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Process the configuration map passed to the field.\n   *\n   * @param config A map of options used to configure the field. See the\n   *     individual field's documentation for a list of properties this\n   *     parameter supports.\n   */\n  protected configure_(config: FieldConfig) {\n    // TODO (#2884): Possibly add CSS class config option.\n    // TODO (#2885): Possibly add cursor config option.\n    if (config.tooltip) {\n      this.setTooltip(parsing.replaceMessageReferences(config.tooltip));\n    }\n  }\n\n  /**\n   * Attach this field to a block.\n   *\n   * @param block The block containing this field.\n   */\n  setSourceBlock(block: Block) {\n    if (this.sourceBlock_) {\n      throw Error('Field already bound to a block');\n    }\n    this.sourceBlock_ = block;\n  }\n\n  /**\n   * Get the renderer constant provider.\n   *\n   * @returns The renderer constant provider.\n   */\n  getConstants(): ConstantProvider | null {\n    if (\n      !this.constants_ &&\n      this.sourceBlock_ &&\n      !this.sourceBlock_.isDeadOrDying() &&\n      this.sourceBlock_.workspace.rendered\n    ) {\n      this.constants_ = (this.sourceBlock_.workspace as WorkspaceSvg)\n        .getRenderer()\n        .getConstants();\n    }\n    return this.constants_;\n  }\n\n  /**\n   * Get the block this field is attached to.\n   *\n   * @returns The block containing this field.\n   * @throws An error if the source block is not defined.\n   */\n  getSourceBlock(): Block | null {\n    return this.sourceBlock_;\n  }\n\n  /**\n   * Initialize everything to render this field. Override\n   * methods initModel and initView rather than this method.\n   *\n   * @sealed\n   * @internal\n   */\n  init() {\n    if (this.fieldGroup_) {\n      // Field has already been initialized once.\n      return;\n    }\n    this.fieldGroup_ = dom.createSvgElement(Svg.G, {});\n    if (!this.isVisible()) {\n      this.fieldGroup_.style.display = 'none';\n    }\n    const sourceBlockSvg = this.sourceBlock_ as BlockSvg;\n    sourceBlockSvg.getSvgRoot().appendChild(this.fieldGroup_);\n    this.initView();\n    this.updateEditable();\n    this.setTooltip(this.tooltip_);\n    this.bindEvents_();\n    this.initModel();\n  }\n\n  /**\n   * Create the block UI for this field.\n   *\n   * @internal\n   */\n  initView() {\n    this.createBorderRect_();\n    this.createTextElement_();\n  }\n\n  /**\n   * Initializes the model of the field after it has been installed on a block.\n   * No-op by default.\n   *\n   * @internal\n   */\n  initModel() {}\n\n  /**\n   * Create a field border rect element. Not to be overridden by subclasses.\n   * Instead modify the result of the function inside initView, or create a\n   * separate function to call.\n   */\n  protected createBorderRect_() {\n    this.borderRect_ = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'rx': this.getConstants()!.FIELD_BORDER_RECT_RADIUS,\n        'ry': this.getConstants()!.FIELD_BORDER_RECT_RADIUS,\n        'x': 0,\n        'y': 0,\n        'height': this.size_.height,\n        'width': this.size_.width,\n        'class': 'blocklyFieldRect',\n      },\n      this.fieldGroup_\n    );\n  }\n\n  /**\n   * Create a field text element. Not to be overridden by subclasses. Instead\n   * modify the result of the function inside initView, or create a separate\n   * function to call.\n   */\n  protected createTextElement_() {\n    this.textElement_ = dom.createSvgElement(\n      Svg.TEXT,\n      {\n        'class': 'blocklyText',\n      },\n      this.fieldGroup_\n    );\n    if (this.getConstants()!.FIELD_TEXT_BASELINE_CENTER) {\n      this.textElement_.setAttribute('dominant-baseline', 'central');\n    }\n    this.textContent_ = document.createTextNode('');\n    this.textElement_.appendChild(this.textContent_);\n  }\n\n  /**\n   * Bind events to the field. Can be overridden by subclasses if they need to\n   * do custom input handling.\n   */\n  protected bindEvents_() {\n    const clickTarget = this.getClickTarget_();\n    if (!clickTarget) throw new Error('A click target has not been set.');\n    Tooltip.bindMouseEvents(clickTarget);\n    this.mouseDownWrapper_ = browserEvents.conditionalBind(\n      clickTarget,\n      'pointerdown',\n      this,\n      this.onMouseDown_\n    );\n  }\n\n  /**\n   * Sets the field's value based on the given XML element. Should only be\n   * called by Blockly.Xml.\n   *\n   * @param fieldElement The element containing info about the field's state.\n   * @internal\n   */\n  fromXml(fieldElement: Element) {\n    // Any because gremlins live here. No touchie!\n    this.setValue(fieldElement.textContent as any);\n  }\n\n  /**\n   * Serializes this field's value to XML. Should only be called by Blockly.Xml.\n   *\n   * @param fieldElement The element to populate with info about the field's\n   *     state.\n   * @returns The element containing info about the field's state.\n   * @internal\n   */\n  toXml(fieldElement: Element): Element {\n    // Any because gremlins live here. No touchie!\n    fieldElement.textContent = this.getValue() as any;\n    return fieldElement;\n  }\n\n  /**\n   * Saves this fields value as something which can be serialized to JSON.\n   * Should only be called by the serialization system.\n   *\n   * @param _doFullSerialization If true, this signals to the field that if it\n   *     normally just saves a reference to some state (eg variable fields) it\n   *     should instead serialize the full state of the thing being referenced.\n   * @returns JSON serializable state.\n   * @internal\n   */\n  saveState(_doFullSerialization?: boolean): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(Field);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    return this.getValue();\n  }\n\n  /**\n   * Sets the field's state based on the given state value. Should only be\n   * called by the serialization system.\n   *\n   * @param state The state we want to apply to the field.\n   * @internal\n   */\n  loadState(state: AnyDuringMigration) {\n    if (this.loadLegacyState(Field, state)) {\n      return;\n    }\n    this.setValue(state);\n  }\n\n  /**\n   * Returns a stringified version of the XML state, if it should be used.\n   * Otherwise this returns null, to signal the field should use its own\n   * serialization.\n   *\n   * @param callingClass The class calling this method.\n   *     Used to see if `this` has overridden any relevant hooks.\n   * @returns The stringified version of the XML state, or null.\n   */\n  protected saveLegacyState(callingClass: FieldProto): string | null {\n    if (\n      callingClass.prototype.saveState === this.saveState &&\n      callingClass.prototype.toXml !== this.toXml\n    ) {\n      const elem = utilsXml.createElement('field');\n      elem.setAttribute('name', this.name || '');\n      const text = utilsXml.domToText(this.toXml(elem));\n      return text.replace(\n        ' xmlns=\"https://developers.google.com/blockly/xml\"',\n        ''\n      );\n    }\n    // Either they called this on purpose from their saveState, or they have\n    // no implementations of either hook. Just do our thing.\n    return null;\n  }\n\n  /**\n   * Loads the given state using either the old XML hooks, if they should be\n   * used. Returns true to indicate loading has been handled, false otherwise.\n   *\n   * @param callingClass The class calling this method.\n   *     Used to see if `this` has overridden any relevant hooks.\n   * @param state The state to apply to the field.\n   * @returns Whether the state was applied or not.\n   */\n  loadLegacyState(\n    callingClass: FieldProto,\n    state: AnyDuringMigration\n  ): boolean {\n    if (\n      callingClass.prototype.loadState === this.loadState &&\n      callingClass.prototype.fromXml !== this.fromXml\n    ) {\n      this.fromXml(utilsXml.textToDom(state as string));\n      return true;\n    }\n    // Either they called this on purpose from their loadState, or they have\n    // no implementations of either hook. Just do our thing.\n    return false;\n  }\n\n  /**\n   * Dispose of all DOM objects and events belonging to this editable field.\n   *\n   * @internal\n   */\n  dispose() {\n    dropDownDiv.hideIfOwner(this);\n    WidgetDiv.hideIfOwner(this);\n\n    if (!this.getSourceBlock()?.isDeadOrDying()) {\n      dom.removeNode(this.fieldGroup_);\n    }\n\n    this.disposed = true;\n  }\n\n  /** Add or remove the UI indicating if this field is editable or not. */\n  updateEditable() {\n    const group = this.fieldGroup_;\n    const block = this.getSourceBlock();\n    if (!this.EDITABLE || !group || !block) {\n      return;\n    }\n    if (this.enabled_ && block.isEditable()) {\n      dom.addClass(group, 'blocklyEditableText');\n      dom.removeClass(group, 'blocklyNonEditableText');\n      group.style.cursor = this.CURSOR;\n    } else {\n      dom.addClass(group, 'blocklyNonEditableText');\n      dom.removeClass(group, 'blocklyEditableText');\n      group.style.cursor = '';\n    }\n  }\n\n  /**\n   * Set whether this field's value can be changed using the editor when the\n   *     source block is editable.\n   *\n   * @param enabled True if enabled.\n   */\n  setEnabled(enabled: boolean) {\n    this.enabled_ = enabled;\n    this.updateEditable();\n  }\n\n  /**\n   * Check whether this field's value can be changed using the editor when the\n   *     source block is editable.\n   *\n   * @returns Whether this field is enabled.\n   */\n  isEnabled(): boolean {\n    return this.enabled_;\n  }\n\n  /**\n   * Check whether this field defines the showEditor_ function.\n   *\n   * @returns Whether this field is clickable.\n   */\n  isClickable(): boolean {\n    return (\n      this.enabled_ &&\n      !!this.sourceBlock_ &&\n      this.sourceBlock_.isEditable() &&\n      this.showEditor_ !== Field.prototype.showEditor_\n    );\n  }\n\n  /**\n   * Check whether this field is currently editable.  Some fields are never\n   * EDITABLE (e.g. text labels). Other fields may be EDITABLE but may exist on\n   * non-editable blocks or be currently disabled.\n   *\n   * @returns Whether this field is currently enabled, editable and on an\n   *     editable block.\n   */\n  isCurrentlyEditable(): boolean {\n    return (\n      this.enabled_ &&\n      this.EDITABLE &&\n      !!this.sourceBlock_ &&\n      this.sourceBlock_.isEditable()\n    );\n  }\n\n  /**\n   * Check whether this field should be serialized by the XML renderer.\n   * Handles the logic for backwards compatibility and incongruous states.\n   *\n   * @returns Whether this field should be serialized or not.\n   */\n  isSerializable(): boolean {\n    let isSerializable = false;\n    if (this.name) {\n      if (this.SERIALIZABLE) {\n        isSerializable = true;\n      } else if (this.EDITABLE) {\n        console.warn(\n          'Detected an editable field that was not serializable.' +\n            ' Please define SERIALIZABLE property as true on all editable custom' +\n            ' fields. Proceeding with serialization.'\n        );\n        isSerializable = true;\n      }\n    }\n    return isSerializable;\n  }\n\n  /**\n   * Gets whether this editable field is visible or not.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.visible_;\n  }\n\n  /**\n   * Sets whether this editable field is visible or not. Should only be called\n   * by input.setVisible.\n   *\n   * @param visible True if visible.\n   * @internal\n   */\n  setVisible(visible: boolean) {\n    if (this.visible_ === visible) {\n      return;\n    }\n    this.visible_ = visible;\n    const root = this.fieldGroup_;\n    if (root) {\n      root.style.display = visible ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Sets a new validation function for editable fields, or clears a previously\n   * set validator.\n   *\n   * The validator function takes in the new field value, and returns\n   * validated value. The validated value could be the input value, a modified\n   * version of the input value, or null to abort the change.\n   *\n   * If the function does not return anything (or returns undefined) the new\n   * value is accepted as valid. This is to allow for fields using the\n   * validated function as a field-level change event notification.\n   *\n   * @param handler The validator function or null to clear a previous\n   *     validator.\n   */\n  setValidator(handler: FieldValidator<T>) {\n    this.validator_ = handler;\n  }\n\n  /**\n   * Gets the validation function for editable fields, or null if not set.\n   *\n   * @returns Validation function, or null.\n   */\n  getValidator(): FieldValidator<T> | null {\n    return this.validator_;\n  }\n\n  /**\n   * Gets the group element for this editable field.\n   * Used for measuring the size and for positioning.\n   *\n   * @returns The group element.\n   */\n  getSvgRoot(): SVGGElement | null {\n    return this.fieldGroup_;\n  }\n\n  /**\n   * Gets the border rectangle element.\n   *\n   * @returns The border rectangle element.\n   * @throws An error if the border rectangle element is not defined.\n   */\n  protected getBorderRect(): SVGRectElement {\n    if (!this.borderRect_) {\n      throw new Error(`The border rectangle is ${this.borderRect_}.`);\n    }\n    return this.borderRect_;\n  }\n\n  /**\n   * Gets the text element.\n   *\n   * @returns The text element.\n   * @throws An error if the text element is not defined.\n   */\n  protected getTextElement(): SVGTextElement {\n    if (!this.textElement_) {\n      throw new Error(`The text element is ${this.textElement_}.`);\n    }\n    return this.textElement_;\n  }\n\n  /**\n   * Gets the text content.\n   *\n   * @returns The text content.\n   * @throws An error if the text content is not defined.\n   */\n  protected getTextContent(): Text {\n    if (!this.textContent_) {\n      throw new Error(`The text content is ${this.textContent_}.`);\n    }\n    return this.textContent_;\n  }\n\n  /**\n   * Updates the field to match the colour/style of the block.\n   *\n   * Non-abstract sub-classes may wish to implement this if the colour of the\n   * field depends on the colour of the block. It will automatically be called\n   * at relevant times, such as when the parent block or renderer changes.\n   *\n   * See {@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/customizing-fields/creating#matching_block_colours\n   * | the field documentation} for more information, or FieldDropdown for an\n   * example.\n   */\n  applyColour() {}\n\n  /**\n   * Used by getSize() to move/resize any DOM elements, and get the new size.\n   *\n   * All rendering that has an effect on the size/shape of the block should be\n   * done here, and should be triggered by getSize().\n   */\n  protected render_() {\n    if (this.textContent_) {\n      this.textContent_.nodeValue = this.getDisplayText_();\n    }\n    this.updateSize_();\n  }\n\n  /**\n   * Calls showEditor_ when the field is clicked if the field is clickable.\n   * Do not override.\n   *\n   * @param e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   * @sealed\n   * @internal\n   */\n  showEditor(e?: Event) {\n    if (this.isClickable()) {\n      this.showEditor_(e);\n    }\n  }\n\n  /**\n   * A developer hook to create an editor for the field. This is no-op by\n   * default, and must be overriden to create an editor.\n   *\n   * @param _e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   */\n  protected showEditor_(_e?: Event): void {}\n  // NOP\n\n  /**\n   * A developer hook to reposition the WidgetDiv during a window resize. You\n   * need to define this hook if your field has a WidgetDiv that needs to\n   * reposition itself when the window is resized. For example, text input\n   * fields define this hook so that the input WidgetDiv can reposition itself\n   * on a window resize event. This is especially important when modal inputs\n   * have been disabled, as Android devices will fire a window resize event when\n   * the soft keyboard opens.\n   *\n   * If you want the WidgetDiv to hide itself instead of repositioning, return\n   * false. This is the default behavior.\n   *\n   * DropdownDivs already handle their own positioning logic, so you do not need\n   * to override this function if your field only has a DropdownDiv.\n   *\n   * @returns True if the field should be repositioned,\n   *    false if the WidgetDiv should hide itself instead.\n   */\n  repositionForWindowResize(): boolean {\n    return false;\n  }\n\n  /**\n   * Updates the size of the field based on the text.\n   *\n   * @param margin margin to use when positioning the text element.\n   */\n  protected updateSize_(margin?: number) {\n    const constants = this.getConstants();\n    const xOffset =\n      margin !== undefined\n        ? margin\n        : this.borderRect_\n        ? this.getConstants()!.FIELD_BORDER_RECT_X_PADDING\n        : 0;\n    let totalWidth = xOffset * 2;\n    let totalHeight = constants!.FIELD_TEXT_HEIGHT;\n\n    let contentWidth = 0;\n    if (this.textElement_) {\n      contentWidth = dom.getFastTextWidth(\n        this.textElement_,\n        constants!.FIELD_TEXT_FONTSIZE,\n        constants!.FIELD_TEXT_FONTWEIGHT,\n        constants!.FIELD_TEXT_FONTFAMILY\n      );\n      totalWidth += contentWidth;\n    }\n    if (this.borderRect_) {\n      totalHeight = Math.max(totalHeight, constants!.FIELD_BORDER_RECT_HEIGHT);\n    }\n\n    this.size_.height = totalHeight;\n    this.size_.width = totalWidth;\n\n    this.positionTextElement_(xOffset, contentWidth);\n    this.positionBorderRect_();\n  }\n\n  /**\n   * Position a field's text element after a size change.  This handles both LTR\n   * and RTL positioning.\n   *\n   * @param xOffset x offset to use when positioning the text element.\n   * @param contentWidth The content width.\n   */\n  protected positionTextElement_(xOffset: number, contentWidth: number) {\n    if (!this.textElement_) {\n      return;\n    }\n    const constants = this.getConstants();\n    const halfHeight = this.size_.height / 2;\n\n    this.textElement_.setAttribute(\n      'x',\n      String(\n        this.getSourceBlock()?.RTL\n          ? this.size_.width - contentWidth - xOffset\n          : xOffset\n      )\n    );\n    this.textElement_.setAttribute(\n      'y',\n      String(\n        constants!.FIELD_TEXT_BASELINE_CENTER\n          ? halfHeight\n          : halfHeight -\n              constants!.FIELD_TEXT_HEIGHT / 2 +\n              constants!.FIELD_TEXT_BASELINE\n      )\n    );\n  }\n\n  /** Position a field's border rect after a size change. */\n  protected positionBorderRect_() {\n    if (!this.borderRect_) {\n      return;\n    }\n    this.borderRect_.setAttribute('width', String(this.size_.width));\n    this.borderRect_.setAttribute('height', String(this.size_.height));\n    this.borderRect_.setAttribute(\n      'rx',\n      String(this.getConstants()!.FIELD_BORDER_RECT_RADIUS)\n    );\n    this.borderRect_.setAttribute(\n      'ry',\n      String(this.getConstants()!.FIELD_BORDER_RECT_RADIUS)\n    );\n  }\n\n  /**\n   * Returns the height and width of the field.\n   *\n   * This should *in general* be the only place render_ gets called from.\n   *\n   * @returns Height and width.\n   */\n  getSize(): Size {\n    if (!this.isVisible()) {\n      return new Size(0, 0);\n    }\n\n    if (this.isDirty_) {\n      this.render_();\n      this.isDirty_ = false;\n    } else if (this.visible_ && this.size_.width === 0) {\n      // If the field is not visible the width will be 0 as well, one of the\n      // problems with the old system.\n      this.render_();\n      // Don't issue a warning if the field is actually zero width.\n      if (this.size_.width !== 0) {\n        console.warn(\n          'Deprecated use of setting size_.width to 0 to rerender a' +\n            ' field. Set field.isDirty_ to true instead.'\n        );\n      }\n    }\n    return this.size_;\n  }\n\n  /**\n   * Returns the bounding box of the rendered field, accounting for workspace\n   * scaling.\n   *\n   * @returns An object with top, bottom, left, and right in pixels relative to\n   *     the top left corner of the page (window coordinates).\n   * @internal\n   */\n  getScaledBBox(): Rect {\n    let scaledWidth;\n    let scaledHeight;\n    let xy;\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n\n    if (!this.borderRect_) {\n      // Browsers are inconsistent in what they return for a bounding box.\n      // - Webkit / Blink: fill-box / object bounding box\n      // - Gecko: stroke-box\n      const bBox = (this.sourceBlock_ as BlockSvg).getHeightWidth();\n      const scale = (block.workspace as WorkspaceSvg).scale;\n      xy = this.getAbsoluteXY_();\n      scaledWidth = (bBox.width + 1) * scale;\n      scaledHeight = (bBox.height + 1) * scale;\n\n      if (userAgent.GECKO) {\n        xy.x += 1.5 * scale;\n        xy.y += 1.5 * scale;\n      } else {\n        xy.x -= 0.5 * scale;\n        xy.y -= 0.5 * scale;\n      }\n    } else {\n      const bBox = this.borderRect_.getBoundingClientRect();\n      xy = style.getPageOffset(this.borderRect_);\n      scaledWidth = bBox.width;\n      scaledHeight = bBox.height;\n    }\n    return new Rect(xy.y, xy.y + scaledHeight, xy.x, xy.x + scaledWidth);\n  }\n\n  /**\n   * Get the text from this field to display on the block. May differ from\n   * `getText` due to ellipsis, and other formatting.\n   *\n   * @returns Text to display.\n   */\n  protected getDisplayText_(): string {\n    let text = this.getText();\n    if (!text) {\n      // Prevent the field from disappearing if empty.\n      return Field.NBSP;\n    }\n    if (text.length > this.maxDisplayLength) {\n      // Truncate displayed string and add an ellipsis ('...').\n      text = text.substring(0, this.maxDisplayLength - 2) + '…';\n    }\n    // Replace whitespace with non-breaking spaces so the text doesn't collapse.\n    text = text.replace(/\\s/g, Field.NBSP);\n    if (this.sourceBlock_ && this.sourceBlock_.RTL) {\n      // The SVG is LTR, force text to be RTL by adding an RLM.\n      text += '\\u200F';\n    }\n    return text;\n  }\n\n  /**\n   * Get the text from this field.\n   * Override getText_ to provide a different behavior than simply casting the\n   * value to a string.\n   *\n   * @returns Current text.\n   * @sealed\n   */\n  getText(): string {\n    // this.getText_ was intended so that devs don't have to remember to call\n    // super when overriding how the text of the field is generated. (#2910)\n    const text = this.getText_();\n    if (text !== null) {\n      return String(text);\n    }\n    return String(this.getValue());\n  }\n\n  /**\n   * A developer hook to override the returned text of this field.\n   * Override if the text representation of the value of this field\n   * is not just a string cast of its value.\n   * Return null to resort to a string cast.\n   *\n   * @returns Current text or null.\n   */\n  protected getText_(): string | null {\n    return null;\n  }\n\n  /**\n   * Force a rerender of the block that this field is installed on, which will\n   * rerender this field and adjust for any sizing changes.\n   * Other fields on the same block will not rerender, because their sizes have\n   * already been recorded.\n   *\n   * @internal\n   */\n  markDirty() {\n    this.isDirty_ = true;\n    this.constants_ = null;\n  }\n\n  /**\n   * Force a rerender of the block that this field is installed on, which will\n   * rerender this field and adjust for any sizing changes.\n   * Other fields on the same block will not rerender, because their sizes have\n   * already been recorded.\n   *\n   * @internal\n   */\n  forceRerender() {\n    this.isDirty_ = true;\n    if (this.sourceBlock_ && this.sourceBlock_.rendered) {\n      (this.sourceBlock_ as BlockSvg).queueRender();\n      (this.sourceBlock_ as BlockSvg).bumpNeighbours();\n    }\n  }\n\n  /**\n   * Used to change the value of the field. Handles validation and events.\n   * Subclasses should override doClassValidation_ and doValueUpdate_ rather\n   * than this method.\n   *\n   * @param newValue New value.\n   * @sealed\n   */\n  setValue(newValue: AnyDuringMigration) {\n    const doLogging = false;\n    if (newValue === null) {\n      doLogging && console.log('null, return');\n      // Not a valid value to check.\n      return;\n    }\n\n    const classValidation = this.doClassValidation_(newValue);\n    const classValue = this.processValidation_(newValue, classValidation);\n    if (classValue instanceof Error) {\n      doLogging && console.log('invalid class validation, return');\n      return;\n    }\n\n    const localValidation = this.getValidator()?.call(this, classValue);\n    const localValue = this.processValidation_(classValue, localValidation);\n    if (localValue instanceof Error) {\n      doLogging && console.log('invalid local validation, return');\n      return;\n    }\n\n    const source = this.sourceBlock_;\n    if (source && source.disposed) {\n      doLogging && console.log('source disposed, return');\n      return;\n    }\n\n    const oldValue = this.getValue();\n    if (oldValue === localValue) {\n      doLogging && console.log('same, doValueUpdate_, return');\n      this.doValueUpdate_(localValue);\n      return;\n    }\n\n    this.doValueUpdate_(localValue);\n    if (source && eventUtils.isEnabled()) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          source,\n          'field',\n          this.name || null,\n          oldValue,\n          localValue\n        )\n      );\n    }\n    if (this.isDirty_) {\n      this.forceRerender();\n    }\n    doLogging && console.log(this.value_);\n  }\n\n  /**\n   * Process the result of validation.\n   *\n   * @param newValue New value.\n   * @param validatedValue Validated value.\n   * @returns New value, or an Error object.\n   */\n  private processValidation_(\n    newValue: AnyDuringMigration,\n    validatedValue: T | null | undefined\n  ): T | Error {\n    if (validatedValue === null) {\n      this.doValueInvalid_(newValue);\n      if (this.isDirty_) {\n        this.forceRerender();\n      }\n      return Error();\n    }\n    return validatedValue === undefined ? (newValue as T) : validatedValue;\n  }\n\n  /**\n   * Get the current value of the field.\n   *\n   * @returns Current value.\n   */\n  getValue(): T | null {\n    return this.value_;\n  }\n\n  /**\n   * Validate the changes to a field's value before they are set. See\n   * **FieldDropdown** for an example of subclass implementation.\n   *\n   * **NOTE:** Validation returns one option between `T`, `null`, and\n   * `undefined`. **Field**'s implementation will never return `undefined`, but\n   * it is valid for a subclass to return `undefined` if the new value is\n   * compatible with `T`.\n   *\n   * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n   * @param newValue - The value to be validated.\n   * @returns One of three instructions for setting the new value: `T`, `null`,\n   * or `undefined`.\n   *\n   * - `T` to set this function's returned value instead of `newValue`.\n   *\n   * - `null` to invoke `doValueInvalid_` and not set a value.\n   *\n   * - `undefined` to set `newValue` as is.\n   */\n  protected doClassValidation_(newValue: T): T | null | undefined;\n  protected doClassValidation_(newValue?: AnyDuringMigration): T | null;\n  protected doClassValidation_(\n    newValue?: T | AnyDuringMigration\n  ): T | null | undefined {\n    if (newValue === null || newValue === undefined) {\n      return null;\n    }\n\n    return newValue as T;\n  }\n\n  /**\n   * Used to update the value of a field. Can be overridden by subclasses to do\n   * custom storage of values/updating of external things.\n   *\n   * @param newValue The value to be saved.\n   */\n  protected doValueUpdate_(newValue: T) {\n    this.value_ = newValue;\n    this.isDirty_ = true;\n  }\n\n  /**\n   * Used to notify the field an invalid value was input. Can be overridden by\n   * subclasses, see FieldTextInput.\n   * No-op by default.\n   *\n   * @param _invalidValue The input value that was determined to be invalid.\n   */\n  protected doValueInvalid_(_invalidValue: AnyDuringMigration) {}\n  // NOP\n\n  /**\n   * Handle a pointerdown event on a field.\n   *\n   * @param e Pointer down event.\n   */\n  protected onMouseDown_(e: PointerEvent) {\n    if (!this.sourceBlock_ || this.sourceBlock_.isDeadOrDying()) {\n      return;\n    }\n    const gesture = (this.sourceBlock_.workspace as WorkspaceSvg).getGesture(e);\n    if (gesture) {\n      gesture.setStartField(this);\n    }\n  }\n\n  /**\n   * Sets the tooltip for this field.\n   *\n   * @param newTip The text for the tooltip, a function that returns the text\n   *     for the tooltip, a parent object whose tooltip will be used, or null to\n   *     display the tooltip of the parent block. To not display a tooltip pass\n   *     the empty string.\n   */\n  setTooltip(newTip: Tooltip.TipInfo | null) {\n    if (!newTip && newTip !== '') {\n      // If null or undefined.\n      newTip = this.sourceBlock_;\n    }\n    const clickTarget = this.getClickTarget_();\n    if (clickTarget) {\n      (clickTarget as AnyDuringMigration).tooltip = newTip;\n    } else {\n      // Field has not been initialized yet.\n      this.tooltip_ = newTip;\n    }\n  }\n\n  /**\n   * Returns the tooltip text for this field.\n   *\n   * @returns The tooltip text for this field.\n   */\n  getTooltip(): string {\n    const clickTarget = this.getClickTarget_();\n    if (clickTarget) {\n      return Tooltip.getTooltipOfObject(clickTarget);\n    }\n    // Field has not been initialized yet. Return stashed this.tooltip_ value.\n    return Tooltip.getTooltipOfObject({tooltip: this.tooltip_});\n  }\n\n  /**\n   * The element to bind the click handler to. If not set explicitly, defaults\n   * to the SVG root of the field. When this element is\n   * clicked on an editable field, the editor will open.\n   *\n   * @returns Element to bind click handler to.\n   */\n  protected getClickTarget_(): Element | null {\n    return this.clickTarget_ || this.getSvgRoot();\n  }\n\n  /**\n   * Return the absolute coordinates of the top-left corner of this field.\n   * The origin (0,0) is the top-left corner of the page body.\n   *\n   * @returns Object with .x and .y properties.\n   */\n  protected getAbsoluteXY_(): Coordinate {\n    return style.getPageOffset(this.getClickTarget_() as SVGRectElement);\n  }\n\n  /**\n   * Whether this field references any Blockly variables.  If true it may need\n   * to be handled differently during serialization and deserialization.\n   * Subclasses may override this.\n   *\n   * @returns True if this field has any variable references.\n   * @internal\n   */\n  referencesVariables(): boolean {\n    return false;\n  }\n\n  /**\n   * Refresh the variable name referenced by this field if this field references\n   * variables.\n   *\n   * @internal\n   */\n  refreshVariableName() {}\n  // NOP\n\n  /**\n   * Search through the list of inputs and their fields in order to find the\n   * parent input of a field.\n   *\n   * @returns The input that the field belongs to.\n   * @internal\n   */\n  getParentInput(): Input {\n    let parentInput = null;\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const inputs = block.inputList;\n\n    for (let idx = 0; idx < block.inputList.length; idx++) {\n      const input = inputs[idx];\n      const fieldRows = input.fieldRow;\n      for (let j = 0; j < fieldRows.length; j++) {\n        if (fieldRows[j] === this) {\n          parentInput = input;\n          break;\n        }\n      }\n    }\n    return parentInput!;\n  }\n\n  /**\n   * Returns whether or not we should flip the field in RTL.\n   *\n   * @returns True if we should flip in RTL.\n   */\n  getFlipRtl(): boolean {\n    return false;\n  }\n\n  /**\n   * Returns whether or not the field is tab navigable.\n   *\n   * @returns True if the field is tab navigable.\n   */\n  isTabNavigable(): boolean {\n    return false;\n  }\n\n  /**\n   * Handles the given keyboard shortcut.\n   *\n   * @param _shortcut The shortcut to be handled.\n   * @returns True if the shortcut has been handled, false otherwise.\n   */\n  onShortcut(_shortcut: KeyboardShortcut): boolean {\n    return false;\n  }\n\n  /**\n   * Add the cursor SVG to this fields SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the field group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    if (!cursorSvg) {\n      this.cursorSvg_ = null;\n      return;\n    }\n\n    if (!this.fieldGroup_) {\n      throw new Error(`The field group is ${this.fieldGroup_}.`);\n    }\n    this.fieldGroup_.appendChild(cursorSvg);\n    this.cursorSvg_ = cursorSvg;\n  }\n\n  /**\n   * Add the marker SVG to this fields SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the field group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    if (!markerSvg) {\n      this.markerSvg_ = null;\n      return;\n    }\n\n    if (!this.fieldGroup_) {\n      throw new Error(`The field group is ${this.fieldGroup_}.`);\n    }\n    this.fieldGroup_.appendChild(markerSvg);\n    this.markerSvg_ = markerSvg;\n  }\n\n  /**\n   * Redraw any attached marker or cursor svgs if needed.\n   *\n   * @internal\n   */\n  updateMarkers_() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const workspace = block.workspace as WorkspaceSvg;\n    if (workspace.keyboardAccessibilityMode && this.cursorSvg_) {\n      workspace.getCursor()!.draw();\n    }\n    if (workspace.keyboardAccessibilityMode && this.markerSvg_) {\n      // TODO(#4592): Update all markers on the field.\n      workspace.getMarker(MarkerManager.LOCAL_MARKER)!.draw();\n    }\n  }\n}\n\n/**\n * Extra configuration options for the base field.\n */\nexport interface FieldConfig {\n  tooltip?: string;\n}\n\n/**\n * For use by Field and descendants of Field. Constructors can change\n * in descendants, though they should contain all of Field's prototype methods.\n *\n * @internal\n */\nexport type FieldProto = Pick<typeof Field, 'prototype'>;\n\n/**\n * Represents an error where the field is trying to access its block or\n * information about its block before it has actually been attached to said\n * block.\n */\nexport class UnattachedFieldError extends Error {\n  /** @internal */\n  constructor() {\n    super(\n      'The field has not yet been attached to its input. ' +\n        'Call appendField to attach it.'\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Blockly menu similar to Closure's goog.ui.Menu\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Menu');\n\nimport * as browserEvents from './browser_events.js';\nimport type {MenuItem} from './menuitem.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {Size} from './utils/size.js';\nimport * as style from './utils/style.js';\n\n/**\n * A basic menu class.\n */\nexport class Menu {\n  /**\n   * Array of menu items.\n   * (Nulls are never in the array, but typing the array as nullable prevents\n   * the compiler from objecting to .indexOf(null))\n   */\n  private readonly menuItems: MenuItem[] = [];\n\n  /**\n   * Coordinates of the mousedown event that caused this menu to open. Used to\n   * prevent the consequent mouseup event due to a simple click from\n   * activating a menu item immediately.\n   */\n  openingCoords: Coordinate | null = null;\n\n  /**\n   * This is the element that we will listen to the real focus events on.\n   * A value of null means no menu item is highlighted.\n   */\n  private highlightedItem: MenuItem | null = null;\n\n  /** Mouse over event data. */\n  private mouseOverHandler: browserEvents.Data | null = null;\n\n  /** Click event data. */\n  private clickHandler: browserEvents.Data | null = null;\n\n  /** Mouse enter event data. */\n  private mouseEnterHandler: browserEvents.Data | null = null;\n\n  /** Mouse leave event data. */\n  private mouseLeaveHandler: browserEvents.Data | null = null;\n\n  /** Key down event data. */\n  private onKeyDownHandler: browserEvents.Data | null = null;\n\n  /** The menu's root DOM element. */\n  private element: HTMLDivElement | null = null;\n\n  /** ARIA name for this menu. */\n  private roleName: aria.Role | null = null;\n\n  /** Constructs a new Menu instance. */\n  constructor() {}\n\n  /**\n   * Add a new menu item to the bottom of this menu.\n   *\n   * @param menuItem Menu item to append.\n   * @internal\n   */\n  addChild(menuItem: MenuItem) {\n    this.menuItems.push(menuItem);\n  }\n\n  /**\n   * Creates the menu DOM.\n   *\n   * @param container Element upon which to append this menu.\n   * @returns The menu's root DOM element.\n   */\n  render(container: Element): HTMLDivElement {\n    const element = document.createElement('div');\n    // goog-menu is deprecated, use blocklyMenu.  May 2020.\n    element.className = 'blocklyMenu goog-menu blocklyNonSelectable';\n    element.tabIndex = 0;\n    if (this.roleName) {\n      aria.setRole(element, this.roleName);\n    }\n    this.element = element;\n\n    // Add menu items.\n    for (let i = 0, menuItem; (menuItem = this.menuItems[i]); i++) {\n      element.appendChild(menuItem.createDom());\n    }\n\n    // Add event handlers.\n    this.mouseOverHandler = browserEvents.conditionalBind(\n      element,\n      'pointerover',\n      this,\n      this.handleMouseOver,\n      true\n    );\n    this.clickHandler = browserEvents.conditionalBind(\n      element,\n      'pointerup',\n      this,\n      this.handleClick,\n      true\n    );\n    this.mouseEnterHandler = browserEvents.conditionalBind(\n      element,\n      'pointerenter',\n      this,\n      this.handleMouseEnter,\n      true\n    );\n    this.mouseLeaveHandler = browserEvents.conditionalBind(\n      element,\n      'pointerleave',\n      this,\n      this.handleMouseLeave,\n      true\n    );\n    this.onKeyDownHandler = browserEvents.conditionalBind(\n      element,\n      'keydown',\n      this,\n      this.handleKeyEvent\n    );\n\n    container.appendChild(element);\n    return element;\n  }\n\n  /**\n   * Gets the menu's element.\n   *\n   * @returns The DOM element.\n   * @internal\n   */\n  getElement(): HTMLDivElement | null {\n    return this.element;\n  }\n\n  /**\n   * Focus the menu element.\n   *\n   * @internal\n   */\n  focus() {\n    const el = this.getElement();\n    if (el) {\n      el.focus({preventScroll: true});\n      dom.addClass(el, 'blocklyFocused');\n    }\n  }\n\n  /** Blur the menu element. */\n  private blur() {\n    const el = this.getElement();\n    if (el) {\n      el.blur();\n      dom.removeClass(el, 'blocklyFocused');\n    }\n  }\n\n  /**\n   * Set the menu accessibility role.\n   *\n   * @param roleName role name.\n   * @internal\n   */\n  setRole(roleName: aria.Role) {\n    this.roleName = roleName;\n  }\n\n  /** Dispose of this menu. */\n  dispose() {\n    // Remove event handlers.\n    if (this.mouseOverHandler) {\n      browserEvents.unbind(this.mouseOverHandler);\n      this.mouseOverHandler = null;\n    }\n    if (this.clickHandler) {\n      browserEvents.unbind(this.clickHandler);\n      this.clickHandler = null;\n    }\n    if (this.mouseEnterHandler) {\n      browserEvents.unbind(this.mouseEnterHandler);\n      this.mouseEnterHandler = null;\n    }\n    if (this.mouseLeaveHandler) {\n      browserEvents.unbind(this.mouseLeaveHandler);\n      this.mouseLeaveHandler = null;\n    }\n    if (this.onKeyDownHandler) {\n      browserEvents.unbind(this.onKeyDownHandler);\n      this.onKeyDownHandler = null;\n    }\n\n    // Remove menu items.\n    for (let i = 0, menuItem; (menuItem = this.menuItems[i]); i++) {\n      menuItem.dispose();\n    }\n    this.element = null;\n  }\n\n  // Child component management.\n\n  /**\n   * Returns the child menu item that owns the given DOM element,\n   * or null if no such menu item is found.\n   *\n   * @param elem DOM element whose owner is to be returned.\n   * @returns Menu item for which the DOM element belongs to.\n   */\n  private getMenuItem(elem: Element): MenuItem | null {\n    const menuElem = this.getElement();\n    // Node might be the menu border (resulting in no associated menu item), or\n    // a menu item's div, or some element within the menu item.\n    // Walk up parents until one meets either the menu's root element, or\n    // a menu item's div.\n    let currentElement: Element | null = elem;\n    while (currentElement && currentElement !== menuElem) {\n      if (currentElement.classList.contains('blocklyMenuItem')) {\n        // Having found a menu item's div, locate that menu item in this menu.\n        for (let i = 0, menuItem; (menuItem = this.menuItems[i]); i++) {\n          if (menuItem.getElement() === currentElement) {\n            return menuItem;\n          }\n        }\n      }\n      currentElement = currentElement.parentElement;\n    }\n    return null;\n  }\n\n  // Highlight management.\n\n  /**\n   * Highlights the given menu item, or clears highlighting if null.\n   *\n   * @param item Item to highlight, or null.\n   * @internal\n   */\n  setHighlighted(item: MenuItem | null) {\n    const currentHighlighted = this.highlightedItem;\n    if (currentHighlighted) {\n      currentHighlighted.setHighlighted(false);\n      this.highlightedItem = null;\n    }\n    if (item) {\n      item.setHighlighted(true);\n      this.highlightedItem = item;\n      // Bring the highlighted item into view. This has no effect if the menu is\n      // not scrollable.\n      const el = this.getElement() as Element;\n      style.scrollIntoContainerView(item.getElement() as Element, el);\n\n      aria.setState(el, aria.State.ACTIVEDESCENDANT, item.getId());\n    }\n  }\n\n  /**\n   * Highlights the next highlightable item (or the first if nothing is\n   * currently highlighted).\n   *\n   * @internal\n   */\n  highlightNext() {\n    const index = this.highlightedItem\n      ? this.menuItems.indexOf(this.highlightedItem)\n      : -1;\n    this.highlightHelper(index, 1);\n  }\n\n  /**\n   * Highlights the previous highlightable item (or the last if nothing is\n   * currently highlighted).\n   *\n   * @internal\n   */\n  highlightPrevious() {\n    const index = this.highlightedItem\n      ? this.menuItems.indexOf(this.highlightedItem)\n      : -1;\n    this.highlightHelper(index < 0 ? this.menuItems.length : index, -1);\n  }\n\n  /** Highlights the first highlightable item. */\n  private highlightFirst() {\n    this.highlightHelper(-1, 1);\n  }\n\n  /** Highlights the last highlightable item. */\n  private highlightLast() {\n    this.highlightHelper(this.menuItems.length, -1);\n  }\n\n  /**\n   * Helper function that manages the details of moving the highlight among\n   * child menuitems in response to keyboard events.\n   *\n   * @param startIndex Start index.\n   * @param delta Step direction: 1 to go down, -1 to go up.\n   */\n  private highlightHelper(startIndex: number, delta: number) {\n    let index = startIndex + delta;\n    let menuItem;\n    while ((menuItem = this.menuItems[index])) {\n      if (menuItem.isEnabled()) {\n        this.setHighlighted(menuItem);\n        break;\n      }\n      index += delta;\n    }\n  }\n\n  // Mouse events.\n\n  /**\n   * Handles mouseover events. Highlight menuitems as the user hovers over them.\n   *\n   * @param e Mouse event to handle.\n   */\n  private handleMouseOver(e: PointerEvent) {\n    const menuItem = this.getMenuItem(e.target as Element);\n\n    if (menuItem) {\n      if (menuItem.isEnabled()) {\n        if (this.highlightedItem !== menuItem) {\n          this.setHighlighted(menuItem);\n        }\n      } else {\n        this.setHighlighted(null);\n      }\n    }\n  }\n\n  /**\n   * Handles click events. Pass the event onto the child menuitem to handle.\n   *\n   * @param e Click event to handle.\n   */\n  private handleClick(e: PointerEvent) {\n    const oldCoords = this.openingCoords;\n    // Clear out the saved opening coords immediately so they're not used twice.\n    this.openingCoords = null;\n    if (oldCoords && typeof e.clientX === 'number') {\n      const newCoords = new Coordinate(e.clientX, e.clientY);\n      if (Coordinate.distance(oldCoords, newCoords) < 1) {\n        // This menu was opened by a mousedown and we're handling the consequent\n        // click event. The coords haven't changed, meaning this was the same\n        // opening event. Don't do the usual behavior because the menu just\n        // popped up under the mouse and the user didn't mean to activate this\n        // item.\n        return;\n      }\n    }\n\n    const menuItem = this.getMenuItem(e.target as Element);\n    if (menuItem) {\n      menuItem.performAction();\n    }\n  }\n\n  /**\n   * Handles mouse enter events. Focus the element.\n   *\n   * @param _e Mouse event to handle.\n   */\n  private handleMouseEnter(_e: PointerEvent) {\n    this.focus();\n  }\n\n  /**\n   * Handles mouse leave events. Blur and clear highlight.\n   *\n   * @param _e Mouse event to handle.\n   */\n  private handleMouseLeave(_e: PointerEvent) {\n    if (this.getElement()) {\n      this.blur();\n      this.setHighlighted(null);\n    }\n  }\n\n  // Keyboard events.\n\n  /**\n   * Attempts to handle a keyboard event, if the menu item is enabled, by\n   * calling\n   * {@link Menu#handleKeyEventInternal_}.\n   *\n   * @param e Key event to handle.\n   */\n  private handleKeyEvent(e: Event) {\n    if (!this.menuItems.length) {\n      // Empty menu.\n      return;\n    }\n    const keyboardEvent = e as KeyboardEvent;\n    if (\n      keyboardEvent.shiftKey ||\n      keyboardEvent.ctrlKey ||\n      keyboardEvent.metaKey ||\n      keyboardEvent.altKey\n    ) {\n      // Do not handle the key event if any modifier key is pressed.\n      return;\n    }\n\n    const highlighted = this.highlightedItem;\n    switch (keyboardEvent.key) {\n      case 'Enter':\n      case ' ':\n        if (highlighted) {\n          highlighted.performAction();\n        }\n        break;\n\n      case 'ArrowUp':\n        this.highlightPrevious();\n        break;\n\n      case 'ArrowDown':\n        this.highlightNext();\n        break;\n\n      case 'PageUp':\n      case 'Home':\n        this.highlightFirst();\n        break;\n\n      case 'PageDown':\n      case 'End':\n        this.highlightLast();\n        break;\n\n      default:\n        // Not a key the menu is interested in.\n        return;\n    }\n    // The menu used this key, don't let it have secondary effects.\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  /**\n   * Get the size of a rendered menu.\n   *\n   * @returns Object with width and height properties.\n   * @internal\n   */\n  getSize(): Size {\n    const menuDom = this.getElement() as HTMLDivElement;\n    const menuSize = style.getSize(menuDom);\n    // Recalculate height for the total content, not only box height.\n    menuSize.height = menuDom.scrollHeight;\n    return menuSize;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Blockly menu item similar to Closure's goog.ui.MenuItem\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.MenuItem');\n\nimport * as aria from './utils/aria.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\n\n/**\n * Class representing an item in a menu.\n */\nexport class MenuItem {\n  /** Is the menu item clickable, as opposed to greyed-out. */\n  private enabled = true;\n\n  /** The DOM element for the menu item. */\n  private element: HTMLDivElement | null = null;\n\n  /** Whether the menu item is rendered right-to-left. */\n  private rightToLeft = false;\n\n  /** ARIA name for this menu. */\n  private roleName: aria.Role | null = null;\n\n  /** Is this menu item checkable. */\n  private checkable = false;\n\n  /** Is this menu item currently checked. */\n  private checked = false;\n\n  /** Is this menu item currently highlighted. */\n  private highlight = false;\n\n  /** Bound function to call when this menu item is clicked. */\n  private actionHandler: Function | null = null;\n\n  /**\n   * @param content Text caption to display as the content of the item, or a\n   *     HTML element to display.\n   * @param opt_value Data/model associated with the menu item.\n   */\n  constructor(\n    private readonly content: string | HTMLElement,\n    private readonly opt_value?: string\n  ) {}\n\n  /**\n   * Creates the menuitem's DOM.\n   *\n   * @returns Completed DOM.\n   */\n  createDom(): Element {\n    const element = document.createElement('div');\n    element.id = idGenerator.getNextUniqueId();\n    this.element = element;\n\n    // Set class and style\n    // goog-menuitem* is deprecated, use blocklyMenuItem*.  May 2020.\n    element.className =\n      'blocklyMenuItem goog-menuitem ' +\n      (this.enabled ? '' : 'blocklyMenuItemDisabled goog-menuitem-disabled ') +\n      (this.checked ? 'blocklyMenuItemSelected goog-option-selected ' : '') +\n      (this.highlight\n        ? 'blocklyMenuItemHighlight goog-menuitem-highlight '\n        : '') +\n      (this.rightToLeft ? 'blocklyMenuItemRtl goog-menuitem-rtl ' : '');\n\n    const content = document.createElement('div');\n    content.className = 'blocklyMenuItemContent goog-menuitem-content';\n    // Add a checkbox for checkable menu items.\n    if (this.checkable) {\n      const checkbox = document.createElement('div');\n      checkbox.className = 'blocklyMenuItemCheckbox goog-menuitem-checkbox';\n      content.appendChild(checkbox);\n    }\n\n    let contentDom: Node = this.content as HTMLElement;\n    if (typeof this.content === 'string') {\n      contentDom = document.createTextNode(this.content);\n    }\n    content.appendChild(contentDom);\n    element.appendChild(content);\n\n    // Initialize ARIA role and state.\n    if (this.roleName) {\n      aria.setRole(element, this.roleName);\n    }\n    aria.setState(\n      element,\n      aria.State.SELECTED,\n      (this.checkable && this.checked) || false\n    );\n    aria.setState(element, aria.State.DISABLED, !this.enabled);\n\n    return element;\n  }\n\n  /** Dispose of this menu item. */\n  dispose() {\n    this.element = null;\n  }\n\n  /**\n   * Gets the menu item's element.\n   *\n   * @returns The DOM element.\n   * @internal\n   */\n  getElement(): Element | null {\n    return this.element;\n  }\n\n  /**\n   * Gets the unique ID for this menu item.\n   *\n   * @returns Unique component ID.\n   * @internal\n   */\n  getId(): string {\n    return this.element!.id;\n  }\n\n  /**\n   * Gets the value associated with the menu item.\n   *\n   * @returns value Value associated with the menu item.\n   * @internal\n   */\n  getValue(): string | null {\n    return this.opt_value ?? null;\n  }\n\n  /**\n   * Set menu item's rendering direction.\n   *\n   * @param rtl True if RTL, false if LTR.\n   * @internal\n   */\n  setRightToLeft(rtl: boolean) {\n    this.rightToLeft = rtl;\n  }\n\n  /**\n   * Set the menu item's accessibility role.\n   *\n   * @param roleName Role name.\n   * @internal\n   */\n  setRole(roleName: aria.Role) {\n    this.roleName = roleName;\n  }\n\n  /**\n   * Sets the menu item to be checkable or not. Set to true for menu items\n   * that represent checkable options.\n   *\n   * @param checkable Whether the menu item is checkable.\n   * @internal\n   */\n  setCheckable(checkable: boolean) {\n    this.checkable = checkable;\n  }\n\n  /**\n   * Checks or unchecks the component.\n   *\n   * @param checked Whether to check or uncheck the component.\n   * @internal\n   */\n  setChecked(checked: boolean) {\n    this.checked = checked;\n  }\n\n  /**\n   * Highlights or unhighlights the component.\n   *\n   * @param highlight Whether to highlight or unhighlight the component.\n   * @internal\n   */\n  setHighlighted(highlight: boolean) {\n    this.highlight = highlight;\n\n    const el = this.getElement();\n    if (el && this.isEnabled()) {\n      // goog-menuitem-highlight is deprecated, use blocklyMenuItemHighlight.\n      // May 2020.\n      const name = 'blocklyMenuItemHighlight';\n      const nameDep = 'goog-menuitem-highlight';\n      if (highlight) {\n        dom.addClass(el, name);\n        dom.addClass(el, nameDep);\n      } else {\n        dom.removeClass(el, name);\n        dom.removeClass(el, nameDep);\n      }\n    }\n  }\n\n  /**\n   * Returns true if the menu item is enabled, false otherwise.\n   *\n   * @returns Whether the menu item is enabled.\n   * @internal\n   */\n  isEnabled(): boolean {\n    return this.enabled;\n  }\n\n  /**\n   * Enables or disables the menu item.\n   *\n   * @param enabled Whether to enable or disable the menu item.\n   * @internal\n   */\n  setEnabled(enabled: boolean) {\n    this.enabled = enabled;\n  }\n\n  /**\n   * Performs the appropriate action when the menu item is activated\n   * by the user.\n   *\n   * @internal\n   */\n  performAction() {\n    if (this.isEnabled() && this.actionHandler) {\n      this.actionHandler(this);\n    }\n  }\n\n  /**\n   * Set the handler that's called when the menu item is activated by the user.\n   * `obj` will be used as the 'this' object in the function when called.\n   *\n   * @param fn The handler.\n   * @param obj Used as the 'this' object in fn when called.\n   * @internal\n   */\n  onAction(fn: (p1: MenuItem) => void, obj: object) {\n    this.actionHandler = fn.bind(obj);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport * as browserEvents from '../browser_events.js';\nimport {hasBubble} from '../interfaces/i_has_bubble.js';\nimport type {IIcon} from '../interfaces/i_icon.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport type {IconType} from './icon_types.js';\n\nexport abstract class Icon implements IIcon {\n  /**\n   * The position of this icon relative to its blocks top-start,\n   * in workspace units.\n   */\n  protected offsetInBlock: Coordinate = new Coordinate(0, 0);\n\n  /** The position of this icon in workspace coordinates. */\n  protected workspaceLocation: Coordinate = new Coordinate(0, 0);\n\n  /** The root svg element visually representing this icon. */\n  protected svgRoot: SVGGElement | null = null;\n\n  constructor(protected sourceBlock: Block) {}\n\n  getType(): IconType<IIcon> {\n    throw new Error('Icons must implement getType');\n  }\n\n  initView(pointerdownListener: (e: PointerEvent) => void): void {\n    if (this.svgRoot) return; // The icon has already been initialized.\n\n    const svgBlock = this.sourceBlock as BlockSvg;\n    this.svgRoot = dom.createSvgElement(Svg.G, {'class': 'blocklyIconGroup'});\n    svgBlock.getSvgRoot().appendChild(this.svgRoot);\n    this.updateSvgRootOffset();\n    browserEvents.conditionalBind(\n      this.svgRoot,\n      'pointerdown',\n      this,\n      pointerdownListener\n    );\n  }\n\n  dispose(): void {\n    dom.removeNode(this.svgRoot);\n  }\n\n  getWeight(): number {\n    return -1;\n  }\n\n  getSize(): Size {\n    return new Size(0, 0);\n  }\n\n  applyColour(): void {}\n\n  updateEditable(): void {}\n\n  updateCollapsed(): void {\n    if (!this.svgRoot) return;\n    if (this.sourceBlock.isCollapsed()) {\n      this.svgRoot.style.display = 'none';\n    } else {\n      this.svgRoot.style.display = 'block';\n    }\n    if (hasBubble(this)) {\n      this.setBubbleVisible(false);\n    }\n  }\n\n  hideForInsertionMarker(): void {\n    if (!this.svgRoot) return;\n    this.svgRoot.style.display = 'none';\n  }\n\n  isShownWhenCollapsed(): boolean {\n    return false;\n  }\n\n  setOffsetInBlock(offset: Coordinate): void {\n    this.offsetInBlock = offset;\n    this.updateSvgRootOffset();\n  }\n\n  private updateSvgRootOffset(): void {\n    this.svgRoot?.setAttribute(\n      'transform',\n      `translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`\n    );\n  }\n\n  onLocationChange(blockOrigin: Coordinate): void {\n    this.workspaceLocation = Coordinate.sum(blockOrigin, this.offsetInBlock);\n  }\n\n  onClick(): void {}\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a scrollbar.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Scrollbar');\n\nimport * as browserEvents from './browser_events.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * A note on units: most of the numbers that are in CSS pixels are scaled if the\n * scrollbar is in a mutator.\n */\n\n/**\n * Class for a pure SVG scrollbar.\n * This technique offers a scrollbar that is guaranteed to work, but may not\n * look or behave like the system's scrollbars.\n */\nexport class Scrollbar {\n  /**\n   * Width of vertical scrollbar or height of horizontal scrollbar in CSS\n   * pixels. Scrollbars should be larger on touch devices.\n   */\n  static scrollbarThickness = Touch.TOUCH_ENABLED ? 25 : 15;\n\n  /**\n   * Default margin around the scrollbar (between the scrollbar and the edge of\n   * the viewport in pixels).\n   *\n   * @internal\n   */\n  static readonly DEFAULT_SCROLLBAR_MARGIN = 0.5;\n\n  /** Whether this scrollbar is part of a pair. */\n  private readonly pair: boolean;\n\n  /**\n   * Margin around the scrollbar (between the scrollbar and the edge of the\n   * viewport in pixels).\n   */\n  private readonly margin: number;\n\n  /** Previously recorded metrics from the workspace. */\n  private oldHostMetrics: Metrics | null = null;\n\n  /**\n   * The ratio of handle position offset to workspace content displacement.\n   *\n   * @internal\n   */\n  ratio = 1;\n\n  /**\n   * The location of the origin of the workspace that the scrollbar is in,\n   * measured in CSS pixels relative to the injection div origin.  This is\n   * usually (0, 0).  When the scrollbar is in a flyout it may have a\n   * different origin.\n   */\n  private origin = new Coordinate(0, 0);\n\n  /**\n   * The position of the mouse along this scrollbar's major axis at the start\n   * of the most recent drag. Units are CSS pixels, with (0, 0) at the top\n   * left of the browser window. For a horizontal scrollbar this is the x\n   * coordinate of the mouse down event; for a vertical scrollbar it's the y\n   * coordinate of the mouse down event.\n   */\n  private startDragMouse = 0;\n\n  /**\n   * The length of the scrollbars (including the handle and the background),\n   * in CSS pixels. This is equivalent to scrollbar background length and the\n   * area within which the scrollbar handle can move.\n   */\n  private scrollbarLength = 0;\n\n  /** The length of the scrollbar handle in CSS pixels. */\n  private handleLength = 0;\n\n  /**\n   * The offset of the start of the handle from the scrollbar position, in CSS\n   * pixels.\n   */\n  private handlePosition = 0;\n\n  private startDragHandle = 0;\n\n  /** Whether the scrollbar handle is visible. */\n  private isHandleVisible = true;\n\n  /** Whether the workspace containing this scrollbar is visible. */\n  private containerVisible = true;\n\n  /** The transparent background behind the handle. */\n  private svgBackground: SVGRectElement;\n\n  /** The visible handle that can be dragged around. */\n  private svgHandle: SVGRectElement;\n\n  /** The outermost SVG element, which contains all parts of the scrollbar. */\n  private outerSvg: SVGSVGElement;\n\n  /**\n   * The upper left corner of the scrollbar's SVG group in CSS pixels relative\n   * to the scrollbar's origin.  This is usually relative to the injection div\n   * origin.\n   *\n   * @internal\n   */\n  position = new Coordinate(0, 0);\n\n  /**\n   * The DOM attribute that controls the length of the scrollbar. Different\n   * for horizontal and vertical scrollbars.\n   */\n  lengthAttribute_: string;\n\n  /**\n   * The DOM attribute that controls the position of the scrollbar.\n   * Different for horizontal and vertical scrollbars.\n   */\n  positionAttribute_: string;\n\n  /** Handler for mouse down events on the background of the scrollbar. */\n  onMouseDownBarWrapper_: browserEvents.Data;\n\n  /** Handler for mouse down events on the handle of the scrollbar. */\n  onMouseDownHandleWrapper_: browserEvents.Data;\n\n  /** Handler for mouse move events during scrollbar drags. */\n  onMouseUpWrapper_: browserEvents.Data | null = null;\n\n  /** Handler for mouse up events to end scrollbar drags. */\n  onMouseMoveWrapper_: browserEvents.Data | null = null;\n\n  /**\n   * @param workspace Workspace to bind the scrollbar to.\n   * @param horizontal True if horizontal, false if vertical.\n   * @param opt_pair True if scrollbar is part of a horiz/vert pair.\n   * @param opt_class A class to be applied to this scrollbar.\n   * @param opt_margin The margin to apply to this scrollbar.\n   */\n  constructor(\n    private workspace: WorkspaceSvg,\n    private readonly horizontal: boolean,\n    opt_pair?: boolean,\n    opt_class?: string,\n    opt_margin?: number\n  ) {\n    this.pair = opt_pair || false;\n\n    this.margin =\n      opt_margin !== undefined\n        ? opt_margin\n        : Scrollbar.DEFAULT_SCROLLBAR_MARGIN;\n\n    let className =\n      'blocklyScrollbar' + (this.horizontal ? 'Horizontal' : 'Vertical');\n    if (opt_class) {\n      className += ' ' + opt_class;\n    }\n\n    /* Create the following DOM:\n      <svg class=\"blocklyScrollbarHorizontal optionalClass\">\n        <g>\n          <rect class=\"blocklyScrollbarBackground\" />\n          <rect class=\"blocklyScrollbarHandle\" rx=\"8\" ry=\"8\" />\n        </g>\n      </svg>\n    */\n    this.outerSvg = dom.createSvgElement(Svg.SVG, {'class': className});\n    // Child group to hold the handle and background together.\n    const group = dom.createSvgElement(Svg.G, {}, this.outerSvg);\n\n    this.svgBackground = dom.createSvgElement(\n      Svg.RECT,\n      {'class': 'blocklyScrollbarBackground'},\n      group\n    );\n\n    const radius = Math.floor((Scrollbar.scrollbarThickness - 5) / 2);\n    this.svgHandle = dom.createSvgElement(\n      Svg.RECT,\n      {'class': 'blocklyScrollbarHandle', 'rx': radius, 'ry': radius},\n      group\n    );\n\n    this.workspace\n      .getThemeManager()\n      .subscribe(this.svgHandle, 'scrollbarColour', 'fill');\n    this.workspace\n      .getThemeManager()\n      .subscribe(this.svgHandle, 'scrollbarOpacity', 'fill-opacity');\n\n    // Add everything to the DOM.\n    dom.insertAfter(this.outerSvg, this.workspace.getParentSvg());\n\n    this.setInitialThickness();\n\n    if (horizontal) {\n      this.lengthAttribute_ = 'width';\n      this.positionAttribute_ = 'x';\n    } else {\n      this.lengthAttribute_ = 'height';\n      this.positionAttribute_ = 'y';\n    }\n\n    this.onMouseDownBarWrapper_ = browserEvents.conditionalBind(\n      this.svgBackground,\n      'pointerdown',\n      this,\n      this.onMouseDownBar\n    );\n    this.onMouseDownHandleWrapper_ = browserEvents.conditionalBind(\n      this.svgHandle,\n      'pointerdown',\n      this,\n      this.onMouseDownHandle\n    );\n  }\n\n  /**\n   * Set the size of the scrollbar DOM elements along the minor axis.\n   */\n  private setInitialThickness() {\n    const scrollbarThickness = Scrollbar.scrollbarThickness;\n    if (this.horizontal) {\n      this.svgBackground.setAttribute('height', String(scrollbarThickness));\n      this.outerSvg.setAttribute('height', String(scrollbarThickness));\n      this.svgHandle.setAttribute('height', String(scrollbarThickness - 5));\n      this.svgHandle.setAttribute('y', '2.5');\n    } else {\n      this.svgBackground.setAttribute('width', String(scrollbarThickness));\n      this.outerSvg.setAttribute('width', String(scrollbarThickness));\n      this.svgHandle.setAttribute('width', String(scrollbarThickness - 5));\n      this.svgHandle.setAttribute('x', '2.5');\n    }\n  }\n\n  /**\n   * Dispose of this scrollbar. Remove DOM elements, event listeners,\n   * and theme subscriptions.\n   */\n  dispose() {\n    this.cleanUp();\n    browserEvents.unbind(this.onMouseDownBarWrapper_);\n    browserEvents.unbind(this.onMouseDownHandleWrapper_);\n\n    dom.removeNode(this.outerSvg);\n    this.workspace.getThemeManager().unsubscribe(this.svgHandle);\n  }\n\n  /**\n   * Constrain the handle's length within the minimum (0) and maximum\n   * (scrollbar background) values allowed for the scrollbar.\n   *\n   * @param value Value that is potentially out of bounds, in CSS pixels.\n   * @returns Constrained value, in CSS pixels.\n   */\n  private constrainHandleLength(value: number): number {\n    if (value <= 0 || isNaN(value)) {\n      value = 0;\n    } else {\n      value = Math.min(value, this.scrollbarLength);\n    }\n    return value;\n  }\n\n  /**\n   * Set the length of the scrollbar's handle and change the SVG attribute\n   * accordingly.\n   *\n   * @param newLength The new scrollbar handle length in CSS pixels.\n   */\n  private setHandleLength(newLength: number) {\n    this.handleLength = newLength;\n    this.svgHandle.setAttribute(\n      this.lengthAttribute_,\n      String(this.handleLength)\n    );\n  }\n\n  /**\n   * Constrain the handle's position within the minimum (0) and maximum values\n   * allowed for the scrollbar.\n   *\n   * @param value Value that is potentially out of bounds, in CSS pixels.\n   * @returns Constrained value, in CSS pixels.\n   */\n  private constrainHandlePosition(value: number): number {\n    if (value <= 0 || isNaN(value)) {\n      value = 0;\n    } else {\n      // Handle length should never be greater than this.scrollbarLength_.\n      // If the viewSize is greater than or equal to the scrollSize, the\n      // handleLength will end up equal to this.scrollbarLength_.\n      value = Math.min(value, this.scrollbarLength - this.handleLength);\n    }\n    return value;\n  }\n\n  /**\n   * Set the offset of the scrollbar's handle from the scrollbar's position, and\n   * change the SVG attribute accordingly.\n   *\n   * @param newPosition The new scrollbar handle offset in CSS pixels.\n   */\n  setHandlePosition(newPosition: number) {\n    this.handlePosition = newPosition;\n    this.svgHandle.setAttribute(\n      this.positionAttribute_,\n      String(this.handlePosition)\n    );\n  }\n\n  /**\n   * Set the size of the scrollbar's background and change the SVG attribute\n   * accordingly.\n   *\n   * @param newSize The new scrollbar background length in CSS pixels.\n   */\n  private setScrollbarLength(newSize: number) {\n    this.scrollbarLength = newSize;\n    this.outerSvg.setAttribute(\n      this.lengthAttribute_,\n      String(this.scrollbarLength)\n    );\n    this.svgBackground.setAttribute(\n      this.lengthAttribute_,\n      String(this.scrollbarLength)\n    );\n  }\n\n  /**\n   * Set the position of the scrollbar's SVG group in CSS pixels relative to the\n   * scrollbar's origin.  This sets the scrollbar's location within the\n   * workspace.\n   *\n   * @param x The new x coordinate.\n   * @param y The new y coordinate.\n   * @internal\n   */\n  setPosition(x: number, y: number) {\n    this.position.x = x;\n    this.position.y = y;\n\n    const tempX = this.position.x + this.origin.x;\n    const tempY = this.position.y + this.origin.y;\n    const transform = 'translate(' + tempX + 'px,' + tempY + 'px)';\n    dom.setCssTransform(this.outerSvg, transform);\n  }\n\n  /**\n   * Recalculate the scrollbar's location and its length.\n   *\n   * @param opt_metrics A data structure of from the describing all the required\n   *     dimensions.  If not provided, it will be fetched from the host object.\n   */\n  resize(opt_metrics?: Metrics) {\n    // Determine the location, height and width of the host element.\n    let hostMetrics = opt_metrics;\n    if (!hostMetrics) {\n      hostMetrics = this.workspace.getMetrics();\n      if (!hostMetrics) {\n        // Host element is likely not visible.\n        return;\n      }\n    }\n\n    if (\n      this.oldHostMetrics &&\n      Scrollbar.metricsAreEquivalent(hostMetrics, this.oldHostMetrics)\n    ) {\n      return;\n    }\n\n    if (this.horizontal) {\n      this.resizeHorizontal(hostMetrics);\n    } else {\n      this.resizeVertical(hostMetrics);\n    }\n\n    this.oldHostMetrics = hostMetrics;\n\n    // Resizing may have caused some scrolling.\n    this.updateMetrics();\n  }\n\n  /**\n   * Returns whether the a resizeView is necessary by comparing the passed\n   * hostMetrics with cached old host metrics.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   * @returns Whether a resizeView is necessary.\n   */\n  private requiresViewResize(hostMetrics: Metrics): boolean {\n    if (!this.oldHostMetrics) {\n      return true;\n    }\n    return (\n      this.oldHostMetrics.viewWidth !== hostMetrics.viewWidth ||\n      this.oldHostMetrics.viewHeight !== hostMetrics.viewHeight ||\n      this.oldHostMetrics.absoluteLeft !== hostMetrics.absoluteLeft ||\n      this.oldHostMetrics.absoluteTop !== hostMetrics.absoluteTop\n    );\n  }\n\n  /**\n   * Recalculate a horizontal scrollbar's location and length.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  private resizeHorizontal(hostMetrics: Metrics) {\n    if (this.requiresViewResize(hostMetrics)) {\n      this.resizeViewHorizontal(hostMetrics);\n    } else {\n      this.resizeContentHorizontal(hostMetrics);\n    }\n  }\n\n  /**\n   * Recalculate a horizontal scrollbar's location on the screen and path\n   * length. This should be called when the layout or size of the window has\n   * changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeViewHorizontal(hostMetrics: Metrics) {\n    let viewSize = hostMetrics.viewWidth - this.margin * 2;\n    if (this.pair) {\n      // Shorten the scrollbar to make room for the corner square.\n      viewSize -= Scrollbar.scrollbarThickness;\n    }\n    this.setScrollbarLength(Math.max(0, viewSize));\n\n    let xCoordinate = hostMetrics.absoluteLeft + this.margin;\n    if (this.pair && this.workspace.RTL) {\n      xCoordinate += Scrollbar.scrollbarThickness;\n    }\n\n    // Horizontal toolbar should always be just above the bottom of the\n    // workspace.\n    const yCoordinate =\n      hostMetrics.absoluteTop +\n      hostMetrics.viewHeight -\n      Scrollbar.scrollbarThickness -\n      this.margin;\n    this.setPosition(xCoordinate, yCoordinate);\n\n    // If the view has been resized, a content resize will also be necessary.\n    // The reverse is not true.\n    this.resizeContentHorizontal(hostMetrics);\n  }\n\n  /**\n   * Recalculate a horizontal scrollbar's location within its path and length.\n   * This should be called when the contents of the workspace have changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeContentHorizontal(hostMetrics: Metrics) {\n    if (hostMetrics.viewWidth >= hostMetrics.scrollWidth) {\n      // viewWidth is often greater than scrollWidth in flyouts and\n      // non-scrollable workspaces.\n      this.setHandleLength(this.scrollbarLength);\n      this.setHandlePosition(0);\n      if (!this.pair) {\n        // The scrollbar isn't needed.\n        // This doesn't apply to scrollbar pairs because interactions with the\n        // corner square aren't handled.\n        this.setVisible(false);\n      }\n      return;\n    } else if (!this.pair) {\n      // The scrollbar is needed. Only non-paired scrollbars are hidden/shown.\n      this.setVisible(true);\n    }\n\n    // Resize the handle.\n    let handleLength =\n      (this.scrollbarLength * hostMetrics.viewWidth) / hostMetrics.scrollWidth;\n    handleLength = this.constrainHandleLength(handleLength);\n    this.setHandleLength(handleLength);\n\n    // Compute the handle offset.\n    // The position of the handle can be between:\n    //     0 and this.scrollbarLength_ - handleLength\n    // If viewLeft === scrollLeft\n    //     then the offset should be 0\n    // If viewRight === scrollRight\n    //     then viewLeft = scrollLeft + scrollWidth - viewWidth\n    //     then the offset should be max offset\n\n    const maxScrollDistance = hostMetrics.scrollWidth - hostMetrics.viewWidth;\n    const contentDisplacement = hostMetrics.viewLeft - hostMetrics.scrollLeft;\n    // Percent of content to the left of our current position.\n    const offsetRatio = contentDisplacement / maxScrollDistance;\n    // Area available to scroll * percent to the left\n    const maxHandleOffset = this.scrollbarLength - this.handleLength;\n    let handleOffset = maxHandleOffset * offsetRatio;\n    handleOffset = this.constrainHandlePosition(handleOffset);\n    this.setHandlePosition(handleOffset);\n\n    // Compute ratio (for use with set calls, which pass in content\n    // displacement).\n    this.ratio = maxHandleOffset / maxScrollDistance;\n  }\n\n  /**\n   * Recalculate a vertical scrollbar's location and length.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  private resizeVertical(hostMetrics: Metrics) {\n    if (this.requiresViewResize(hostMetrics)) {\n      this.resizeViewVertical(hostMetrics);\n    } else {\n      this.resizeContentVertical(hostMetrics);\n    }\n  }\n\n  /**\n   * Recalculate a vertical scrollbar's location on the screen and path length.\n   * This should be called when the layout or size of the window has changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeViewVertical(hostMetrics: Metrics) {\n    let viewSize = hostMetrics.viewHeight - this.margin * 2;\n    if (this.pair) {\n      // Shorten the scrollbar to make room for the corner square.\n      viewSize -= Scrollbar.scrollbarThickness;\n    }\n    this.setScrollbarLength(Math.max(0, viewSize));\n\n    const xCoordinate = this.workspace.RTL\n      ? hostMetrics.absoluteLeft + this.margin\n      : hostMetrics.absoluteLeft +\n        hostMetrics.viewWidth -\n        Scrollbar.scrollbarThickness -\n        this.margin;\n\n    const yCoordinate = hostMetrics.absoluteTop + this.margin;\n    this.setPosition(xCoordinate, yCoordinate);\n\n    // If the view has been resized, a content resize will also be necessary.\n    // The reverse is not true.\n    this.resizeContentVertical(hostMetrics);\n  }\n\n  /**\n   * Recalculate a vertical scrollbar's location within its path and length.\n   * This should be called when the contents of the workspace have changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeContentVertical(hostMetrics: Metrics) {\n    if (hostMetrics.viewHeight >= hostMetrics.scrollHeight) {\n      // viewHeight is often greater than scrollHeight in flyouts and\n      // non-scrollable workspaces.\n      this.setHandleLength(this.scrollbarLength);\n      this.setHandlePosition(0);\n      if (!this.pair) {\n        // The scrollbar isn't needed.\n        // This doesn't apply to scrollbar pairs because interactions with the\n        // corner square aren't handled.\n        this.setVisible(false);\n      }\n      return;\n    } else if (!this.pair) {\n      // The scrollbar is needed. Only non-paired scrollbars are hidden/shown.\n      this.setVisible(true);\n    }\n\n    // Resize the handle.\n    let handleLength =\n      (this.scrollbarLength * hostMetrics.viewHeight) /\n      hostMetrics.scrollHeight;\n    handleLength = this.constrainHandleLength(handleLength);\n    this.setHandleLength(handleLength);\n\n    // Compute the handle offset.\n    // The position of the handle can be between:\n    //     0 and this.scrollbarLength_ - handleLength\n    // If viewTop === scrollTop\n    //     then the offset should be 0\n    // If viewBottom === scrollBottom\n    //     then viewTop = scrollTop + scrollHeight - viewHeight\n    //     then the offset should be max offset\n\n    const maxScrollDistance = hostMetrics.scrollHeight - hostMetrics.viewHeight;\n    const contentDisplacement = hostMetrics.viewTop - hostMetrics.scrollTop;\n    // Percent of content to the left of our current position.\n    const offsetRatio = contentDisplacement / maxScrollDistance;\n    // Area available to scroll * percent to the left\n    const maxHandleOffset = this.scrollbarLength - this.handleLength;\n    let handleOffset = maxHandleOffset * offsetRatio;\n    handleOffset = this.constrainHandlePosition(handleOffset);\n    this.setHandlePosition(handleOffset);\n\n    // Compute ratio (for use with set calls, which pass in content\n    // displacement).\n    this.ratio = maxHandleOffset / maxScrollDistance;\n  }\n\n  /**\n   * Is the scrollbar visible.  Non-paired scrollbars disappear when they aren't\n   * needed.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.isHandleVisible;\n  }\n\n  /**\n   * Set whether the scrollbar's container is visible and update\n   * display accordingly if visibility has changed.\n   *\n   * @param visible Whether the container is visible\n   */\n  setContainerVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.containerVisible;\n\n    this.containerVisible = visible;\n    if (visibilityChanged) {\n      this.updateDisplay_();\n    }\n  }\n\n  /**\n   * Set whether the scrollbar is visible.\n   * Only applies to non-paired scrollbars.\n   *\n   * @param visible True if visible.\n   */\n  setVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.isVisible();\n\n    // Ideally this would also apply to scrollbar pairs, but that's a bigger\n    // headache (due to interactions with the corner square).\n    if (this.pair) {\n      throw Error('Unable to toggle visibility of paired scrollbars.');\n    }\n    this.isHandleVisible = visible;\n    if (visibilityChanged) {\n      this.updateDisplay_();\n    }\n  }\n\n  /**\n   * Update visibility of scrollbar based on whether it thinks it should\n   * be visible and whether its containing workspace is visible.\n   * We cannot rely on the containing workspace being hidden to hide us\n   * because it is not necessarily our parent in the DOM.\n   */\n  updateDisplay_() {\n    let show = true;\n    // Check whether our parent/container is visible.\n    if (!this.containerVisible) {\n      show = false;\n    } else {\n      show = this.isVisible();\n    }\n    if (show) {\n      this.outerSvg.setAttribute('display', 'block');\n    } else {\n      this.outerSvg.setAttribute('display', 'none');\n    }\n  }\n\n  /**\n   * Scroll by one pageful.\n   * Called when scrollbar background is clicked.\n   *\n   * @param e Mouse down event.\n   */\n  private onMouseDownBar(e: MouseEvent) {\n    this.workspace.markFocused();\n    Touch.clearTouchIdentifier(); // This is really a click.\n    this.cleanUp();\n    if (browserEvents.isRightButton(e)) {\n      // Right-click.\n      // Scrollbars have no context menu.\n      e.stopPropagation();\n      return;\n    }\n    const mouseXY = browserEvents.mouseToSvg(\n      e,\n      this.workspace.getParentSvg(),\n      this.workspace.getInverseScreenCTM()\n    );\n    const mouseLocation = this.horizontal ? mouseXY.x : mouseXY.y;\n\n    const handleXY = svgMath.getInjectionDivXY(this.svgHandle);\n    const handleStart = this.horizontal ? handleXY.x : handleXY.y;\n    let handlePosition = this.handlePosition;\n\n    const pageLength = this.handleLength * 0.95;\n    if (mouseLocation <= handleStart) {\n      // Decrease the scrollbar's value by a page.\n      handlePosition -= pageLength;\n    } else if (mouseLocation >= handleStart + this.handleLength) {\n      // Increase the scrollbar's value by a page.\n      handlePosition += pageLength;\n    }\n\n    this.setHandlePosition(this.constrainHandlePosition(handlePosition));\n\n    this.updateMetrics();\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  /**\n   * Start a dragging operation.\n   * Called when scrollbar handle is clicked.\n   *\n   * @param e Mouse down event.\n   */\n  private onMouseDownHandle(e: PointerEvent) {\n    this.workspace.markFocused();\n    this.cleanUp();\n    if (browserEvents.isRightButton(e)) {\n      // Right-click.\n      // Scrollbars have no context menu.\n      e.stopPropagation();\n      return;\n    }\n    // Look up the current translation and record it.\n    this.startDragHandle = this.handlePosition;\n\n    // Record the current mouse position.\n    this.startDragMouse = this.horizontal ? e.clientX : e.clientY;\n    this.onMouseUpWrapper_ = browserEvents.conditionalBind(\n      document,\n      'pointerup',\n      this,\n      this.onMouseUpHandle\n    );\n    this.onMouseMoveWrapper_ = browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      this,\n      this.onMouseMoveHandle\n    );\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  /**\n   * Drag the scrollbar's handle.\n   *\n   * @param e Mouse move event.\n   */\n  private onMouseMoveHandle(e: PointerEvent) {\n    const currentMouse = this.horizontal ? e.clientX : e.clientY;\n    const mouseDelta = currentMouse - this.startDragMouse;\n    const handlePosition = this.startDragHandle + mouseDelta;\n    // Position the bar.\n    this.setHandlePosition(this.constrainHandlePosition(handlePosition));\n    this.updateMetrics();\n  }\n\n  /** Release the scrollbar handle and reset state accordingly. */\n  private onMouseUpHandle() {\n    Touch.clearTouchIdentifier();\n    this.cleanUp();\n  }\n\n  /**\n   * Hide chaff and stop binding to mouseup and mousemove events.  Call this to\n   * wrap up loose ends associated with the scrollbar.\n   */\n  private cleanUp() {\n    this.workspace.hideChaff(true);\n    if (this.onMouseUpWrapper_) {\n      browserEvents.unbind(this.onMouseUpWrapper_);\n      this.onMouseUpWrapper_ = null;\n    }\n    if (this.onMouseMoveWrapper_) {\n      browserEvents.unbind(this.onMouseMoveWrapper_);\n      this.onMouseMoveWrapper_ = null;\n    }\n  }\n\n  /**\n   * Helper to calculate the ratio of handle position to scrollbar view size.\n   *\n   * @returns Ratio.\n   * @internal\n   */\n  getRatio_(): number {\n    const scrollHandleRange = this.scrollbarLength - this.handleLength;\n    let ratio = this.handlePosition / scrollHandleRange;\n    if (isNaN(ratio)) {\n      ratio = 0;\n    }\n    return ratio;\n  }\n\n  /**\n   * Updates workspace metrics based on new scroll ratio. Called when scrollbar\n   * is moved.\n   */\n  private updateMetrics() {\n    const ratio = this.getRatio_();\n    if (this.horizontal) {\n      this.workspace.setMetrics({x: ratio});\n    } else {\n      this.workspace.setMetrics({y: ratio});\n    }\n  }\n\n  /**\n   * Set the scrollbar handle's position.\n   *\n   * @param value The content displacement, relative to the view in pixels.\n   * @param updateMetrics Whether to update metrics on this set call.\n   *    Defaults to true.\n   */\n  set(value: number, updateMetrics?: boolean) {\n    this.setHandlePosition(this.constrainHandlePosition(value * this.ratio));\n    if (updateMetrics || updateMetrics === undefined) {\n      this.updateMetrics();\n    }\n  }\n\n  /**\n   * Record the origin of the workspace that the scrollbar is in, in pixels\n   * relative to the injection div origin. This is for times when the scrollbar\n   * is used in an object whose origin isn't the same as the main workspace\n   * (e.g. in a flyout.)\n   *\n   * @param x The x coordinate of the scrollbar's origin, in CSS pixels.\n   * @param y The y coordinate of the scrollbar's origin, in CSS pixels.\n   */\n  setOrigin(x: number, y: number) {\n    this.origin = new Coordinate(x, y);\n  }\n\n  /**\n   * @param first An object containing computed measurements of a workspace.\n   * @param second Another object containing computed measurements of a\n   *     workspace.\n   * @returns Whether the two sets of metrics are equivalent.\n   */\n  private static metricsAreEquivalent(\n    first: Metrics,\n    second: Metrics\n  ): boolean {\n    return (\n      first.viewWidth === second.viewWidth &&\n      first.viewHeight === second.viewHeight &&\n      first.viewLeft === second.viewLeft &&\n      first.viewTop === second.viewTop &&\n      first.absoluteTop === second.absoluteTop &&\n      first.absoluteLeft === second.absoluteLeft &&\n      first.scrollWidth === second.scrollWidth &&\n      first.scrollHeight === second.scrollHeight &&\n      first.scrollLeft === second.scrollLeft &&\n      first.scrollTop === second.scrollTop\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as browserEvents from '../browser_events.js';\nimport {IBubble} from '../interfaces/i_bubble.js';\nimport {ContainerRegion} from '../metrics_manager.js';\nimport {Scrollbar} from '../scrollbar.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport * as math from '../utils/math.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\n\nexport abstract class Bubble implements IBubble {\n  /** The width of the border around the bubble. */\n  static readonly BORDER_WIDTH = 6;\n\n  /** Double the width of the border around the bubble. */\n  static readonly DOUBLE_BORDER = this.BORDER_WIDTH * 2;\n\n  /** The minimum size the bubble can have. */\n  static readonly MIN_SIZE = this.DOUBLE_BORDER;\n\n  /**\n   * The thickness of the base of the tail in relation to the size of the\n   * bubble. Higher numbers result in thinner tails.\n   */\n  static readonly TAIL_THICKNESS = 1;\n\n  /** The number of degrees that the tail bends counter-clockwise. */\n  static readonly TAIL_ANGLE = 20;\n\n  /**\n   * The sharpness of the tail's bend. Higher numbers result in smoother\n   * tails.\n   */\n  static readonly TAIL_BEND = 4;\n\n  /** Distance between arrow point and anchor point. */\n  static readonly ANCHOR_RADIUS = 8;\n\n  /** The SVG group containing all parts of the bubble. */\n  protected svgRoot: SVGGElement;\n\n  /** The SVG path for the arrow from the anchor to the bubble. */\n  private tail: SVGPathElement;\n\n  /** The SVG background rect for the main body of the bubble. */\n  private background: SVGRectElement;\n\n  /** The SVG group containing the contents of the bubble. */\n  protected contentContainer: SVGGElement;\n\n  /**\n   * The size of the bubble (including background and contents but not tail).\n   */\n  private size = new Size(0, 0);\n\n  /** The colour of the background of the bubble. */\n  private colour = '#ffffff';\n\n  /** True if the bubble has been disposed, false otherwise. */\n  public disposed = false;\n\n  /** The position of the top of the bubble relative to its anchor. */\n  private relativeTop = 0;\n\n  /** The position of the left of the bubble realtive to its anchor. */\n  private relativeLeft = 0;\n\n  /**\n   * @param workspace The workspace this bubble belongs to.\n   * @param anchor The anchor location of the thing this bubble is attached to.\n   *     The tail of the bubble will point to this location.\n   * @param ownerRect An optional rect we don't want the bubble to overlap with\n   *     when automatically positioning.\n   */\n  constructor(\n    protected readonly workspace: WorkspaceSvg,\n    protected anchor: Coordinate,\n    protected ownerRect?: Rect\n  ) {\n    this.svgRoot = dom.createSvgElement(Svg.G, {}, workspace.getBubbleCanvas());\n    const embossGroup = dom.createSvgElement(\n      Svg.G,\n      {\n        'filter': `url(#${\n          this.workspace.getRenderer().getConstants().embossFilterId\n        })`,\n      },\n      this.svgRoot\n    );\n    this.tail = dom.createSvgElement(Svg.PATH, {}, embossGroup);\n    this.background = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyDraggable',\n        'x': 0,\n        'y': 0,\n        'rx': Bubble.BORDER_WIDTH,\n        'ry': Bubble.BORDER_WIDTH,\n      },\n      embossGroup\n    );\n    this.contentContainer = dom.createSvgElement(Svg.G, {}, this.svgRoot);\n\n    browserEvents.conditionalBind(\n      this.background,\n      'pointerdown',\n      this,\n      this.onMouseDown\n    );\n  }\n\n  /** Dispose of this bubble. */\n  dispose() {\n    dom.removeNode(this.svgRoot);\n    this.disposed = true;\n  }\n\n  /**\n   * Set the location the tail of this bubble points to.\n   *\n   * @param anchor The location the tail of this bubble points to.\n   * @param relayout If true, reposition the bubble from scratch so that it is\n   *     optimally visible. If false, reposition it so it maintains the same\n   *     position relative to the anchor.\n   */\n  setAnchorLocation(anchor: Coordinate, relayout = false) {\n    this.anchor = anchor;\n    if (relayout) {\n      this.positionByRect(this.ownerRect);\n    } else {\n      this.positionRelativeToAnchor();\n    }\n    this.renderTail();\n  }\n\n  /** Sets the position of this bubble relative to its anchor. */\n  setPositionRelativeToAnchor(left: number, top: number) {\n    this.relativeLeft = left;\n    this.relativeTop = top;\n    this.positionRelativeToAnchor();\n    this.renderTail();\n  }\n\n  /** @returns the size of this bubble. */\n  protected getSize() {\n    return this.size;\n  }\n\n  /**\n   * Sets the size of this bubble, including the border.\n   *\n   * @param size Sets the size of this bubble, including the border.\n   * @param relayout If true, reposition the bubble from scratch so that it is\n   *     optimally visible. If false, reposition it so it maintains the same\n   *     position relative to the anchor.\n   */\n  protected setSize(size: Size, relayout = false) {\n    size.width = Math.max(size.width, Bubble.MIN_SIZE);\n    size.height = Math.max(size.height, Bubble.MIN_SIZE);\n    this.size = size;\n\n    this.background.setAttribute('width', `${size.width}`);\n    this.background.setAttribute('height', `${size.height}`);\n\n    if (relayout) {\n      this.positionByRect(this.ownerRect);\n    } else {\n      this.positionRelativeToAnchor();\n    }\n    this.renderTail();\n  }\n\n  /** Returns the colour of the background and tail of this bubble. */\n  protected getColour(): string {\n    return this.colour;\n  }\n\n  /** Sets the colour of the background and tail of this bubble. */\n  public setColour(colour: string) {\n    this.colour = colour;\n    this.tail.setAttribute('fill', colour);\n    this.background.setAttribute('fill', colour);\n  }\n\n  /** Passes the pointer event off to the gesture system. */\n  private onMouseDown(e: PointerEvent) {\n    this.workspace.getGesture(e)?.handleBubbleStart(e, this);\n  }\n\n  /** Positions the bubble relative to its anchor. Does not render its tail. */\n  protected positionRelativeToAnchor() {\n    let left = this.anchor.x;\n    if (this.workspace.RTL) {\n      left -= this.relativeLeft + this.size.width;\n    } else {\n      left += this.relativeLeft;\n    }\n    const top = this.relativeTop + this.anchor.y;\n    this.moveTo(left, top);\n  }\n\n  /**\n   * Moves the bubble to the given coordinates.\n   *\n   * @internal\n   */\n  moveTo(x: number, y: number) {\n    this.svgRoot.setAttribute('transform', `translate(${x}, ${y})`);\n  }\n\n  /**\n   * Positions the bubble \"optimally\" so that the most of it is visible and\n   * it does not overlap the rect (if provided).\n   */\n  protected positionByRect(rect = new Rect(0, 0, 0, 0)) {\n    const viewMetrics = this.workspace.getMetricsManager().getViewMetrics(true);\n\n    const optimalLeft = this.getOptimalRelativeLeft(viewMetrics);\n    const optimalTop = this.getOptimalRelativeTop(viewMetrics);\n\n    const topPosition = {\n      x: optimalLeft,\n      y: (-this.size.height -\n        this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT) as number,\n    };\n    const startPosition = {x: -this.size.width - 30, y: optimalTop};\n    const endPosition = {x: rect.getWidth(), y: optimalTop};\n    const bottomPosition = {x: optimalLeft, y: rect.getHeight()};\n\n    const closerPosition =\n      rect.getWidth() < rect.getHeight() ? endPosition : bottomPosition;\n    const fartherPosition =\n      rect.getWidth() < rect.getHeight() ? bottomPosition : endPosition;\n\n    const topPositionOverlap = this.getOverlap(topPosition, viewMetrics);\n    const startPositionOverlap = this.getOverlap(startPosition, viewMetrics);\n    const closerPositionOverlap = this.getOverlap(closerPosition, viewMetrics);\n    const fartherPositionOverlap = this.getOverlap(\n      fartherPosition,\n      viewMetrics\n    );\n\n    // Set the position to whichever position shows the most of the bubble,\n    // with tiebreaks going in the order: top > start > close > far.\n    const mostOverlap = Math.max(\n      topPositionOverlap,\n      startPositionOverlap,\n      closerPositionOverlap,\n      fartherPositionOverlap\n    );\n    if (topPositionOverlap === mostOverlap) {\n      this.relativeLeft = topPosition.x;\n      this.relativeTop = topPosition.y;\n      this.positionRelativeToAnchor();\n      return;\n    }\n    if (startPositionOverlap === mostOverlap) {\n      this.relativeLeft = startPosition.x;\n      this.relativeTop = startPosition.y;\n      this.positionRelativeToAnchor();\n      return;\n    }\n    if (closerPositionOverlap === mostOverlap) {\n      this.relativeLeft = closerPosition.x;\n      this.relativeTop = closerPosition.y;\n      this.positionRelativeToAnchor();\n      return;\n    }\n    // TODO: I believe relativeLeft_ should actually be called relativeStart_\n    //  and then the math should be fixed to reflect this. (hopefully it'll\n    //  make it look simpler)\n    this.relativeLeft = fartherPosition.x;\n    this.relativeTop = fartherPosition.y;\n    this.positionRelativeToAnchor();\n  }\n\n  /**\n   * Calculate the what percentage of the bubble overlaps with the visible\n   * workspace (what percentage of the bubble is visible).\n   *\n   * @param relativeMin The position of the top-left corner of the bubble\n   *     relative to the anchor point.\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The percentage of the bubble that is visible.\n   */\n  private getOverlap(\n    relativeMin: {x: number; y: number},\n    viewMetrics: ContainerRegion\n  ): number {\n    // The position of the top-left corner of the bubble in workspace units.\n    const bubbleMin = {\n      x: this.workspace.RTL\n        ? this.anchor.x - relativeMin.x - this.size.width\n        : relativeMin.x + this.anchor.x,\n      y: relativeMin.y + this.anchor.y,\n    };\n    // The position of the bottom-right corner of the bubble in workspace units.\n    const bubbleMax = {\n      x: bubbleMin.x + this.size.width,\n      y: bubbleMin.y + this.size.height,\n    };\n\n    // We could adjust these values to account for the scrollbars, but the\n    // bubbles should have been adjusted to not collide with them anyway, so\n    // giving the workspace a slightly larger \"bounding box\" shouldn't affect\n    // the calculation.\n\n    // The position of the top-left corner of the workspace.\n    const workspaceMin = {x: viewMetrics.left, y: viewMetrics.top};\n    // The position of the bottom-right corner of the workspace.\n    const workspaceMax = {\n      x: viewMetrics.left + viewMetrics.width,\n      y: viewMetrics.top + viewMetrics.height,\n    };\n\n    const overlapWidth =\n      Math.min(bubbleMax.x, workspaceMax.x) -\n      Math.max(bubbleMin.x, workspaceMin.x);\n    const overlapHeight =\n      Math.min(bubbleMax.y, workspaceMax.y) -\n      Math.max(bubbleMin.y, workspaceMin.y);\n    return Math.max(\n      0,\n      Math.min(\n        1,\n        (overlapWidth * overlapHeight) / (this.size.width * this.size.height)\n      )\n    );\n  }\n\n  /**\n   * Calculate what the optimal horizontal position of the top-left corner of\n   * the bubble is (relative to the anchor point) so that the most area of the\n   * bubble is shown.\n   *\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The optimal horizontal position of the top-left corner of the\n   *     bubble.\n   */\n  private getOptimalRelativeLeft(viewMetrics: ContainerRegion): number {\n    // By default, show the bubble just a bit to the left of the anchor.\n    let relativeLeft = -this.size.width / 4;\n\n    // No amount of sliding left or right will give us better overlap.\n    if (this.size.width > viewMetrics.width) return relativeLeft;\n\n    const workspaceRect = this.getWorkspaceViewRect(viewMetrics);\n\n    if (this.workspace.RTL) {\n      // Bubble coordinates are flipped in RTL.\n      const bubbleRight = this.anchor.x - relativeLeft;\n      const bubbleLeft = bubbleRight - this.size.width;\n\n      if (bubbleLeft < workspaceRect.left) {\n        // Slide the bubble right until it is onscreen.\n        relativeLeft = -(workspaceRect.left - this.anchor.x + this.size.width);\n      } else if (bubbleRight > workspaceRect.right) {\n        // Slide the bubble left until it is onscreen.\n        relativeLeft = -(workspaceRect.right - this.anchor.x);\n      }\n    } else {\n      const bubbleLeft = relativeLeft + this.anchor.x;\n      const bubbleRight = bubbleLeft + this.size.width;\n\n      if (bubbleLeft < workspaceRect.left) {\n        // Slide the bubble right until it is onscreen.\n        relativeLeft = workspaceRect.left - this.anchor.x;\n      } else if (bubbleRight > workspaceRect.right) {\n        // Slide the bubble left until it is onscreen.\n        relativeLeft = workspaceRect.right - this.anchor.x - this.size.width;\n      }\n    }\n\n    return relativeLeft;\n  }\n\n  /**\n   * Calculate what the optimal vertical position of the top-left corner of\n   * the bubble is (relative to the anchor point) so that the most area of the\n   * bubble is shown.\n   *\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The optimal vertical position of the top-left corner of the\n   *     bubble.\n   */\n  private getOptimalRelativeTop(viewMetrics: ContainerRegion): number {\n    // By default, show the bubble just a bit higher than the anchor.\n    let relativeTop = -this.size.height / 4;\n\n    // No amount of sliding up or down will give us better overlap.\n    if (this.size.height > viewMetrics.height) return relativeTop;\n\n    const top = this.anchor.y + relativeTop;\n    const bottom = top + this.size.height;\n    const workspaceRect = this.getWorkspaceViewRect(viewMetrics);\n\n    if (top < workspaceRect.top) {\n      // Slide the bubble down until it is onscreen.\n      relativeTop = workspaceRect.top - this.anchor.y;\n    } else if (bottom > workspaceRect.bottom) {\n      // Slide the bubble up until it is onscreen.\n      relativeTop = workspaceRect.bottom - this.anchor.y - this.size.height;\n    }\n\n    return relativeTop;\n  }\n\n  /**\n   * @returns a rect defining the bounds of the workspace's view in workspace\n   * coordinates.\n   */\n  private getWorkspaceViewRect(viewMetrics: ContainerRegion): Rect {\n    const top = viewMetrics.top;\n    let bottom = viewMetrics.top + viewMetrics.height;\n    let left = viewMetrics.left;\n    let right = viewMetrics.left + viewMetrics.width;\n\n    bottom -= this.getScrollbarThickness();\n    if (this.workspace.RTL) {\n      left -= this.getScrollbarThickness();\n    } else {\n      right -= this.getScrollbarThickness();\n    }\n\n    return new Rect(top, bottom, left, right);\n  }\n\n  /** @returns the scrollbar thickness in workspace units. */\n  private getScrollbarThickness() {\n    return Scrollbar.scrollbarThickness / this.workspace.scale;\n  }\n\n  /** Draws the tail of the bubble. */\n  private renderTail() {\n    const steps = [];\n    // Find the relative coordinates of the center of the bubble.\n    const relBubbleX = this.size.width / 2;\n    const relBubbleY = this.size.height / 2;\n    // Find the relative coordinates of the center of the anchor.\n    let relAnchorX = -this.relativeLeft;\n    let relAnchorY = -this.relativeTop;\n    if (relBubbleX === relAnchorX && relBubbleY === relAnchorY) {\n      // Null case.  Bubble is directly on top of the anchor.\n      // Short circuit this rather than wade through divide by zeros.\n      steps.push('M ' + relBubbleX + ',' + relBubbleY);\n    } else {\n      // Compute the angle of the tail's line.\n      const rise = relAnchorY - relBubbleY;\n      let run = relAnchorX - relBubbleX;\n      if (this.workspace.RTL) {\n        run *= -1;\n      }\n      const hypotenuse = Math.sqrt(rise * rise + run * run);\n      let angle = Math.acos(run / hypotenuse);\n      if (rise < 0) {\n        angle = 2 * Math.PI - angle;\n      }\n      // Compute a line perpendicular to the tail.\n      let rightAngle = angle + Math.PI / 2;\n      if (rightAngle > Math.PI * 2) {\n        rightAngle -= Math.PI * 2;\n      }\n      const rightRise = Math.sin(rightAngle);\n      const rightRun = Math.cos(rightAngle);\n\n      // Calculate the thickness of the base of the tail.\n      let thickness =\n        (this.size.width + this.size.height) / Bubble.TAIL_THICKNESS;\n      thickness = Math.min(thickness, this.size.width, this.size.height) / 4;\n\n      // Back the tip of the tail off of the anchor.\n      const backoffRatio = 1 - Bubble.ANCHOR_RADIUS / hypotenuse;\n      relAnchorX = relBubbleX + backoffRatio * run;\n      relAnchorY = relBubbleY + backoffRatio * rise;\n\n      // Coordinates for the base of the tail.\n      const baseX1 = relBubbleX + thickness * rightRun;\n      const baseY1 = relBubbleY + thickness * rightRise;\n      const baseX2 = relBubbleX - thickness * rightRun;\n      const baseY2 = relBubbleY - thickness * rightRise;\n\n      // Distortion to curve the tail.\n      const radians = math.toRadians(\n        this.workspace.RTL ? -Bubble.TAIL_ANGLE : Bubble.TAIL_ANGLE\n      );\n      let swirlAngle = angle + radians;\n      if (swirlAngle > Math.PI * 2) {\n        swirlAngle -= Math.PI * 2;\n      }\n      const swirlRise = (Math.sin(swirlAngle) * hypotenuse) / Bubble.TAIL_BEND;\n      const swirlRun = (Math.cos(swirlAngle) * hypotenuse) / Bubble.TAIL_BEND;\n\n      steps.push('M' + baseX1 + ',' + baseY1);\n      steps.push(\n        'C' +\n          (baseX1 + swirlRun) +\n          ',' +\n          (baseY1 + swirlRise) +\n          ' ' +\n          relAnchorX +\n          ',' +\n          relAnchorY +\n          ' ' +\n          relAnchorX +\n          ',' +\n          relAnchorY\n      );\n      steps.push(\n        'C' +\n          relAnchorX +\n          ',' +\n          relAnchorY +\n          ' ' +\n          (baseX2 + swirlRun) +\n          ',' +\n          (baseY2 + swirlRise) +\n          ' ' +\n          baseX2 +\n          ',' +\n          baseY2\n      );\n    }\n    steps.push('z');\n    this.tail?.setAttribute('d', steps.join(' '));\n  }\n  /**\n   * Move this bubble to the front of the visible workspace.\n   *\n   * @returns Whether or not the bubble has been moved.\n   * @internal\n   */\n  bringToFront(): boolean {\n    const svgGroup = this.svgRoot?.parentNode;\n    if (this.svgRoot && svgGroup?.lastChild !== this.svgRoot) {\n      svgGroup?.appendChild(this.svgRoot);\n      return true;\n    }\n    return false;\n  }\n\n  /** @internal */\n  getRelativeToSurfaceXY(): Coordinate {\n    return new Coordinate(\n      this.workspace.RTL\n        ? -this.relativeLeft + this.anchor.x - this.size.width\n        : this.anchor.x + this.relativeLeft,\n      this.anchor.y + this.relativeTop\n    );\n  }\n\n  /** @internal */\n  getSvgRoot(): SVGElement {\n    return this.svgRoot;\n  }\n\n  /**\n   * Move this bubble during a drag.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate) {\n    this.moveTo(newLoc.x, newLoc.y);\n    if (this.workspace.RTL) {\n      this.relativeLeft = this.anchor.x - newLoc.x - this.size.width;\n    } else {\n      this.relativeLeft = newLoc.x - this.anchor.x;\n    }\n    this.relativeTop = newLoc.y - this.anchor.y;\n    this.renderTail();\n  }\n\n  setDragging(_start: boolean) {\n    // NOOP in base class.\n  }\n\n  /** @internal */\n  setDeleteStyle(_enable: boolean) {\n    // NOOP in base class.\n  }\n\n  /** @internal */\n  isDeletable(): boolean {\n    return false;\n  }\n\n  /** @internal */\n  showContextMenu(_e: Event) {\n    // NOOP in base class.\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a theme.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Theme');\n\nimport * as registry from './registry.js';\nimport * as object from './utils/object.js';\n\nexport interface ITheme {\n  blockStyles?: {[key: string]: Partial<BlockStyle>};\n  categoryStyles?: {[key: string]: CategoryStyle};\n  componentStyles?: ComponentStyle;\n  fontStyle?: FontStyle;\n  startHats?: boolean;\n  base?: string | Theme;\n  name: string;\n}\n\n/**\n * Class for a theme.\n */\nexport class Theme implements ITheme {\n  /** @internal */\n  blockStyles: {[key: string]: BlockStyle};\n  /** @internal */\n  categoryStyles: {[key: string]: CategoryStyle};\n  /** @internal */\n  componentStyles: ComponentStyle;\n  /** @internal */\n  fontStyle: FontStyle;\n\n  /**\n   * Whether or not to add a 'hat' on top of all blocks with no previous or\n   * output connections.\n   *\n   * @internal\n   */\n  startHats?: boolean = false;\n\n  /**\n   * @param name Theme name.\n   * @param opt_blockStyles A map from style names (strings) to objects with\n   *     style attributes for blocks.\n   * @param opt_categoryStyles A map from style names (strings) to objects with\n   *     style attributes for categories.\n   * @param opt_componentStyles A map of Blockly component names to style value.\n   */\n  constructor(\n    public name: string,\n    opt_blockStyles?: {[key: string]: Partial<BlockStyle>},\n    opt_categoryStyles?: {[key: string]: CategoryStyle},\n    opt_componentStyles?: ComponentStyle\n  ) {\n    /** The block styles map. */\n    this.blockStyles = opt_blockStyles || Object.create(null);\n\n    /** The category styles map. */\n    this.categoryStyles = opt_categoryStyles || Object.create(null);\n\n    /** The UI components styles map. */\n    this.componentStyles =\n      opt_componentStyles || (Object.create(null) as ComponentStyle);\n\n    /** The font style. */\n    this.fontStyle = Object.create(null) as FontStyle;\n\n    // Register the theme by name.\n    registry.register(registry.Type.THEME, name, this);\n  }\n\n  /**\n   * Gets the class name that identifies this theme.\n   *\n   * @returns The CSS class name.\n   * @internal\n   */\n  getClassName(): string {\n    return this.name + '-theme';\n  }\n\n  /**\n   * Overrides or adds a style to the blockStyles map.\n   *\n   * @param blockStyleName The name of the block style.\n   * @param blockStyle The block style.\n   */\n  setBlockStyle(blockStyleName: string, blockStyle: BlockStyle) {\n    this.blockStyles[blockStyleName] = blockStyle;\n  }\n\n  /**\n   * Overrides or adds a style to the categoryStyles map.\n   *\n   * @param categoryStyleName The name of the category style.\n   * @param categoryStyle The category style.\n   */\n  setCategoryStyle(categoryStyleName: string, categoryStyle: CategoryStyle) {\n    this.categoryStyles[categoryStyleName] = categoryStyle;\n  }\n\n  /**\n   * Gets the style for a given Blockly UI component.  If the style value is a\n   * string, we attempt to find the value of any named references.\n   *\n   * @param componentName The name of the component.\n   * @returns The style value.\n   */\n  getComponentStyle(componentName: string): string | null {\n    const style = (this.componentStyles as AnyDuringMigration)[componentName];\n    if (!style) {\n      return null;\n    }\n    if (typeof style === 'string') {\n      const recursiveStyle = this.getComponentStyle(style);\n      if (recursiveStyle) {\n        return recursiveStyle;\n      }\n    }\n    return `${style}`;\n  }\n\n  /**\n   * Configure a specific Blockly UI component with a style value.\n   *\n   * @param componentName The name of the component.\n   * @param styleValue The style value.\n   */\n  setComponentStyle(componentName: string, styleValue: AnyDuringMigration) {\n    (this.componentStyles as AnyDuringMigration)[componentName] = styleValue;\n  }\n\n  /**\n   * Configure a theme's font style.\n   *\n   * @param fontStyle The font style.\n   */\n  setFontStyle(fontStyle: FontStyle) {\n    this.fontStyle = fontStyle;\n  }\n\n  /**\n   * Configure a theme's start hats.\n   *\n   * @param startHats True if the theme enables start hats, false otherwise.\n   */\n  setStartHats(startHats: boolean) {\n    this.startHats = startHats;\n  }\n\n  /**\n   * Define a new Blockly theme.\n   *\n   * @param name The name of the theme.\n   * @param themeObj An object containing theme properties.\n   * @returns A new Blockly theme.\n   */\n  static defineTheme(name: string, themeObj: ITheme): Theme {\n    name = name.toLowerCase();\n    const theme = new Theme(name);\n    let base = themeObj['base'];\n    if (base) {\n      if (typeof base === 'string') {\n        base = registry.getObject(registry.Type.THEME, base) ?? undefined;\n      }\n      if (base instanceof Theme) {\n        object.deepMerge(theme, base);\n        theme.name = name;\n      }\n    }\n\n    object.deepMerge(theme.blockStyles, themeObj['blockStyles']);\n    object.deepMerge(theme.categoryStyles, themeObj['categoryStyles']);\n    object.deepMerge(theme.componentStyles, themeObj['componentStyles']);\n    object.deepMerge(theme.fontStyle, themeObj['fontStyle']);\n    if (themeObj['startHats'] !== null) {\n      theme.startHats = themeObj['startHats'];\n    }\n\n    return theme;\n  }\n}\n\nexport namespace Theme {\n  export interface BlockStyle {\n    colourPrimary: string;\n    colourSecondary: string;\n    colourTertiary: string;\n    hat: string;\n  }\n\n  export interface CategoryStyle {\n    colour: string;\n  }\n\n  export interface ComponentStyle {\n    workspaceBackgroundColour?: string;\n    toolboxBackgroundColour?: string;\n    toolboxForegroundColour?: string;\n    flyoutBackgroundColour?: string;\n    flyoutForegroundColour?: string;\n    flyoutOpacity?: number;\n    scrollbarColour?: string;\n    scrollbarOpacity?: number;\n    insertionMarkerColour?: string;\n    insertionMarkerOpacity?: number;\n    markerColour?: string;\n    cursorColour?: string;\n    selectedGlowColour?: string;\n    selectedGlowOpacity?: number;\n    replacementGlowColour?: string;\n    replacementGlowOpacity?: number;\n  }\n\n  export interface FontStyle {\n    family?: string;\n    weight?: string;\n    size?: number;\n  }\n}\n\nexport type BlockStyle = Theme.BlockStyle;\nexport type CategoryStyle = Theme.CategoryStyle;\nexport type ComponentStyle = Theme.ComponentStyle;\nexport type FontStyle = Theme.FontStyle;\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Themes.Classic');\n\nimport {Theme} from '../theme.js';\n\nconst defaultBlockStyles = {\n  'colour_blocks': {'colourPrimary': '20'},\n  'list_blocks': {'colourPrimary': '260'},\n  'logic_blocks': {'colourPrimary': '210'},\n  'loop_blocks': {'colourPrimary': '120'},\n  'math_blocks': {'colourPrimary': '230'},\n  'procedure_blocks': {'colourPrimary': '290'},\n  'text_blocks': {'colourPrimary': '160'},\n  'variable_blocks': {'colourPrimary': '330'},\n  'variable_dynamic_blocks': {'colourPrimary': '310'},\n  'hat_blocks': {'colourPrimary': '330', 'hat': 'cap'},\n};\n\nconst categoryStyles = {\n  'colour_category': {'colour': '20'},\n  'list_category': {'colour': '260'},\n  'logic_category': {'colour': '210'},\n  'loop_category': {'colour': '120'},\n  'math_category': {'colour': '230'},\n  'procedure_category': {'colour': '290'},\n  'text_category': {'colour': '160'},\n  'variable_category': {'colour': '330'},\n  'variable_dynamic_category': {'colour': '310'},\n};\n\n/**\n * Classic theme.\n * Contains multi-coloured border to create shadow effect.\n */\nexport const Classic = new Theme('classic', defaultBlockStyles, categoryStyles);\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object that controls settings for the workspace.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Options');\n\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as deprecation from './utils/deprecation.js';\nimport * as registry from './registry.js';\nimport {Theme} from './theme.js';\nimport {Classic} from './theme/classic.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport type {Metrics} from './utils/metrics.js';\nimport * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Parse the user-specified options, using reasonable defaults where behaviour\n * is unspecified.\n */\nexport class Options {\n  RTL: boolean;\n  oneBasedIndex: boolean;\n  collapse: boolean;\n  comments: boolean;\n  disable: boolean;\n  readOnly: boolean;\n  maxBlocks: number;\n  maxInstances: {[key: string]: number} | null;\n  modalInputs: boolean;\n  pathToMedia: string;\n  hasCategories: boolean;\n  moveOptions: MoveOptions;\n  hasScrollbars: boolean;\n  hasTrashcan: boolean;\n  maxTrashcanContents: number;\n  hasSounds: boolean;\n  hasCss: boolean;\n  horizontalLayout: boolean;\n  languageTree: toolbox.ToolboxInfo | null;\n  gridOptions: GridOptions;\n  zoomOptions: ZoomOptions;\n  toolboxPosition: toolbox.Position;\n  theme: Theme;\n  renderer: string;\n  rendererOverrides: {[rendererConstant: string]: any} | null;\n\n  /**\n   * The SVG element for the grid pattern.\n   * Created during injection.\n   */\n  gridPattern: SVGElement | null = null;\n  parentWorkspace: WorkspaceSvg | null;\n  plugins: {[key: string]: (new (...p1: any[]) => any) | string};\n\n  /**\n   * If set, sets the translation of the workspace to match the scrollbars.\n   * A function that\n   *     sets the translation of the workspace to match the scrollbars. The\n   *     argument Contains an x and/or y property which is a float between 0\n   *     and 1 specifying the degree of scrolling.\n   */\n  setMetrics?: (p1: {x?: number; y?: number}) => void = undefined;\n\n  /**\n   * A function that returns a metrics\n   *     object that describes the current workspace.\n   */\n  getMetrics?: () => Metrics = undefined;\n\n  /**\n   * @param options Dictionary of options.\n   *     Specification:\n   * https://developers.google.com/blockly/guides/get-started/web#configuration\n   */\n  constructor(options: BlocklyOptions) {\n    let toolboxJsonDef = null;\n    let hasCategories = false;\n    let hasTrashcan = false;\n    let hasCollapse = false;\n    let hasComments = false;\n    let hasDisable = false;\n    let hasSounds = false;\n    const readOnly = !!options['readOnly'];\n    if (!readOnly) {\n      toolboxJsonDef = toolbox.convertToolboxDefToJson(\n        options['toolbox'] ?? null\n      );\n      hasCategories = toolbox.hasCategories(toolboxJsonDef);\n      const rawHasTrashcan = options['trashcan'];\n      hasTrashcan =\n        rawHasTrashcan === undefined ? hasCategories : rawHasTrashcan;\n      const rawHasCollapse = options['collapse'];\n      hasCollapse =\n        rawHasCollapse === undefined ? hasCategories : rawHasCollapse;\n      const rawHasComments = options['comments'];\n      hasComments =\n        rawHasComments === undefined ? hasCategories : rawHasComments;\n      const rawHasDisable = options['disable'];\n      hasDisable = rawHasDisable === undefined ? hasCategories : rawHasDisable;\n      const rawHasSounds = options['sounds'];\n      hasSounds = rawHasSounds === undefined ? true : rawHasSounds;\n    }\n\n    let maxTrashcanContents = options['maxTrashcanContents'];\n    if (hasTrashcan) {\n      if (maxTrashcanContents === undefined) {\n        maxTrashcanContents = 32;\n      }\n    } else {\n      maxTrashcanContents = 0;\n    }\n    const rtl = !!options['rtl'];\n    let horizontalLayout = options['horizontalLayout'];\n    if (horizontalLayout === undefined) {\n      horizontalLayout = false;\n    }\n    const toolboxAtStart = options['toolboxPosition'] !== 'end';\n\n    let toolboxPosition: toolbox.Position;\n    if (horizontalLayout) {\n      toolboxPosition = toolboxAtStart\n        ? toolbox.Position.TOP\n        : toolbox.Position.BOTTOM;\n    } else {\n      toolboxPosition =\n        toolboxAtStart === rtl ? toolbox.Position.RIGHT : toolbox.Position.LEFT;\n    }\n\n    let hasCss = options['css'];\n    if (hasCss === undefined) {\n      hasCss = true;\n    }\n    let pathToMedia = 'https://blockly-demo.appspot.com/static/media/';\n    if (options['media']) {\n      pathToMedia = options['media'].endsWith('/')\n        ? options['media']\n        : options['media'] + '/';\n    } else if ('path' in options) {\n      // 'path' is a deprecated option which has been replaced by 'media'.\n      deprecation.warn('path', 'Nov 2014', 'Jul 2023', 'media');\n      pathToMedia = (options as any)['path'] + 'media/';\n    }\n    const rawOneBasedIndex = options['oneBasedIndex'];\n    const oneBasedIndex =\n      rawOneBasedIndex === undefined ? true : rawOneBasedIndex;\n    const renderer = options['renderer'] || 'geras';\n\n    const plugins = options['plugins'] || {};\n\n    let modalInputs = options['modalInputs'];\n    if (modalInputs === undefined) {\n      modalInputs = true;\n    }\n\n    this.RTL = rtl;\n    this.oneBasedIndex = oneBasedIndex;\n    this.collapse = hasCollapse;\n    this.comments = hasComments;\n    this.disable = hasDisable;\n    this.readOnly = readOnly;\n    this.maxBlocks = options['maxBlocks'] || Infinity;\n    this.maxInstances = options['maxInstances'] ?? null;\n    this.modalInputs = modalInputs;\n    this.pathToMedia = pathToMedia;\n    this.hasCategories = hasCategories;\n    this.moveOptions = Options.parseMoveOptions_(options, hasCategories);\n    /** @deprecated  January 2019 */\n    this.hasScrollbars = !!this.moveOptions.scrollbars;\n    this.hasTrashcan = hasTrashcan;\n    this.maxTrashcanContents = maxTrashcanContents;\n    this.hasSounds = hasSounds;\n    this.hasCss = hasCss;\n    this.horizontalLayout = horizontalLayout;\n    this.languageTree = toolboxJsonDef;\n    this.gridOptions = Options.parseGridOptions_(options);\n    this.zoomOptions = Options.parseZoomOptions_(options);\n    this.toolboxPosition = toolboxPosition;\n    this.theme = Options.parseThemeOptions_(options);\n    this.renderer = renderer;\n    this.rendererOverrides = options['rendererOverrides'] ?? null;\n\n    /**\n     * The parent of the current workspace, or null if there is no parent\n     * workspace.  We can assert that this is of type WorkspaceSvg as opposed to\n     * Workspace as this is only used in a rendered workspace.\n     */\n    this.parentWorkspace = options['parentWorkspace'] ?? null;\n\n    /** Map of plugin type to name of registered plugin or plugin class. */\n    this.plugins = plugins;\n  }\n\n  /**\n   * Parse the user-specified move options, using reasonable defaults where\n   *    behaviour is unspecified.\n   *\n   * @param options Dictionary of options.\n   * @param hasCategories Whether the workspace has categories or not.\n   * @returns Normalized move options.\n   */\n  private static parseMoveOptions_(\n    options: BlocklyOptions,\n    hasCategories: boolean\n  ): MoveOptions {\n    const move = options['move'] || {};\n    const moveOptions = {} as MoveOptions;\n    if (\n      move['scrollbars'] === undefined &&\n      options['scrollbars'] === undefined\n    ) {\n      moveOptions.scrollbars = hasCategories;\n    } else if (typeof move['scrollbars'] === 'object') {\n      moveOptions.scrollbars = {\n        'horizontal': !!move['scrollbars']['horizontal'],\n        'vertical': !!move['scrollbars']['vertical'],\n      };\n      // Convert scrollbars object to boolean if they have the same value.\n      // This allows us to easily check for whether any scrollbars exist using\n      // !!moveOptions.scrollbars.\n      if (\n        moveOptions.scrollbars.horizontal &&\n        moveOptions.scrollbars.vertical\n      ) {\n        moveOptions.scrollbars = true;\n      } else if (\n        !moveOptions.scrollbars.horizontal &&\n        !moveOptions.scrollbars.vertical\n      ) {\n        moveOptions.scrollbars = false;\n      }\n    } else {\n      moveOptions.scrollbars = !!move['scrollbars'] || !!options['scrollbars'];\n    }\n\n    if (!moveOptions.scrollbars || move['wheel'] === undefined) {\n      // Defaults to true if single-direction scroll is enabled.\n      moveOptions.wheel = typeof moveOptions.scrollbars === 'object';\n    } else {\n      moveOptions.wheel = !!move['wheel'];\n    }\n    if (!moveOptions.scrollbars) {\n      moveOptions.drag = false;\n    } else if (move['drag'] === undefined) {\n      // Defaults to true if scrollbars is true.\n      moveOptions.drag = true;\n    } else {\n      moveOptions.drag = !!move['drag'];\n    }\n    return moveOptions;\n  }\n\n  /**\n   * Parse the user-specified zoom options, using reasonable defaults where\n   * behaviour is unspecified.  See zoom documentation:\n   *   https://developers.google.com/blockly/guides/configure/web/zoom\n   *\n   * @param options Dictionary of options.\n   * @returns Normalized zoom options.\n   */\n  private static parseZoomOptions_(options: BlocklyOptions): ZoomOptions {\n    const zoom = options['zoom'] || {};\n    const zoomOptions = {} as ZoomOptions;\n    if (zoom['controls'] === undefined) {\n      zoomOptions.controls = false;\n    } else {\n      zoomOptions.controls = !!zoom['controls'];\n    }\n    if (zoom['wheel'] === undefined) {\n      zoomOptions.wheel = false;\n    } else {\n      zoomOptions.wheel = !!zoom['wheel'];\n    }\n    if (zoom['startScale'] === undefined) {\n      zoomOptions.startScale = 1;\n    } else {\n      zoomOptions.startScale = Number(zoom['startScale']);\n    }\n    if (zoom['maxScale'] === undefined) {\n      zoomOptions.maxScale = 3;\n    } else {\n      zoomOptions.maxScale = Number(zoom['maxScale']);\n    }\n    if (zoom['minScale'] === undefined) {\n      zoomOptions.minScale = 0.3;\n    } else {\n      zoomOptions.minScale = Number(zoom['minScale']);\n    }\n    if (zoom['scaleSpeed'] === undefined) {\n      zoomOptions.scaleSpeed = 1.2;\n    } else {\n      zoomOptions.scaleSpeed = Number(zoom['scaleSpeed']);\n    }\n    if (zoom['pinch'] === undefined) {\n      zoomOptions.pinch = zoomOptions.wheel || zoomOptions.controls;\n    } else {\n      zoomOptions.pinch = !!zoom['pinch'];\n    }\n    return zoomOptions;\n  }\n\n  /**\n   * Parse the user-specified grid options, using reasonable defaults where\n   * behaviour is unspecified. See grid documentation:\n   *   https://developers.google.com/blockly/guides/configure/web/grid\n   *\n   * @param options Dictionary of options.\n   * @returns Normalized grid options.\n   */\n  private static parseGridOptions_(options: BlocklyOptions): GridOptions {\n    const grid = options['grid'] || {};\n    const gridOptions = {} as GridOptions;\n    gridOptions.spacing = Number(grid['spacing']) || 0;\n    gridOptions.colour = grid['colour'] || '#888';\n    gridOptions.length =\n      grid['length'] === undefined ? 1 : Number(grid['length']);\n    gridOptions.snap = gridOptions.spacing > 0 && !!grid['snap'];\n    return gridOptions;\n  }\n\n  /**\n   * Parse the user-specified theme options, using the classic theme as a\n   * default. https://developers.google.com/blockly/guides/configure/web/themes\n   *\n   * @param options Dictionary of options.\n   * @returns A Blockly Theme.\n   */\n  private static parseThemeOptions_(options: BlocklyOptions): Theme {\n    const theme = options['theme'] || Classic;\n    if (typeof theme === 'string') {\n      return registry.getObject(registry.Type.THEME, theme) as Theme;\n    } else if (theme instanceof Theme) {\n      return theme;\n    }\n    return Theme.defineTheme(\n      theme.name || 'builtin' + idGenerator.getNextUniqueId(),\n      theme\n    );\n  }\n}\n\nexport namespace Options {\n  export interface GridOptions {\n    colour: string;\n    length: number;\n    snap: boolean;\n    spacing: number;\n  }\n\n  export interface MoveOptions {\n    drag: boolean;\n    scrollbars: boolean | ScrollbarOptions;\n    wheel: boolean;\n  }\n\n  export interface ScrollbarOptions {\n    horizontal: boolean;\n    vertical: boolean;\n  }\n\n  export interface ZoomOptions {\n    controls: boolean;\n    maxScale: number;\n    minScale: number;\n    pinch: boolean;\n    scaleSpeed: number;\n    startScale: number;\n    wheel: boolean;\n  }\n}\n\nexport type GridOptions = Options.GridOptions;\nexport type MoveOptions = Options.MoveOptions;\nexport type ScrollbarOptions = Options.ScrollbarOptions;\nexport type ZoomOptions = Options.ZoomOptions;\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Abstract as AbstractEvent} from '../events/events_abstract.js';\nimport type {BlocklyOptions} from '../blockly_options.js';\nimport {Bubble} from './bubble.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport {Options} from '../options.js';\nimport {Svg} from '../utils/svg.js';\nimport type {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\nexport class MiniWorkspaceBubble extends Bubble {\n  /**\n   * The minimum amount of change to the mini workspace view to trigger\n   * resizing the bubble.\n   */\n  private static readonly MINIMUM_VIEW_CHANGE = 10;\n\n  /**\n   * An arbitrary margin of whitespace to put around the blocks in the\n   * workspace.\n   */\n  private static readonly MARGIN = Bubble.DOUBLE_BORDER * 3;\n\n  /** The root svg element containing the workspace. */\n  private svgDialog: SVGElement;\n\n  /** The workspace that gets shown within this bubble. */\n  private miniWorkspace: WorkspaceSvg;\n\n  /**\n   * Should this bubble automatically reposition itself when it resizes?\n   * Becomes false after this bubble is first dragged.\n   */\n  private autoLayout = true;\n\n  /** @internal */\n  constructor(\n    workspaceOptions: BlocklyOptions,\n    protected readonly workspace: WorkspaceSvg,\n    protected anchor: Coordinate,\n    protected ownerRect?: Rect\n  ) {\n    super(workspace, anchor, ownerRect);\n    const options = new Options(workspaceOptions);\n    this.validateWorkspaceOptions(options);\n\n    this.svgDialog = dom.createSvgElement(\n      Svg.SVG,\n      {\n        'x': Bubble.BORDER_WIDTH,\n        'y': Bubble.BORDER_WIDTH,\n      },\n      this.contentContainer\n    );\n    workspaceOptions.parentWorkspace = this.workspace;\n    this.miniWorkspace = this.newWorkspaceSvg(new Options(workspaceOptions));\n    const background = this.miniWorkspace.createDom('blocklyMutatorBackground');\n    this.svgDialog.appendChild(background);\n    if (options.languageTree) {\n      background.insertBefore(\n        this.miniWorkspace.addFlyout(Svg.G),\n        this.miniWorkspace.getCanvas()\n      );\n      const flyout = this.miniWorkspace.getFlyout();\n      flyout?.init(this.miniWorkspace);\n      flyout?.show(options.languageTree);\n    }\n\n    this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this));\n    this.miniWorkspace\n      .getFlyout()\n      ?.getWorkspace()\n      ?.addChangeListener(this.onWorkspaceChange.bind(this));\n    this.updateBubbleSize();\n  }\n\n  dispose() {\n    this.miniWorkspace.dispose();\n    super.dispose();\n  }\n\n  /** @internal */\n  getWorkspace(): WorkspaceSvg {\n    return this.miniWorkspace;\n  }\n\n  /** Adds a change listener to the mini workspace. */\n  addWorkspaceChangeListener(listener: (e: AbstractEvent) => void) {\n    this.miniWorkspace.addChangeListener(listener);\n  }\n\n  /**\n   * Validates the workspace options to make sure folks aren't trying to\n   * enable things the miniworkspace doesn't support.\n   */\n  private validateWorkspaceOptions(options: Options) {\n    if (options.hasCategories) {\n      throw new Error(\n        'The miniworkspace bubble does not support toolboxes with categories'\n      );\n    }\n    if (options.hasTrashcan) {\n      throw new Error('The miniworkspace bubble does not support trashcans');\n    }\n    if (\n      options.zoomOptions.controls ||\n      options.zoomOptions.wheel ||\n      options.zoomOptions.pinch\n    ) {\n      throw new Error('The miniworkspace bubble does not support zooming');\n    }\n    if (\n      options.moveOptions.scrollbars ||\n      options.moveOptions.wheel ||\n      options.moveOptions.drag\n    ) {\n      throw new Error(\n        'The miniworkspace bubble does not scrolling/moving the workspace'\n      );\n    }\n    if (options.horizontalLayout) {\n      throw new Error(\n        'The miniworkspace bubble does not support horizontal layouts'\n      );\n    }\n  }\n\n  private onWorkspaceChange() {\n    this.bumpBlocksIntoBounds();\n    this.updateBubbleSize();\n  }\n\n  /**\n   * Bumps blocks that are above the top or outside the start-side of the\n   * workspace back within the workspace.\n   *\n   * Blocks that are below the bottom or outside the end-side of the workspace\n   * are dealt with by resizing the workspace to show them.\n   */\n  private bumpBlocksIntoBounds() {\n    if (this.miniWorkspace.isDragging()) return;\n\n    const MARGIN = 20;\n\n    for (const block of this.miniWorkspace.getTopBlocks(false)) {\n      const blockXY = block.getRelativeToSurfaceXY();\n\n      // Bump any block that's above the top back inside.\n      if (blockXY.y < MARGIN) {\n        block.moveBy(0, MARGIN - blockXY.y);\n      }\n      // Bump any block overlapping the flyout back inside.\n      if (block.RTL) {\n        let right = -MARGIN;\n        const flyout = this.miniWorkspace.getFlyout();\n        if (flyout) {\n          right -= flyout.getWidth();\n        }\n        if (blockXY.x > right) {\n          block.moveBy(right - blockXY.x, 0);\n        }\n      } else if (blockXY.x < MARGIN) {\n        block.moveBy(MARGIN - blockXY.x, 0);\n      }\n    }\n  }\n\n  /**\n   * Updates the size of this bubble to account for the size of the\n   * mini workspace.\n   */\n  private updateBubbleSize() {\n    if (this.miniWorkspace.isDragging()) return;\n\n    const currSize = this.getSize();\n    const newSize = this.calculateWorkspaceSize();\n    if (\n      Math.abs(currSize.width - newSize.width) <\n        MiniWorkspaceBubble.MINIMUM_VIEW_CHANGE &&\n      Math.abs(currSize.height - newSize.height) <\n        MiniWorkspaceBubble.MINIMUM_VIEW_CHANGE\n    ) {\n      // Only resize if the size has noticeably changed.\n      return;\n    }\n    this.svgDialog.setAttribute('width', `${newSize.width}px`);\n    this.svgDialog.setAttribute('height', `${newSize.height}px`);\n    this.miniWorkspace.setCachedParentSvgSize(newSize.width, newSize.height);\n    if (this.miniWorkspace.RTL) {\n      // Scroll the workspace to always left-align.\n      this.miniWorkspace\n        .getCanvas()\n        .setAttribute('transform', `translate(${newSize.width}, 0)`);\n    }\n    this.setSize(\n      new Size(\n        newSize.width + Bubble.DOUBLE_BORDER,\n        newSize.height + Bubble.DOUBLE_BORDER\n      ),\n      this.autoLayout\n    );\n    this.miniWorkspace.resize();\n    this.miniWorkspace.recordDragTargets();\n  }\n\n  /**\n   * Calculates the size of the mini workspace for use in resizing the bubble.\n   */\n  private calculateWorkspaceSize(): Size {\n    // TODO (#7104): Clean this up to be more readable and unified for RTL\n    //     vs LTR.\n    const canvas = this.miniWorkspace.getCanvas();\n    const workspaceSize = canvas.getBBox();\n    let width = workspaceSize.width + workspaceSize.x;\n    let height = workspaceSize.height + MiniWorkspaceBubble.MARGIN;\n    const flyout = this.miniWorkspace.getFlyout();\n    if (flyout) {\n      const flyoutScrollMetrics = flyout\n        .getWorkspace()\n        .getMetricsManager()\n        .getScrollMetrics();\n      height = Math.max(height, flyoutScrollMetrics.height + 20);\n      width += flyout.getWidth();\n    }\n    if (this.miniWorkspace.RTL) {\n      width = -workspaceSize.x;\n    }\n    width += MiniWorkspaceBubble.MARGIN;\n    return new Size(width, height);\n  }\n\n  /** Reapplies styles to all of the blocks in the mini workspace. */\n  updateBlockStyles() {\n    for (const block of this.miniWorkspace.getAllBlocks(false)) {\n      block.setStyle(block.getStyleName());\n    }\n\n    const flyoutWs = this.miniWorkspace.getFlyout()?.getWorkspace();\n    if (flyoutWs) {\n      for (const block of flyoutWs.getAllBlocks(false)) {\n        block.setStyle(block.getStyleName());\n      }\n    }\n  }\n\n  /**\n   * Move this bubble during a drag.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate): void {\n    super.moveDuringDrag(newLoc);\n    this.autoLayout = false;\n  }\n\n  /** @internal */\n  moveTo(x: number, y: number): void {\n    super.moveTo(x, y);\n    this.miniWorkspace.recordDragTargets();\n  }\n\n  /** @internal */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  newWorkspaceSvg(options: Options): WorkspaceSvg {\n    throw new Error(\n      'The implementation of newWorkspaceSvg should be ' +\n        'monkey-patched in by blockly.ts'\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Mutator');\n\nimport type {Abstract} from '../events/events_abstract.js';\nimport type {Block} from '../block.js';\nimport {BlockChange} from '../events/events_block_change.js';\nimport type {BlocklyOptions} from '../blockly_options.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport type {Connection} from '../connection.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport * as eventUtils from '../events/utils.js';\nimport type {IHasBubble} from '../interfaces/i_has_bubble.js';\nimport {Icon} from './icon.js';\nimport {MiniWorkspaceBubble} from '../bubbles/mini_workspace_bubble.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\nimport * as deprecation from '../utils/deprecation.js';\nimport {IconType} from './icon_types.js';\n\n/** The size of the mutator icon in workspace-scale units. */\nconst SIZE = 17;\n\n/**\n * The distance between the root block in the mini workspace and that\n * workspace's edges.\n */\nconst WORKSPACE_MARGIN = 16;\n\nexport class MutatorIcon extends Icon implements IHasBubble {\n  /** The type string used to identify this icon. */\n  static readonly TYPE = IconType.MUTATOR;\n\n  /**\n   * The weight this icon has relative to other icons. Icons with more positive\n   * weight values are rendered farther toward the end of the block.\n   */\n  static readonly WEIGHT = 1;\n\n  /** The bubble used to show the mini workspace to the user. */\n  private miniWorkspaceBubble: MiniWorkspaceBubble | null = null;\n\n  /** The root block in the mini workspace. */\n  private rootBlock: BlockSvg | null = null;\n\n  /** The PID tracking updating the workkspace in response to user events. */\n  private updateWorkspacePid: ReturnType<typeof setTimeout> | null = null;\n\n  constructor(\n    private readonly flyoutBlockTypes: string[],\n    protected readonly sourceBlock: BlockSvg\n  ) {\n    super(sourceBlock);\n  }\n\n  override getType(): IconType<MutatorIcon> {\n    return MutatorIcon.TYPE;\n  }\n\n  override initView(pointerdownListener: (e: PointerEvent) => void): void {\n    if (this.svgRoot) return; // Already initialized.\n\n    super.initView(pointerdownListener);\n\n    // Square with rounded corners.\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyIconShape',\n        'rx': '4',\n        'ry': '4',\n        'height': '16',\n        'width': '16',\n      },\n      this.svgRoot\n    );\n    // Gear teeth.\n    dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyIconSymbol',\n        'd':\n          'm4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,' +\n          '0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,' +\n          '-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,' +\n          '-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,' +\n          '-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 ' +\n          '-0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,' +\n          '0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z',\n      },\n      this.svgRoot\n    );\n    // Axle hole.\n    dom.createSvgElement(\n      Svg.CIRCLE,\n      {'class': 'blocklyIconShape', 'r': '2.7', 'cx': '8', 'cy': '8'},\n      this.svgRoot\n    );\n  }\n\n  override dispose(): void {\n    super.dispose();\n    this.miniWorkspaceBubble?.dispose();\n  }\n\n  override getWeight(): number {\n    return MutatorIcon.WEIGHT;\n  }\n\n  override getSize(): Size {\n    return new Size(SIZE, SIZE);\n  }\n\n  override applyColour(): void {\n    super.applyColour();\n    this.miniWorkspaceBubble?.setColour(this.sourceBlock.style.colourPrimary);\n    this.miniWorkspaceBubble?.updateBlockStyles();\n  }\n\n  override updateCollapsed(): void {\n    super.updateCollapsed();\n    if (this.sourceBlock.isCollapsed()) this.setBubbleVisible(false);\n  }\n\n  override onLocationChange(blockOrigin: Coordinate): void {\n    super.onLocationChange(blockOrigin);\n    this.miniWorkspaceBubble?.setAnchorLocation(this.getAnchorLocation());\n  }\n\n  override onClick(): void {\n    super.onClick();\n    this.setBubbleVisible(!this.bubbleIsVisible());\n  }\n\n  bubbleIsVisible(): boolean {\n    return !!this.miniWorkspaceBubble;\n  }\n\n  setBubbleVisible(visible: boolean): void {\n    if (this.bubbleIsVisible() === visible) return;\n\n    if (visible) {\n      this.miniWorkspaceBubble = new MiniWorkspaceBubble(\n        this.getMiniWorkspaceConfig(),\n        this.sourceBlock.workspace,\n        this.getAnchorLocation(),\n        this.getBubbleOwnerRect()\n      );\n      this.applyColour();\n      this.createRootBlock();\n      this.addSaveConnectionsListener();\n      this.miniWorkspaceBubble?.addWorkspaceChangeListener(\n        this.createMiniWorkspaceChangeListener()\n      );\n    } else {\n      this.miniWorkspaceBubble?.dispose();\n      this.miniWorkspaceBubble = null;\n    }\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BUBBLE_OPEN))(\n        this.sourceBlock,\n        visible,\n        'mutator'\n      )\n    );\n  }\n\n  /** @returns the configuration the mini workspace should have. */\n  private getMiniWorkspaceConfig() {\n    const options: BlocklyOptions = {\n      'disable': false,\n      'media': this.sourceBlock.workspace.options.pathToMedia,\n      'rtl': this.sourceBlock.RTL,\n      'renderer': this.sourceBlock.workspace.options.renderer,\n      'rendererOverrides':\n        this.sourceBlock.workspace.options.rendererOverrides ?? undefined,\n    };\n\n    if (this.flyoutBlockTypes.length) {\n      options.toolbox = {\n        'kind': 'flyoutToolbox',\n        'contents': this.flyoutBlockTypes.map((type) => ({\n          'kind': 'block',\n          'type': type,\n        })),\n      };\n    }\n\n    return options;\n  }\n\n  /**\n   * @returns the location the bubble should be anchored to.\n   *     I.E. the middle of this icon.\n   */\n  private getAnchorLocation(): Coordinate {\n    const midIcon = SIZE / 2;\n    return Coordinate.sum(\n      this.workspaceLocation,\n      new Coordinate(midIcon, midIcon)\n    );\n  }\n\n  /**\n   * @returns the rect the bubble should avoid overlapping.\n   *     I.E. the block that owns this icon.\n   */\n  private getBubbleOwnerRect(): Rect {\n    const bbox = this.sourceBlock.getSvgRoot().getBBox();\n    return new Rect(bbox.y, bbox.y + bbox.height, bbox.x, bbox.x + bbox.width);\n  }\n\n  /** Decomposes the source block to create blocks in the mini workspace. */\n  private createRootBlock() {\n    this.rootBlock = this.sourceBlock.decompose!(\n      this.miniWorkspaceBubble!.getWorkspace()\n    )!;\n\n    for (const child of this.rootBlock.getDescendants(false)) {\n      child.queueRender();\n    }\n\n    this.rootBlock.setMovable(false);\n    this.rootBlock.setDeletable(false);\n\n    const flyoutWidth =\n      this.miniWorkspaceBubble?.getWorkspace()?.getFlyout()?.getWidth() ?? 0;\n    this.rootBlock.moveBy(\n      this.rootBlock.RTL ? -(flyoutWidth + WORKSPACE_MARGIN) : WORKSPACE_MARGIN,\n      WORKSPACE_MARGIN\n    );\n  }\n\n  /** Adds a listen to the source block that triggers saving connections. */\n  private addSaveConnectionsListener() {\n    if (!this.sourceBlock.saveConnections || !this.rootBlock) return;\n    const saveConnectionsListener = () => {\n      if (!this.sourceBlock.saveConnections || !this.rootBlock) return;\n      this.sourceBlock.saveConnections(this.rootBlock);\n    };\n    saveConnectionsListener();\n    this.sourceBlock.workspace.addChangeListener(saveConnectionsListener);\n  }\n\n  /**\n   * Creates a change listener to add to the mini workspace which recomposes\n   * the block.\n   */\n  private createMiniWorkspaceChangeListener() {\n    return (e: Abstract) => {\n      if (!MutatorIcon.isIgnorableMutatorEvent(e) && !this.updateWorkspacePid) {\n        this.updateWorkspacePid = setTimeout(() => {\n          this.updateWorkspacePid = null;\n          this.recomposeSourceBlock();\n        }, 0);\n      }\n    };\n  }\n\n  /**\n   * Returns true if the given event is not one the mutator needs to\n   * care about.\n   *\n   * @internal\n   */\n  static isIgnorableMutatorEvent(e: Abstract) {\n    return (\n      e.isUiEvent ||\n      e.type === eventUtils.CREATE ||\n      (e.type === eventUtils.CHANGE &&\n        (e as BlockChange).element === 'disabled')\n    );\n  }\n\n  /** Recomposes the source block based on changes to the mini workspace. */\n  private recomposeSourceBlock() {\n    if (!this.rootBlock) return;\n\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) eventUtils.setGroup(true);\n\n    const oldExtraState = BlockChange.getExtraBlockState_(this.sourceBlock);\n    this.sourceBlock.compose!(this.rootBlock);\n    const newExtraState = BlockChange.getExtraBlockState_(this.sourceBlock);\n\n    if (oldExtraState !== newExtraState) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this.sourceBlock,\n          'mutation',\n          null,\n          oldExtraState,\n          newExtraState\n        )\n      );\n    }\n\n    eventUtils.setGroup(existingGroup);\n  }\n\n  /** @internal */\n  getWorkspace(): WorkspaceSvg | undefined {\n    return this.miniWorkspaceBubble?.getWorkspace();\n  }\n\n  /**\n   * Reconnects the given connection to the mutated input on the given block.\n   *\n   * @deprecated Use connection.reconnect instead. To be removed in v11.\n   */\n  static reconnect(\n    connectionChild: Connection | null,\n    block: Block,\n    inputName: string\n  ): boolean {\n    deprecation.warn(\n      'MutatorIcon.reconnect',\n      'v10',\n      'v11',\n      'connection.reconnect'\n    );\n    if (!connectionChild) return false;\n    return connectionChild.reconnect(block, inputName);\n  }\n\n  /**\n   * Returns the parent workspace of a workspace that is inside a mini workspace\n   * bubble, taking into account whether the workspace is a flyout.\n   *\n   * @deprecated Use workspace.getRootWorkspace. To be removed in v11.\n   */\n  static findParentWs(workspace: WorkspaceSvg): WorkspaceSvg | null {\n    deprecation.warn(\n      'MutatorIcon.findParentWs',\n      'v10',\n      'v11',\n      'workspace.getRootWorkspace'\n    );\n    return workspace.getRootWorkspace();\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Non-editable, non-serializable text field.  Used for titles,\n *    labels, etc.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldLabel');\n\nimport * as dom from './utils/dom.js';\nimport {Field, FieldConfig} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as parsing from './utils/parsing.js';\n\n/**\n * Class for a non-editable, non-serializable text field.\n */\nexport class FieldLabel extends Field<string> {\n  /** The HTML class name to use for this field. */\n  private class: string | null = null;\n\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. This field should not.\n   */\n  override EDITABLE = false;\n\n  /** Text labels should not truncate. */\n  override maxDisplayLength = Infinity;\n\n  /**\n   * @param value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param textClass Optional CSS class for the field's text.\n   * @param config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/label#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    textClass?: string,\n    config?: FieldLabelConfig\n  ) {\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    } else {\n      this.class = textClass || null;\n    }\n    this.setValue(value);\n  }\n\n  protected override configure_(config: FieldLabelConfig) {\n    super.configure_(config);\n    if (config.class) this.class = config.class;\n  }\n\n  /**\n   * Create block UI for this label.\n   *\n   * @internal\n   */\n  override initView() {\n    this.createTextElement_();\n    if (this.class) {\n      dom.addClass(this.getTextElement(), this.class);\n    }\n  }\n\n  /**\n   * Ensure that the input value casts to a valid string.\n   *\n   * @param newValue The input value.\n   * @returns A valid string, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration\n  ): string | null {\n    if (newValue === null || newValue === undefined) {\n      return null;\n    }\n    return `${newValue}`;\n  }\n\n  /**\n   * Set the CSS class applied to the field's textElement_.\n   *\n   * @param cssClass The new CSS class name, or null to remove.\n   */\n  setClass(cssClass: string | null) {\n    if (this.textElement_) {\n      if (this.class) {\n        dom.removeClass(this.textElement_, this.class);\n      }\n      if (cssClass) {\n        dom.addClass(this.textElement_, cssClass);\n      }\n    }\n    this.class = cssClass;\n  }\n\n  /**\n   * Construct a FieldLabel from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and class).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldLabelFromJsonConfig): FieldLabel {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldLabel if that class doesn't override\n    // the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_label', FieldLabel);\n\nFieldLabel.prototype.DEFAULT_VALUE = '';\n\n// clang-format off\n// Clang does not like the 'class' keyword being used as a property.\n/**\n * Config options for the label field.\n */\nexport interface FieldLabelConfig extends FieldConfig {\n  class?: string;\n}\n// clang-format on\n\n/**\n * fromJson config options for the label field.\n */\nexport interface FieldLabelFromJsonConfig extends FieldLabelConfig {\n  text?: string;\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing an input (value, statement, or dummy).\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Input');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport '../field_label.js';\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport type {Connection} from '../connection.js';\nimport type {ConnectionType} from '../connection_type.js';\nimport type {Field} from '../field.js';\nimport * as fieldRegistry from '../field_registry.js';\nimport type {RenderedConnection} from '../rendered_connection.js';\nimport {inputTypes} from './input_types.js';\n\n/**\n * Class for an input with an optional field.\n */\nexport class Input {\n  fieldRow: Field[] = [];\n  /** Alignment of input's fields (left, right or centre). */\n  align = Align.LEFT;\n\n  /** Is the input visible? */\n  private visible = true;\n\n  public readonly type: inputTypes = inputTypes.CUSTOM;\n\n  public connection: Connection | null = null;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param sourceBlock The block containing this input.\n   */\n  constructor(public name: string, private sourceBlock: Block) {}\n\n  /**\n   * Get the source block for this input.\n   *\n   * @returns The block this input is part of.\n   */\n  getSourceBlock(): Block {\n    return this.sourceBlock;\n  }\n\n  /**\n   * Add a field (or label from string), and all prefix and suffix fields, to\n   * the end of the input's field row.\n   *\n   * @param field Something to add as a field.\n   * @param opt_name Language-neutral identifier which may used to find this\n   *     field again.  Should be unique to the host block.\n   * @returns The input being append to (to allow chaining).\n   */\n  appendField<T>(field: string | Field<T>, opt_name?: string): Input {\n    this.insertFieldAt(this.fieldRow.length, field, opt_name);\n    return this;\n  }\n\n  /**\n   * Inserts a field (or label from string), and all prefix and suffix fields,\n   * at the location of the input's field row.\n   *\n   * @param index The index at which to insert field.\n   * @param field Something to add as a field.\n   * @param opt_name Language-neutral identifier which may used to find this\n   *     field again.  Should be unique to the host block.\n   * @returns The index following the last inserted field.\n   */\n  insertFieldAt<T>(\n    index: number,\n    field: string | Field<T>,\n    opt_name?: string\n  ): number {\n    if (index < 0 || index > this.fieldRow.length) {\n      throw Error('index ' + index + ' out of bounds.');\n    }\n    // Falsy field values don't generate a field, unless the field is an empty\n    // string and named.\n    if (!field && !(field === '' && opt_name)) {\n      return index;\n    }\n\n    // Generate a FieldLabel when given a plain text field.\n    if (typeof field === 'string') {\n      field = fieldRegistry.fromJson({\n        type: 'field_label',\n        text: field,\n      })!;\n    }\n\n    field.setSourceBlock(this.sourceBlock);\n    if (this.sourceBlock.rendered) {\n      field.init();\n      field.applyColour();\n    }\n    field.name = opt_name;\n    field.setVisible(this.isVisible());\n\n    if (field.prefixField) {\n      // Add any prefix.\n      index = this.insertFieldAt(index, field.prefixField);\n    }\n    // Add the field to the field row.\n    this.fieldRow.splice(index, 0, field as Field);\n    index++;\n    if (field.suffixField) {\n      // Add any suffix.\n      index = this.insertFieldAt(index, field.suffixField);\n    }\n\n    if (this.sourceBlock.rendered) {\n      (this.sourceBlock as BlockSvg).queueRender();\n      // Adding a field will cause the block to change shape.\n      this.sourceBlock.bumpNeighbours();\n    }\n    return index;\n  }\n\n  /**\n   * Remove a field from this input.\n   *\n   * @param name The name of the field.\n   * @param opt_quiet True to prevent an error if field is not present.\n   * @returns True if operation succeeds, false if field is not present and\n   *     opt_quiet is true.\n   * @throws {Error} if the field is not present and opt_quiet is false.\n   */\n  removeField(name: string, opt_quiet?: boolean): boolean {\n    for (let i = 0, field; (field = this.fieldRow[i]); i++) {\n      if (field.name === name) {\n        field.dispose();\n        this.fieldRow.splice(i, 1);\n        if (this.sourceBlock.rendered) {\n          (this.sourceBlock as BlockSvg).queueRender();\n          // Removing a field will cause the block to change shape.\n          this.sourceBlock.bumpNeighbours();\n        }\n        return true;\n      }\n    }\n    if (opt_quiet) {\n      return false;\n    }\n    throw Error('Field \"' + name + '\" not found.');\n  }\n\n  /**\n   * Gets whether this input is visible or not.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.visible;\n  }\n\n  /**\n   * Sets whether this input is visible or not.\n   * Should only be used to collapse/uncollapse a block.\n   *\n   * @param visible True if visible.\n   * @returns List of blocks to render.\n   * @internal\n   */\n  setVisible(visible: boolean): BlockSvg[] {\n    // Note: Currently there are only unit tests for block.setCollapsed()\n    // because this function is package. If this function goes back to being a\n    // public API tests (lots of tests) should be added.\n    let renderList: AnyDuringMigration[] = [];\n    if (this.visible === visible) {\n      return renderList;\n    }\n    this.visible = visible;\n\n    for (let y = 0, field; (field = this.fieldRow[y]); y++) {\n      field.setVisible(visible);\n    }\n    if (this.connection) {\n      const renderedConnection = this.connection as RenderedConnection;\n      // Has a connection.\n      if (visible) {\n        renderList = renderedConnection.startTrackingAll();\n      } else {\n        renderedConnection.stopTrackingAll();\n      }\n      const child = renderedConnection.targetBlock();\n      if (child) {\n        child.getSvgRoot().style.display = visible ? 'block' : 'none';\n      }\n    }\n    return renderList;\n  }\n\n  /**\n   * Mark all fields on this input as dirty.\n   *\n   * @internal\n   */\n  markDirty() {\n    for (let y = 0, field; (field = this.fieldRow[y]); y++) {\n      field.markDirty();\n    }\n  }\n\n  /**\n   * Change a connection's compatibility.\n   *\n   * @param check Compatible value type or list of value types.  Null if all\n   *     types are compatible.\n   * @returns The input being modified (to allow chaining).\n   */\n  setCheck(check: string | string[] | null): Input {\n    if (!this.connection) {\n      throw Error('This input does not have a connection.');\n    }\n    this.connection.setCheck(check);\n    return this;\n  }\n\n  /**\n   * Change the alignment of the connection's field(s).\n   *\n   * @param align One of the values of Align.  In RTL mode directions\n   *     are reversed, and Align.RIGHT aligns to the left.\n   * @returns The input being modified (to allow chaining).\n   */\n  setAlign(align: Align): Input {\n    this.align = align;\n    if (this.sourceBlock.rendered) {\n      const sourceBlock = this.sourceBlock as BlockSvg;\n      sourceBlock.queueRender();\n    }\n    return this;\n  }\n\n  /**\n   * Changes the connection's shadow block.\n   *\n   * @param shadow DOM representation of a block or null.\n   * @returns The input being modified (to allow chaining).\n   */\n  setShadowDom(shadow: Element | null): Input {\n    if (!this.connection) {\n      throw Error('This input does not have a connection.');\n    }\n    this.connection.setShadowDom(shadow);\n    return this;\n  }\n\n  /**\n   * Returns the XML representation of the connection's shadow block.\n   *\n   * @returns Shadow DOM representation of a block or null.\n   */\n  getShadowDom(): Element | null {\n    if (!this.connection) {\n      throw Error('This input does not have a connection.');\n    }\n    return this.connection.getShadowDom();\n  }\n\n  /** Initialize the fields on this input. */\n  init() {\n    if (!this.sourceBlock.workspace.rendered) {\n      return; // Headless blocks don't need fields initialized.\n    }\n    for (let i = 0; i < this.fieldRow.length; i++) {\n      this.fieldRow[i].init();\n    }\n  }\n\n  /**\n   * Sever all links to this input.\n   */\n  dispose() {\n    for (let i = 0, field; (field = this.fieldRow[i]); i++) {\n      field.dispose();\n    }\n    if (this.connection) {\n      this.connection.dispose();\n    }\n  }\n\n  /**\n   * Constructs a connection based on the type of this input's source block.\n   * Properly handles constructing headless connections for headless blocks\n   * and rendered connections for rendered blocks.\n   *\n   * @returns a connection of the given type, which is either a headless\n   *     or rendered connection, based on the type of this input's source block.\n   */\n  protected makeConnection(type: ConnectionType): Connection {\n    return this.sourceBlock.makeConnection_(type);\n  }\n}\n\nexport namespace Input {\n  /**\n   * Enum for alignment of inputs.\n   *\n   */\n  export enum Align {\n    LEFT = -1,\n    CENTRE = 0,\n    RIGHT = 1,\n  }\n}\n\nexport type Align = Input.Align;\nexport const Align = Input.Align;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils.KeyCodes');\n\n/**\n * Key codes for common characters.\n *\n * Copied from Closure's goog.events.KeyCodes\n *\n * This list is not localized and therefore some of the key codes are not\n * correct for non US keyboard layouts. See comments below.\n */\nexport enum KeyCodes {\n  WIN_KEY_FF_LINUX = 0,\n  MAC_ENTER = 3,\n  BACKSPACE = 8,\n  TAB = 9,\n  NUM_CENTER = 12, // NUMLOCK on FF/Safari Mac\n  ENTER = 13,\n  SHIFT = 16,\n  CTRL = 17,\n  ALT = 18,\n  PAUSE = 19,\n  CAPS_LOCK = 20,\n  ESC = 27,\n  SPACE = 32,\n  PAGE_UP = 33, // also NUM_NORTH_EAST\n  PAGE_DOWN = 34, // also NUM_SOUTH_EAST\n  END = 35, // also NUM_SOUTH_WEST\n  HOME = 36, // also NUM_NORTH_WEST\n  LEFT = 37, // also NUM_WEST\n  UP = 38, // also NUM_NORTH\n  RIGHT = 39, // also NUM_EAST\n  DOWN = 40, // also NUM_SOUTH\n  PLUS_SIGN = 43, // NOT numpad plus\n  PRINT_SCREEN = 44,\n  INSERT = 45, // also NUM_INSERT\n  DELETE = 46, // also NUM_DELETE\n  ZERO = 48,\n  ONE = 49,\n  TWO = 50,\n  THREE = 51,\n  FOUR = 52,\n  FIVE = 53,\n  SIX = 54,\n  SEVEN = 55,\n  EIGHT = 56,\n  NINE = 57,\n  FF_SEMICOLON = 59, // Firefox (Gecko) fires this for semicolon instead of 186\n  FF_EQUALS = 61, // Firefox (Gecko) fires this for equals instead of 187\n  FF_DASH = 173, // Firefox (Gecko) fires this for dash instead of 189\n  // Firefox (Gecko) fires this for # on UK keyboards, rather than\n  // Shift+SINGLE_QUOTE.\n  FF_HASH = 163,\n  QUESTION_MARK = 63, // needs localization\n  AT_SIGN = 64,\n  A = 65,\n  B = 66,\n  C = 67,\n  D = 68,\n  E = 69,\n  F = 70,\n  G = 71,\n  H = 72,\n  I = 73,\n  J = 74,\n  K = 75,\n  L = 76,\n  M = 77,\n  N = 78,\n  O = 79,\n  P = 80,\n  Q = 81,\n  R = 82,\n  S = 83,\n  T = 84,\n  U = 85,\n  V = 86,\n  W = 87,\n  X = 88,\n  Y = 89,\n  Z = 90,\n  META = 91, // WIN_KEY_LEFT\n  WIN_KEY_RIGHT = 92,\n  CONTEXT_MENU = 93,\n  NUM_ZERO = 96,\n  NUM_ONE = 97,\n  NUM_TWO = 98,\n  NUM_THREE = 99,\n  NUM_FOUR = 100,\n  NUM_FIVE = 101,\n  NUM_SIX = 102,\n  NUM_SEVEN = 103,\n  NUM_EIGHT = 104,\n  NUM_NINE = 105,\n  NUM_MULTIPLY = 106,\n  NUM_PLUS = 107,\n  NUM_MINUS = 109,\n  NUM_PERIOD = 110,\n  NUM_DIVISION = 111,\n  F1 = 112,\n  F2 = 113,\n  F3 = 114,\n  F4 = 115,\n  F5 = 116,\n  F6 = 117,\n  F7 = 118,\n  F8 = 119,\n  F9 = 120,\n  F10 = 121,\n  F11 = 122,\n  F12 = 123,\n  NUMLOCK = 144,\n  SCROLL_LOCK = 145,\n\n  // OS-specific media keys like volume controls and browser controls.\n  FIRST_MEDIA_KEY = 166,\n  LAST_MEDIA_KEY = 183,\n\n  SEMICOLON = 186, // needs localization\n  DASH = 189, // needs localization\n  EQUALS = 187, // needs localization\n  COMMA = 188, // needs localization\n  PERIOD = 190, // needs localization\n  SLASH = 191, // needs localization\n  APOSTROPHE = 192, // needs localization\n  TILDE = 192, // needs localization\n  SINGLE_QUOTE = 222, // needs localization\n  OPEN_SQUARE_BRACKET = 219, // needs localization\n  BACKSLASH = 220, // needs localization\n  CLOSE_SQUARE_BRACKET = 221, // needs localization\n  WIN_KEY = 224,\n  MAC_FF_META = 224, // Firefox (Gecko) fires this for the meta key instead of 91\n  MAC_WK_CMD_LEFT = 91, // WebKit Left Command key fired, same as META\n  MAC_WK_CMD_RIGHT = 93, // WebKit Right Command key fired, different from META\n  WIN_IME = 229,\n\n  // \"Reserved for future use\". Some programs (e.g. the SlingPlayer 2.4 ActiveX\n  // control) fire this as a hacky way to disable screensavers.\n  VK_NONAME = 252,\n\n  // We've seen users whose machines fire this keycode at regular one\n  // second intervals. The common thread among these users is that\n  // they're all using Dell Inspiron laptops, so we suspect that this\n  // indicates a hardware/bios problem.\n  // http://en.community.dell.com/support-forums/laptop/f/3518/p/19285957/19523128.aspx\n  PHANTOM = 255,\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.utils');\n\nimport * as browserEvents from './browser_events.js';\nimport * as extensions from './extensions.js';\nimport * as aria from './utils/aria.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as colour from './utils/colour.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as deprecation from './utils/deprecation.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {KeyCodes} from './utils/keycodes.js';\nimport * as math from './utils/math.js';\nimport type {Metrics} from './utils/metrics.js';\nimport * as object from './utils/object.js';\nimport * as parsing from './utils/parsing.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport * as stringUtils from './utils/string.js';\nimport * as style from './utils/style.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as svgPaths from './utils/svg_paths.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as xml from './utils/xml.js';\n\nexport {\n  aria,\n  arrayUtils as array,\n  browserEvents,\n  colour,\n  Coordinate,\n  deprecation,\n  dom,\n  extensions,\n  idGenerator,\n  KeyCodes,\n  math,\n  Metrics,\n  object,\n  parsing,\n  Rect,\n  Size,\n  stringUtils as string,\n  style,\n  Svg,\n  svgMath,\n  svgPaths,\n  toolbox,\n  userAgent,\n  xml,\n};\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Bubble} from './bubble.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\n\nexport class TextBubble extends Bubble {\n  private paragraph: SVGTextElement;\n\n  constructor(\n    private text: string,\n    protected readonly workspace: WorkspaceSvg,\n    protected anchor: Coordinate,\n    protected ownerRect?: Rect\n  ) {\n    super(workspace, anchor, ownerRect);\n    this.paragraph = this.stringToSvg(text, this.contentContainer);\n    this.updateBubbleSize();\n  }\n\n  /** @returns the current text of this text bubble. */\n  getText(): string {\n    return this.text;\n  }\n\n  /** Sets the current text of this text bubble, and updates the display. */\n  setText(text: string) {\n    this.text = text;\n    dom.removeNode(this.paragraph);\n    this.paragraph = this.stringToSvg(text, this.contentContainer);\n    this.updateBubbleSize();\n  }\n\n  /**\n   * Converts the given string into an svg containing that string,\n   * broken up by newlines.\n   */\n  private stringToSvg(text: string, container: SVGGElement) {\n    const paragraph = this.createParagraph(container);\n    const spans = this.createSpans(paragraph, text);\n    if (this.workspace.RTL)\n      this.rightAlignSpans(paragraph.getBBox().width, spans);\n    return paragraph;\n  }\n\n  /** Creates the paragraph container for this bubble's view's spans. */\n  private createParagraph(container: SVGGElement): SVGTextElement {\n    return dom.createSvgElement(\n      Svg.TEXT,\n      {\n        'class': 'blocklyText blocklyBubbleText blocklyNoPointerEvents',\n        'y': Bubble.BORDER_WIDTH,\n      },\n      container\n    );\n  }\n\n  /** Creates the spans visualizing the text of this bubble. */\n  private createSpans(parent: SVGTextElement, text: string): SVGTSpanElement[] {\n    return text.split('\\n').map((line) => {\n      const tspan = dom.createSvgElement(\n        Svg.TSPAN,\n        {'dy': '1em', 'x': Bubble.BORDER_WIDTH},\n        parent\n      );\n      const textNode = document.createTextNode(line);\n      tspan.appendChild(textNode);\n      return tspan;\n    });\n  }\n\n  /** Right aligns the given spans. */\n  private rightAlignSpans(maxWidth: number, spans: SVGTSpanElement[]) {\n    for (const span of spans) {\n      span.setAttribute('text-anchor', 'end');\n      span.setAttribute('x', `${maxWidth + Bubble.BORDER_WIDTH}`);\n    }\n  }\n\n  /** Updates the size of this bubble to account for the size of the text. */\n  private updateBubbleSize() {\n    const bbox = this.paragraph.getBBox();\n    this.setSize(\n      new Size(\n        bbox.width + Bubble.BORDER_WIDTH * 2,\n        bbox.height + Bubble.BORDER_WIDTH * 2\n      ),\n      true\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {Bubble} from './bubble.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as Css from '../css.js';\nimport * as dom from '../utils/dom.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport * as touch from '../touch.js';\nimport {WorkspaceSvg} from '../workspace_svg.js';\nimport {browserEvents} from '../utils.js';\n\nexport class TextInputBubble extends Bubble {\n  /** The root of the elements specific to the text element. */\n  private inputRoot: SVGForeignObjectElement;\n\n  /** The text input area element. */\n  private textArea: HTMLTextAreaElement;\n\n  /** The group containing the lines indicating the bubble is resizable. */\n  private resizeGroup: SVGGElement;\n\n  /**\n   * Event data associated with the listener for pointer up events on the\n   * resize group.\n   */\n  private resizePointerUpListener: browserEvents.Data | null = null;\n\n  /**\n   * Event data associated with the listener for pointer move events on the\n   * resize group.\n   */\n  private resizePointerMoveListener: browserEvents.Data | null = null;\n\n  /** Functions listening for changes to the text of this bubble. */\n  private textChangeListeners: (() => void)[] = [];\n\n  /** Functions listening for changes to the size of this bubble. */\n  private sizeChangeListeners: (() => void)[] = [];\n\n  /** The text of this bubble. */\n  private text = '';\n\n  /** The default size of this bubble, including borders. */\n  private readonly DEFAULT_SIZE = new Size(\n    160 + Bubble.DOUBLE_BORDER,\n    80 + Bubble.DOUBLE_BORDER\n  );\n\n  /** The minimum size of this bubble, including borders. */\n  private readonly MIN_SIZE = new Size(\n    45 + Bubble.DOUBLE_BORDER,\n    20 + Bubble.DOUBLE_BORDER\n  );\n\n  /**\n   * @param workspace The workspace this bubble belongs to.\n   * @param anchor The anchor location of the thing this bubble is attached to.\n   *     The tail of the bubble will point to this location.\n   * @param ownerRect An optional rect we don't want the bubble to overlap with\n   *     when automatically positioning.\n   */\n  constructor(\n    protected readonly workspace: WorkspaceSvg,\n    protected anchor: Coordinate,\n    protected ownerRect?: Rect\n  ) {\n    super(workspace, anchor, ownerRect);\n    ({inputRoot: this.inputRoot, textArea: this.textArea} = this.createEditor(\n      this.contentContainer\n    ));\n    this.resizeGroup = this.createResizeHandle(this.svgRoot);\n    this.setSize(this.DEFAULT_SIZE, true);\n  }\n\n  /** @returns the text of this bubble. */\n  getText(): string {\n    return this.text;\n  }\n\n  /** Sets the text of this bubble. Calls change listeners. */\n  setText(text: string) {\n    this.text = text;\n    this.textArea.value = text;\n    this.onTextChange();\n  }\n\n  /** Adds a change listener to be notified when this bubble's text changes. */\n  addTextChangeListener(listener: () => void) {\n    this.textChangeListeners.push(listener);\n  }\n\n  /** Adds a change listener to be notified when this bubble's size changes. */\n  addSizeChangeListener(listener: () => void) {\n    this.sizeChangeListeners.push(listener);\n  }\n\n  /** Creates the editor UI for this bubble. */\n  private createEditor(container: SVGGElement): {\n    inputRoot: SVGForeignObjectElement;\n    textArea: HTMLTextAreaElement;\n  } {\n    const inputRoot = dom.createSvgElement(\n      Svg.FOREIGNOBJECT,\n      {\n        'x': Bubble.BORDER_WIDTH,\n        'y': Bubble.BORDER_WIDTH,\n      },\n      container\n    );\n\n    const body = document.createElementNS(dom.HTML_NS, 'body');\n    body.setAttribute('xmlns', dom.HTML_NS);\n    body.className = 'blocklyMinimalBody';\n\n    const textArea = document.createElementNS(\n      dom.HTML_NS,\n      'textarea'\n    ) as HTMLTextAreaElement;\n    textArea.className = 'blocklyCommentTextarea';\n    textArea.setAttribute('dir', this.workspace.RTL ? 'RTL' : 'LTR');\n\n    body.appendChild(textArea);\n    inputRoot.appendChild(body);\n\n    this.bindTextAreaEvents(textArea);\n    setTimeout(() => {\n      textArea.focus();\n    }, 0);\n\n    return {inputRoot, textArea};\n  }\n\n  /** Binds events to the text area element. */\n  private bindTextAreaEvents(textArea: HTMLTextAreaElement) {\n    // Don't zoom with mousewheel.\n    browserEvents.conditionalBind(textArea, 'wheel', this, (e: Event) => {\n      e.stopPropagation();\n    });\n\n    browserEvents.conditionalBind(\n      textArea,\n      'focus',\n      this,\n      this.onStartEdit,\n      true\n    );\n    browserEvents.conditionalBind(textArea, 'change', this, this.onTextChange);\n  }\n\n  /** Creates the resize handler elements and binds events to them. */\n  private createResizeHandle(container: SVGGElement): SVGGElement {\n    const resizeGroup = dom.createSvgElement(\n      Svg.G,\n      {\n        'class': this.workspace.RTL ? 'blocklyResizeSW' : 'blocklyResizeSE',\n      },\n      container\n    );\n    const size = 2 * Bubble.BORDER_WIDTH;\n    dom.createSvgElement(\n      Svg.POLYGON,\n      {'points': `0,${size} ${size},${size} ${size},0`},\n      resizeGroup\n    );\n    dom.createSvgElement(\n      Svg.LINE,\n      {\n        'class': 'blocklyResizeLine',\n        'x1': size / 3,\n        'y1': size - 1,\n        'x2': size - 1,\n        'y2': size / 3,\n      },\n      resizeGroup\n    );\n    dom.createSvgElement(\n      Svg.LINE,\n      {\n        'class': 'blocklyResizeLine',\n        'x1': (size * 2) / 3,\n        'y1': size - 1,\n        'x2': size - 1,\n        'y2': (size * 2) / 3,\n      },\n      resizeGroup\n    );\n\n    browserEvents.conditionalBind(\n      resizeGroup,\n      'pointerdown',\n      this,\n      this.onResizePointerDown\n    );\n\n    return resizeGroup;\n  }\n\n  /**\n   * Sets the size of this bubble, including the border.\n   *\n   * @param size Sets the size of this bubble, including the border.\n   * @param relayout If true, reposition the bubble from scratch so that it is\n   *     optimally visible. If false, reposition it so it maintains the same\n   *     position relative to the anchor.\n   */\n  setSize(size: Size, relayout = false) {\n    size.width = Math.max(size.width, this.MIN_SIZE.width);\n    size.height = Math.max(size.height, this.MIN_SIZE.height);\n\n    const widthMinusBorder = size.width - Bubble.DOUBLE_BORDER;\n    const heightMinusBorder = size.height - Bubble.DOUBLE_BORDER;\n    this.inputRoot.setAttribute('width', `${widthMinusBorder}`);\n    this.inputRoot.setAttribute('height', `${heightMinusBorder}`);\n    this.textArea.style.width = `${widthMinusBorder - 4}px`;\n    this.textArea.style.height = `${heightMinusBorder - 4}px`;\n\n    if (this.workspace.RTL) {\n      this.resizeGroup.setAttribute(\n        'transform',\n        `translate(${Bubble.DOUBLE_BORDER}, ${heightMinusBorder}) scale(-1 1)`\n      );\n    } else {\n      this.resizeGroup.setAttribute(\n        'transform',\n        `translate(${widthMinusBorder}, ${heightMinusBorder})`\n      );\n    }\n\n    super.setSize(size, relayout);\n    this.onSizeChange();\n  }\n\n  /** @returns the size of this bubble. */\n  getSize(): Size {\n    // Overriden to be public.\n    return super.getSize();\n  }\n\n  /** Handles mouse down events on the resize target. */\n  private onResizePointerDown(e: PointerEvent) {\n    this.bringToFront();\n    if (browserEvents.isRightButton(e)) {\n      e.stopPropagation();\n      return;\n    }\n\n    this.workspace.startDrag(\n      e,\n      new Coordinate(\n        this.workspace.RTL ? -this.getSize().width : this.getSize().width,\n        this.getSize().height\n      )\n    );\n\n    this.resizePointerUpListener = browserEvents.conditionalBind(\n      document,\n      'pointerup',\n      this,\n      this.onResizePointerUp\n    );\n    this.resizePointerMoveListener = browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      this,\n      this.onResizePointerMove\n    );\n    this.workspace.hideChaff();\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /** Handles pointer up events on the resize target. */\n  private onResizePointerUp(_e: PointerEvent) {\n    touch.clearTouchIdentifier();\n    if (this.resizePointerUpListener) {\n      browserEvents.unbind(this.resizePointerUpListener);\n      this.resizePointerUpListener = null;\n    }\n    if (this.resizePointerMoveListener) {\n      browserEvents.unbind(this.resizePointerMoveListener);\n      this.resizePointerMoveListener = null;\n    }\n  }\n\n  /** Handles pointer move events on the resize target. */\n  private onResizePointerMove(e: PointerEvent) {\n    const delta = this.workspace.moveDrag(e);\n    this.setSize(\n      new Size(this.workspace.RTL ? -delta.x : delta.x, delta.y),\n      false\n    );\n    this.onSizeChange();\n  }\n\n  /**\n   * Handles starting an edit of the text area. Brings the bubble to the front.\n   */\n  private onStartEdit() {\n    if (this.bringToFront()) {\n      // Since the act of moving this node within the DOM causes a loss of\n      // focus, we need to reapply the focus.\n      this.textArea.focus();\n    }\n  }\n\n  /** Handles a text change event for the text area. Calls event listeners. */\n  private onTextChange() {\n    this.text = this.textArea.value;\n    for (const listener of this.textChangeListeners) {\n      listener();\n    }\n  }\n\n  /** Handles a size change event for the text area. Calls event listeners. */\n  private onSizeChange() {\n    for (const listener of this.sizeChangeListeners) {\n      listener();\n    }\n  }\n}\n\nCss.register(`\n.blocklyCommentTextarea {\n  background-color: #fef49c;\n  border: 0;\n  display: block;\n  margin: 0;\n  outline: 0;\n  padding: 3px;\n  resize: none;\n  text-overflow: hidden;\n}\n`);\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Comment');\n\nimport type {Block} from '../block.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport {IconType} from './icon_types.js';\nimport {Coordinate} from '../utils.js';\nimport * as dom from '../utils/dom.js';\nimport * as eventUtils from '../events/utils.js';\nimport {Icon} from './icon.js';\nimport type {IHasBubble} from '../interfaces/i_has_bubble.js';\nimport type {ISerializable} from '../interfaces/i_serializable.js';\nimport {Rect} from '../utils/rect.js';\nimport * as registry from './registry.js';\nimport {Size} from '../utils/size.js';\nimport {Svg} from '../utils/svg.js';\nimport {TextBubble} from '../bubbles/text_bubble.js';\nimport {TextInputBubble} from '../bubbles/textinput_bubble.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\n/** The size of the comment icon in workspace-scale units. */\nconst SIZE = 17;\n\n/** The default width in workspace-scale units of the text input bubble. */\nconst DEFAULT_BUBBLE_WIDTH = 160;\n\n/** The default height in workspace-scale units of the text input bubble. */\nconst DEFAULT_BUBBLE_HEIGHT = 80;\n\nexport class CommentIcon extends Icon implements IHasBubble, ISerializable {\n  /** The type string used to identify this icon. */\n  static readonly TYPE = IconType.COMMENT;\n\n  /**\n   * The weight this icon has relative to other icons. Icons with more positive\n   * weight values are rendered farther toward the end of the block.\n   */\n  static readonly WEIGHT = 3;\n\n  /** The bubble used to show editable text to the user. */\n  private textInputBubble: TextInputBubble | null = null;\n\n  /** The bubble used to show non-editable text to the user. */\n  private textBubble: TextBubble | null = null;\n\n  /** The text of this comment. */\n  private text = '';\n\n  /** The size of this comment (which is applied to the editable bubble). */\n  private bubbleSize = new Size(DEFAULT_BUBBLE_WIDTH, DEFAULT_BUBBLE_HEIGHT);\n\n  /**\n   * The visibility of the bubble for this comment.\n   *\n   * This is used to track what the visibile state /should/ be, not necessarily\n   * what it currently /is/. E.g. sometimes this will be true, but the block\n   * hasn't been rendered yet, so the bubble will not currently be visible.\n   */\n  private bubbleVisiblity = false;\n\n  constructor(protected readonly sourceBlock: Block) {\n    super(sourceBlock);\n  }\n\n  override getType(): IconType<CommentIcon> {\n    return CommentIcon.TYPE;\n  }\n\n  override initView(pointerdownListener: (e: PointerEvent) => void): void {\n    if (this.svgRoot) return; // Already initialized.\n\n    super.initView(pointerdownListener);\n\n    // Circle.\n    dom.createSvgElement(\n      Svg.CIRCLE,\n      {'class': 'blocklyIconShape', 'r': '8', 'cx': '8', 'cy': '8'},\n      this.svgRoot\n    );\n    // Can't use a real '?' text character since different browsers and\n    // operating systems render it differently. Body of question mark.\n    dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyIconSymbol',\n        'd':\n          'm6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.405' +\n          '0.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25' +\n          '-1.201,0.998 -1.201,1.528 -1.204,2.19z',\n      },\n      this.svgRoot\n    );\n    // Dot of question mark.\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyIconSymbol',\n        'x': '6.8',\n        'y': '10.78',\n        'height': '2',\n        'width': '2',\n      },\n      this.svgRoot\n    );\n  }\n\n  override dispose() {\n    super.dispose();\n    this.textInputBubble?.dispose();\n    this.textBubble?.dispose();\n  }\n\n  override getWeight(): number {\n    return CommentIcon.WEIGHT;\n  }\n\n  override getSize(): Size {\n    return new Size(SIZE, SIZE);\n  }\n\n  override applyColour(): void {\n    super.applyColour();\n    const colour = (this.sourceBlock as BlockSvg).style.colourPrimary;\n    this.textInputBubble?.setColour(colour);\n    this.textBubble?.setColour(colour);\n  }\n\n  /**\n   * Updates the state of the bubble (editable / noneditable) to reflect the\n   * state of the bubble if the bubble is currently shown.\n   */\n  override updateEditable(): void {\n    super.updateEditable();\n    if (this.bubbleIsVisible()) {\n      // Close and reopen the bubble to display the correct UI.\n      this.setBubbleVisible(false);\n      this.setBubbleVisible(true);\n    }\n  }\n\n  override onLocationChange(blockOrigin: Coordinate): void {\n    super.onLocationChange(blockOrigin);\n    const anchorLocation = this.getAnchorLocation();\n    this.textInputBubble?.setAnchorLocation(anchorLocation);\n    this.textBubble?.setAnchorLocation(anchorLocation);\n  }\n\n  /** Sets the text of this comment. Updates any bubbles if they are visible. */\n  setText(text: string) {\n    this.text = text;\n    this.textInputBubble?.setText(this.text);\n    this.textBubble?.setText(this.text);\n  }\n\n  /** Returns the text of this comment. */\n  getText(): string {\n    return this.text;\n  }\n\n  /**\n   * Sets the size of the editable bubble for this comment. Resizes the\n   * bubble if it is visible.\n   */\n  setBubbleSize(size: Size) {\n    this.bubbleSize = size;\n    this.textInputBubble?.setSize(this.bubbleSize, true);\n  }\n\n  /** @returns the size of the editable bubble for this comment. */\n  getBubbleSize(): Size {\n    return this.bubbleSize;\n  }\n\n  /**\n   * @returns the state of the comment as a JSON serializable value if the\n   * comment has text. Otherwise returns null.\n   */\n  saveState(): CommentState | null {\n    if (this.text) {\n      return {\n        'text': this.text,\n        'pinned': this.bubbleIsVisible(),\n        'height': this.bubbleSize.height,\n        'width': this.bubbleSize.width,\n      };\n    }\n    return null;\n  }\n\n  /** Applies the given state to this comment. */\n  loadState(state: CommentState) {\n    this.text = state['text'] ?? '';\n    this.bubbleSize = new Size(\n      state['width'] ?? DEFAULT_BUBBLE_WIDTH,\n      state['height'] ?? DEFAULT_BUBBLE_HEIGHT\n    );\n    this.bubbleVisiblity = state['pinned'] ?? false;\n    // Give the block a chance to be positioned and rendered before showing.\n    setTimeout(() => this.setBubbleVisible(this.bubbleVisiblity), 1);\n  }\n\n  override onClick(): void {\n    super.onClick();\n    this.setBubbleVisible(!this.bubbleIsVisible());\n  }\n\n  /**\n   * Updates the text of this comment in response to changes in the text of\n   * the input bubble.\n   */\n  onTextChange(): void {\n    if (this.textInputBubble) {\n      this.text = this.textInputBubble.getText();\n    }\n  }\n\n  /**\n   * Updates the size of this icon in response to changes in the size of the\n   * input bubble.\n   */\n  onSizeChange(): void {\n    if (this.textInputBubble) {\n      this.bubbleSize = this.textInputBubble.getSize();\n    }\n  }\n\n  bubbleIsVisible(): boolean {\n    return this.bubbleVisiblity;\n  }\n\n  setBubbleVisible(visible: boolean): void {\n    if (visible && (this.textBubble || this.textInputBubble)) return;\n    if (!visible && !(this.textBubble || this.textInputBubble)) return;\n\n    this.bubbleVisiblity = visible;\n\n    if (!this.sourceBlock.rendered || this.sourceBlock.isInFlyout) return;\n\n    if (visible) {\n      if (this.sourceBlock.isEditable()) {\n        this.showEditableBubble();\n      } else {\n        this.showNonEditableBubble();\n      }\n      this.applyColour();\n    } else {\n      this.hideBubble();\n    }\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BUBBLE_OPEN))(\n        this.sourceBlock,\n        visible,\n        'comment'\n      )\n    );\n  }\n\n  /**\n   * Shows the editable text bubble for this comment, and adds change listeners\n   * to update the state of this icon in response to changes in the bubble.\n   */\n  private showEditableBubble() {\n    this.textInputBubble = new TextInputBubble(\n      this.sourceBlock.workspace as WorkspaceSvg,\n      this.getAnchorLocation(),\n      this.getBubbleOwnerRect()\n    );\n    this.textInputBubble.setText(this.getText());\n    this.textInputBubble.setSize(this.bubbleSize, true);\n    this.textInputBubble.addTextChangeListener(() => this.onTextChange());\n    this.textInputBubble.addSizeChangeListener(() => this.onSizeChange());\n  }\n\n  /** Shows the non editable text bubble for this comment. */\n  private showNonEditableBubble() {\n    this.textBubble = new TextBubble(\n      this.getText(),\n      this.sourceBlock.workspace as WorkspaceSvg,\n      this.getAnchorLocation(),\n      this.getBubbleOwnerRect()\n    );\n  }\n\n  /** Hides any open bubbles owned by this comment. */\n  private hideBubble() {\n    this.textInputBubble?.dispose();\n    this.textInputBubble = null;\n    this.textBubble?.dispose();\n    this.textBubble = null;\n  }\n\n  /**\n   * @returns the location the bubble should be anchored to.\n   *     I.E. the middle of this icon.\n   */\n  private getAnchorLocation(): Coordinate {\n    const midIcon = SIZE / 2;\n    return Coordinate.sum(\n      this.workspaceLocation,\n      new Coordinate(midIcon, midIcon)\n    );\n  }\n\n  /**\n   * @returns the rect the bubble should avoid overlapping.\n   *     I.E. the block that owns this icon.\n   */\n  private getBubbleOwnerRect(): Rect {\n    const bbox = (this.sourceBlock as BlockSvg).getSvgRoot().getBBox();\n    return new Rect(bbox.y, bbox.y + bbox.height, bbox.x, bbox.x + bbox.width);\n  }\n}\n\nexport interface CommentState {\n  text?: string;\n  pinned?: boolean;\n  height?: number;\n  width?: number;\n}\n\nregistry.register(CommentIcon.TYPE, CommentIcon);\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport {Input} from './input.js';\nimport {inputTypes} from './input_types.js';\n\n/** Represents an input on a block with no connection. */\nexport class DummyInput extends Input {\n  readonly type = inputTypes.DUMMY;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param block The block containing this input.\n   */\n  constructor(public name: string, block: Block) {\n    super(name, block);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport {ConnectionType} from '../connection_type.js';\nimport {Input} from './input.js';\nimport {inputTypes} from './input_types.js';\n\n/** Represents an input on a block with a value connection. */\nexport class ValueInput extends Input {\n  readonly type = inputTypes.VALUE;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param block The block containing this input.\n   */\n  constructor(public name: string, block: Block) {\n    // Errors are maintained for people not using typescript.\n    if (!name) throw new Error('Value inputs must have a non-empty name');\n    super(name, block);\n    this.connection = this.makeConnection(ConnectionType.INPUT_VALUE);\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport type {Block} from '../block.js';\nimport type {Connection} from '../connection.js';\nimport {ConnectionType} from '../connection_type.js';\nimport {Input} from './input.js';\nimport {inputTypes} from './input_types.js';\n\n/** Represents an input on a block with a statement connection. */\nexport class StatementInput extends Input {\n  readonly type = inputTypes.STATEMENT;\n\n  public connection: Connection;\n\n  /**\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.\n   * @param block The block containing this input.\n   */\n  constructor(public name: string, block: Block) {\n    // Errors are maintained for people not using typescript.\n    if (!name) throw new Error('Statement inputs must have a non-empty name');\n\n    super(name, block);\n    this.connection = this.makeConnection(ConnectionType.NEXT_STATEMENT);\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing one block.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Block');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_create.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_delete.js';\n\nimport {Blocks} from './blocks.js';\nimport * as common from './common.js';\nimport {Connection} from './connection.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as constants from './constants.js';\nimport {DuplicateIconType} from './icons/exceptions.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport * as Extensions from './extensions.js';\nimport type {Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {Align, Input} from './inputs/input.js';\nimport type {IASTNodeLocation} from './interfaces/i_ast_node_location.js';\nimport type {IDeletable} from './interfaces/i_deletable.js';\nimport type {IIcon} from './interfaces/i_icon.js';\nimport {CommentIcon} from './icons/comment_icon.js';\nimport type {MutatorIcon} from './icons/mutator_icon.js';\nimport * as Tooltip from './tooltip.js';\nimport * as arrayUtils from './utils/array.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport * as parsing from './utils/parsing.js';\nimport * as registry from './registry.js';\nimport {Size} from './utils/size.js';\nimport type {VariableModel} from './variable_model.js';\nimport type {Workspace} from './workspace.js';\nimport {DummyInput} from './inputs/dummy_input.js';\nimport {ValueInput} from './inputs/value_input.js';\nimport {StatementInput} from './inputs/statement_input.js';\nimport {IconType} from './icons/icon_types.js';\n\n/**\n * Class for one block.\n * Not normally called directly, workspace.newBlock() is preferred.\n */\nexport class Block implements IASTNodeLocation, IDeletable {\n  /**\n   * An optional callback method to use whenever the block's parent workspace\n   * changes. This is usually only called from the constructor, the block type\n   * initializer function, or an extension initializer function.\n   */\n  onchange?: ((p1: Abstract) => void) | null;\n\n  /** The language-neutral ID given to the collapsed input. */\n  static readonly COLLAPSED_INPUT_NAME: string = constants.COLLAPSED_INPUT_NAME;\n\n  /** The language-neutral ID given to the collapsed field. */\n  static readonly COLLAPSED_FIELD_NAME: string = constants.COLLAPSED_FIELD_NAME;\n\n  /**\n   * Optional text data that round-trips between blocks and XML.\n   * Has no effect. May be used by 3rd parties for meta information.\n   */\n  data: string | null = null;\n\n  /**\n   * Has this block been disposed of?\n   *\n   * @internal\n   */\n  disposed = false;\n\n  /**\n   * Colour of the block as HSV hue value (0-360)\n   * This may be null if the block colour was not set via a hue number.\n   */\n  private hue_: number | null = null;\n\n  /** Colour of the block in '#RRGGBB' format. */\n  protected colour_ = '#000000';\n\n  /** Name of the block style. */\n  protected styleName_ = '';\n\n  /** An optional method called during initialization. */\n  init?: () => void;\n\n  /** An optional method called during disposal. */\n  destroy?: () => void;\n\n  /**\n   * An optional serialization method for defining how to serialize the\n   * mutation state to XML. This must be coupled with defining\n   * `domToMutation`.\n   */\n  mutationToDom?: (...p1: AnyDuringMigration[]) => Element;\n\n  /**\n   * An optional deserialization method for defining how to deserialize the\n   * mutation state from XML. This must be coupled with defining\n   * `mutationToDom`.\n   */\n  domToMutation?: (p1: Element) => void;\n\n  /**\n   * An optional serialization method for defining how to serialize the\n   * block's extra state (eg mutation state) to something JSON compatible.\n   * This must be coupled with defining `loadExtraState`.\n   */\n  saveExtraState?: () => AnyDuringMigration;\n\n  /**\n   * An optional serialization method for defining how to deserialize the\n   * block's extra state (eg mutation state) from something JSON compatible.\n   * This must be coupled with defining `saveExtraState`.\n   */\n  loadExtraState?: (p1: AnyDuringMigration) => void;\n\n  /**\n   * An optional property for suppressing adding STATEMENT_PREFIX and\n   * STATEMENT_SUFFIX to generated code.\n   */\n  suppressPrefixSuffix: boolean | null = false;\n\n  /**\n   * An optional property for declaring developer variables.  Return a list of\n   * variable names for use by generators.  Developer variables are never\n   * shown to the user, but are declared as global variables in the generated\n   * code.\n   */\n  getDeveloperVariables?: () => string[];\n\n  /**\n   * An optional function that reconfigures the block based on the contents of\n   * the mutator dialog.\n   */\n  compose?: (p1: Block) => void;\n\n  /**\n   * An optional function that populates the mutator's dialog with\n   * this block's components.\n   */\n  decompose?: (p1: Workspace) => Block;\n  id: string;\n  outputConnection: Connection | null = null;\n  nextConnection: Connection | null = null;\n  previousConnection: Connection | null = null;\n  inputList: Input[] = [];\n  inputsInline?: boolean;\n  icons: IIcon[] = [];\n  private disabled = false;\n  tooltip: Tooltip.TipInfo = '';\n  contextMenu = true;\n\n  protected parentBlock_: this | null = null;\n\n  protected childBlocks_: this[] = [];\n\n  private deletable_ = true;\n\n  private movable_ = true;\n\n  private editable_ = true;\n\n  private isShadow_ = false;\n\n  protected collapsed_ = false;\n  protected outputShape_: number | null = null;\n\n  /**\n   * Is the current block currently in the process of being disposed?\n   */\n  private disposing = false;\n\n  private readonly xy_: Coordinate;\n  isInFlyout: boolean;\n  isInMutator: boolean;\n  RTL: boolean;\n\n  /** True if this block is an insertion marker. */\n  protected isInsertionMarker_ = false;\n\n  /** Name of the type of hat. */\n  hat?: string;\n\n  rendered: boolean | null = null;\n\n  /**\n   * String for block help, or function that returns a URL. Null for no help.\n   */\n  helpUrl: string | Function | null = null;\n\n  /** A bound callback function to use when the parent workspace changes. */\n  private onchangeWrapper_: ((p1: Abstract) => void) | null = null;\n\n  /**\n   * A count of statement inputs on the block.\n   *\n   * @internal\n   */\n  statementInputCount = 0;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  type!: string;\n  // Record initial inline state.\n  inputsInlineDefault?: boolean;\n  workspace: Workspace;\n\n  /**\n   * @param workspace The block's workspace.\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @throws When the prototypeName is not valid or not allowed.\n   */\n  constructor(workspace: Workspace, prototypeName: string, opt_id?: string) {\n    this.workspace = workspace;\n\n    this.id =\n      opt_id && !workspace.getBlockById(opt_id) ? opt_id : idGenerator.genUid();\n    workspace.setBlockById(this.id, this);\n\n    /**\n     * The block's position in workspace units.  (0, 0) is at the workspace's\n     * origin; scale does not change this value.\n     */\n    this.xy_ = new Coordinate(0, 0);\n    this.isInFlyout = workspace.isFlyout;\n    this.isInMutator = workspace.isMutator;\n\n    this.RTL = workspace.RTL;\n\n    // Copy the type-specific functions and data from the prototype.\n    if (prototypeName) {\n      this.type = prototypeName;\n      const prototype = Blocks[prototypeName];\n      if (!prototype || typeof prototype !== 'object') {\n        throw TypeError('Invalid block definition for type: ' + prototypeName);\n      }\n      Object.assign(this, prototype);\n    }\n\n    workspace.addTopBlock(this);\n    workspace.addTypedBlock(this);\n\n    if (new.target === Block) {\n      this.doInit_();\n    }\n  }\n\n  /** Calls the init() function and handles associated event firing, etc. */\n  protected doInit_() {\n    // All events fired should be part of the same group.\n    // Any events fired during init should not be undoable,\n    // so that block creation is atomic.\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    const initialUndoFlag = eventUtils.getRecordUndo();\n\n    try {\n      // Call an initialization function, if it exists.\n      if (typeof this.init === 'function') {\n        eventUtils.setRecordUndo(false);\n        this.init();\n        eventUtils.setRecordUndo(initialUndoFlag);\n      }\n\n      // Fire a create event.\n      if (eventUtils.isEnabled()) {\n        eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(this));\n      }\n    } finally {\n      eventUtils.setGroup(existingGroup);\n      // In case init threw, recordUndo flag should still be reset.\n      eventUtils.setRecordUndo(initialUndoFlag);\n    }\n    this.inputsInlineDefault = this.inputsInline;\n\n    // Bind an onchange function, if it exists.\n    if (typeof this.onchange === 'function') {\n      this.setOnChange(this.onchange);\n    }\n  }\n\n  /**\n   * Dispose of this block.\n   *\n   * @param healStack If true, then try to heal any gap by connecting the next\n   *     statement with the previous statement.  Otherwise, dispose of all\n   *     children of this block.\n   */\n  dispose(healStack: boolean) {\n    if (this.isDeadOrDying()) return;\n\n    // Dispose of this change listener before unplugging.\n    // Technically not necessary due to the event firing delay.\n    // But future-proofing.\n    if (this.onchangeWrapper_) {\n      this.workspace.removeChangeListener(this.onchangeWrapper_);\n    }\n\n    this.unplug(healStack);\n    if (eventUtils.isEnabled()) {\n      // Constructing the delete event is costly. Only perform if necessary.\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_DELETE))(this));\n    }\n    this.workspace.removeTopBlock(this);\n    this.disposeInternal();\n  }\n\n  /**\n   * Disposes of this block without doing things required by the top block.\n   * E.g. does not fire events, unplug the block, etc.\n   */\n  protected disposeInternal() {\n    if (this.isDeadOrDying()) return;\n\n    if (this.onchangeWrapper_) {\n      this.workspace.removeChangeListener(this.onchangeWrapper_);\n    }\n\n    this.workspace.removeTypedBlock(this);\n    this.workspace.removeBlockById(this.id);\n    this.disposing = true;\n\n    if (typeof this.destroy === 'function') this.destroy();\n\n    this.childBlocks_.forEach((c) => c.disposeInternal());\n    this.inputList.forEach((i) => i.dispose());\n    this.inputList.length = 0;\n    this.getConnections_(true).forEach((c) => c.dispose());\n    this.disposed = true;\n  }\n\n  /**\n   * Returns true if the block is either in the process of being disposed, or\n   * is disposed.\n   *\n   * @internal\n   */\n  isDeadOrDying(): boolean {\n    return this.disposing || this.disposed;\n  }\n\n  /**\n   * Call initModel on all fields on the block.\n   * May be called more than once.\n   * Either initModel or initSvg must be called after creating a block and\n   * before the first interaction with it.  Interactions include UI actions\n   * (e.g. clicking and dragging) and firing events (e.g. create, delete, and\n   * change).\n   */\n  initModel() {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.initModel) {\n          field.initModel();\n        }\n      }\n    }\n  }\n\n  /**\n   * Unplug this block from its superior block.  If this block is a statement,\n   * optionally reconnect the block underneath with the block on top.\n   *\n   * @param opt_healStack Disconnect child statement and reconnect stack.\n   *     Defaults to false.\n   */\n  unplug(opt_healStack?: boolean) {\n    if (this.outputConnection) {\n      this.unplugFromRow_(opt_healStack);\n    }\n    if (this.previousConnection) {\n      this.unplugFromStack_(opt_healStack);\n    }\n  }\n\n  /**\n   * Unplug this block's output from an input on another block.  Optionally\n   * reconnect the block's parent to the only child block, if possible.\n   *\n   * @param opt_healStack Disconnect right-side block and connect to left-side\n   *     block.  Defaults to false.\n   */\n  private unplugFromRow_(opt_healStack?: boolean) {\n    let parentConnection = null;\n    if (this.outputConnection?.isConnected()) {\n      parentConnection = this.outputConnection.targetConnection;\n      // Disconnect from any superior block.\n      this.outputConnection.disconnect();\n    }\n\n    // Return early in obvious cases.\n    if (!parentConnection || !opt_healStack) {\n      return;\n    }\n\n    const thisConnection = this.getOnlyValueConnection_();\n    if (\n      !thisConnection ||\n      !thisConnection.isConnected() ||\n      thisConnection.targetBlock()!.isShadow()\n    ) {\n      // Too many or too few possible connections on this block, or there's\n      // nothing on the other side of this connection.\n      return;\n    }\n\n    const childConnection = thisConnection.targetConnection;\n    // Disconnect the child block.\n    childConnection?.disconnect();\n    // Connect child to the parent if possible, otherwise bump away.\n    if (\n      this.workspace.connectionChecker.canConnect(\n        childConnection,\n        parentConnection,\n        false\n      )\n    ) {\n      parentConnection.connect(childConnection!);\n    } else {\n      childConnection?.onFailedConnect(parentConnection);\n    }\n  }\n\n  /**\n   * Returns the connection on the value input that is connected to another\n   * block. When an insertion marker is connected to a connection with a block\n   * already attached, the connected block is attached to the insertion marker.\n   * Since only one block can be displaced and attached to the insertion marker\n   * this should only ever return one connection.\n   *\n   * @returns The connection on the value input, or null.\n   */\n  private getOnlyValueConnection_(): Connection | null {\n    let connection = null;\n    for (let i = 0; i < this.inputList.length; i++) {\n      const thisConnection = this.inputList[i].connection;\n      if (\n        thisConnection &&\n        thisConnection.type === ConnectionType.INPUT_VALUE &&\n        thisConnection.targetConnection\n      ) {\n        if (connection) {\n          return null; // More than one value input found.\n        }\n        connection = thisConnection;\n      }\n    }\n    return connection;\n  }\n\n  /**\n   * Unplug this statement block from its superior block.  Optionally reconnect\n   * the block underneath with the block on top.\n   *\n   * @param opt_healStack Disconnect child statement and reconnect stack.\n   *     Defaults to false.\n   */\n  private unplugFromStack_(opt_healStack?: boolean) {\n    let previousTarget = null;\n    if (this.previousConnection?.isConnected()) {\n      // Remember the connection that any next statements need to connect to.\n      previousTarget = this.previousConnection.targetConnection;\n      // Detach this block from the parent's tree.\n      this.previousConnection.disconnect();\n    }\n    const nextBlock = this.getNextBlock();\n    if (opt_healStack && nextBlock && !nextBlock.isShadow()) {\n      // Disconnect the next statement.\n      const nextTarget = this.nextConnection?.targetConnection ?? null;\n      nextTarget?.disconnect();\n      if (\n        previousTarget &&\n        this.workspace.connectionChecker.canConnect(\n          previousTarget,\n          nextTarget,\n          false\n        )\n      ) {\n        // Attach the next statement to the previous statement.\n        previousTarget.connect(nextTarget!);\n      }\n    }\n  }\n\n  /**\n   * Returns all connections originating from this block.\n   *\n   * @param _all If true, return all connections even hidden ones.\n   * @returns Array of connections.\n   * @internal\n   */\n  getConnections_(_all: boolean): Connection[] {\n    const myConnections = [];\n    if (this.outputConnection) {\n      myConnections.push(this.outputConnection);\n    }\n    if (this.previousConnection) {\n      myConnections.push(this.previousConnection);\n    }\n    if (this.nextConnection) {\n      myConnections.push(this.nextConnection);\n    }\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.connection) {\n        myConnections.push(input.connection);\n      }\n    }\n    return myConnections;\n  }\n\n  /**\n   * Walks down a stack of blocks and finds the last next connection on the\n   * stack.\n   *\n   * @param ignoreShadows If true,the last connection on a non-shadow block will\n   *     be returned. If false, this will follow shadows to find the last\n   *     connection.\n   * @returns The last next connection on the stack, or null.\n   * @internal\n   */\n  lastConnectionInStack(ignoreShadows: boolean): Connection | null {\n    let nextConnection = this.nextConnection;\n    while (nextConnection) {\n      const nextBlock = nextConnection.targetBlock();\n      if (!nextBlock || (ignoreShadows && nextBlock.isShadow())) {\n        return nextConnection;\n      }\n      nextConnection = nextBlock.nextConnection;\n    }\n    return null;\n  }\n\n  /**\n   * Bump unconnected blocks out of alignment.  Two blocks which aren't actually\n   * connected should not coincidentally line up on screen.\n   */\n  bumpNeighbours() {}\n  // noop.\n\n  /**\n   * Return the parent block or null if this block is at the top level. The\n   * parent block is either the block connected to the previous connection (for\n   * a statement block) or the block connected to the output connection (for a\n   * value block).\n   *\n   * @returns The block (if any) that holds the current block.\n   */\n  getParent(): this | null {\n    return this.parentBlock_;\n  }\n\n  /**\n   * Return the input that connects to the specified block.\n   *\n   * @param block A block connected to an input on this block.\n   * @returns The input (if any) that connects to the specified block.\n   */\n  getInputWithBlock(block: Block): Input | null {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.connection && input.connection.targetBlock() === block) {\n        return input;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Return the parent block that surrounds the current block, or null if this\n   * block has no surrounding block.  A parent block might just be the previous\n   * statement, whereas the surrounding block is an if statement, while loop,\n   * etc.\n   *\n   * @returns The block (if any) that surrounds the current block.\n   */\n  getSurroundParent(): this | null {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block: this | null = this;\n    let prevBlock;\n    do {\n      prevBlock = block;\n      block = block.getParent();\n      if (!block) {\n        // Ran off the top.\n        return null;\n      }\n    } while (block.getNextBlock() === prevBlock);\n    // This block is an enclosing parent, not just a statement in a stack.\n    return block;\n  }\n\n  /**\n   * Return the next statement block directly connected to this block.\n   *\n   * @returns The next statement block or null.\n   */\n  getNextBlock(): Block | null {\n    return this.nextConnection && this.nextConnection.targetBlock();\n  }\n\n  /**\n   * Returns the block connected to the previous connection.\n   *\n   * @returns The previous statement block or null.\n   */\n  getPreviousBlock(): Block | null {\n    return this.previousConnection && this.previousConnection.targetBlock();\n  }\n\n  /**\n   * Return the connection on the first statement input on this block, or null\n   * if there are none.\n   *\n   * @returns The first statement connection or null.\n   * @internal\n   */\n  getFirstStatementConnection(): Connection | null {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (\n        input.connection &&\n        input.connection.type === ConnectionType.NEXT_STATEMENT\n      ) {\n        return input.connection;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Return the top-most block in this block's tree.\n   * This will return itself if this block is at the top level.\n   *\n   * @returns The root block.\n   */\n  getRootBlock(): this {\n    let rootBlock: this;\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block: this | null = this;\n    do {\n      rootBlock = block;\n      block = rootBlock.parentBlock_;\n    } while (block);\n    return rootBlock;\n  }\n\n  /**\n   * Walk up from the given block up through the stack of blocks to find\n   * the top block of the sub stack. If we are nested in a statement input only\n   * find the top-most nested block. Do not go all the way to the root block.\n   *\n   * @returns The top block in a stack.\n   * @internal\n   */\n  getTopStackBlock(): this {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block = this;\n    let previous;\n    do {\n      previous = block.getPreviousBlock();\n      // AnyDuringMigration because:  Type 'Block' is not assignable to type\n      // 'this'.\n    } while (\n      previous &&\n      previous.getNextBlock() === block &&\n      (block = previous as AnyDuringMigration)\n    );\n    return block;\n  }\n\n  /**\n   * Find all the blocks that are directly nested inside this one.\n   * Includes value and statement inputs, as well as any following statement.\n   * Excludes any connection on an output tab or any preceding statement.\n   * Blocks are optionally sorted by position; top to bottom.\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  getChildren(ordered: boolean): Block[] {\n    if (!ordered) {\n      return this.childBlocks_;\n    }\n    const blocks = [];\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.connection) {\n        const child = input.connection.targetBlock();\n        if (child) {\n          blocks.push(child);\n        }\n      }\n    }\n    const next = this.getNextBlock();\n    if (next) {\n      blocks.push(next);\n    }\n    return blocks;\n  }\n\n  /**\n   * Set parent of this block to be a new block or null.\n   *\n   * @param newParent New parent block.\n   * @internal\n   */\n  setParent(newParent: this | null) {\n    if (newParent === this.parentBlock_) {\n      return;\n    }\n\n    // Check that block is connected to new parent if new parent is not null and\n    //    that block is not connected to superior one if new parent is null.\n    const targetBlock =\n      (this.previousConnection && this.previousConnection.targetBlock()) ||\n      (this.outputConnection && this.outputConnection.targetBlock());\n    const isConnected = !!targetBlock;\n\n    if (isConnected && newParent && targetBlock !== newParent) {\n      throw Error('Block connected to superior one that is not new parent.');\n    } else if (!isConnected && newParent) {\n      throw Error('Block not connected to new parent.');\n    } else if (isConnected && !newParent) {\n      throw Error(\n        'Cannot set parent to null while block is still connected to' +\n          ' superior block.'\n      );\n    }\n\n    // This block hasn't actually moved on-screen, so there's no need to\n    // update\n    //     its connection locations.\n    if (this.parentBlock_) {\n      // Remove this block from the old parent's child list.\n      arrayUtils.removeElem(this.parentBlock_.childBlocks_, this);\n    } else {\n      // New parent must be non-null so remove this block from the workspace's\n      //     list of top-most blocks.\n      this.workspace.removeTopBlock(this);\n    }\n\n    this.parentBlock_ = newParent;\n    if (newParent) {\n      // Add this block to the new parent's child list.\n      newParent.childBlocks_.push(this);\n    } else {\n      this.workspace.addTopBlock(this);\n    }\n  }\n\n  /**\n   * Find all the blocks that are directly or indirectly nested inside this one.\n   * Includes this block in the list.\n   * Includes value and statement inputs, as well as any following statements.\n   * Excludes any connection on an output tab or any preceding statements.\n   * Blocks are optionally sorted by position; top to bottom.\n   *\n   * @param ordered Sort the list if true.\n   * @returns Flattened array of blocks.\n   */\n  getDescendants(ordered: boolean): this[] {\n    const blocks = [this];\n    const childBlocks = this.getChildren(ordered);\n    for (let child, i = 0; (child = childBlocks[i]); i++) {\n      // AnyDuringMigration because:  Argument of type 'Block[]' is not\n      // assignable to parameter of type 'this[]'.\n      blocks.push(...(child.getDescendants(ordered) as AnyDuringMigration));\n    }\n    return blocks;\n  }\n\n  /**\n   * Get whether this block is deletable or not.\n   *\n   * @returns True if deletable.\n   */\n  isDeletable(): boolean {\n    return (\n      this.deletable_ &&\n      !this.isShadow_ &&\n      !this.isDeadOrDying() &&\n      !this.workspace.options.readOnly\n    );\n  }\n\n  /**\n   * Return whether this block's own deletable property is true or false.\n   *\n   * @returns True if the block's deletable property is true, false otherwise.\n   */\n  isOwnDeletable(): boolean {\n    return this.deletable_;\n  }\n\n  /**\n   * Set whether this block is deletable or not.\n   *\n   * @param deletable True if deletable.\n   */\n  setDeletable(deletable: boolean) {\n    this.deletable_ = deletable;\n  }\n\n  /**\n   * Get whether this block is movable or not.\n   *\n   * @returns True if movable.\n   * @internal\n   */\n  isMovable(): boolean {\n    return (\n      this.movable_ &&\n      !this.isShadow_ &&\n      !this.isDeadOrDying() &&\n      !this.workspace.options.readOnly\n    );\n  }\n\n  /**\n   * Return whether this block's own movable property is true or false.\n   *\n   * @returns True if the block's movable property is true, false otherwise.\n   * @internal\n   */\n  isOwnMovable(): boolean {\n    return this.movable_;\n  }\n\n  /**\n   * Set whether this block is movable or not.\n   *\n   * @param movable True if movable.\n   */\n  setMovable(movable: boolean) {\n    this.movable_ = movable;\n  }\n\n  /**\n   * Get whether is block is duplicatable or not. If duplicating this block and\n   * descendants will put this block over the workspace's capacity this block is\n   * not duplicatable. If duplicating this block and descendants will put any\n   * type over their maxInstances this block is not duplicatable.\n   *\n   * @returns True if duplicatable.\n   */\n  isDuplicatable(): boolean {\n    if (!this.workspace.hasBlockLimits()) {\n      return true;\n    }\n    return this.workspace.isCapacityAvailable(\n      common.getBlockTypeCounts(this, true)\n    );\n  }\n\n  /**\n   * Get whether this block is a shadow block or not.\n   *\n   * @returns True if a shadow.\n   */\n  isShadow(): boolean {\n    return this.isShadow_;\n  }\n\n  /**\n   * Set whether this block is a shadow block or not.\n   *\n   * @param shadow True if a shadow.\n   * @internal\n   */\n  setShadow(shadow: boolean) {\n    this.isShadow_ = shadow;\n  }\n\n  /**\n   * Get whether this block is an insertion marker block or not.\n   *\n   * @returns True if an insertion marker.\n   */\n  isInsertionMarker(): boolean {\n    return this.isInsertionMarker_;\n  }\n\n  /**\n   * Set whether this block is an insertion marker block or not.\n   * Once set this cannot be unset.\n   *\n   * @param insertionMarker True if an insertion marker.\n   * @internal\n   */\n  setInsertionMarker(insertionMarker: boolean) {\n    this.isInsertionMarker_ = insertionMarker;\n  }\n\n  /**\n   * Get whether this block is editable or not.\n   *\n   * @returns True if editable.\n   * @internal\n   */\n  isEditable(): boolean {\n    return (\n      this.editable_ &&\n      !this.isDeadOrDying() &&\n      !this.workspace.options.readOnly\n    );\n  }\n\n  /**\n   * Return whether this block's own editable property is true or false.\n   *\n   * @returns True if the block's editable property is true, false otherwise.\n   */\n  isOwnEditable(): boolean {\n    return this.editable_;\n  }\n\n  /**\n   * Set whether this block is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  setEditable(editable: boolean) {\n    this.editable_ = editable;\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        field.updateEditable();\n      }\n    }\n  }\n\n  /**\n   * Returns if this block has been disposed of / deleted.\n   *\n   * @returns True if this block has been disposed of / deleted.\n   */\n  isDisposed(): boolean {\n    return this.disposed;\n  }\n\n  /**\n   * Find the connection on this block that corresponds to the given connection\n   * on the other block.\n   * Used to match connections between a block and its insertion marker.\n   *\n   * @param otherBlock The other block to match against.\n   * @param conn The other connection to match.\n   * @returns The matching connection on this block, or null.\n   * @internal\n   */\n  getMatchingConnection(\n    otherBlock: Block,\n    conn: Connection\n  ): Connection | null {\n    const connections = this.getConnections_(true);\n    const otherConnections = otherBlock.getConnections_(true);\n    if (connections.length !== otherConnections.length) {\n      throw Error('Connection lists did not match in length.');\n    }\n    for (let i = 0; i < otherConnections.length; i++) {\n      if (otherConnections[i] === conn) {\n        return connections[i];\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Set the URL of this block's help page.\n   *\n   * @param url URL string for block help, or function that returns a URL.  Null\n   *     for no help.\n   */\n  setHelpUrl(url: string | Function) {\n    this.helpUrl = url;\n  }\n\n  /**\n   * Sets the tooltip for this block.\n   *\n   * @param newTip The text for the tooltip, a function that returns the text\n   *     for the tooltip, or a parent object whose tooltip will be used. To not\n   *     display a tooltip pass the empty string.\n   */\n  setTooltip(newTip: Tooltip.TipInfo) {\n    this.tooltip = newTip;\n  }\n\n  /**\n   * Returns the tooltip text for this block.\n   *\n   * @returns The tooltip text for this block.\n   */\n  getTooltip(): string {\n    return Tooltip.getTooltipOfObject(this);\n  }\n\n  /**\n   * Get the colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  getColour(): string {\n    return this.colour_;\n  }\n\n  /**\n   * Get the name of the block style.\n   *\n   * @returns Name of the block style.\n   */\n  getStyleName(): string {\n    return this.styleName_;\n  }\n\n  /**\n   * Get the HSV hue value of a block.  Null if hue not set.\n   *\n   * @returns Hue value (0-360).\n   */\n  getHue(): number | null {\n    return this.hue_;\n  }\n\n  /**\n   * Change the colour of a block.\n   *\n   * @param colour HSV hue value (0 to 360), #RRGGBB string, or a message\n   *     reference string pointing to one of those two values.\n   */\n  setColour(colour: number | string) {\n    const parsed = parsing.parseBlockColour(colour);\n    this.hue_ = parsed.hue;\n    this.colour_ = parsed.hex;\n  }\n\n  /**\n   * Set the style and colour values of a block.\n   *\n   * @param blockStyleName Name of the block style.\n   */\n  setStyle(blockStyleName: string) {\n    this.styleName_ = blockStyleName;\n  }\n\n  /**\n   * Sets a callback function to use whenever the block's parent workspace\n   * changes, replacing any prior onchange handler. This is usually only called\n   * from the constructor, the block type initializer function, or an extension\n   * initializer function.\n   *\n   * @param onchangeFn The callback to call when the block's workspace changes.\n   * @throws {Error} if onchangeFn is not falsey and not a function.\n   */\n  setOnChange(onchangeFn: (p1: Abstract) => void) {\n    if (onchangeFn && typeof onchangeFn !== 'function') {\n      throw Error('onchange must be a function.');\n    }\n    if (this.onchangeWrapper_) {\n      this.workspace.removeChangeListener(this.onchangeWrapper_);\n    }\n    this.onchange = onchangeFn;\n    this.onchangeWrapper_ = onchangeFn.bind(this);\n    this.workspace.addChangeListener(this.onchangeWrapper_);\n  }\n\n  /**\n   * Returns the named field from a block.\n   *\n   * @param name The name of the field.\n   * @returns Named field, or null if field does not exist.\n   */\n  getField(name: string): Field | null {\n    if (typeof name !== 'string') {\n      throw TypeError(\n        'Block.prototype.getField expects a string ' +\n          'with the field name but received ' +\n          (name === undefined ? 'nothing' : name + ' of type ' + typeof name) +\n          ' instead'\n      );\n    }\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.name === name) {\n          return field;\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Return all variables referenced by this block.\n   *\n   * @returns List of variable ids.\n   */\n  getVars(): string[] {\n    const vars: string[] = [];\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.referencesVariables()) {\n          // NOTE: This only applies to `FieldVariable`, a `Field<string>`\n          vars.push(field.getValue() as string);\n        }\n      }\n    }\n    return vars;\n  }\n\n  /**\n   * Return all variables referenced by this block.\n   *\n   * @returns List of variable models.\n   * @internal\n   */\n  getVarModels(): VariableModel[] {\n    const vars = [];\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.referencesVariables()) {\n          const model = this.workspace.getVariableById(\n            field.getValue() as string\n          );\n          // Check if the variable actually exists (and isn't just a potential\n          // variable).\n          if (model) {\n            vars.push(model);\n          }\n        }\n      }\n    }\n    return vars;\n  }\n\n  /**\n   * Notification that a variable is renaming but keeping the same ID.  If the\n   * variable is in use on this block, rerender to show the new name.\n   *\n   * @param variable The variable being renamed.\n   * @internal\n   */\n  updateVarName(variable: VariableModel) {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (\n          field.referencesVariables() &&\n          variable.getId() === field.getValue()\n        ) {\n          field.refreshVariableName();\n        }\n      }\n    }\n  }\n\n  /**\n   * Notification that a variable is renaming.\n   * If the ID matches one of this block's variables, rename it.\n   *\n   * @param oldId ID of variable to rename.\n   * @param newId ID of new variable.  May be the same as oldId, but with an\n   *     updated name.\n   */\n  renameVarById(oldId: string, newId: string) {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        if (field.referencesVariables() && oldId === field.getValue()) {\n          field.setValue(newId);\n        }\n      }\n    }\n  }\n\n  /**\n   * Returns the language-neutral value of the given field.\n   *\n   * @param name The name of the field.\n   * @returns Value of the field or null if field does not exist.\n   */\n  getFieldValue(name: string): AnyDuringMigration {\n    const field = this.getField(name);\n    if (field) {\n      return field.getValue();\n    }\n    return null;\n  }\n\n  /**\n   * Sets the value of the given field for this block.\n   *\n   * @param newValue The value to set.\n   * @param name The name of the field to set the value of.\n   */\n  setFieldValue(newValue: AnyDuringMigration, name: string) {\n    const field = this.getField(name);\n    if (!field) {\n      throw Error('Field \"' + name + '\" not found.');\n    }\n    field.setValue(newValue);\n  }\n\n  /**\n   * Set whether this block can chain onto the bottom of another block.\n   *\n   * @param newBoolean True if there can be a previous statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  setPreviousStatement(\n    newBoolean: boolean,\n    opt_check?: string | string[] | null\n  ) {\n    if (newBoolean) {\n      if (opt_check === undefined) {\n        opt_check = null;\n      }\n      if (!this.previousConnection) {\n        this.previousConnection = this.makeConnection_(\n          ConnectionType.PREVIOUS_STATEMENT\n        );\n      }\n      this.previousConnection.setCheck(opt_check);\n    } else {\n      if (this.previousConnection) {\n        if (this.previousConnection.isConnected()) {\n          throw Error(\n            'Must disconnect previous statement before removing ' +\n              'connection.'\n          );\n        }\n        this.previousConnection.dispose();\n        this.previousConnection = null;\n      }\n    }\n  }\n\n  /**\n   * Set whether another block can chain onto the bottom of this block.\n   *\n   * @param newBoolean True if there can be a next statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  setNextStatement(newBoolean: boolean, opt_check?: string | string[] | null) {\n    if (newBoolean) {\n      if (opt_check === undefined) {\n        opt_check = null;\n      }\n      if (!this.nextConnection) {\n        this.nextConnection = this.makeConnection_(\n          ConnectionType.NEXT_STATEMENT\n        );\n      }\n      this.nextConnection.setCheck(opt_check);\n    } else {\n      if (this.nextConnection) {\n        if (this.nextConnection.isConnected()) {\n          throw Error(\n            'Must disconnect next statement before removing ' + 'connection.'\n          );\n        }\n        this.nextConnection.dispose();\n        this.nextConnection = null;\n      }\n    }\n  }\n\n  /**\n   * Set whether this block returns a value.\n   *\n   * @param newBoolean True if there is an output.\n   * @param opt_check Returned type or list of returned types.  Null or\n   *     undefined if any type could be returned (e.g. variable get).\n   */\n  setOutput(newBoolean: boolean, opt_check?: string | string[] | null) {\n    if (newBoolean) {\n      if (opt_check === undefined) {\n        opt_check = null;\n      }\n      if (!this.outputConnection) {\n        this.outputConnection = this.makeConnection_(\n          ConnectionType.OUTPUT_VALUE\n        );\n      }\n      this.outputConnection.setCheck(opt_check);\n    } else {\n      if (this.outputConnection) {\n        if (this.outputConnection.isConnected()) {\n          throw Error(\n            'Must disconnect output value before removing connection.'\n          );\n        }\n        this.outputConnection.dispose();\n        this.outputConnection = null;\n      }\n    }\n  }\n\n  /**\n   * Set whether value inputs are arranged horizontally or vertically.\n   *\n   * @param newBoolean True if inputs are horizontal.\n   */\n  setInputsInline(newBoolean: boolean) {\n    if (this.inputsInline !== newBoolean) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this,\n          'inline',\n          null,\n          this.inputsInline,\n          newBoolean\n        )\n      );\n      this.inputsInline = newBoolean;\n    }\n  }\n\n  /**\n   * Get whether value inputs are arranged horizontally or vertically.\n   *\n   * @returns True if inputs are horizontal.\n   */\n  getInputsInline(): boolean {\n    if (this.inputsInline !== undefined) {\n      // Set explicitly.\n      return this.inputsInline;\n    }\n    // Not defined explicitly.  Figure out what would look best.\n    for (let i = 1; i < this.inputList.length; i++) {\n      if (\n        this.inputList[i - 1] instanceof DummyInput &&\n        this.inputList[i] instanceof DummyInput\n      ) {\n        // Two dummy inputs in a row.  Don't inline them.\n        return false;\n      }\n    }\n    for (let i = 1; i < this.inputList.length; i++) {\n      if (\n        this.inputList[i - 1] instanceof ValueInput &&\n        this.inputList[i] instanceof DummyInput\n      ) {\n        // Dummy input after a value input.  Inline them.\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Set the block's output shape.\n   *\n   * @param outputShape Value representing an output shape.\n   */\n  setOutputShape(outputShape: number | null) {\n    this.outputShape_ = outputShape;\n  }\n\n  /**\n   * Get the block's output shape.\n   *\n   * @returns Value representing output shape if one exists.\n   */\n  getOutputShape(): number | null {\n    return this.outputShape_;\n  }\n\n  /**\n   * Get whether this block is enabled or not.\n   *\n   * @returns True if enabled.\n   */\n  isEnabled(): boolean {\n    return !this.disabled;\n  }\n\n  /**\n   * Set whether the block is enabled or not.\n   *\n   * @param enabled True if enabled.\n   */\n  setEnabled(enabled: boolean) {\n    if (this.isEnabled() !== enabled) {\n      const oldValue = this.disabled;\n      this.disabled = !enabled;\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this,\n          'disabled',\n          null,\n          oldValue,\n          !enabled\n        )\n      );\n    }\n  }\n\n  /**\n   * Get whether the block is disabled or not due to parents.\n   * The block's own disabled property is not considered.\n   *\n   * @returns True if disabled.\n   */\n  getInheritedDisabled(): boolean {\n    let ancestor = this.getSurroundParent();\n    while (ancestor) {\n      if (ancestor.disabled) {\n        return true;\n      }\n      ancestor = ancestor.getSurroundParent();\n    }\n    // Ran off the top.\n    return false;\n  }\n\n  /**\n   * Get whether the block is collapsed or not.\n   *\n   * @returns True if collapsed.\n   */\n  isCollapsed(): boolean {\n    return this.collapsed_;\n  }\n\n  /**\n   * Set whether the block is collapsed or not.\n   *\n   * @param collapsed True if collapsed.\n   */\n  setCollapsed(collapsed: boolean) {\n    if (this.collapsed_ !== collapsed) {\n      eventUtils.fire(\n        new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n          this,\n          'collapsed',\n          null,\n          this.collapsed_,\n          collapsed\n        )\n      );\n      this.collapsed_ = collapsed;\n    }\n  }\n\n  /**\n   * Create a human-readable text representation of this block and any children.\n   *\n   * @param opt_maxLength Truncate the string to this length.\n   * @param opt_emptyToken The placeholder string used to denote an empty input.\n   *     If not specified, '?' is used.\n   * @returns Text of block.\n   */\n  toString(opt_maxLength?: number, opt_emptyToken?: string): string {\n    const tokens = this.toTokens(opt_emptyToken);\n\n    // Run through our tokens array and simplify expression to remove\n    // parentheses around single field blocks.\n    // E.g. ['repeat', '(', '10', ')', 'times', 'do', '?']\n    for (let i = 2; i < tokens.length; i++) {\n      if (tokens[i - 2] === '(' && tokens[i] === ')') {\n        tokens[i - 2] = tokens[i - 1];\n        tokens.splice(i - 1, 2);\n      }\n    }\n\n    // Join the text array, removing the spaces around added parentheses.\n    let prev = '';\n    let text: string = tokens.reduce((acc, curr) => {\n      const val = acc + (prev === '(' || curr === ')' ? '' : ' ') + curr;\n      prev = curr[curr.length - 1];\n      return val;\n    }, '');\n\n    text = text.trim() || '???';\n    if (opt_maxLength) {\n      // TODO: Improve truncation so that text from this block is given\n      // priority. E.g. \"1+2+3+4+5+6+7+8+9=0\" should be \"...6+7+8+9=0\", not\n      // \"1+2+3+4+5...\". E.g. \"1+2+3+4+5=6+7+8+9+0\" should be \"...4+5=6+7...\".\n      if (text.length > opt_maxLength) {\n        text = text.substring(0, opt_maxLength - 3) + '...';\n      }\n    }\n    return text;\n  }\n\n  /**\n   * Converts this block into string tokens.\n   *\n   * @param emptyToken The token to use in place of an empty input.\n   *     Defaults to '?'.\n   * @returns The array of string tokens representing this block.\n   */\n  private toTokens(emptyToken = '?'): string[] {\n    const tokens = [];\n    /**\n     * Whether or not to add parentheses around an input.\n     *\n     * @param connection The connection.\n     * @returns True if we should add parentheses around the input.\n     */\n    function shouldAddParentheses(connection: Connection): boolean {\n      let checks = connection.getCheck();\n      if (!checks && connection.targetConnection) {\n        checks = connection.targetConnection.getCheck();\n      }\n      return (\n        !!checks &&\n        (checks.indexOf('Boolean') !== -1 || checks.indexOf('Number') !== -1)\n      );\n    }\n\n    for (const input of this.inputList) {\n      if (input.name == constants.COLLAPSED_INPUT_NAME) {\n        continue;\n      }\n      for (const field of input.fieldRow) {\n        tokens.push(field.getText());\n      }\n      if (input.connection) {\n        const child = input.connection.targetBlock();\n        if (child) {\n          const shouldAddParens = shouldAddParentheses(input.connection);\n          if (shouldAddParens) tokens.push('(');\n          tokens.push(...child.toTokens(emptyToken));\n          if (shouldAddParens) tokens.push(')');\n        } else {\n          tokens.push(emptyToken);\n        }\n      }\n    }\n    return tokens;\n  }\n\n  /**\n   * Appends a value input row.\n   *\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendValueInput(name: string): Input {\n    return this.appendInput(new ValueInput(name, this));\n  }\n\n  /**\n   * Appends a statement input row.\n   *\n   * @param name Language-neutral identifier which may used to find this input\n   *     again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendStatementInput(name: string): Input {\n    this.statementInputCount++;\n    return this.appendInput(new StatementInput(name, this));\n  }\n\n  /**\n   * Appends a dummy input row.\n   *\n   * @param name Optional language-neutral identifier which may used to find\n   *     this input again.  Should be unique to this block.\n   * @returns The input object created.\n   */\n  appendDummyInput(name = ''): Input {\n    return this.appendInput(new DummyInput(name, this));\n  }\n\n  /**\n   * Appends the given input row.\n   *\n   * Allows for custom inputs to be appended to the block.\n   */\n  appendInput(input: Input): Input {\n    this.inputList.push(input);\n    return input;\n  }\n\n  /**\n   * Appends an input with the given input type and name to the block after\n   * constructing it from the registry.\n   *\n   * @param type The name the input is registered under in the registry.\n   * @param name The name the input will have within the block.\n   * @returns The constucted input, or null if there was no constructor\n   *     associated with the type.\n   */\n  private appendInputFromRegistry(type: string, name: string): Input | null {\n    const inputConstructor = registry.getClass(\n      registry.Type.INPUT,\n      type,\n      false\n    );\n    if (!inputConstructor) return null;\n    return this.appendInput(new inputConstructor(name, this));\n  }\n\n  /**\n   * Initialize this block using a cross-platform, internationalization-friendly\n   * JSON description.\n   *\n   * @param json Structured data describing the block.\n   */\n  jsonInit(json: AnyDuringMigration) {\n    const warningPrefix = json['type'] ? 'Block \"' + json['type'] + '\": ' : '';\n\n    // Validate inputs.\n    if (json['output'] && json['previousStatement']) {\n      throw Error(\n        warningPrefix + 'Must not have both an output and a previousStatement.'\n      );\n    }\n\n    // Set basic properties of block.\n    // Makes styles backward compatible with old way of defining hat style.\n    if (json['style'] && json['style'].hat) {\n      this.hat = json['style'].hat;\n      // Must set to null so it doesn't error when checking for style and\n      // colour.\n      json['style'] = null;\n    }\n\n    if (json['style'] && json['colour']) {\n      throw Error(warningPrefix + 'Must not have both a colour and a style.');\n    } else if (json['style']) {\n      this.jsonInitStyle_(json, warningPrefix);\n    } else {\n      this.jsonInitColour_(json, warningPrefix);\n    }\n\n    // Interpolate the message blocks.\n    let i = 0;\n    while (json['message' + i] !== undefined) {\n      this.interpolate_(\n        json['message' + i],\n        json['args' + i] || [],\n        json['lastDummyAlign' + i],\n        warningPrefix\n      );\n      i++;\n    }\n\n    if (json['inputsInline'] !== undefined) {\n      this.setInputsInline(json['inputsInline']);\n    }\n    // Set output and previous/next connections.\n    if (json['output'] !== undefined) {\n      this.setOutput(true, json['output']);\n    }\n    if (json['outputShape'] !== undefined) {\n      this.setOutputShape(json['outputShape']);\n    }\n    if (json['previousStatement'] !== undefined) {\n      this.setPreviousStatement(true, json['previousStatement']);\n    }\n    if (json['nextStatement'] !== undefined) {\n      this.setNextStatement(true, json['nextStatement']);\n    }\n    if (json['tooltip'] !== undefined) {\n      const rawValue = json['tooltip'];\n      const localizedText = parsing.replaceMessageReferences(rawValue);\n      this.setTooltip(localizedText);\n    }\n    if (json['enableContextMenu'] !== undefined) {\n      this.contextMenu = !!json['enableContextMenu'];\n    }\n    if (json['suppressPrefixSuffix'] !== undefined) {\n      this.suppressPrefixSuffix = !!json['suppressPrefixSuffix'];\n    }\n    if (json['helpUrl'] !== undefined) {\n      const rawValue = json['helpUrl'];\n      const localizedValue = parsing.replaceMessageReferences(rawValue);\n      this.setHelpUrl(localizedValue);\n    }\n    if (typeof json['extensions'] === 'string') {\n      console.warn(\n        warningPrefix +\n          \"JSON attribute 'extensions' should be an array of\" +\n          \" strings. Found raw string in JSON for '\" +\n          json['type'] +\n          \"' block.\"\n      );\n      json['extensions'] = [json['extensions']]; // Correct and continue.\n    }\n\n    // Add the mutator to the block.\n    if (json['mutator'] !== undefined) {\n      Extensions.apply(json['mutator'], this, true);\n    }\n\n    const extensionNames = json['extensions'];\n    if (Array.isArray(extensionNames)) {\n      for (let j = 0; j < extensionNames.length; j++) {\n        Extensions.apply(extensionNames[j], this, false);\n      }\n    }\n  }\n\n  /**\n   * Initialize the colour of this block from the JSON description.\n   *\n   * @param json Structured data describing the block.\n   * @param warningPrefix Warning prefix string identifying block.\n   */\n  private jsonInitColour_(json: AnyDuringMigration, warningPrefix: string) {\n    if ('colour' in json) {\n      if (json['colour'] === undefined) {\n        console.warn(warningPrefix + 'Undefined colour value.');\n      } else {\n        const rawValue = json['colour'];\n        try {\n          this.setColour(rawValue);\n        } catch (e) {\n          console.warn(warningPrefix + 'Illegal colour value: ', rawValue);\n        }\n      }\n    }\n  }\n\n  /**\n   * Initialize the style of this block from the JSON description.\n   *\n   * @param json Structured data describing the block.\n   * @param warningPrefix Warning prefix string identifying block.\n   */\n  private jsonInitStyle_(json: AnyDuringMigration, warningPrefix: string) {\n    const blockStyleName = json['style'];\n    try {\n      this.setStyle(blockStyleName);\n    } catch (styleError) {\n      console.warn(warningPrefix + 'Style does not exist: ', blockStyleName);\n    }\n  }\n\n  /**\n   * Add key/values from mixinObj to this block object. By default, this method\n   * will check that the keys in mixinObj will not overwrite existing values in\n   * the block, including prototype values. This provides some insurance against\n   * mixin / extension incompatibilities with future block features. This check\n   * can be disabled by passing true as the second argument.\n   *\n   * @param mixinObj The key/values pairs to add to this block object.\n   * @param opt_disableCheck Option flag to disable overwrite checks.\n   */\n  mixin(mixinObj: AnyDuringMigration, opt_disableCheck?: boolean) {\n    if (\n      opt_disableCheck !== undefined &&\n      typeof opt_disableCheck !== 'boolean'\n    ) {\n      throw Error('opt_disableCheck must be a boolean if provided');\n    }\n    if (!opt_disableCheck) {\n      const overwrites = [];\n      for (const key in mixinObj) {\n        if ((this as AnyDuringMigration)[key] !== undefined) {\n          overwrites.push(key);\n        }\n      }\n      if (overwrites.length) {\n        throw Error(\n          'Mixin will overwrite block members: ' + JSON.stringify(overwrites)\n        );\n      }\n    }\n    Object.assign(this, mixinObj);\n  }\n\n  /**\n   * Interpolate a message description onto the block.\n   *\n   * @param message Text contains interpolation tokens (%1, %2, ...) that match\n   *     with fields or inputs defined in the args array.\n   * @param args Array of arguments to be interpolated.\n   * @param lastDummyAlign If a dummy input is added at the end, how should it\n   *     be aligned?\n   * @param warningPrefix Warning prefix string identifying block.\n   */\n  private interpolate_(\n    message: string,\n    args: AnyDuringMigration[],\n    lastDummyAlign: string | undefined,\n    warningPrefix: string\n  ) {\n    const tokens = parsing.tokenizeInterpolation(message);\n    this.validateTokens_(tokens, args.length);\n    const elements = this.interpolateArguments_(tokens, args, lastDummyAlign);\n\n    // An array of [field, fieldName] tuples.\n    const fieldStack = [];\n    for (let i = 0, element; (element = elements[i]); i++) {\n      if (this.isInputKeyword_(element['type'])) {\n        const input = this.inputFromJson_(element, warningPrefix);\n        // Should never be null, but just in case.\n        if (input) {\n          for (let j = 0, tuple; (tuple = fieldStack[j]); j++) {\n            input.appendField(tuple[0], tuple[1]);\n          }\n          fieldStack.length = 0;\n        }\n      } else {\n        // All other types, including ones starting with 'input_' get routed\n        // here.\n        const field = this.fieldFromJson_(element);\n        if (field) {\n          fieldStack.push([field, element['name']]);\n        }\n      }\n    }\n  }\n\n  /**\n   * Validates that the tokens are within the correct bounds, with no\n   * duplicates, and that all of the arguments are referred to. Throws errors if\n   * any of these things are not true.\n   *\n   * @param tokens An array of tokens to validate\n   * @param argsCount The number of args that need to be referred to.\n   */\n  private validateTokens_(tokens: Array<string | number>, argsCount: number) {\n    const visitedArgsHash = [];\n    let visitedArgsCount = 0;\n    for (let i = 0; i < tokens.length; i++) {\n      const token = tokens[i];\n      if (typeof token !== 'number') {\n        continue;\n      }\n      if (token < 1 || token > argsCount) {\n        throw Error(\n          'Block \"' +\n            this.type +\n            '\": ' +\n            'Message index %' +\n            token +\n            ' out of range.'\n        );\n      }\n      if (visitedArgsHash[token]) {\n        throw Error(\n          'Block \"' +\n            this.type +\n            '\": ' +\n            'Message index %' +\n            token +\n            ' duplicated.'\n        );\n      }\n      visitedArgsHash[token] = true;\n      visitedArgsCount++;\n    }\n    if (visitedArgsCount !== argsCount) {\n      throw Error(\n        'Block \"' +\n          this.type +\n          '\": ' +\n          'Message does not reference all ' +\n          argsCount +\n          ' arg(s).'\n      );\n    }\n  }\n\n  /**\n   * Inserts args in place of numerical tokens. String args are converted to\n   * JSON that defines a label field. If necessary an extra dummy input is added\n   * to the end of the elements.\n   *\n   * @param tokens The tokens to interpolate\n   * @param args The arguments to insert.\n   * @param lastDummyAlign The alignment the added dummy input should have, if\n   *     we are required to add one.\n   * @returns The JSON definitions of field and inputs to add to the block.\n   */\n  private interpolateArguments_(\n    tokens: Array<string | number>,\n    args: Array<AnyDuringMigration | string>,\n    lastDummyAlign: string | undefined\n  ): AnyDuringMigration[] {\n    const elements = [];\n    for (let i = 0; i < tokens.length; i++) {\n      let element = tokens[i];\n      if (typeof element === 'number') {\n        element = args[element - 1];\n      }\n      // Args can be strings, which is why this isn't elseif.\n      if (typeof element === 'string') {\n        // AnyDuringMigration because:  Type '{ text: string; type: string; } |\n        // null' is not assignable to type 'string | number'.\n        element = this.stringToFieldJson_(element) as AnyDuringMigration;\n        if (!element) {\n          continue;\n        }\n      }\n      elements.push(element);\n    }\n\n    const length = elements.length;\n    if (\n      length &&\n      !this.isInputKeyword_(\n        (elements as AnyDuringMigration)[length - 1]['type']\n      )\n    ) {\n      const dummyInput = {'type': 'input_dummy'};\n      if (lastDummyAlign) {\n        (dummyInput as AnyDuringMigration)['align'] = lastDummyAlign;\n      }\n      elements.push(dummyInput);\n    }\n\n    return elements;\n  }\n\n  /**\n   * Creates a field from the JSON definition of a field. If a field with the\n   * given type cannot be found, this attempts to create a different field using\n   * the 'alt' property of the JSON definition (if it exists).\n   *\n   * @param element The element to try to turn into a field.\n   * @returns The field defined by the JSON, or null if one couldn't be created.\n   */\n  private fieldFromJson_(element: {\n    alt?: string;\n    type: string;\n    text?: string;\n  }): Field | null {\n    const field = fieldRegistry.fromJson(element);\n    if (!field && element['alt']) {\n      if (typeof element['alt'] === 'string') {\n        const json = this.stringToFieldJson_(element['alt']);\n        return json ? this.fieldFromJson_(json) : null;\n      }\n      return this.fieldFromJson_(element['alt']);\n    }\n    return field;\n  }\n\n  /**\n   * Creates an input from the JSON definition of an input. Sets the input's\n   * check and alignment if they are provided.\n   *\n   * @param element The JSON to turn into an input.\n   * @param warningPrefix The prefix to add to warnings to help the developer\n   *     debug.\n   * @returns The input that has been created, or null if one could not be\n   *     created for some reason (should never happen).\n   */\n  private inputFromJson_(\n    element: AnyDuringMigration,\n    warningPrefix: string\n  ): Input | null {\n    const alignmentLookup = {\n      'LEFT': Align.LEFT,\n      'RIGHT': Align.RIGHT,\n      'CENTRE': Align.CENTRE,\n      'CENTER': Align.CENTRE,\n    };\n\n    let input = null;\n    switch (element['type']) {\n      case 'input_value':\n        input = this.appendValueInput(element['name']);\n        break;\n      case 'input_statement':\n        input = this.appendStatementInput(element['name']);\n        break;\n      case 'input_dummy':\n        input = this.appendDummyInput(element['name']);\n        break;\n      default: {\n        input = this.appendInputFromRegistry(element['type'], element['name']);\n        break;\n      }\n    }\n    // Should never be hit because of interpolate_'s checks, but just in case.\n    if (!input) {\n      return null;\n    }\n\n    if (element['check']) {\n      input.setCheck(element['check']);\n    }\n    if (element['align']) {\n      const alignment = (alignmentLookup as AnyDuringMigration)[\n        element['align'].toUpperCase()\n      ];\n      if (alignment === undefined) {\n        console.warn(warningPrefix + 'Illegal align value: ', element['align']);\n      } else {\n        input.setAlign(alignment);\n      }\n    }\n    return input;\n  }\n\n  /**\n   * Returns true if the given string matches one of the input keywords.\n   *\n   * @param str The string to check.\n   * @returns True if the given string matches one of the input keywords, false\n   *     otherwise.\n   */\n  private isInputKeyword_(str: string): boolean {\n    return (\n      str === 'input_value' ||\n      str === 'input_statement' ||\n      str === 'input_dummy' ||\n      registry.hasItem(registry.Type.INPUT, str)\n    );\n  }\n\n  /**\n   * Turns a string into the JSON definition of a label field. If the string\n   * becomes an empty string when trimmed, this returns null.\n   *\n   * @param str String to turn into the JSON definition of a label field.\n   * @returns The JSON definition or null.\n   */\n  private stringToFieldJson_(str: string): {text: string; type: string} | null {\n    str = str.trim();\n    if (str) {\n      return {\n        'type': 'field_label',\n        'text': str,\n      };\n    }\n    return null;\n  }\n\n  /**\n   * Move a named input to a different location on this block.\n   *\n   * @param name The name of the input to move.\n   * @param refName Name of input that should be after the moved input, or null\n   *     to be the input at the end.\n   */\n  moveInputBefore(name: string, refName: string | null) {\n    if (name === refName) {\n      return;\n    }\n    // Find both inputs.\n    let inputIndex = -1;\n    let refIndex = refName ? -1 : this.inputList.length;\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.name === name) {\n        inputIndex = i;\n        if (refIndex !== -1) {\n          break;\n        }\n      } else if (refName && input.name === refName) {\n        refIndex = i;\n        if (inputIndex !== -1) {\n          break;\n        }\n      }\n    }\n    if (inputIndex === -1) {\n      throw Error('Named input \"' + name + '\" not found.');\n    }\n    if (refIndex === -1) {\n      throw Error('Reference input \"' + refName + '\" not found.');\n    }\n    this.moveNumberedInputBefore(inputIndex, refIndex);\n  }\n\n  /**\n   * Move a numbered input to a different location on this block.\n   *\n   * @param inputIndex Index of the input to move.\n   * @param refIndex Index of input that should be after the moved input.\n   */\n  moveNumberedInputBefore(inputIndex: number, refIndex: number) {\n    // Validate arguments.\n    if (inputIndex === refIndex) {\n      throw Error(\"Can't move input to itself.\");\n    }\n    if (inputIndex >= this.inputList.length) {\n      throw RangeError('Input index ' + inputIndex + ' out of bounds.');\n    }\n    if (refIndex > this.inputList.length) {\n      throw RangeError('Reference input ' + refIndex + ' out of bounds.');\n    }\n    // Remove input.\n    const input = this.inputList[inputIndex];\n    this.inputList.splice(inputIndex, 1);\n    if (inputIndex < refIndex) {\n      refIndex--;\n    }\n    // Reinsert input.\n    this.inputList.splice(refIndex, 0, input);\n  }\n\n  /**\n   * Remove an input from this block.\n   *\n   * @param name The name of the input.\n   * @param opt_quiet True to prevent an error if input is not present.\n   * @returns True if operation succeeds, false if input is not present and\n   *     opt_quiet is true.\n   * @throws {Error} if the input is not present and opt_quiet is not true.\n   */\n  removeInput(name: string, opt_quiet?: boolean): boolean {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.name === name) {\n        if (input instanceof StatementInput) this.statementInputCount--;\n        input.dispose();\n        this.inputList.splice(i, 1);\n        return true;\n      }\n    }\n    if (opt_quiet) {\n      return false;\n    }\n    throw Error('Input not found: ' + name);\n  }\n\n  /**\n   * Fetches the named input object.\n   *\n   * @param name The name of the input.\n   * @returns The input object, or null if input does not exist.\n   */\n  getInput(name: string): Input | null {\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.name === name) {\n        return input;\n      }\n    }\n    // This input does not exist.\n    return null;\n  }\n\n  /**\n   * Fetches the block attached to the named input.\n   *\n   * @param name The name of the input.\n   * @returns The attached value block, or null if the input is either\n   *     disconnected or if the input does not exist.\n   */\n  getInputTargetBlock(name: string): Block | null {\n    const input = this.getInput(name);\n    return input && input.connection && input.connection.targetBlock();\n  }\n\n  /**\n   * Returns the comment on this block (or null if there is no comment).\n   *\n   * @returns Block's comment.\n   */\n  getCommentText(): string | null {\n    const comment = this.getIcon(CommentIcon.TYPE) as CommentIcon | null;\n    return comment?.getText() ?? null;\n  }\n\n  /**\n   * Set this block's comment text.\n   *\n   * @param text The text, or null to delete.\n   */\n  setCommentText(text: string | null) {\n    const comment = this.getIcon(CommentIcon.TYPE) as CommentIcon | null;\n    const oldText = comment?.getText() ?? null;\n    if (oldText === text) return;\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n        this,\n        'comment',\n        null,\n        oldText,\n        text\n      )\n    );\n\n    if (text !== null) {\n      let comment = this.getIcon(CommentIcon.TYPE) as CommentIcon | undefined;\n      if (!comment) {\n        comment = this.addIcon(new CommentIcon(this));\n      }\n      comment.setText(text);\n    } else {\n      this.removeIcon(CommentIcon.TYPE);\n    }\n  }\n\n  /**\n   * Set this block's warning text.\n   *\n   * @param _text The text, or null to delete.\n   * @param _opt_id An optional ID for the warning text to be able to maintain\n   *     multiple warnings.\n   */\n  setWarningText(_text: string | null, _opt_id?: string) {\n    // NOOP.\n  }\n\n  /**\n   * Give this block a mutator dialog.\n   *\n   * @param _mutator A mutator dialog instance or null to remove.\n   */\n  setMutator(_mutator: MutatorIcon) {\n    // NOOP.\n  }\n\n  /** Adds the given icon to the block. */\n  addIcon<T extends IIcon>(icon: T): T {\n    if (this.hasIcon(icon.getType())) throw new DuplicateIconType(icon);\n    this.icons.push(icon);\n    this.icons.sort((a, b) => a.getWeight() - b.getWeight());\n    return icon;\n  }\n\n  /**\n   * Removes the icon whose getType matches the given type iconType from the\n   * block.\n   *\n   * @param type The type of the icon to remove from the block.\n   * @returns True if an icon with the given type was found, false otherwise.\n   */\n  removeIcon(type: IconType<IIcon>): boolean {\n    if (!this.hasIcon(type)) return false;\n    this.getIcon(type)?.dispose();\n    this.icons = this.icons.filter((icon) => !icon.getType().equals(type));\n    return true;\n  }\n\n  /**\n   * @returns True if an icon with the given type exists on the block,\n   *     false otherwise.\n   */\n  hasIcon(type: IconType<IIcon>): boolean {\n    return this.icons.some((icon) => icon.getType().equals(type));\n  }\n\n  /**\n   * @param type The type of the icon to retrieve. Prefer passing an `IconType`\n   *     for proper type checking when using typescript.\n   * @returns The icon with the given type if it exists on the block, undefined\n   *     otherwise.\n   */\n  getIcon<T extends IIcon>(type: IconType<T> | string): T | undefined {\n    if (type instanceof IconType) {\n      return this.icons.find((icon) => icon.getType().equals(type)) as T;\n    } else {\n      return this.icons.find((icon) => icon.getType().toString() === type) as T;\n    }\n  }\n\n  /** @returns An array of the icons attached to this block. */\n  getIcons(): IIcon[] {\n    return [...this.icons];\n  }\n\n  /**\n   * Return the coordinates of the top-left corner of this block relative to the\n   * drawing surface's origin (0,0), in workspace units.\n   *\n   * @returns Object with .x and .y properties.\n   */\n  getRelativeToSurfaceXY(): Coordinate {\n    return this.xy_;\n  }\n\n  /**\n   * Move a block by a relative offset.\n   *\n   * @param dx Horizontal offset, in workspace units.\n   * @param dy Vertical offset, in workspace units.\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  moveBy(dx: number, dy: number, reason?: string[]) {\n    if (this.parentBlock_) {\n      throw Error('Block has parent');\n    }\n    const event = new (eventUtils.get(eventUtils.BLOCK_MOVE))(\n      this\n    ) as BlockMove;\n    reason && event.setReason(reason);\n    this.xy_.translate(dx, dy);\n    event.recordNew();\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Create a connection of the specified type.\n   *\n   * @param type The type of the connection to create.\n   * @returns A new connection of the specified type.\n   * @internal\n   */\n  makeConnection_(type: ConnectionType): Connection {\n    return new Connection(this, type);\n  }\n\n  /**\n   * Recursively checks whether all statement and value inputs are filled with\n   * blocks. Also checks all following statement blocks in this stack.\n   *\n   * @param opt_shadowBlocksAreFilled An optional argument controlling whether\n   *     shadow blocks are counted as filled. Defaults to true.\n   * @returns True if all inputs are filled, false otherwise.\n   */\n  allInputsFilled(opt_shadowBlocksAreFilled?: boolean): boolean {\n    // Account for the shadow block filledness toggle.\n    if (opt_shadowBlocksAreFilled === undefined) {\n      opt_shadowBlocksAreFilled = true;\n    }\n    if (!opt_shadowBlocksAreFilled && this.isShadow()) {\n      return false;\n    }\n\n    // Recursively check each input block of the current block.\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (!input.connection) {\n        continue;\n      }\n      const target = input.connection.targetBlock();\n      if (!target || !target.allInputsFilled(opt_shadowBlocksAreFilled)) {\n        return false;\n      }\n    }\n\n    // Recursively check the next block after the current block.\n    const next = this.getNextBlock();\n    if (next) {\n      return next.allInputsFilled(opt_shadowBlocksAreFilled);\n    }\n\n    return true;\n  }\n\n  /**\n   * This method returns a string describing this Block in developer terms (type\n   * name and ID; English only).\n   *\n   * Intended to on be used in console logs and errors. If you need a string\n   * that uses the user's native language (including block text, field values,\n   * and child blocks), use [toString()]{@link Block#toString}.\n   *\n   * @returns The description.\n   */\n  toDevString(): string {\n    let msg = this.type ? '\"' + this.type + '\" block' : 'Block';\n    if (this.id) {\n      msg += ' (id=\"' + this.id + '\")';\n    }\n    return msg;\n  }\n}\n\nexport namespace Block {\n  export interface CommentModel {\n    text: string | null;\n    pinned: boolean;\n    size: Size;\n  }\n}\n\nexport type CommentModel = Block.CommentModel;\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a block drag.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BlockDrag');\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners when a block is being manually dragged/dropped.\n */\nexport class BlockDrag extends UiBase {\n  /** The ID of the top-level block being dragged. */\n  blockId?: string;\n\n  /** True if this is the start of a drag, false if this is the end of one. */\n  isStart?: boolean;\n\n  /**\n   * A list of all of the blocks (i.e. all descendants of the block associated\n   * with the block ID) being dragged.\n   */\n  blocks?: Block[];\n\n  override type = eventUtils.BLOCK_DRAG;\n\n  /**\n   * @param opt_block The top block in the stack that is being dragged.\n   *     Undefined for a blank event.\n   * @param opt_isStart Whether this is the start of a block drag.\n   *    Undefined for a blank event.\n   * @param opt_blocks The blocks affected by this drag. Undefined for a blank\n   *     event.\n   */\n  constructor(opt_block?: Block, opt_isStart?: boolean, opt_blocks?: Block[]) {\n    const workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    super(workspaceId);\n    if (!opt_block) return;\n\n    this.blockId = opt_block.id;\n    this.isStart = opt_isStart;\n    this.blocks = opt_blocks;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockDragJson {\n    const json = super.toJson() as BlockDragJson;\n    if (this.isStart === undefined) {\n      throw new Error(\n        'Whether this event is the start of a drag is undefined. ' +\n          'Either pass the value to the constructor, or call fromJson'\n      );\n    }\n    if (this.blockId === undefined) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['isStart'] = this.isStart;\n    json['blockId'] = this.blockId;\n    // TODO: I don't think we should actually apply the blocks array to the JSON\n    //   object b/c they have functions and aren't actually serializable.\n    json['blocks'] = this.blocks;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockDrag, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses..\n   * @internal\n   */\n  static fromJson(\n    json: BlockDragJson,\n    workspace: Workspace,\n    event?: any\n  ): BlockDrag {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockDrag()\n    ) as BlockDrag;\n    newEvent.isStart = json['isStart'];\n    newEvent.blockId = json['blockId'];\n    newEvent.blocks = json['blocks'];\n    return newEvent;\n  }\n}\n\nexport interface BlockDragJson extends AbstractEventJson {\n  isStart: boolean;\n  blockId: string;\n  blocks?: Block[];\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.BLOCK_DRAG, BlockDrag);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Manager for all items registered with the workspace.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ComponentManager');\n\nimport type {IAutoHideable} from './interfaces/i_autohideable.js';\nimport type {IComponent} from './interfaces/i_component.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {IPositionable} from './interfaces/i_positionable.js';\nimport * as arrayUtils from './utils/array.js';\n\nclass Capability<_T> {\n  static POSITIONABLE = new Capability<IPositionable>('positionable');\n  static DRAG_TARGET = new Capability<IDragTarget>('drag_target');\n  static DELETE_AREA = new Capability<IDeleteArea>('delete_area');\n  static AUTOHIDEABLE = new Capability<IAutoHideable>('autohideable');\n  private readonly name_: string;\n  /** @param name The name of the component capability. */\n  constructor(name: string) {\n    this.name_ = name;\n  }\n\n  /**\n   * Returns the name of the capability.\n   *\n   * @returns The name.\n   */\n  toString(): string {\n    return this.name_;\n  }\n}\n\n/**\n * Manager for all items registered with the workspace.\n */\nexport class ComponentManager {\n  static Capability = Capability;\n\n  /**\n   * A map of the components registered with the workspace, mapped to id.\n   */\n  private readonly componentData = new Map<string, ComponentDatum>();\n\n  /** A map of capabilities to component IDs. */\n  private readonly capabilityToComponentIds = new Map<string, string[]>();\n\n  /**\n   * Adds a component.\n   *\n   * @param componentInfo The data for the component to register.\n   * @param opt_allowOverrides True to prevent an error when overriding an\n   *     already registered item.\n   */\n  addComponent(componentInfo: ComponentDatum, opt_allowOverrides?: boolean) {\n    // Don't throw an error if opt_allowOverrides is true.\n    const id = componentInfo.component.id;\n    if (!opt_allowOverrides && this.componentData.has(id)) {\n      throw Error(\n        'Plugin \"' +\n          id +\n          '\" with capabilities \"' +\n          this.componentData.get(id)?.capabilities +\n          '\" already added.'\n      );\n    }\n    this.componentData.set(id, componentInfo);\n    const stringCapabilities = [];\n    for (let i = 0; i < componentInfo.capabilities.length; i++) {\n      const capability = String(componentInfo.capabilities[i]).toLowerCase();\n      stringCapabilities.push(capability);\n      if (!this.capabilityToComponentIds.has(capability)) {\n        this.capabilityToComponentIds.set(capability, [id]);\n      } else {\n        this.capabilityToComponentIds.get(capability)?.push(id);\n      }\n    }\n    this.componentData.get(id)!.capabilities = stringCapabilities;\n  }\n\n  /**\n   * Removes a component.\n   *\n   * @param id The ID of the component to remove.\n   */\n  removeComponent(id: string) {\n    const componentInfo = this.componentData.get(id);\n    if (!componentInfo) {\n      return;\n    }\n    for (let i = 0; i < componentInfo.capabilities.length; i++) {\n      const capability = String(componentInfo.capabilities[i]).toLowerCase();\n      arrayUtils.removeElem(this.capabilityToComponentIds.get(capability)!, id);\n    }\n    this.componentData.delete(id);\n  }\n\n  /**\n   * Adds a capability to a existing registered component.\n   *\n   * @param id The ID of the component to add the capability to.\n   * @param capability The capability to add.\n   */\n  addCapability<T>(id: string, capability: string | Capability<T>) {\n    if (!this.getComponent(id)) {\n      throw Error(\n        'Cannot add capability, \"' +\n          capability +\n          '\". Plugin \"' +\n          id +\n          '\" has not been added to the ComponentManager'\n      );\n    }\n    if (this.hasCapability(id, capability)) {\n      console.warn(\n        'Plugin \"' + id + 'already has capability \"' + capability + '\"'\n      );\n      return;\n    }\n    capability = `${capability}`.toLowerCase();\n    this.componentData.get(id)?.capabilities.push(capability);\n    this.capabilityToComponentIds.get(capability)?.push(id);\n  }\n\n  /**\n   * Removes a capability from an existing registered component.\n   *\n   * @param id The ID of the component to remove the capability from.\n   * @param capability The capability to remove.\n   */\n  removeCapability<T>(id: string, capability: string | Capability<T>) {\n    if (!this.getComponent(id)) {\n      throw Error(\n        'Cannot remove capability, \"' +\n          capability +\n          '\". Plugin \"' +\n          id +\n          '\" has not been added to the ComponentManager'\n      );\n    }\n    if (!this.hasCapability(id, capability)) {\n      console.warn(\n        'Plugin \"' +\n          id +\n          'doesn\\'t have capability \"' +\n          capability +\n          '\" to remove'\n      );\n      return;\n    }\n    capability = `${capability}`.toLowerCase();\n    arrayUtils.removeElem(this.componentData.get(id)!.capabilities, capability);\n    arrayUtils.removeElem(this.capabilityToComponentIds.get(capability)!, id);\n  }\n\n  /**\n   * Returns whether the component with this id has the specified capability.\n   *\n   * @param id The ID of the component to check.\n   * @param capability The capability to check for.\n   * @returns Whether the component has the capability.\n   */\n  hasCapability<T>(id: string, capability: string | Capability<T>): boolean {\n    capability = `${capability}`.toLowerCase();\n    return (\n      this.componentData.has(id) &&\n      this.componentData.get(id)!.capabilities.indexOf(capability) !== -1\n    );\n  }\n\n  /**\n   * Gets the component with the given ID.\n   *\n   * @param id The ID of the component to get.\n   * @returns The component with the given name or undefined if not found.\n   */\n  getComponent(id: string): IComponent | undefined {\n    return this.componentData.get(id)?.component;\n  }\n\n  /**\n   * Gets all the components with the specified capability.\n   *\n   * @param capability The capability of the component.\n   * @param sorted Whether to return list ordered by weights.\n   * @returns The components that match the specified capability.\n   */\n  getComponents<T extends IComponent>(\n    capability: string | Capability<T>,\n    sorted: boolean\n  ): T[] {\n    capability = `${capability}`.toLowerCase();\n    const componentIds = this.capabilityToComponentIds.get(capability);\n    if (!componentIds) {\n      return [];\n    }\n    const components: T[] = [];\n    if (sorted) {\n      const componentDataList: ComponentDatum[] = [];\n      componentIds.forEach((id) => {\n        componentDataList.push(this.componentData.get(id)!);\n      });\n      componentDataList.sort(function (a, b) {\n        return a.weight - b.weight;\n      });\n      componentDataList.forEach(function (componentDatum) {\n        components.push(componentDatum.component as T);\n      });\n    } else {\n      componentIds.forEach((id) => {\n        components.push(this.componentData.get(id)!.component as T);\n      });\n    }\n    return components;\n  }\n}\n\nexport namespace ComponentManager {\n  /** An object storing component information. */\n  export interface ComponentDatum {\n    component: IComponent;\n    capabilities: Array<string | Capability<IComponent>>;\n    weight: number;\n  }\n}\n\nexport type ComponentDatum = ComponentManager.ComponentDatum;\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.config');\n\n/**\n * All the values that we expect developers to be able to change\n * before injecting Blockly.\n */\ninterface Config {\n  dragRadius: number;\n  flyoutDragRadius: number;\n  snapRadius: number;\n  currentConnectionPreference: number;\n  bumpDelay: number;\n  connectingSnapRadius: number;\n}\n\n/** Default snap radius. */\nconst DEFAULT_SNAP_RADIUS = 28;\n\n/**\n * Object holding all the values on Blockly that we expect developers to be\n * able to change.\n */\nexport const config: Config = {\n  /**\n   * Number of pixels the mouse must move before a drag starts.\n   *\n   */\n  dragRadius: 5,\n  /**\n   * Number of pixels the mouse must move before a drag/scroll starts from the\n   * flyout.  Because the drag-intention is determined when this is reached, it\n   * is larger than dragRadius so that the drag-direction is clearer.\n   *\n   */\n  flyoutDragRadius: 10,\n  /**\n   * Maximum misalignment between connections for them to snap together.\n   *\n   */\n  snapRadius: DEFAULT_SNAP_RADIUS,\n  /**\n   * Maximum misalignment between connections for them to snap together.\n   * This should be the same as the snap radius.\n   *\n   */\n  connectingSnapRadius: DEFAULT_SNAP_RADIUS,\n  /**\n   * How much to prefer staying connected to the current connection over moving\n   * to a new connection.  The current previewed connection is considered to be\n   * this much closer to the matching connection on the block than it actually\n   * is.\n   *\n   */\n  currentConnectionPreference: 8,\n  /**\n   * Delay in ms between trigger and bumping unconnected block out of alignment.\n   *\n   */\n  bumpDelay: 250,\n};\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class that controls updates to connections during drags.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.InsertionMarkerManager');\n\nimport {finishQueuedRenders} from './render_management.js';\nimport * as blockAnimations from './block_animations.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {config} from './config.js';\nimport * as constants from './constants.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {RenderedConnection} from './rendered_connection.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/** Represents a nearby valid connection. */\ninterface CandidateConnection {\n  /**\n   * A nearby valid connection that is compatible with local.\n   * This is not on any of the blocks that are being dragged.\n   */\n  closest: RenderedConnection;\n  /**\n   * A connection on the dragging stack that is compatible with closest. This is\n   * on the top block that is being dragged or the last block in the dragging\n   * stack.\n   */\n  local: RenderedConnection;\n  radius: number;\n}\n\n/**\n * An error message to throw if the block created by createMarkerBlock_ is\n * missing any components.\n */\nconst DUPLICATE_BLOCK_ERROR =\n  'The insertion marker ' +\n  'manager tried to create a marker but the result is missing %1. If ' +\n  'you are using a mutator, make sure your domToMutation method is ' +\n  'properly defined.';\n\n/**\n * Class that controls updates to connections during drags.  It is primarily\n * responsible for finding the closest eligible connection and highlighting or\n * unhighlighting it as needed during a drag.\n */\nexport class InsertionMarkerManager {\n  /**\n   * The top block in the stack being dragged.\n   * Does not change during a drag.\n   */\n  private readonly topBlock: BlockSvg;\n\n  /**\n   * The workspace on which these connections are being dragged.\n   * Does not change during a drag.\n   */\n  private readonly workspace: WorkspaceSvg;\n\n  /**\n   * The last connection on the stack, if it's not the last connection on the\n   * first block.\n   * Set in initAvailableConnections, if at all.\n   */\n  private lastOnStack: RenderedConnection | null = null;\n\n  /**\n   * The insertion marker corresponding to the last block in the stack, if\n   * that's not the same as the first block in the stack.\n   * Set in initAvailableConnections, if at all\n   */\n  private lastMarker: BlockSvg | null = null;\n\n  /**\n   * The insertion marker that shows up between blocks to show where a block\n   * would go if dropped immediately.\n   */\n  private firstMarker: BlockSvg;\n\n  /**\n   * Information about the connection that would be made if the dragging block\n   * were released immediately. Updated on every mouse move.\n   */\n  private activeCandidate: CandidateConnection | null = null;\n\n  /**\n   * Whether the block would be deleted if it were dropped immediately.\n   * Updated on every mouse move.\n   *\n   * @internal\n   */\n  public wouldDeleteBlock = false;\n\n  /**\n   * Connection on the insertion marker block that corresponds to\n   * the active candidate's local connection on the currently dragged block.\n   */\n  private markerConnection: RenderedConnection | null = null;\n\n  /** The block that currently has an input being highlighted, or null. */\n  private highlightedBlock: BlockSvg | null = null;\n\n  /** The block being faded to indicate replacement, or null. */\n  private fadedBlock: BlockSvg | null = null;\n\n  /**\n   * The connections on the dragging blocks that are available to connect to\n   * other blocks.  This includes all open connections on the top block, as\n   * well as the last connection on the block stack.\n   */\n  private availableConnections: RenderedConnection[];\n\n  /** @param block The top block in the stack being dragged. */\n  constructor(block: BlockSvg) {\n    common.setSelected(block);\n    this.topBlock = block;\n\n    this.workspace = block.workspace;\n\n    this.firstMarker = this.createMarkerBlock(this.topBlock);\n\n    this.availableConnections = this.initAvailableConnections();\n\n    if (this.lastOnStack) {\n      this.lastMarker = this.createMarkerBlock(\n        this.lastOnStack.getSourceBlock()\n      );\n    }\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    this.availableConnections.length = 0;\n    this.disposeInsertionMarker(this.firstMarker);\n    this.disposeInsertionMarker(this.lastMarker);\n  }\n\n  /**\n   * Update the available connections for the top block. These connections can\n   * change if a block is unplugged and the stack is healed.\n   *\n   * @internal\n   */\n  updateAvailableConnections() {\n    this.availableConnections = this.initAvailableConnections();\n  }\n\n  /**\n   * Return whether the block would be connected if dropped immediately, based\n   * on information from the most recent move event.\n   *\n   * @returns True if the block would be connected if dropped immediately.\n   * @internal\n   */\n  wouldConnectBlock(): boolean {\n    return !!this.activeCandidate;\n  }\n\n  /**\n   * Connect to the closest connection and render the results.\n   * This should be called at the end of a drag.\n   *\n   * @internal\n   */\n  applyConnections() {\n    if (!this.activeCandidate) return;\n    eventUtils.disable();\n    this.hidePreview();\n    eventUtils.enable();\n    const {local, closest} = this.activeCandidate;\n    local.connect(closest);\n    if (this.topBlock.rendered) {\n      const inferiorConnection = local.isSuperior() ? closest : local;\n      const rootBlock = this.topBlock.getRootBlock();\n\n      finishQueuedRenders().then(() => {\n        blockAnimations.connectionUiEffect(inferiorConnection.getSourceBlock());\n        // bringToFront is incredibly expensive. Delay until the next frame.\n        setTimeout(() => {\n          rootBlock.bringToFront();\n        }, 0);\n      });\n    }\n  }\n\n  /**\n   * Update connections based on the most recent move location.\n   *\n   * @param dxy Position relative to drag start, in workspace units.\n   * @param dragTarget The drag target that the block is currently over.\n   * @internal\n   */\n  update(dxy: Coordinate, dragTarget: IDragTarget | null) {\n    const newCandidate = this.getCandidate(dxy);\n\n    this.wouldDeleteBlock = this.shouldDelete(!!newCandidate, dragTarget);\n\n    const shouldUpdate =\n      this.wouldDeleteBlock || this.shouldUpdatePreviews(newCandidate, dxy);\n\n    if (shouldUpdate) {\n      // Don't fire events for insertion marker creation or movement.\n      eventUtils.disable();\n      this.maybeHidePreview(newCandidate);\n      this.maybeShowPreview(newCandidate);\n      eventUtils.enable();\n    }\n  }\n\n  /**\n   * Create an insertion marker that represents the given block.\n   *\n   * @param sourceBlock The block that the insertion marker will represent.\n   * @returns The insertion marker that represents the given block.\n   */\n  private createMarkerBlock(sourceBlock: BlockSvg): BlockSvg {\n    const imType = sourceBlock.type;\n\n    eventUtils.disable();\n    let result: BlockSvg;\n    try {\n      result = this.workspace.newBlock(imType);\n      result.setInsertionMarker(true);\n      if (sourceBlock.saveExtraState) {\n        const state = sourceBlock.saveExtraState();\n        if (state && result.loadExtraState) {\n          result.loadExtraState(state);\n        }\n      } else if (sourceBlock.mutationToDom) {\n        const oldMutationDom = sourceBlock.mutationToDom();\n        if (oldMutationDom && result.domToMutation) {\n          result.domToMutation(oldMutationDom);\n        }\n      }\n      // Copy field values from the other block.  These values may impact the\n      // rendered size of the insertion marker.  Note that we do not care about\n      // child blocks here.\n      for (let i = 0; i < sourceBlock.inputList.length; i++) {\n        const sourceInput = sourceBlock.inputList[i];\n        if (sourceInput.name === constants.COLLAPSED_INPUT_NAME) {\n          continue; // Ignore the collapsed input.\n        }\n        const resultInput = result.inputList[i];\n        if (!resultInput) {\n          throw new Error(DUPLICATE_BLOCK_ERROR.replace('%1', 'an input'));\n        }\n        for (let j = 0; j < sourceInput.fieldRow.length; j++) {\n          const sourceField = sourceInput.fieldRow[j];\n          const resultField = resultInput.fieldRow[j];\n          if (!resultField) {\n            throw new Error(DUPLICATE_BLOCK_ERROR.replace('%1', 'a field'));\n          }\n          resultField.setValue(sourceField.getValue());\n        }\n      }\n\n      result.setCollapsed(sourceBlock.isCollapsed());\n      result.setInputsInline(sourceBlock.getInputsInline());\n\n      result.initSvg();\n      result.getSvgRoot().setAttribute('visibility', 'hidden');\n    } finally {\n      eventUtils.enable();\n    }\n\n    return result;\n  }\n\n  /**\n   * Populate the list of available connections on this block stack. If the\n   * stack has more than one block, this function will also update lastOnStack.\n   *\n   * @returns A list of available connections.\n   */\n  private initAvailableConnections(): RenderedConnection[] {\n    const available = this.topBlock.getConnections_(false);\n    // Also check the last connection on this stack\n    const lastOnStack = this.topBlock.lastConnectionInStack(true);\n    if (lastOnStack && lastOnStack !== this.topBlock.nextConnection) {\n      available.push(lastOnStack);\n      this.lastOnStack = lastOnStack;\n    }\n    return available;\n  }\n\n  /**\n   * Whether the previews (insertion marker and replacement marker) should be\n   * updated based on the closest candidate and the current drag distance.\n   *\n   * @param newCandidate A new candidate connection that may replace the current\n   *     best candidate.\n   * @param dxy Position relative to drag start, in workspace units.\n   * @returns Whether the preview should be updated.\n   */\n  private shouldUpdatePreviews(\n    newCandidate: CandidateConnection | null,\n    dxy: Coordinate\n  ): boolean {\n    // Only need to update if we were showing a preview before.\n    if (!newCandidate) return !!this.activeCandidate;\n\n    // We weren't showing a preview before, but we should now.\n    if (!this.activeCandidate) return true;\n\n    // We're already showing an insertion marker.\n    // Decide whether the new connection has higher priority.\n    const {local: activeLocal, closest: activeClosest} = this.activeCandidate;\n    if (\n      activeClosest === newCandidate.closest &&\n      activeLocal === newCandidate.local\n    ) {\n      // The connection was the same as the current connection.\n      return false;\n    }\n\n    const xDiff = activeLocal.x + dxy.x - activeClosest.x;\n    const yDiff = activeLocal.y + dxy.y - activeClosest.y;\n    const curDistance = Math.sqrt(xDiff * xDiff + yDiff * yDiff);\n    // Slightly prefer the existing preview over a new preview.\n    return (\n      newCandidate.radius < curDistance - config.currentConnectionPreference\n    );\n  }\n\n  /**\n   * Find the nearest valid connection, which may be the same as the current\n   * closest connection.\n   *\n   * @param dxy Position relative to drag start, in workspace units.\n   * @returns An object containing a local connection, a closest connection, and\n   *     a radius.\n   */\n  private getCandidate(dxy: Coordinate): CandidateConnection | null {\n    // It's possible that a block has added or removed connections during a\n    // drag, (e.g. in a drag/move event handler), so let's update the available\n    // connections. Note that this will be called on every move while dragging,\n    // so it might cause slowness, especially if the block stack is large.  If\n    // so, maybe it could be made more efficient. Also note that we won't update\n    // the connections if we've already connected the insertion marker to a\n    // block.\n    if (!this.markerConnection || !this.markerConnection.isConnected()) {\n      this.updateAvailableConnections();\n    }\n\n    let radius = this.getStartRadius();\n    let candidate = null;\n    for (let i = 0; i < this.availableConnections.length; i++) {\n      const myConnection = this.availableConnections[i];\n      const neighbour = myConnection.closest(radius, dxy);\n      if (neighbour.connection) {\n        candidate = {\n          closest: neighbour.connection,\n          local: myConnection,\n          radius: neighbour.radius,\n        };\n        radius = neighbour.radius;\n      }\n    }\n    return candidate;\n  }\n\n  /**\n   * Decide the radius at which to start searching for the closest connection.\n   *\n   * @returns The radius at which to start the search for the closest\n   *     connection.\n   */\n  private getStartRadius(): number {\n    // If there is already a connection highlighted,\n    // increase the radius we check for making new connections.\n    // When a connection is highlighted, blocks move around when the\n    // insertion marker is created, which could cause the connection became out\n    // of range. By increasing radiusConnection when a connection already\n    // exists, we never \"lose\" the connection from the offset.\n    return this.activeCandidate\n      ? config.connectingSnapRadius\n      : config.snapRadius;\n  }\n\n  /**\n   * Whether ending the drag would delete the block.\n   *\n   * @param newCandidate Whether there is a candidate connection that the\n   *     block could connect to if the drag ended immediately.\n   * @param dragTarget The drag target that the block is currently over.\n   * @returns Whether dropping the block immediately would delete the block.\n   */\n  private shouldDelete(\n    newCandidate: boolean,\n    dragTarget: IDragTarget | null\n  ): boolean {\n    if (dragTarget) {\n      const componentManager = this.workspace.getComponentManager();\n      const isDeleteArea = componentManager.hasCapability(\n        dragTarget.id,\n        ComponentManager.Capability.DELETE_AREA\n      );\n      if (isDeleteArea) {\n        return (dragTarget as IDeleteArea).wouldDelete(\n          this.topBlock,\n          newCandidate\n        );\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Show an insertion marker or replacement highlighting during a drag, if\n   * needed.\n   * At the beginning of this function, this.activeConnection should be null.\n   *\n   * @param newCandidate A new candidate connection that may replace the current\n   *     best candidate.\n   */\n  private maybeShowPreview(newCandidate: CandidateConnection | null) {\n    if (this.wouldDeleteBlock) return; // Nope, don't add a marker.\n    if (!newCandidate) return; // Nothing to connect to.\n\n    const closest = newCandidate.closest;\n\n    // Something went wrong and we're trying to connect to an invalid\n    // connection.\n    if (\n      closest === this.activeCandidate?.closest ||\n      closest.getSourceBlock().isInsertionMarker()\n    ) {\n      console.log('Trying to connect to an insertion marker');\n      return;\n    }\n    this.activeCandidate = newCandidate;\n    // Add an insertion marker or replacement marker.\n    this.showPreview(this.activeCandidate);\n  }\n\n  /**\n   * A preview should be shown.  This function figures out if it should be a\n   * block highlight or an insertion marker, and shows the appropriate one.\n   *\n   * @param activeCandidate The connection that will be made if the drag ends\n   *     immediately.\n   */\n  private showPreview(activeCandidate: CandidateConnection) {\n    const renderer = this.workspace.getRenderer();\n    const method = renderer.getConnectionPreviewMethod(\n      activeCandidate.closest,\n      activeCandidate.local,\n      this.topBlock\n    );\n\n    switch (method) {\n      case InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:\n        this.showInsertionInputOutline(activeCandidate);\n        break;\n      case InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:\n        this.showInsertionMarker(activeCandidate);\n        break;\n      case InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:\n        this.showReplacementFade(activeCandidate);\n        break;\n    }\n\n    // Optionally highlight the actual connection, as a nod to previous\n    // behaviour.\n    if (renderer.shouldHighlightConnection(activeCandidate.closest)) {\n      activeCandidate.closest.highlight();\n    }\n  }\n\n  /**\n   * Hide an insertion marker or replacement highlighting during a drag, if\n   * needed.\n   * At the end of this function, this.activeCandidate will be null.\n   *\n   * @param newCandidate A new candidate connection that may replace the current\n   *     best candidate.\n   */\n  private maybeHidePreview(newCandidate: CandidateConnection | null) {\n    // If there's no new preview, remove the old one but don't bother deleting\n    // it. We might need it later, and this saves disposing of it and recreating\n    // it.\n    if (!newCandidate) {\n      this.hidePreview();\n    } else {\n      if (this.activeCandidate) {\n        const closestChanged =\n          this.activeCandidate.closest !== newCandidate.closest;\n        const localChanged = this.activeCandidate.local !== newCandidate.local;\n\n        // If there's a new preview and there was a preview before, and either\n        // connection has changed, remove the old preview.\n        // Also hide if we had a preview before but now we're going to delete\n        // instead.\n        if (closestChanged || localChanged || this.wouldDeleteBlock) {\n          this.hidePreview();\n        }\n      }\n    }\n\n    // Either way, clear out old state.\n    this.markerConnection = null;\n    this.activeCandidate = null;\n  }\n\n  /**\n   * A preview should be hidden. Loop through all possible preview modes\n   * and hide everything.\n   */\n  private hidePreview() {\n    const closest = this.activeCandidate?.closest;\n    if (\n      closest &&\n      closest.targetBlock() &&\n      this.workspace.getRenderer().shouldHighlightConnection(closest)\n    ) {\n      closest.unhighlight();\n    }\n    this.hideReplacementFade();\n    this.hideInsertionInputOutline();\n    this.hideInsertionMarker();\n  }\n\n  /**\n   * Shows an insertion marker connected to the appropriate blocks (based on\n   * manager state).\n   *\n   * @param activeCandidate The connection that will be made if the drag ends\n   *     immediately.\n   */\n  private showInsertionMarker(activeCandidate: CandidateConnection) {\n    const {local, closest} = activeCandidate;\n\n    const isLastInStack = this.lastOnStack && local === this.lastOnStack;\n    let insertionMarker = isLastInStack ? this.lastMarker : this.firstMarker;\n    if (!insertionMarker) {\n      throw new Error(\n        'Cannot show the insertion marker because there is no insertion ' +\n          'marker block'\n      );\n    }\n    let imConn;\n    try {\n      imConn = insertionMarker.getMatchingConnection(\n        local.getSourceBlock(),\n        local\n      );\n    } catch (e) {\n      // It's possible that the number of connections on the local block has\n      // changed since the insertion marker was originally created.  Let's\n      // recreate the insertion marker and try again. In theory we could\n      // probably recreate the marker block (e.g. in getCandidate_), which is\n      // called more often during the drag, but creating a block that often\n      // might be too slow, so we only do it if necessary.\n      if (isLastInStack && this.lastOnStack) {\n        this.disposeInsertionMarker(this.lastMarker);\n        this.lastMarker = this.createMarkerBlock(\n          this.lastOnStack.getSourceBlock()\n        );\n        insertionMarker = this.lastMarker;\n      } else {\n        this.disposeInsertionMarker(this.firstMarker);\n        this.firstMarker = this.createMarkerBlock(this.topBlock);\n        insertionMarker = this.firstMarker;\n      }\n\n      if (!insertionMarker) {\n        throw new Error(\n          'Cannot show the insertion marker because there is no insertion ' +\n            'marker block'\n        );\n      }\n      imConn = insertionMarker.getMatchingConnection(\n        local.getSourceBlock(),\n        local\n      );\n    }\n\n    if (!imConn) {\n      throw new Error(\n        'Cannot show the insertion marker because there is no ' +\n          'associated connection'\n      );\n    }\n\n    if (imConn === this.markerConnection) {\n      throw new Error(\n        \"Made it to showInsertionMarker_ even though the marker isn't \" +\n          'changing'\n      );\n    }\n\n    // Render disconnected from everything else so that we have a valid\n    // connection location.\n    insertionMarker.render();\n    insertionMarker.rendered = true;\n    insertionMarker.getSvgRoot().setAttribute('visibility', 'visible');\n\n    if (imConn && closest) {\n      // Position so that the existing block doesn't move.\n      insertionMarker.positionNearConnection(imConn, closest);\n    }\n    if (closest) {\n      // Connect() also renders the insertion marker.\n      imConn.connect(closest);\n    }\n\n    this.markerConnection = imConn;\n  }\n\n  /**\n   * Disconnects and hides the current insertion marker. Should return the\n   * blocks to their original state.\n   */\n  private hideInsertionMarker() {\n    if (!this.markerConnection) return;\n\n    const markerConn = this.markerConnection;\n    const imBlock = markerConn.getSourceBlock();\n    const markerPrev = imBlock.previousConnection;\n    const markerOutput = imBlock.outputConnection;\n\n    if (!markerPrev?.targetConnection && !markerOutput?.targetConnection) {\n      // If we are the top block, unplugging doesn't do anything.\n      // The marker connection may not have a target block if we are hiding\n      // as part of applying connections.\n      markerConn.targetBlock()?.unplug(false);\n    } else {\n      imBlock.unplug(true);\n    }\n\n    if (markerConn.targetConnection) {\n      throw Error(\n        'markerConnection still connected at the end of ' +\n          'disconnectInsertionMarker'\n      );\n    }\n\n    this.markerConnection = null;\n    const svg = imBlock.getSvgRoot();\n    if (svg) {\n      svg.setAttribute('visibility', 'hidden');\n    }\n  }\n\n  /**\n   * Shows an outline around the input the closest connection belongs to.\n   *\n   * @param activeCandidate The connection that will be made if the drag ends\n   *     immediately.\n   */\n  private showInsertionInputOutline(activeCandidate: CandidateConnection) {\n    const closest = activeCandidate.closest;\n    this.highlightedBlock = closest.getSourceBlock();\n    this.highlightedBlock.highlightShapeForInput(closest, true);\n  }\n\n  /** Hides any visible input outlines. */\n  private hideInsertionInputOutline() {\n    if (!this.highlightedBlock) return;\n\n    if (!this.activeCandidate) {\n      throw new Error(\n        'Cannot hide the insertion marker outline because ' +\n          'there is no active candidate'\n      );\n    }\n    this.highlightedBlock.highlightShapeForInput(\n      this.activeCandidate.closest,\n      false\n    );\n    this.highlightedBlock = null;\n  }\n\n  /**\n   * Shows a replacement fade affect on the closest connection's target block\n   * (the block that is currently connected to it).\n   *\n   * @param activeCandidate The connection that will be made if the drag ends\n   *     immediately.\n   */\n  private showReplacementFade(activeCandidate: CandidateConnection) {\n    this.fadedBlock = activeCandidate.closest.targetBlock();\n    if (!this.fadedBlock) {\n      throw new Error(\n        'Cannot show the replacement fade because the ' +\n          'closest connection does not have a target block'\n      );\n    }\n    this.fadedBlock.fadeForReplacement(true);\n  }\n\n  /**\n   * Hides/Removes any visible fade affects.\n   */\n  private hideReplacementFade() {\n    if (!this.fadedBlock) return;\n\n    this.fadedBlock.fadeForReplacement(false);\n    this.fadedBlock = null;\n  }\n\n  /**\n   * Get a list of the insertion markers that currently exist.  Drags have 0, 1,\n   * or 2 insertion markers.\n   *\n   * @returns A possibly empty list of insertion marker blocks.\n   * @internal\n   */\n  getInsertionMarkers(): BlockSvg[] {\n    const result = [];\n    if (this.firstMarker) {\n      result.push(this.firstMarker);\n    }\n    if (this.lastMarker) {\n      result.push(this.lastMarker);\n    }\n    return result;\n  }\n\n  /**\n   * Safely disposes of an insertion marker.\n   */\n  private disposeInsertionMarker(marker: BlockSvg | null) {\n    if (marker) {\n      eventUtils.disable();\n      try {\n        marker.dispose();\n      } finally {\n        eventUtils.enable();\n      }\n    }\n  }\n}\n\nexport namespace InsertionMarkerManager {\n  /**\n   * An enum describing different kinds of previews the InsertionMarkerManager\n   * could display.\n   */\n  export enum PREVIEW_TYPE {\n    INSERTION_MARKER = 0,\n    INPUT_OUTLINE = 1,\n    REPLACEMENT_FADE = 2,\n  }\n}\n\nexport type PreviewType = InsertionMarkerManager.PREVIEW_TYPE;\nexport const PreviewType = InsertionMarkerManager.PREVIEW_TYPE;\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Registry for context menu option items.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ContextMenuRegistry');\n\nimport type {BlockSvg} from './block_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for the registry of context menu items. This is intended to be a\n * singleton. You should not create a new instance, and only access this class\n * from ContextMenuRegistry.registry.\n */\nexport class ContextMenuRegistry {\n  static registry: ContextMenuRegistry;\n  /** Registry of all registered RegistryItems, keyed by ID. */\n  private registry_ = new Map<string, RegistryItem>();\n\n  /** Resets the existing singleton instance of ContextMenuRegistry. */\n  constructor() {\n    this.reset();\n  }\n\n  /** Clear and recreate the registry. */\n  reset() {\n    this.registry_.clear();\n  }\n\n  /**\n   * Registers a RegistryItem.\n   *\n   * @param item Context menu item to register.\n   * @throws {Error} if an item with the given ID already exists.\n   */\n  register(item: RegistryItem) {\n    if (this.registry_.has(item.id)) {\n      throw Error('Menu item with ID \"' + item.id + '\" is already registered.');\n    }\n    this.registry_.set(item.id, item);\n  }\n\n  /**\n   * Unregisters a RegistryItem with the given ID.\n   *\n   * @param id The ID of the RegistryItem to remove.\n   * @throws {Error} if an item with the given ID does not exist.\n   */\n  unregister(id: string) {\n    if (!this.registry_.has(id)) {\n      throw new Error('Menu item with ID \"' + id + '\" not found.');\n    }\n    this.registry_.delete(id);\n  }\n\n  /**\n   * @param id The ID of the RegistryItem to get.\n   * @returns RegistryItem or null if not found\n   */\n  getItem(id: string): RegistryItem | null {\n    return this.registry_.get(id) ?? null;\n  }\n\n  /**\n   * Gets the valid context menu options for the given scope type (e.g. block or\n   * workspace) and scope. Blocks are only shown if the preconditionFn shows\n   * they should not be hidden.\n   *\n   * @param scopeType Type of scope where menu should be shown (e.g. on a block\n   *     or on a workspace)\n   * @param scope Current scope of context menu (i.e., the exact workspace or\n   *     block being clicked on)\n   * @returns the list of ContextMenuOptions\n   */\n  getContextMenuOptions(\n    scopeType: ScopeType,\n    scope: Scope\n  ): ContextMenuOption[] {\n    const menuOptions: ContextMenuOption[] = [];\n    for (const item of this.registry_.values()) {\n      if (scopeType === item.scopeType) {\n        const precondition = item.preconditionFn(scope);\n        if (precondition !== 'hidden') {\n          const displayText =\n            typeof item.displayText === 'function'\n              ? item.displayText(scope)\n              : item.displayText;\n          const menuOption: ContextMenuOption = {\n            text: displayText,\n            enabled: precondition === 'enabled',\n            callback: item.callback,\n            scope,\n            weight: item.weight,\n          };\n          menuOptions.push(menuOption);\n        }\n      }\n    }\n    menuOptions.sort(function (a, b) {\n      return a.weight - b.weight;\n    });\n    return menuOptions;\n  }\n}\n\nexport namespace ContextMenuRegistry {\n  /**\n   * Where this menu item should be rendered. If the menu item should be\n   * rendered in multiple scopes, e.g. on both a block and a workspace, it\n   * should be registered for each scope.\n   */\n  export enum ScopeType {\n    BLOCK = 'block',\n    WORKSPACE = 'workspace',\n  }\n\n  /**\n   * The actual workspace/block where the menu is being rendered. This is passed\n   * to callback and displayText functions that depend on this information.\n   */\n  export interface Scope {\n    block?: BlockSvg;\n    workspace?: WorkspaceSvg;\n  }\n\n  /**\n   * A menu item as entered in the registry.\n   */\n  export interface RegistryItem {\n    callback: (p1: Scope) => void;\n    scopeType: ScopeType;\n    displayText: ((p1: Scope) => string) | string;\n    preconditionFn: (p1: Scope) => string;\n    weight: number;\n    id: string;\n  }\n\n  /**\n   * A menu item as presented to contextmenu.js.\n   */\n  export interface ContextMenuOption {\n    text: string;\n    enabled: boolean;\n    callback: (p1: Scope) => void;\n    scope: Scope;\n    weight: number;\n  }\n\n  /**\n   * A subset of ContextMenuOption corresponding to what was publicly\n   * documented.  ContextMenuOption should be preferred for new code.\n   */\n  export interface LegacyContextMenuOption {\n    text: string;\n    enabled: boolean;\n    callback: (p1: Scope) => void;\n  }\n\n  /**\n   * Singleton instance of this class. All interactions with this class should\n   * be done on this object.\n   */\n  ContextMenuRegistry.registry = new ContextMenuRegistry();\n}\n\nexport type ScopeType = ContextMenuRegistry.ScopeType;\nexport const ScopeType = ContextMenuRegistry.ScopeType;\nexport type Scope = ContextMenuRegistry.Scope;\nexport type RegistryItem = ContextMenuRegistry.RegistryItem;\nexport type ContextMenuOption = ContextMenuRegistry.ContextMenuOption;\nexport type LegacyContextMenuOption =\n  ContextMenuRegistry.LegacyContextMenuOption;\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.internalConstants');\n\nimport {ConnectionType} from './connection_type.js';\n\n/**\n * Number of characters to truncate a collapsed block to.\n *\n * @internal\n */\nexport const COLLAPSE_CHARS = 30;\n\n/**\n * When dragging a block out of a stack, split the stack in two (true), or drag\n * out the block healing the stack (false).\n *\n * @internal\n */\nexport const DRAG_STACK = true;\n\n/**\n * Lookup table for determining the opposite type of a connection.\n *\n * @internal\n */\nexport const OPPOSITE_TYPE: number[] = [];\nOPPOSITE_TYPE[ConnectionType.INPUT_VALUE] = ConnectionType.OUTPUT_VALUE;\nOPPOSITE_TYPE[ConnectionType.OUTPUT_VALUE] = ConnectionType.INPUT_VALUE;\nOPPOSITE_TYPE[ConnectionType.NEXT_STATEMENT] =\n  ConnectionType.PREVIOUS_STATEMENT;\nOPPOSITE_TYPE[ConnectionType.PREVIOUS_STATEMENT] =\n  ConnectionType.NEXT_STATEMENT;\n\n/**\n * String for use in the dropdown created in field_variable.\n * This string indicates that this option in the dropdown is 'Rename\n * variable...' and if selected, should trigger the prompt to rename a variable.\n *\n * @internal\n */\nexport const RENAME_VARIABLE_ID = 'RENAME_VARIABLE_ID';\n\n/**\n * String for use in the dropdown created in field_variable.\n * This string indicates that this option in the dropdown is 'Delete the \"%1\"\n * variable' and if selected, should trigger the prompt to delete a variable.\n *\n * @internal\n */\nexport const DELETE_VARIABLE_ID = 'DELETE_VARIABLE_ID';\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a marker.\n * Used primarily for keyboard navigation to show a marked location.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Marker');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {MarkerSvg} from '../renderers/common/marker_svg.js';\n\nimport type {ASTNode} from './ast_node.js';\n\n/**\n * Class for a marker.\n * This is used in keyboard navigation to save a location in the Blockly AST.\n */\nexport class Marker {\n  /** The colour of the marker. */\n  colour: string | null = null;\n\n  /** The current location of the marker. */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'ASTNode'.\n  private curNode: ASTNode = null as AnyDuringMigration;\n\n  /**\n   * The object in charge of drawing the visual representation of the current\n   * node.\n   */\n  // AnyDuringMigration because:  Type 'null' is not assignable to type\n  // 'MarkerSvg'.\n  private drawer: MarkerSvg = null as AnyDuringMigration;\n\n  /** The type of the marker. */\n  type = 'marker';\n\n  /** Constructs a new Marker instance. */\n  constructor() {}\n\n  /**\n   * Sets the object in charge of drawing the marker.\n   *\n   * @param drawer The object in charge of drawing the marker.\n   */\n  setDrawer(drawer: MarkerSvg) {\n    this.drawer = drawer;\n  }\n\n  /**\n   * Get the current drawer for the marker.\n   *\n   * @returns The object in charge of drawing the marker.\n   */\n  getDrawer(): MarkerSvg {\n    return this.drawer;\n  }\n\n  /**\n   * Gets the current location of the marker.\n   *\n   * @returns The current field, connection, or block the marker is on.\n   */\n  getCurNode(): ASTNode {\n    return this.curNode;\n  }\n\n  /**\n   * Set the location of the marker and call the update method.\n   * Setting isStack to true will only work if the newLocation is the top most\n   * output or previous connection on a stack.\n   *\n   * @param newNode The new location of the marker.\n   */\n  setCurNode(newNode: ASTNode) {\n    const oldNode = this.curNode;\n    this.curNode = newNode;\n    if (this.drawer) {\n      this.drawer.draw(oldNode, this.curNode);\n    }\n  }\n\n  /**\n   * Redraw the current marker.\n   *\n   * @internal\n   */\n  draw() {\n    if (this.drawer) {\n      this.drawer.draw(this.curNode, this.curNode);\n    }\n  }\n\n  /** Hide the marker SVG. */\n  hide() {\n    if (this.drawer) {\n      this.drawer.hide();\n    }\n  }\n\n  /** Dispose of this marker. */\n  dispose() {\n    if (this.getDrawer()) {\n      this.getDrawer().dispose();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a cursor.\n * Used primarily for keyboard navigation.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Cursor');\n\nimport * as registry from '../registry.js';\n\nimport {ASTNode} from './ast_node.js';\nimport {Marker} from './marker.js';\n\n/**\n * Class for a cursor.\n * A cursor controls how a user navigates the Blockly AST.\n */\nexport class Cursor extends Marker {\n  override type = 'cursor';\n\n  constructor() {\n    super();\n  }\n\n  /**\n   * Find the next connection, field, or block.\n   *\n   * @returns The next element, or null if the current node is not set or there\n   *     is no next value.\n   */\n  next(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n\n    let newNode = curNode.next();\n    while (\n      newNode &&\n      newNode.next() &&\n      (newNode.getType() === ASTNode.types.NEXT ||\n        newNode.getType() === ASTNode.types.BLOCK)\n    ) {\n      newNode = newNode.next();\n    }\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * Find the in connection or field.\n   *\n   * @returns The in element, or null if the current node is not set or there is\n   *     no in value.\n   */\n  in(): ASTNode | null {\n    let curNode: ASTNode | null = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    // If we are on a previous or output connection, go to the block level\n    // before performing next operation.\n    if (\n      curNode.getType() === ASTNode.types.PREVIOUS ||\n      curNode.getType() === ASTNode.types.OUTPUT\n    ) {\n      curNode = curNode.next();\n    }\n    const newNode = curNode?.in() ?? null;\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * Find the previous connection, field, or block.\n   *\n   * @returns The previous element, or null if the current node is not set or\n   *     there is no previous value.\n   */\n  prev(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    let newNode = curNode.prev();\n\n    while (\n      newNode &&\n      newNode.prev() &&\n      (newNode.getType() === ASTNode.types.NEXT ||\n        newNode.getType() === ASTNode.types.BLOCK)\n    ) {\n      newNode = newNode.prev();\n    }\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * Find the out connection, field, or block.\n   *\n   * @returns The out element, or null if the current node is not set or there\n   *     is no out value.\n   */\n  out(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    let newNode = curNode.out();\n\n    if (newNode && newNode.getType() === ASTNode.types.BLOCK) {\n      newNode = newNode.prev() || newNode;\n    }\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n}\n\nregistry.register(registry.Type.CURSOR, registry.DEFAULT, Cursor);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a basic cursor.\n * Used to demo switching between different cursors.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.BasicCursor');\n\nimport * as registry from '../registry.js';\n\nimport {ASTNode} from './ast_node.js';\nimport {Cursor} from './cursor.js';\n\n/**\n * Class for a basic cursor.\n * This will allow the user to get to all nodes in the AST by hitting next or\n * previous.\n */\nexport class BasicCursor extends Cursor {\n  /** Name used for registering a basic cursor. */\n  static readonly registrationName = 'basicCursor';\n\n  constructor() {\n    super();\n  }\n\n  /**\n   * Find the next node in the pre order traversal.\n   *\n   * @returns The next node, or null if the current node is not set or there is\n   *     no next value.\n   */\n  override next(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    const newNode = this.getNextNode_(curNode, this.validNode_);\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * For a basic cursor we only have the ability to go next and previous, so\n   * in will also allow the user to get to the next node in the pre order\n   * traversal.\n   *\n   * @returns The next node, or null if the current node is not set or there is\n   *     no next value.\n   */\n  override in(): ASTNode | null {\n    return this.next();\n  }\n\n  /**\n   * Find the previous node in the pre order traversal.\n   *\n   * @returns The previous node, or null if the current node is not set or there\n   *     is no previous value.\n   */\n  override prev(): ASTNode | null {\n    const curNode = this.getCurNode();\n    if (!curNode) {\n      return null;\n    }\n    const newNode = this.getPreviousNode_(curNode, this.validNode_);\n\n    if (newNode) {\n      this.setCurNode(newNode);\n    }\n    return newNode;\n  }\n\n  /**\n   * For a basic cursor we only have the ability to go next and previous, so\n   * out will allow the user to get to the previous node in the pre order\n   * traversal.\n   *\n   * @returns The previous node, or null if the current node is not set or there\n   *     is no previous value.\n   */\n  override out(): ASTNode | null {\n    return this.prev();\n  }\n\n  /**\n   * Uses pre order traversal to navigate the Blockly AST. This will allow\n   * a user to easily navigate the entire Blockly AST without having to go in\n   * and out levels on the tree.\n   *\n   * @param node The current position in the AST.\n   * @param isValid A function true/false depending on whether the given node\n   *     should be traversed.\n   * @returns The next node in the traversal.\n   */\n  protected getNextNode_(\n    node: ASTNode | null,\n    isValid: (p1: ASTNode | null) => boolean\n  ): ASTNode | null {\n    if (!node) {\n      return null;\n    }\n    const newNode = node.in() || node.next();\n    if (isValid(newNode)) {\n      return newNode;\n    } else if (newNode) {\n      return this.getNextNode_(newNode, isValid);\n    }\n    const siblingOrParent = this.findSiblingOrParent(node.out());\n    if (isValid(siblingOrParent)) {\n      return siblingOrParent;\n    } else if (siblingOrParent) {\n      return this.getNextNode_(siblingOrParent, isValid);\n    }\n    return null;\n  }\n\n  /**\n   * Reverses the pre order traversal in order to find the previous node. This\n   * will allow a user to easily navigate the entire Blockly AST without having\n   * to go in and out levels on the tree.\n   *\n   * @param node The current position in the AST.\n   * @param isValid A function true/false depending on whether the given node\n   *     should be traversed.\n   * @returns The previous node in the traversal or null if no previous node\n   *     exists.\n   */\n  protected getPreviousNode_(\n    node: ASTNode | null,\n    isValid: (p1: ASTNode | null) => boolean\n  ): ASTNode | null {\n    if (!node) {\n      return null;\n    }\n    let newNode: ASTNode | null = node.prev();\n\n    if (newNode) {\n      newNode = this.getRightMostChild(newNode);\n    } else {\n      newNode = node.out();\n    }\n    if (isValid(newNode)) {\n      return newNode;\n    } else if (newNode) {\n      return this.getPreviousNode_(newNode, isValid);\n    }\n    return null;\n  }\n\n  /**\n   * Decides what nodes to traverse and which ones to skip. Currently, it\n   * skips output, stack and workspace nodes.\n   *\n   * @param node The AST node to check whether it is valid.\n   * @returns True if the node should be visited, false otherwise.\n   */\n  protected validNode_(node: ASTNode | null): boolean {\n    let isValid = false;\n    const type = node && node.getType();\n    if (\n      type === ASTNode.types.OUTPUT ||\n      type === ASTNode.types.INPUT ||\n      type === ASTNode.types.FIELD ||\n      type === ASTNode.types.NEXT ||\n      type === ASTNode.types.PREVIOUS ||\n      type === ASTNode.types.WORKSPACE\n    ) {\n      isValid = true;\n    }\n    return isValid;\n  }\n\n  /**\n   * From the given node find either the next valid sibling or parent.\n   *\n   * @param node The current position in the AST.\n   * @returns The parent AST node or null if there are no valid parents.\n   */\n  private findSiblingOrParent(node: ASTNode | null): ASTNode | null {\n    if (!node) {\n      return null;\n    }\n    const nextNode = node.next();\n    if (nextNode) {\n      return nextNode;\n    }\n    return this.findSiblingOrParent(node.out());\n  }\n\n  /**\n   * Get the right most child of a node.\n   *\n   * @param node The node to find the right most child of.\n   * @returns The right most child of the given node, or the node if no child\n   *     exists.\n   */\n  private getRightMostChild(node: ASTNode | null): ASTNode | null {\n    if (!node!.in()) {\n      return node;\n    }\n    let newNode = node!.in();\n    while (newNode && newNode.next()) {\n      newNode = newNode.next();\n    }\n    return this.getRightMostChild(newNode);\n  }\n}\n\nregistry.register(\n  registry.Type.CURSOR,\n  BasicCursor.registrationName,\n  BasicCursor\n);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing a cursor that is used to navigate\n * between tab navigable fields.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.TabNavigateCursor');\n\nimport type {Field} from '../field.js';\n\nimport {ASTNode} from './ast_node.js';\nimport {BasicCursor} from './basic_cursor.js';\n\n/**\n * A cursor for navigating between tab navigable fields.\n */\nexport class TabNavigateCursor extends BasicCursor {\n  /**\n   * Skip all nodes except for tab navigable fields.\n   *\n   * @param node The AST node to check whether it is valid.\n   * @returns True if the node should be visited, false otherwise.\n   */\n  override validNode_(node: ASTNode | null): boolean {\n    let isValid = false;\n    const type = node && node.getType();\n    if (node) {\n      const location = node.getLocation() as Field;\n      if (\n        type === ASTNode.types.FIELD &&\n        location &&\n        location.isTabNavigable() &&\n        location.isClickable()\n      ) {\n        isValid = true;\n      }\n    }\n    return isValid;\n  }\n}\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Components for creating connections between blocks.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.RenderedConnection');\n\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as common from './common.js';\nimport {config} from './config.js';\nimport {Connection} from './connection.js';\nimport type {ConnectionDB} from './connection_db.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as eventUtils from './events/utils.js';\nimport {hasBubble} from './interfaces/i_has_bubble.js';\nimport * as internalConstants from './internal_constants.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport * as svgPaths from './utils/svg_paths.js';\n\n/** A shape that has a pathDown property. */\ninterface PathDownShape {\n  pathDown: string;\n}\n\n/** A shape that has a pathLeft property. */\ninterface PathLeftShape {\n  pathLeft: string;\n}\n\n/** Maximum randomness in workspace units for bumping a block. */\nconst BUMP_RANDOMNESS = 10;\n\n/**\n * Class for a connection between blocks that may be rendered on screen.\n */\nexport class RenderedConnection extends Connection {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  sourceBlock_!: BlockSvg;\n  private readonly db: ConnectionDB;\n  private readonly dbOpposite: ConnectionDB;\n  private readonly offsetInBlock: Coordinate;\n  private trackedState: TrackedState;\n  private highlightPath: SVGPathElement | null = null;\n\n  /** Connection this connection connects to.  Null if not connected. */\n  override targetConnection: RenderedConnection | null = null;\n\n  /**\n   * @param source The block establishing this connection.\n   * @param type The type of the connection.\n   */\n  constructor(source: BlockSvg, type: number) {\n    super(source, type);\n\n    /**\n     * Connection database for connections of this type on the current\n     * workspace.\n     */\n    this.db = source.workspace.connectionDBList[type];\n\n    /**\n     * Connection database for connections compatible with this type on the\n     * current workspace.\n     */\n    this.dbOpposite =\n      source.workspace.connectionDBList[internalConstants.OPPOSITE_TYPE[type]];\n\n    /** Workspace units, (0, 0) is top left of block. */\n    this.offsetInBlock = new Coordinate(0, 0);\n\n    /** Describes the state of this connection's tracked-ness. */\n    this.trackedState = RenderedConnection.TrackedState.WILL_TRACK;\n  }\n\n  /**\n   * Dispose of this connection. Remove it from the database (if it is\n   * tracked) and call the super-function to deal with connected blocks.\n   *\n   * @internal\n   */\n  override dispose() {\n    super.dispose();\n    if (this.trackedState === RenderedConnection.TrackedState.TRACKED) {\n      this.db.removeConnection(this, this.y);\n    }\n  }\n\n  /**\n   * Get the source block for this connection.\n   *\n   * @returns The source block.\n   */\n  override getSourceBlock(): BlockSvg {\n    return super.getSourceBlock() as BlockSvg;\n  }\n\n  /**\n   * Returns the block that this connection connects to.\n   *\n   * @returns The connected block or null if none is connected.\n   */\n  override targetBlock(): BlockSvg | null {\n    return super.targetBlock() as BlockSvg;\n  }\n\n  /**\n   * Returns the distance between this connection and another connection in\n   * workspace units.\n   *\n   * @param otherConnection The other connection to measure the distance to.\n   * @returns The distance between connections, in workspace units.\n   */\n  distanceFrom(otherConnection: Connection): number {\n    const xDiff = this.x - otherConnection.x;\n    const yDiff = this.y - otherConnection.y;\n    return Math.sqrt(xDiff * xDiff + yDiff * yDiff);\n  }\n\n  /**\n   * Move the block(s) belonging to the connection to a point where they don't\n   * visually interfere with the specified connection.\n   *\n   * @param staticConnection The connection to move away from.\n   * @internal\n   */\n  bumpAwayFrom(staticConnection: RenderedConnection) {\n    if (this.sourceBlock_.workspace.isDragging()) {\n      // Don't move blocks around while the user is doing the same.\n      return;\n    }\n    // Move the root block.\n    let rootBlock = this.sourceBlock_.getRootBlock();\n    if (rootBlock.isInFlyout) {\n      // Don't move blocks around in a flyout.\n      return;\n    }\n    let reverse = false;\n    if (!rootBlock.isMovable()) {\n      // Can't bump an uneditable block away.\n      // Check to see if the other block is movable.\n      rootBlock = staticConnection.getSourceBlock().getRootBlock();\n      if (!rootBlock.isMovable()) {\n        return;\n      }\n      // Swap the connections and move the 'static' connection instead.\n      /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n      staticConnection = this;\n      reverse = true;\n    }\n    // Raise it to the top for extra visibility.\n    const selected = common.getSelected() == rootBlock;\n    selected || rootBlock.addSelect();\n    let dx =\n      staticConnection.x +\n      config.snapRadius +\n      Math.floor(Math.random() * BUMP_RANDOMNESS) -\n      this.x;\n    let dy =\n      staticConnection.y +\n      config.snapRadius +\n      Math.floor(Math.random() * BUMP_RANDOMNESS) -\n      this.y;\n    if (reverse) {\n      // When reversing a bump due to an uneditable block, bump up.\n      dy = -dy;\n    }\n    if (rootBlock.RTL) {\n      dx =\n        staticConnection.x -\n        config.snapRadius -\n        Math.floor(Math.random() * BUMP_RANDOMNESS) -\n        this.x;\n    }\n    rootBlock.moveBy(dx, dy, ['bump']);\n    selected || rootBlock.removeSelect();\n  }\n\n  /**\n   * Change the connection's coordinates.\n   *\n   * @param x New absolute x coordinate, in workspace coordinates.\n   * @param y New absolute y coordinate, in workspace coordinates.\n   * @returns True if the position of the connection in the connection db\n   *     was updated.\n   */\n  moveTo(x: number, y: number): boolean {\n    // TODO(#6922): Readd this optimization.\n    // const moved = this.x !== x || this.y !== y;\n    const moved = true;\n    let updated = false;\n\n    if (this.trackedState === RenderedConnection.TrackedState.WILL_TRACK) {\n      this.db.addConnection(this, y);\n      this.trackedState = RenderedConnection.TrackedState.TRACKED;\n      updated = true;\n    } else if (\n      this.trackedState === RenderedConnection.TrackedState.TRACKED &&\n      moved\n    ) {\n      this.db.removeConnection(this, this.y);\n      this.db.addConnection(this, y);\n      updated = true;\n    }\n\n    this.x = x;\n    this.y = y;\n\n    return updated;\n  }\n\n  /**\n   * Change the connection's coordinates.\n   *\n   * @param dx Change to x coordinate, in workspace units.\n   * @param dy Change to y coordinate, in workspace units.\n   * @returns True if the position of the connection in the connection db\n   *     was updated.\n   */\n  moveBy(dx: number, dy: number): boolean {\n    return this.moveTo(this.x + dx, this.y + dy);\n  }\n\n  /**\n   * Move this connection to the location given by its offset within the block\n   * and the location of the block's top left corner.\n   *\n   * @param blockTL The location of the top left corner of the block, in\n   *     workspace coordinates.\n   * @returns True if the position of the connection in the connection db\n   *     was updated.\n   */\n  moveToOffset(blockTL: Coordinate): boolean {\n    return this.moveTo(\n      blockTL.x + this.offsetInBlock.x,\n      blockTL.y + this.offsetInBlock.y\n    );\n  }\n\n  /**\n   * Set the offset of this connection relative to the top left of its block.\n   *\n   * @param x The new relative x, in workspace units.\n   * @param y The new relative y, in workspace units.\n   */\n  setOffsetInBlock(x: number, y: number) {\n    this.offsetInBlock.x = x;\n    this.offsetInBlock.y = y;\n  }\n\n  /**\n   * Get the offset of this connection relative to the top left of its block.\n   *\n   * @returns The offset of the connection.\n   * @internal\n   */\n  getOffsetInBlock(): Coordinate {\n    return this.offsetInBlock;\n  }\n\n  /**\n   * Move the blocks on either side of this connection right next to each other.\n   *\n   * @internal\n   */\n  tighten() {\n    const dx = this.targetConnection!.x - this.x;\n    const dy = this.targetConnection!.y - this.y;\n    if (dx !== 0 || dy !== 0) {\n      const block = this.targetBlock();\n      const svgRoot = block!.getSvgRoot();\n      if (!svgRoot) {\n        throw Error('block is not rendered.');\n      }\n      // Workspace coordinates.\n      const xy = svgMath.getRelativeXY(svgRoot);\n      block!.translate(xy.x - dx, xy.y - dy);\n      block!.moveConnections(-dx, -dy);\n    }\n  }\n\n  /**\n   * Moves the blocks on either side of this connection right next to\n   * each other, based on their local offsets, not global positions.\n   *\n   * @internal\n   */\n  tightenEfficiently() {\n    const target = this.targetConnection;\n    const block = this.targetBlock();\n    if (!target || !block) return;\n    const offset = Coordinate.difference(\n      this.offsetInBlock,\n      target.offsetInBlock\n    );\n    block.translate(offset.x, offset.y);\n  }\n\n  /**\n   * Find the closest compatible connection to this connection.\n   * All parameters are in workspace units.\n   *\n   * @param maxLimit The maximum radius to another connection.\n   * @param dxy Offset between this connection's location in the database and\n   *     the current location (as a result of dragging).\n   * @returns Contains two properties: 'connection' which is either another\n   *     connection or null, and 'radius' which is the distance.\n   */\n  closest(\n    maxLimit: number,\n    dxy: Coordinate\n  ): {connection: RenderedConnection | null; radius: number} {\n    return this.dbOpposite.searchForClosest(this, maxLimit, dxy);\n  }\n\n  /** Add highlighting around this connection. */\n  highlight() {\n    if (this.highlightPath) {\n      // This connection is already highlighted\n      return;\n    }\n    let steps;\n    const sourceBlockSvg = this.sourceBlock_;\n    const renderConstants = sourceBlockSvg.workspace\n      .getRenderer()\n      .getConstants();\n    const shape = renderConstants.shapeFor(this);\n    if (\n      this.type === ConnectionType.INPUT_VALUE ||\n      this.type === ConnectionType.OUTPUT_VALUE\n    ) {\n      // Vertical line, puzzle tab, vertical line.\n      const yLen = renderConstants.TAB_OFFSET_FROM_TOP;\n      steps =\n        svgPaths.moveBy(0, -yLen) +\n        svgPaths.lineOnAxis('v', yLen) +\n        (shape as unknown as PathDownShape).pathDown +\n        svgPaths.lineOnAxis('v', yLen);\n    } else {\n      const xLen =\n        renderConstants.NOTCH_OFFSET_LEFT - renderConstants.CORNER_RADIUS;\n      // Horizontal line, notch, horizontal line.\n      steps =\n        svgPaths.moveBy(-xLen, 0) +\n        svgPaths.lineOnAxis('h', xLen) +\n        (shape as unknown as PathLeftShape).pathLeft +\n        svgPaths.lineOnAxis('h', xLen);\n    }\n    const offset = this.offsetInBlock;\n    this.highlightPath = dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyHighlightedConnectionPath',\n        'd': steps,\n        'transform':\n          `translate(${offset.x}, ${offset.y})` +\n          (this.sourceBlock_.RTL ? ' scale(-1 1)' : ''),\n      },\n      this.sourceBlock_.getSvgRoot()\n    );\n  }\n\n  /** Remove the highlighting around this connection. */\n  unhighlight() {\n    if (this.highlightPath) {\n      dom.removeNode(this.highlightPath);\n      this.highlightPath = null;\n    }\n  }\n\n  /**\n   * Set whether this connections is tracked in the database or not.\n   *\n   * @param doTracking If true, start tracking. If false, stop tracking.\n   * @internal\n   */\n  setTracking(doTracking: boolean) {\n    if (\n      (doTracking &&\n        this.trackedState === RenderedConnection.TrackedState.TRACKED) ||\n      (!doTracking &&\n        this.trackedState === RenderedConnection.TrackedState.UNTRACKED)\n    ) {\n      return;\n    }\n    if (this.sourceBlock_.isInFlyout) {\n      // Don't bother maintaining a database of connections in a flyout.\n      return;\n    }\n    if (doTracking) {\n      this.db.addConnection(this, this.y);\n      this.trackedState = RenderedConnection.TrackedState.TRACKED;\n      return;\n    }\n    if (this.trackedState === RenderedConnection.TrackedState.TRACKED) {\n      this.db.removeConnection(this, this.y);\n    }\n    this.trackedState = RenderedConnection.TrackedState.UNTRACKED;\n  }\n\n  /**\n   * Stop tracking this connection, as well as all down-stream connections on\n   * any block attached to this connection. This happens when a block is\n   * collapsed.\n   *\n   * Also closes down-stream icons/bubbles.\n   *\n   * @internal\n   */\n  stopTrackingAll() {\n    this.setTracking(false);\n    if (this.targetConnection) {\n      const blocks = this.targetBlock()!.getDescendants(false);\n      for (let i = 0; i < blocks.length; i++) {\n        const block = blocks[i];\n        // Stop tracking connections of all children.\n        const connections = block.getConnections_(true);\n        for (let j = 0; j < connections.length; j++) {\n          connections[j].setTracking(false);\n        }\n        // Close all bubbles of all children.\n        for (const icon of block.getIcons()) {\n          if (hasBubble(icon)) icon.setBubbleVisible(false);\n        }\n      }\n    }\n  }\n\n  /**\n   * Start tracking this connection, as well as all down-stream connections on\n   * any block attached to this connection. This happens when a block is\n   * expanded.\n   *\n   * @returns List of blocks to render.\n   */\n  startTrackingAll(): Block[] {\n    this.setTracking(true);\n    // All blocks that are not tracked must start tracking before any\n    // rendering takes place, since rendering requires knowing the dimensions\n    // of lower blocks. Also, since rendering a block renders all its parents,\n    // we only need to render the leaf nodes.\n    let renderList: Block[] = [];\n    if (\n      this.type !== ConnectionType.INPUT_VALUE &&\n      this.type !== ConnectionType.NEXT_STATEMENT\n    ) {\n      // Only spider down.\n      return renderList;\n    }\n    const block = this.targetBlock();\n    if (block) {\n      let connections;\n      if (block.isCollapsed()) {\n        // This block should only be partially revealed since it is collapsed.\n        connections = [];\n        block.outputConnection && connections.push(block.outputConnection);\n        block.nextConnection && connections.push(block.nextConnection);\n        block.previousConnection && connections.push(block.previousConnection);\n      } else {\n        // Show all connections of this block.\n        connections = block.getConnections_(true);\n      }\n      for (let i = 0; i < connections.length; i++) {\n        renderList.push(...connections[i].startTrackingAll());\n      }\n      if (!renderList.length) {\n        // Leaf block.\n        renderList = [block];\n      }\n    }\n    return renderList;\n  }\n\n  /**\n   * Behaviour after a connection attempt fails.\n   * Bumps this connection away from the other connection. Called when an\n   * attempted connection fails.\n   *\n   * @param otherConnection Connection that this connection failed to connect\n   *     to.\n   * @internal\n   */\n  override onFailedConnect(otherConnection: Connection) {\n    const block = this.getSourceBlock();\n    if (eventUtils.getRecordUndo()) {\n      const group = eventUtils.getGroup();\n      setTimeout(\n        function (this: RenderedConnection) {\n          if (!block.isDisposed() && !block.getParent()) {\n            eventUtils.setGroup(group);\n            this.bumpAwayFrom(otherConnection as RenderedConnection);\n            eventUtils.setGroup(false);\n          }\n        }.bind(this),\n        config.bumpDelay\n      );\n    }\n  }\n\n  /**\n   * Disconnect two blocks that are connected by this connection.\n   *\n   * @param setParent Whether to set the parent of the disconnected block or\n   *     not, defaults to true.\n   *     If you do not set the parent, ensure that a subsequent action does,\n   *     otherwise the view and model will be out of sync.\n   */\n  override disconnectInternal(setParent = true) {\n    const {parentConnection, childConnection} =\n      this.getParentAndChildConnections();\n    if (!parentConnection || !childConnection) return;\n    const parent = parentConnection.getSourceBlock() as BlockSvg;\n    const child = childConnection.getSourceBlock() as BlockSvg;\n    super.disconnectInternal(setParent);\n    // Rerender the parent so that it may reflow.\n    if (parent.rendered) {\n      parent.queueRender();\n    }\n    if (child.rendered) {\n      child.updateDisabled();\n      child.queueRender();\n      // Reset visibility, since the child is now a top block.\n      child.getSvgRoot().style.display = 'block';\n    }\n  }\n\n  /**\n   * Respawn the shadow block if there was one connected to the this connection.\n   * Render/rerender blocks as needed.\n   */\n  protected override respawnShadow_() {\n    super.respawnShadow_();\n    const blockShadow = this.targetBlock();\n    if (!blockShadow) {\n      return;\n    }\n    blockShadow.initSvg();\n    blockShadow.queueRender();\n  }\n\n  /**\n   * Find all nearby compatible connections to this connection.\n   * Type checking does not apply, since this function is used for bumping.\n   *\n   * @param maxLimit The maximum radius to another connection, in workspace\n   *     units.\n   * @returns List of connections.\n   * @internal\n   */\n  override neighbours(maxLimit: number): RenderedConnection[] {\n    return this.dbOpposite.getNeighbours(this, maxLimit);\n  }\n\n  /**\n   * Connect two connections together.  This is the connection on the superior\n   * block.  Rerender blocks as needed.\n   *\n   * @param childConnection Connection on inferior block.\n   */\n  protected override connect_(childConnection: Connection) {\n    super.connect_(childConnection);\n\n    const renderedChildConnection = childConnection as RenderedConnection;\n\n    const parentBlock = this.getSourceBlock();\n    const childBlock = renderedChildConnection.getSourceBlock();\n    const parentRendered = parentBlock.rendered;\n    const childRendered = childBlock.rendered;\n\n    if (parentRendered) {\n      parentBlock.updateDisabled();\n    }\n    if (childRendered) {\n      childBlock.updateDisabled();\n    }\n    if (parentRendered && childRendered) {\n      if (\n        this.type === ConnectionType.NEXT_STATEMENT ||\n        this.type === ConnectionType.PREVIOUS_STATEMENT\n      ) {\n        // Child block may need to square off its corners if it is in a stack.\n        // Rendering a child will render its parent.\n        childBlock.queueRender();\n      } else {\n        // Child block does not change shape.  Rendering the parent node will\n        // move its connected children into position.\n        parentBlock.queueRender();\n      }\n    }\n\n    // The input the child block is connected to (if any).\n    const parentInput = parentBlock.getInputWithBlock(childBlock);\n    if (parentInput) {\n      const visible = parentInput.isVisible();\n      childBlock.getSvgRoot().style.display = visible ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Function to be called when this connection's compatible types have changed.\n   */\n  protected override onCheckChanged_() {\n    // The new value type may not be compatible with the existing connection.\n    if (\n      this.isConnected() &&\n      (!this.targetConnection ||\n        !this.getConnectionChecker().canConnect(\n          this,\n          this.targetConnection,\n          false\n        ))\n    ) {\n      const child = this.isSuperior() ? this.targetBlock() : this.sourceBlock_;\n      child!.unplug();\n      // Bump away.\n      this.sourceBlock_.bumpNeighbours();\n    }\n  }\n}\n\nexport namespace RenderedConnection {\n  /**\n   * Enum for different kinds of tracked states.\n   *\n   * WILL_TRACK means that this connection will add itself to\n   * the db on the next moveTo call it receives.\n   *\n   * UNTRACKED means that this connection will not add\n   * itself to the database until setTracking(true) is explicitly called.\n   *\n   * TRACKED means that this connection is currently being tracked.\n   */\n  export enum TrackedState {\n    WILL_TRACK = -1,\n    UNTRACKED = 0,\n    TRACKED = 1,\n  }\n}\n\nexport type TrackedState = RenderedConnection.TrackedState;\nexport const TrackedState = RenderedConnection.TrackedState;\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Warning');\n\nimport type {BlockSvg} from '../block_svg.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport * as dom from '../utils/dom.js';\nimport * as eventUtils from '../events/utils.js';\nimport {Icon} from './icon.js';\nimport type {IHasBubble} from '../interfaces/i_has_bubble.js';\nimport {Rect} from '../utils/rect.js';\nimport {Size} from '../utils.js';\nimport {Svg} from '../utils/svg.js';\nimport {TextBubble} from '../bubbles/text_bubble.js';\nimport {IconType} from './icon_types.js';\n\n/** The size of the warning icon in workspace-scale units. */\nconst SIZE = 17;\n\nexport class WarningIcon extends Icon implements IHasBubble {\n  /** The type string used to identify this icon. */\n  static readonly TYPE = IconType.WARNING;\n\n  /**\n   * The weight this icon has relative to other icons. Icons with more positive\n   * weight values are rendered farther toward the end of the block.\n   */\n  static readonly WEIGHT = 2;\n\n  /** A map of warning IDs to warning text. */\n  private textMap: Map<string, string> = new Map();\n\n  /** The bubble used to display the warnings to the user. */\n  private textBubble: TextBubble | null = null;\n\n  /** @internal */\n  constructor(protected readonly sourceBlock: BlockSvg) {\n    super(sourceBlock);\n  }\n\n  override getType(): IconType<WarningIcon> {\n    return WarningIcon.TYPE;\n  }\n\n  override initView(pointerdownListener: (e: PointerEvent) => void): void {\n    if (this.svgRoot) return; // Already initialized.\n\n    super.initView(pointerdownListener);\n\n    // Triangle with rounded corners.\n    dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyIconShape',\n        'd': 'M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z',\n      },\n      this.svgRoot\n    );\n    // Can't use a real '!' text character since different browsers and\n    // operating systems render it differently. Body of exclamation point.\n    dom.createSvgElement(\n      Svg.PATH,\n      {\n        'class': 'blocklyIconSymbol',\n        'd': 'm7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z',\n      },\n      this.svgRoot\n    );\n    // Dot of exclamation point.\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyIconSymbol',\n        'x': '7',\n        'y': '11',\n        'height': '2',\n        'width': '2',\n      },\n      this.svgRoot\n    );\n  }\n\n  override dispose() {\n    super.dispose();\n    this.textBubble?.dispose();\n  }\n\n  override getWeight(): number {\n    return WarningIcon.WEIGHT;\n  }\n\n  override getSize(): Size {\n    return new Size(SIZE, SIZE);\n  }\n\n  override applyColour(): void {\n    super.applyColour();\n    this.textBubble?.setColour(this.sourceBlock.style.colourPrimary);\n  }\n\n  override updateCollapsed(): void {\n    // We are shown when collapsed, so do nothing! I.e. skip the default\n    // behavior of hiding.\n  }\n\n  /** Tells blockly that this icon is shown when the block is collapsed. */\n  override isShownWhenCollapsed(): boolean {\n    return true;\n  }\n\n  /** Updates the location of the icon's bubble if it is open. */\n  override onLocationChange(blockOrigin: Coordinate): void {\n    super.onLocationChange(blockOrigin);\n    this.textBubble?.setAnchorLocation(this.getAnchorLocation());\n  }\n\n  /**\n   * Adds a warning message to this warning icon.\n   *\n   * @param text The text of the message to add.\n   * @param id The id of the message to add.\n   * @internal\n   */\n  addMessage(text: string, id: string): this {\n    if (this.textMap.get(id) === text) return this;\n\n    if (text) {\n      this.textMap.set(id, text);\n    } else {\n      this.textMap.delete(id);\n    }\n\n    this.textBubble?.setText(this.getText());\n    return this;\n  }\n\n  /**\n   * @returns the display text for this icon. Includes all warning messages\n   *     concatenated together with newlines.\n   * @internal\n   */\n  getText(): string {\n    return [...this.textMap.values()].join('\\n');\n  }\n\n  /** Toggles the visibility of the bubble. */\n  override onClick(): void {\n    super.onClick();\n    this.setBubbleVisible(!this.bubbleIsVisible());\n  }\n\n  bubbleIsVisible(): boolean {\n    return !!this.textBubble;\n  }\n\n  setBubbleVisible(visible: boolean): void {\n    if (this.bubbleIsVisible() === visible) return;\n\n    if (visible) {\n      this.textBubble = new TextBubble(\n        this.getText(),\n        this.sourceBlock.workspace,\n        this.getAnchorLocation(),\n        this.getBubbleOwnerRect()\n      );\n      this.applyColour();\n    } else {\n      this.textBubble?.dispose();\n      this.textBubble = null;\n    }\n\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.BUBBLE_OPEN))(\n        this.sourceBlock,\n        visible,\n        'warning'\n      )\n    );\n  }\n\n  /**\n   * @returns the location the bubble should be anchored to.\n   *     I.E. the middle of this icon.\n   */\n  private getAnchorLocation(): Coordinate {\n    const midIcon = SIZE / 2;\n    return Coordinate.sum(\n      this.workspaceLocation,\n      new Coordinate(midIcon, midIcon)\n    );\n  }\n\n  /**\n   * @returns the rect the bubble should avoid overlapping.\n   *     I.E. the block that owns this icon.\n   */\n  private getBubbleOwnerRect(): Rect {\n    const bbox = this.sourceBlock.getSvgRoot().getBBox();\n    return new Rect(bbox.y, bbox.y + bbox.height, bbox.x, bbox.x + bbox.width);\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for graphically rendering a block as SVG.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.BlockSvg');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_selected.js';\n\nimport {Block} from './block.js';\nimport * as blockAnimations from './block_animations.js';\nimport * as browserEvents from './browser_events.js';\nimport {CommentIcon} from './icons/comment_icon.js';\nimport * as common from './common.js';\nimport {config} from './config.js';\nimport type {Connection} from './connection.js';\nimport {ConnectionType} from './connection_type.js';\nimport * as constants from './constants.js';\nimport * as ContextMenu from './contextmenu.js';\nimport {\n  ContextMenuOption,\n  ContextMenuRegistry,\n  LegacyContextMenuOption,\n} from './contextmenu_registry.js';\nimport type {BlockMove} from './events/events_block_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport {FieldLabel} from './field_label.js';\nimport type {Input} from './inputs/input.js';\nimport type {IASTNodeLocationSvg} from './interfaces/i_ast_node_location_svg.js';\nimport type {IBoundedElement} from './interfaces/i_bounded_element.js';\nimport type {CopyData, ICopyable} from './interfaces/i_copyable.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\nimport {IIcon} from './interfaces/i_icon.js';\nimport * as internalConstants from './internal_constants.js';\nimport {ASTNode} from './keyboard_nav/ast_node.js';\nimport {TabNavigateCursor} from './keyboard_nav/tab_navigate_cursor.js';\nimport {MarkerManager} from './marker_manager.js';\nimport {Msg} from './msg.js';\nimport {MutatorIcon} from './icons/mutator_icon.js';\nimport {RenderedConnection} from './rendered_connection.js';\nimport type {IPathObject} from './renderers/common/i_path_object.js';\nimport * as blocks from './serialization/blocks.js';\nimport type {BlockStyle} from './theme.js';\nimport * as Tooltip from './tooltip.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Svg} from './utils/svg.js';\nimport * as svgMath from './utils/svg_math.js';\nimport {WarningIcon} from './icons/warning_icon.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport {queueRender} from './render_management.js';\nimport * as deprecation from './utils/deprecation.js';\nimport {IconType} from './icons/icon_types.js';\n\n/**\n * Class for a block's SVG representation.\n * Not normally called directly, workspace.newBlock() is preferred.\n */\nexport class BlockSvg\n  extends Block\n  implements IASTNodeLocationSvg, IBoundedElement, ICopyable, IDraggable\n{\n  /**\n   * Constant for identifying rows that are to be rendered inline.\n   * Don't collide with Blockly.inputTypes.\n   */\n  static readonly INLINE = -1;\n\n  /**\n   * ID to give the \"collapsed warnings\" warning. Allows us to remove the\n   * \"collapsed warnings\" warning without removing any warnings that belong to\n   * the block.\n   */\n  static readonly COLLAPSED_WARNING_ID = 'TEMP_COLLAPSED_WARNING_';\n  override decompose?: (p1: Workspace) => BlockSvg;\n  // override compose?: ((p1: BlockSvg) => void)|null;\n  saveConnections?: (p1: BlockSvg) => void;\n  customContextMenu?: (\n    p1: Array<ContextMenuOption | LegacyContextMenuOption>\n  ) => void;\n\n  /**\n   * Height of this block, not including any statement blocks above or below.\n   * Height is in workspace units.\n   */\n  height = 0;\n\n  /**\n   * Width of this block, including any connected value blocks.\n   * Width is in workspace units.\n   */\n  width = 0;\n\n  /**\n   * Map from IDs for warnings text to PIDs of functions to apply them.\n   * Used to be able to maintain multiple warnings.\n   */\n  private warningTextDb = new Map<string, ReturnType<typeof setTimeout>>();\n\n  /** Block's mutator icon (if any). */\n  mutator: MutatorIcon | null = null;\n\n  /**\n   * Block's warning icon (if any).\n   *\n   * @deprecated Use `setWarningText` to modify warnings on this block.\n   */\n  warning: WarningIcon | null = null;\n\n  private svgGroup_: SVGGElement;\n  style: BlockStyle;\n  /** @internal */\n  pathObject: IPathObject;\n  override rendered = false;\n  private visuallyDisabled = false;\n\n  /**\n   * Is this block currently rendering? Used to stop recursive render calls\n   * from actually triggering a re-render.\n   */\n  private renderIsInProgress_ = false;\n\n  /** Whether mousedown events have been bound yet. */\n  private eventsInit_ = false;\n\n  override workspace: WorkspaceSvg;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override outputConnection!: RenderedConnection;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override nextConnection!: RenderedConnection;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override previousConnection!: RenderedConnection;\n\n  private translation = '';\n\n  /**\n   * The ID of the setTimeout callback for bumping neighbours, or 0 if no bump\n   * is currently scheduled.\n   */\n  private bumpNeighboursPid = 0;\n\n  /**\n   * The location of the top left of this block (in workspace coordinates)\n   * relative to either its parent block, or the workspace origin if it has no\n   * parent.\n   *\n   * @internal\n   */\n  relativeCoords = new Coordinate(0, 0);\n\n  /**\n   * @param workspace The block's workspace.\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   */\n  constructor(workspace: WorkspaceSvg, prototypeName: string, opt_id?: string) {\n    super(workspace, prototypeName, opt_id);\n    this.workspace = workspace;\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {});\n\n    /** A block style object. */\n    this.style = workspace.getRenderer().getConstants().getBlockStyle(null);\n\n    /** The renderer's path object. */\n    this.pathObject = workspace\n      .getRenderer()\n      .makePathObject(this.svgGroup_, this.style);\n\n    const svgPath = this.pathObject.svgPath;\n    (svgPath as any).tooltip = this;\n    Tooltip.bindMouseEvents(svgPath);\n\n    // Expose this block's ID on its top-level SVG group.\n    this.svgGroup_.setAttribute('data-id', this.id);\n\n    this.doInit_();\n  }\n\n  /**\n   * Create and initialize the SVG representation of the block.\n   * May be called more than once.\n   */\n  initSvg() {\n    if (!this.workspace.rendered) {\n      throw TypeError('Workspace is headless.');\n    }\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      input.init();\n    }\n    for (const icon of this.getIcons()) {\n      icon.initView(this.createIconPointerDownListener(icon));\n      icon.updateEditable();\n    }\n    this.applyColour();\n    this.pathObject.updateMovable(this.isMovable());\n    const svg = this.getSvgRoot();\n    if (!this.workspace.options.readOnly && !this.eventsInit_ && svg) {\n      browserEvents.conditionalBind(\n        svg,\n        'pointerdown',\n        this,\n        this.onMouseDown_\n      );\n    }\n    this.eventsInit_ = true;\n\n    if (!svg.parentNode) {\n      this.workspace.getCanvas().appendChild(svg);\n    }\n  }\n\n  /**\n   * Get the secondary colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  getColourSecondary(): string | undefined {\n    return this.style.colourSecondary;\n  }\n\n  /**\n   * Get the tertiary colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  getColourTertiary(): string | undefined {\n    return this.style.colourTertiary;\n  }\n\n  /**\n   * Selects this block. Highlights the block visually and fires a select event\n   * if the block is not already selected.\n   */\n  select() {\n    if (this.isShadow() && this.getParent()) {\n      // Shadow blocks should not be selected.\n      this.getParent()!.select();\n      return;\n    }\n    if (common.getSelected() === this) {\n      return;\n    }\n    let oldId = null;\n    if (common.getSelected()) {\n      oldId = common.getSelected()!.id;\n      // Unselect any previously selected block.\n      eventUtils.disable();\n      try {\n        common.getSelected()!.unselect();\n      } finally {\n        eventUtils.enable();\n      }\n    }\n    const event = new (eventUtils.get(eventUtils.SELECTED))(\n      oldId,\n      this.id,\n      this.workspace.id\n    );\n    eventUtils.fire(event);\n    common.setSelected(this);\n    this.addSelect();\n  }\n\n  /**\n   * Unselects this block. Unhighlights the block and fires a select (false)\n   * event if the block is currently selected.\n   */\n  unselect() {\n    if (common.getSelected() !== this) {\n      return;\n    }\n    const event = new (eventUtils.get(eventUtils.SELECTED))(\n      this.id,\n      null,\n      this.workspace.id\n    );\n    event.workspaceId = this.workspace.id;\n    eventUtils.fire(event);\n    common.setSelected(null);\n    this.removeSelect();\n  }\n\n  /**\n   * Sets the parent of this block to be a new block or null.\n   *\n   * @param newParent New parent block.\n   * @internal\n   */\n  override setParent(newParent: this | null) {\n    const oldParent = this.parentBlock_;\n    if (newParent === oldParent) {\n      return;\n    }\n\n    dom.startTextWidthCache();\n    super.setParent(newParent);\n    dom.stopTextWidthCache();\n\n    const svgRoot = this.getSvgRoot();\n\n    // Bail early if workspace is clearing, or we aren't rendered.\n    // We won't need to reattach ourselves anywhere.\n    if (this.workspace.isClearing || !svgRoot) {\n      return;\n    }\n\n    const oldXY = this.getRelativeToSurfaceXY();\n    if (newParent) {\n      (newParent as BlockSvg).getSvgRoot().appendChild(svgRoot);\n    } else if (oldParent) {\n      // If we are losing a parent, we want to move our DOM element to the\n      // root of the workspace.\n      this.workspace.getCanvas().appendChild(svgRoot);\n      this.translate(oldXY.x, oldXY.y);\n    }\n\n    this.applyColour();\n  }\n\n  /**\n   * Return the coordinates of the top-left corner of this block relative to the\n   * drawing surface's origin (0,0), in workspace units.\n   * If the block is on the workspace, (0, 0) is the origin of the workspace\n   * coordinate system.\n   * This does not change with workspace scale.\n   *\n   * @returns Object with .x and .y properties in workspace coordinates.\n   */\n  override getRelativeToSurfaceXY(): Coordinate {\n    let x = 0;\n    let y = 0;\n\n    let element: SVGElement = this.getSvgRoot();\n    if (element) {\n      do {\n        // Loop through this block and every parent.\n        const xy = svgMath.getRelativeXY(element);\n        x += xy.x;\n        y += xy.y;\n        element = element.parentNode as SVGElement;\n      } while (element && element !== this.workspace.getCanvas());\n    }\n    return new Coordinate(x, y);\n  }\n\n  /**\n   * Move a block by a relative offset.\n   *\n   * @param dx Horizontal offset in workspace units.\n   * @param dy Vertical offset in workspace units.\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  override moveBy(dx: number, dy: number, reason?: string[]) {\n    if (this.parentBlock_) {\n      throw Error('Block has parent');\n    }\n    const eventsEnabled = eventUtils.isEnabled();\n    let event: BlockMove | null = null;\n    if (eventsEnabled) {\n      event = new (eventUtils.get(eventUtils.BLOCK_MOVE)!)(this) as BlockMove;\n      reason && event.setReason(reason);\n    }\n    const xy = this.getRelativeToSurfaceXY();\n    this.translate(xy.x + dx, xy.y + dy);\n    this.moveConnections(dx, dy);\n    if (eventsEnabled && event) {\n      event!.recordNew();\n      eventUtils.fire(event);\n    }\n    this.workspace.resizeContents();\n  }\n\n  /**\n   * Transforms a block by setting the translation on the transform attribute\n   * of the block's SVG.\n   *\n   * @param x The x coordinate of the translation in workspace units.\n   * @param y The y coordinate of the translation in workspace units.\n   */\n  translate(x: number, y: number) {\n    this.translation = `translate(${x}, ${y})`;\n    this.relativeCoords = new Coordinate(x, y);\n    this.getSvgRoot().setAttribute('transform', this.getTranslation());\n  }\n\n  /**\n   * Returns the SVG translation of this block.\n   *\n   * @internal\n   */\n  getTranslation(): string {\n    return this.translation;\n  }\n\n  /**\n   * Move a block to a position.\n   *\n   * @param xy The position to move to in workspace units.\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  moveTo(xy: Coordinate, reason?: string[]) {\n    const curXY = this.getRelativeToSurfaceXY();\n    this.moveBy(xy.x - curXY.x, xy.y - curXY.y, reason);\n  }\n\n  /**\n   * Move this block during a drag.\n   * This block must be a top-level block.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate) {\n    this.translate(newLoc.x, newLoc.y);\n    this.getSvgRoot().setAttribute('transform', this.getTranslation());\n  }\n\n  /**\n   * Clear the block of transform=\"...\" attributes.\n   * Used when the block is switching from 3d to 2d transform or vice versa.\n   */\n  private clearTransformAttributes_() {\n    this.getSvgRoot().removeAttribute('transform');\n  }\n\n  /** Snap this block to the nearest grid point. */\n  snapToGrid() {\n    if (this.isDeadOrDying()) {\n      return; // Deleted block.\n    }\n    if (this.workspace.isDragging()) {\n      return; // Don't bump blocks during a drag.;\n    }\n\n    if (this.getParent()) {\n      return; // Only snap top-level blocks.\n    }\n    if (this.isInFlyout) {\n      return; // Don't move blocks around in a flyout.\n    }\n    const grid = this.workspace.getGrid();\n    if (!grid || !grid.shouldSnap()) {\n      return; // Config says no snapping.\n    }\n    const spacing = grid.getSpacing();\n    const half = spacing / 2;\n    const xy = this.getRelativeToSurfaceXY();\n    const dx = Math.round(\n      Math.round((xy.x - half) / spacing) * spacing + half - xy.x\n    );\n    const dy = Math.round(\n      Math.round((xy.y - half) / spacing) * spacing + half - xy.y\n    );\n    if (dx || dy) {\n      this.moveBy(dx, dy, ['snap']);\n    }\n  }\n\n  /**\n   * Returns the coordinates of a bounding box describing the dimensions of this\n   * block and any blocks stacked below it.\n   * Coordinate system: workspace coordinates.\n   *\n   * @returns Object with coordinates of the bounding box.\n   */\n  getBoundingRectangle(): Rect {\n    const blockXY = this.getRelativeToSurfaceXY();\n    const blockBounds = this.getHeightWidth();\n    let left;\n    let right;\n    if (this.RTL) {\n      left = blockXY.x - blockBounds.width;\n      right = blockXY.x;\n    } else {\n      left = blockXY.x;\n      right = blockXY.x + blockBounds.width;\n    }\n    return new Rect(blockXY.y, blockXY.y + blockBounds.height, left, right);\n  }\n\n  /**\n   * Notify every input on this block to mark its fields as dirty.\n   * A dirty field is a field that needs to be re-rendered.\n   */\n  markDirty() {\n    this.pathObject.constants = this.workspace.getRenderer().getConstants();\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      input.markDirty();\n    }\n  }\n\n  /**\n   * Set whether the block is collapsed or not.\n   *\n   * @param collapsed True if collapsed.\n   */\n  override setCollapsed(collapsed: boolean) {\n    if (this.collapsed_ === collapsed) {\n      return;\n    }\n    super.setCollapsed(collapsed);\n    this.updateCollapsed_();\n  }\n\n  /**\n   * Makes sure that when the block is collapsed, it is rendered correctly\n   * for that state.\n   */\n  private updateCollapsed_() {\n    const collapsed = this.isCollapsed();\n    const collapsedInputName = constants.COLLAPSED_INPUT_NAME;\n    const collapsedFieldName = constants.COLLAPSED_FIELD_NAME;\n\n    for (let i = 0, input; (input = this.inputList[i]); i++) {\n      if (input.name !== collapsedInputName) {\n        input.setVisible(!collapsed);\n      }\n    }\n\n    for (const icon of this.getIcons()) {\n      icon.updateCollapsed();\n    }\n\n    if (!collapsed) {\n      this.updateDisabled();\n      this.removeInput(collapsedInputName);\n      return;\n    }\n\n    const text = this.toString(internalConstants.COLLAPSE_CHARS);\n    const field = this.getField(collapsedFieldName);\n    if (field) {\n      field.setValue(text);\n      return;\n    }\n    const input =\n      this.getInput(collapsedInputName) ||\n      this.appendDummyInput(collapsedInputName);\n    input.appendField(new FieldLabel(text), collapsedFieldName);\n  }\n\n  /**\n   * Open the next (or previous) FieldTextInput.\n   *\n   * @param start Current field.\n   * @param forward If true go forward, otherwise backward.\n   */\n  tab(start: Field, forward: boolean) {\n    const tabCursor = new TabNavigateCursor();\n    tabCursor.setCurNode(ASTNode.createFieldNode(start)!);\n    const currentNode = tabCursor.getCurNode();\n\n    if (forward) {\n      tabCursor.next();\n    } else {\n      tabCursor.prev();\n    }\n\n    const nextNode = tabCursor.getCurNode();\n    if (nextNode && nextNode !== currentNode) {\n      const nextField = nextNode.getLocation() as Field;\n      nextField.showEditor();\n\n      // Also move the cursor if we're in keyboard nav mode.\n      if (this.workspace.keyboardAccessibilityMode) {\n        this.workspace.getCursor()!.setCurNode(nextNode);\n      }\n    }\n  }\n\n  /**\n   * Handle a pointerdown on an SVG block.\n   *\n   * @param e Pointer down event.\n   */\n  private onMouseDown_(e: PointerEvent) {\n    const gesture = this.workspace.getGesture(e);\n    if (gesture) {\n      gesture.handleBlockStart(e, this);\n    }\n  }\n\n  /**\n   * Load the block's help page in a new window.\n   *\n   * @internal\n   */\n  showHelp() {\n    const url =\n      typeof this.helpUrl === 'function' ? this.helpUrl() : this.helpUrl;\n    if (url) {\n      window.open(url);\n    }\n  }\n\n  /**\n   * Generate the context menu for this block.\n   *\n   * @returns Context menu options or null if no menu.\n   */\n  protected generateContextMenu(): Array<\n    ContextMenuOption | LegacyContextMenuOption\n  > | null {\n    if (this.workspace.options.readOnly || !this.contextMenu) {\n      return null;\n    }\n    const menuOptions = ContextMenuRegistry.registry.getContextMenuOptions(\n      ContextMenuRegistry.ScopeType.BLOCK,\n      {block: this}\n    );\n\n    // Allow the block to add or modify menuOptions.\n    if (this.customContextMenu) {\n      this.customContextMenu(menuOptions);\n    }\n\n    return menuOptions;\n  }\n\n  /**\n   * Show the context menu for this block.\n   *\n   * @param e Mouse event.\n   * @internal\n   */\n  showContextMenu(e: Event) {\n    const menuOptions = this.generateContextMenu();\n\n    if (menuOptions && menuOptions.length) {\n      ContextMenu.show(e, menuOptions, this.RTL);\n      ContextMenu.setCurrentBlock(this);\n    }\n  }\n\n  /**\n   * Move the connections for this block and all blocks attached under it.\n   * Also update any attached bubbles.\n   *\n   * @param dx Horizontal offset from current location, in workspace units.\n   * @param dy Vertical offset from current location, in workspace units.\n   * @internal\n   */\n  moveConnections(dx: number, dy: number) {\n    if (!this.rendered) {\n      // Rendering is required to lay out the blocks.\n      // This is probably an invisible block attached to a collapsed block.\n      return;\n    }\n    const myConnections = this.getConnections_(false);\n    for (let i = 0; i < myConnections.length; i++) {\n      myConnections[i].moveBy(dx, dy);\n    }\n    const icons = this.getIcons();\n    const pos = this.getRelativeToSurfaceXY();\n    for (const icon of icons) {\n      icon.onLocationChange(pos);\n    }\n\n    // Recurse through all blocks attached under this one.\n    for (let i = 0; i < this.childBlocks_.length; i++) {\n      (this.childBlocks_[i] as BlockSvg).moveConnections(dx, dy);\n    }\n  }\n\n  /**\n   * Recursively adds or removes the dragging class to this node and its\n   * children.\n   *\n   * @param adding True if adding, false if removing.\n   * @internal\n   */\n  setDragging(adding: boolean) {\n    if (adding) {\n      this.translation = '';\n      common.draggingConnections.push(...this.getConnections_(true));\n      dom.addClass(this.svgGroup_, 'blocklyDragging');\n    } else {\n      common.draggingConnections.length = 0;\n      dom.removeClass(this.svgGroup_, 'blocklyDragging');\n    }\n    // Recurse through all blocks attached under this one.\n    for (let i = 0; i < this.childBlocks_.length; i++) {\n      (this.childBlocks_[i] as BlockSvg).setDragging(adding);\n    }\n  }\n\n  /**\n   * Set whether this block is movable or not.\n   *\n   * @param movable True if movable.\n   */\n  override setMovable(movable: boolean) {\n    super.setMovable(movable);\n    this.pathObject.updateMovable(movable);\n  }\n\n  /**\n   * Set whether this block is editable or not.\n   *\n   * @param editable True if editable.\n   */\n  override setEditable(editable: boolean) {\n    super.setEditable(editable);\n    const icons = this.getIcons();\n    for (let i = 0; i < icons.length; i++) {\n      icons[i].updateEditable();\n    }\n  }\n\n  /**\n   * Sets whether this block is a shadow block or not.\n   *\n   * @param shadow True if a shadow.\n   * @internal\n   */\n  override setShadow(shadow: boolean) {\n    super.setShadow(shadow);\n    this.applyColour();\n  }\n\n  /**\n   * Set whether this block is an insertion marker block or not.\n   * Once set this cannot be unset.\n   *\n   * @param insertionMarker True if an insertion marker.\n   * @internal\n   */\n  override setInsertionMarker(insertionMarker: boolean) {\n    if (this.isInsertionMarker_ === insertionMarker) {\n      return; // No change.\n    }\n    this.isInsertionMarker_ = insertionMarker;\n    if (this.isInsertionMarker_) {\n      this.setColour(\n        this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR\n      );\n      this.pathObject.updateInsertionMarker(true);\n    }\n  }\n\n  /**\n   * Return the root node of the SVG or null if none exists.\n   *\n   * @returns The root SVG node (probably a group).\n   */\n  getSvgRoot(): SVGGElement {\n    return this.svgGroup_;\n  }\n\n  /**\n   * Dispose of this block.\n   *\n   * @param healStack If true, then try to heal any gap by connecting the next\n   *     statement with the previous statement.  Otherwise, dispose of all\n   *     children of this block.\n   * @param animate If true, show a disposal animation and sound.\n   */\n  override dispose(healStack?: boolean, animate?: boolean) {\n    if (this.isDeadOrDying()) return;\n\n    Tooltip.dispose();\n    ContextMenu.hide();\n\n    if (animate && this.rendered) {\n      this.unplug(healStack);\n      blockAnimations.disposeUiEffect(this);\n    }\n\n    super.dispose(!!healStack);\n    dom.removeNode(this.svgGroup_);\n  }\n\n  /**\n   * Disposes of this block without doing things required by the top block.\n   * E.g. does trigger UI effects, remove nodes, etc.\n   */\n  override disposeInternal() {\n    if (this.isDeadOrDying()) return;\n    super.disposeInternal();\n\n    this.rendered = false;\n\n    if (common.getSelected() === this) {\n      this.unselect();\n      this.workspace.cancelCurrentGesture();\n    }\n\n    [...this.warningTextDb.values()].forEach((n) => clearTimeout(n));\n    this.warningTextDb.clear();\n\n    this.getIcons().forEach((i) => i.dispose());\n  }\n\n  /**\n   * Delete a block and hide chaff when doing so. The block will not be deleted\n   * if it's in a flyout. This is called from the context menu and keyboard\n   * shortcuts as the full delete action. If you are disposing of a block from\n   * the workspace and don't need to perform flyout checks, handle event\n   * grouping, or hide chaff, then use `block.dispose()` directly.\n   */\n  checkAndDelete() {\n    if (this.workspace.isFlyout) {\n      return;\n    }\n    eventUtils.setGroup(true);\n    this.workspace.hideChaff();\n    if (this.outputConnection) {\n      // Do not attempt to heal rows\n      // (https://github.com/google/blockly/issues/4832)\n      this.dispose(false, true);\n    } else {\n      this.dispose(/* heal */ true, true);\n    }\n    eventUtils.setGroup(false);\n  }\n\n  /**\n   * Encode a block for copying.\n   *\n   * @returns Copy metadata, or null if the block is an insertion marker.\n   * @internal\n   */\n  toCopyData(): CopyData | null {\n    if (this.isInsertionMarker_) {\n      return null;\n    }\n    return {\n      saveInfo: blocks.save(this, {\n        addCoordinates: true,\n        addNextBlocks: false,\n      }) as blocks.State,\n      source: this.workspace,\n      typeCounts: common.getBlockTypeCounts(this, true),\n    };\n  }\n\n  /**\n   * Updates the colour of the block to match the block's state.\n   *\n   * @internal\n   */\n  applyColour() {\n    this.pathObject.applyColour(this);\n\n    const icons = this.getIcons();\n    for (let i = 0; i < icons.length; i++) {\n      icons[i].applyColour();\n    }\n\n    for (let x = 0, input; (input = this.inputList[x]); x++) {\n      for (let y = 0, field; (field = input.fieldRow[y]); y++) {\n        field.applyColour();\n      }\n    }\n  }\n\n  /**\n   * Updates the colour of the block (and children) to match the current\n   * disabled state.\n   *\n   * @internal\n   */\n  updateDisabled() {\n    const disabled = !this.isEnabled() || this.getInheritedDisabled();\n\n    if (this.visuallyDisabled === disabled) {\n      this.getNextBlock()?.updateDisabled();\n      return;\n    }\n\n    this.applyColour();\n    this.visuallyDisabled = disabled;\n    for (const child of this.getChildren(false)) {\n      child.updateDisabled();\n    }\n  }\n\n  /**\n   * Get the comment icon attached to this block, or null if the block has no\n   * comment.\n   *\n   * @returns The comment icon attached to this block, or null.\n   * @deprecated Use getIcon. To be remove in v11.\n   */\n  getCommentIcon(): CommentIcon | null {\n    deprecation.warn('getCommentIcon', 'v10', 'v11', 'getIcon');\n    return (this.getIcon(CommentIcon.TYPE) ?? null) as CommentIcon | null;\n  }\n\n  /**\n   * Set this block's warning text.\n   *\n   * @param text The text, or null to delete.\n   * @param opt_id An optional ID for the warning text to be able to maintain\n   *     multiple warnings.\n   */\n  override setWarningText(text: string | null, opt_id?: string) {\n    const id = opt_id || '';\n    if (!id) {\n      // Kill all previous pending processes, this edit supersedes them all.\n      for (const timeout of this.warningTextDb.values()) {\n        clearTimeout(timeout);\n      }\n      this.warningTextDb.clear();\n    } else if (this.warningTextDb.has(id)) {\n      // Only queue up the latest change.  Kill any earlier pending process.\n      clearTimeout(this.warningTextDb.get(id)!);\n      this.warningTextDb.delete(id);\n    }\n    if (this.workspace.isDragging()) {\n      // Don't change the warning text during a drag.\n      // Wait until the drag finishes.\n      this.warningTextDb.set(\n        id,\n        setTimeout(() => {\n          if (!this.isDeadOrDying()) {\n            this.warningTextDb.delete(id);\n            this.setWarningText(text, id);\n          }\n        }, 100)\n      );\n      return;\n    }\n    if (this.isInFlyout) {\n      text = null;\n    }\n\n    const icon = this.getIcon(WarningIcon.TYPE) as WarningIcon | undefined;\n    if (typeof text === 'string') {\n      // Bubble up to add a warning on top-most collapsed block.\n      let parent = this.getSurroundParent();\n      let collapsedParent = null;\n      while (parent) {\n        if (parent.isCollapsed()) {\n          collapsedParent = parent;\n        }\n        parent = parent.getSurroundParent();\n      }\n      if (collapsedParent) {\n        collapsedParent.setWarningText(\n          Msg['COLLAPSED_WARNINGS_WARNING'],\n          BlockSvg.COLLAPSED_WARNING_ID\n        );\n      }\n\n      if (icon) {\n        (icon as WarningIcon).addMessage(text, id);\n      } else {\n        this.addIcon(new WarningIcon(this).addMessage(text, id));\n      }\n    } else if (icon) {\n      // Dispose all warnings if no ID is given.\n      if (!id) {\n        this.removeIcon(WarningIcon.TYPE);\n      } else {\n        if (!icon.getText()) this.removeIcon(WarningIcon.TYPE);\n      }\n    }\n  }\n\n  /**\n   * Give this block a mutator dialog.\n   *\n   * @param mutator A mutator dialog instance or null to remove.\n   */\n  override setMutator(mutator: MutatorIcon | null) {\n    this.removeIcon(MutatorIcon.TYPE);\n    if (mutator) this.addIcon(mutator);\n  }\n\n  override addIcon<T extends IIcon>(icon: T): T {\n    super.addIcon(icon);\n\n    if (icon instanceof WarningIcon) this.warning = icon;\n    if (icon instanceof MutatorIcon) this.mutator = icon;\n\n    if (this.rendered) {\n      icon.initView(this.createIconPointerDownListener(icon));\n      icon.applyColour();\n      icon.updateEditable();\n      // TODO: Change this based on #7068.\n      this.render();\n      this.bumpNeighbours();\n    }\n\n    return icon;\n  }\n\n  /**\n   * Creates a pointer down event listener for the icon to append to its\n   * root svg.\n   */\n  private createIconPointerDownListener(icon: IIcon) {\n    return (e: PointerEvent) => {\n      if (this.isDeadOrDying()) return;\n      const gesture = this.workspace.getGesture(e);\n      if (gesture) {\n        gesture.setStartIcon(icon);\n      }\n    };\n  }\n\n  override removeIcon(type: IconType<IIcon>): boolean {\n    const removed = super.removeIcon(type);\n\n    if (type.equals(WarningIcon.TYPE)) this.warning = null;\n    if (type.equals(MutatorIcon.TYPE)) this.mutator = null;\n\n    if (this.rendered) {\n      // TODO: Change this based on #7068.\n      this.render();\n      this.bumpNeighbours();\n    }\n    return removed;\n  }\n\n  /**\n   * Set whether the block is enabled or not.\n   *\n   * @param enabled True if enabled.\n   */\n  override setEnabled(enabled: boolean) {\n    if (this.isEnabled() !== enabled) {\n      super.setEnabled(enabled);\n      if (this.rendered && !this.getInheritedDisabled()) {\n        this.updateDisabled();\n      }\n    }\n  }\n\n  /**\n   * Set whether the block is highlighted or not.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param highlighted True if highlighted.\n   */\n  setHighlighted(highlighted: boolean) {\n    if (!this.rendered) {\n      return;\n    }\n    this.pathObject.updateHighlighted(highlighted);\n  }\n\n  /**\n   * Adds the visual \"select\" effect to the block, but does not actually select\n   * it or fire an event.\n   *\n   * @see BlockSvg#select\n   */\n  addSelect() {\n    this.pathObject.updateSelected(true);\n  }\n\n  /**\n   * Removes the visual \"select\" effect from the block, but does not actually\n   * unselect it or fire an event.\n   *\n   * @see BlockSvg#unselect\n   */\n  removeSelect() {\n    this.pathObject.updateSelected(false);\n  }\n\n  /**\n   * Update the cursor over this block by adding or removing a class.\n   *\n   * @param enable True if the delete cursor should be shown, false otherwise.\n   * @internal\n   */\n  setDeleteStyle(enable: boolean) {\n    this.pathObject.updateDraggingDelete(enable);\n  }\n\n  // Overrides of functions on Blockly.Block that take into account whether the\n\n  // block has been rendered.\n\n  /**\n   * Get the colour of a block.\n   *\n   * @returns #RRGGBB string.\n   */\n  override getColour(): string {\n    return this.style.colourPrimary;\n  }\n\n  /**\n   * Change the colour of a block.\n   *\n   * @param colour HSV hue value, or #RRGGBB string.\n   */\n  override setColour(colour: number | string) {\n    super.setColour(colour);\n    const styleObj = this.workspace\n      .getRenderer()\n      .getConstants()\n      .getBlockStyleForColour(this.colour_);\n\n    this.pathObject.setStyle(styleObj.style);\n    this.style = styleObj.style;\n    this.styleName_ = styleObj.name;\n\n    this.applyColour();\n  }\n\n  /**\n   * Set the style and colour values of a block.\n   *\n   * @param blockStyleName Name of the block style.\n   * @throws {Error} if the block style does not exist.\n   */\n  override setStyle(blockStyleName: string) {\n    const blockStyle = this.workspace\n      .getRenderer()\n      .getConstants()\n      .getBlockStyle(blockStyleName);\n    this.styleName_ = blockStyleName;\n\n    if (blockStyle) {\n      this.hat = blockStyle.hat;\n      this.pathObject.setStyle(blockStyle);\n      // Set colour to match Block.\n      this.colour_ = blockStyle.colourPrimary;\n      this.style = blockStyle;\n\n      this.applyColour();\n    } else {\n      throw Error('Invalid style name: ' + blockStyleName);\n    }\n  }\n\n  /**\n   * Move this block to the front of the visible workspace.\n   * <g> tags do not respect z-index so SVG renders them in the\n   * order that they are in the DOM.  By placing this block first within the\n   * block group's <g>, it will render on top of any other blocks.\n   *\n   * @internal\n   */\n  bringToFront() {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let block: this | null = this;\n    do {\n      const root = block.getSvgRoot();\n      const parent = root.parentNode;\n      const childNodes = parent!.childNodes;\n      // Avoid moving the block if it's already at the bottom.\n      if (childNodes[childNodes.length - 1] !== root) {\n        parent!.appendChild(root);\n      }\n      block = block.getParent();\n    } while (block);\n  }\n\n  /**\n   * Set whether this block can chain onto the bottom of another block.\n   *\n   * @param newBoolean True if there can be a previous statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  override setPreviousStatement(\n    newBoolean: boolean,\n    opt_check?: string | string[] | null\n  ) {\n    super.setPreviousStatement(newBoolean, opt_check);\n\n    if (this.rendered) {\n      this.queueRender();\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Set whether another block can chain onto the bottom of this block.\n   *\n   * @param newBoolean True if there can be a next statement.\n   * @param opt_check Statement type or list of statement types.  Null/undefined\n   *     if any type could be connected.\n   */\n  override setNextStatement(\n    newBoolean: boolean,\n    opt_check?: string | string[] | null\n  ) {\n    super.setNextStatement(newBoolean, opt_check);\n\n    if (this.rendered) {\n      this.queueRender();\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Set whether this block returns a value.\n   *\n   * @param newBoolean True if there is an output.\n   * @param opt_check Returned type or list of returned types.  Null or\n   *     undefined if any type could be returned (e.g. variable get).\n   */\n  override setOutput(\n    newBoolean: boolean,\n    opt_check?: string | string[] | null\n  ) {\n    super.setOutput(newBoolean, opt_check);\n\n    if (this.rendered) {\n      this.queueRender();\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Set whether value inputs are arranged horizontally or vertically.\n   *\n   * @param newBoolean True if inputs are horizontal.\n   */\n  override setInputsInline(newBoolean: boolean) {\n    super.setInputsInline(newBoolean);\n\n    if (this.rendered) {\n      this.queueRender();\n      this.bumpNeighbours();\n    }\n  }\n\n  /**\n   * Remove an input from this block.\n   *\n   * @param name The name of the input.\n   * @param opt_quiet True to prevent error if input is not present.\n   * @returns True if operation succeeds, false if input is not present and\n   *     opt_quiet is true\n   * @throws {Error} if the input is not present and opt_quiet is not true.\n   */\n  override removeInput(name: string, opt_quiet?: boolean): boolean {\n    const removed = super.removeInput(name, opt_quiet);\n\n    if (this.rendered) {\n      this.queueRender();\n      // Removing an input will cause the block to change shape.\n      this.bumpNeighbours();\n    }\n\n    return removed;\n  }\n\n  /**\n   * Move a numbered input to a different location on this block.\n   *\n   * @param inputIndex Index of the input to move.\n   * @param refIndex Index of input that should be after the moved input.\n   */\n  override moveNumberedInputBefore(inputIndex: number, refIndex: number) {\n    super.moveNumberedInputBefore(inputIndex, refIndex);\n\n    if (this.rendered) {\n      this.queueRender();\n      // Moving an input will cause the block to change shape.\n      this.bumpNeighbours();\n    }\n  }\n\n  /** @override */\n  override appendInput(input: Input): Input {\n    super.appendInput(input);\n\n    if (this.rendered) {\n      this.queueRender();\n      // Adding an input will cause the block to change shape.\n      this.bumpNeighbours();\n    }\n    return input;\n  }\n\n  /**\n   * Sets whether this block's connections are tracked in the database or not.\n   *\n   * Used by the deserializer to be more efficient. Setting a connection's\n   * tracked_ value to false keeps it from adding itself to the db when it\n   * gets its first moveTo call, saving expensive ops for later.\n   *\n   * @param track If true, start tracking. If false, stop tracking.\n   * @internal\n   */\n  setConnectionTracking(track: boolean) {\n    if (this.previousConnection) {\n      this.previousConnection.setTracking(track);\n    }\n    if (this.outputConnection) {\n      this.outputConnection.setTracking(track);\n    }\n    if (this.nextConnection) {\n      this.nextConnection.setTracking(track);\n      const child = this.nextConnection.targetBlock();\n      if (child) {\n        child.setConnectionTracking(track);\n      }\n    }\n\n    if (this.collapsed_) {\n      // When track is true, we don't want to start tracking collapsed\n      // connections. When track is false, we're already not tracking\n      // collapsed connections, so no need to update.\n      return;\n    }\n\n    for (let i = 0; i < this.inputList.length; i++) {\n      const conn = this.inputList[i].connection as RenderedConnection;\n      if (conn) {\n        conn.setTracking(track);\n\n        // Pass tracking on down the chain.\n        const block = conn.targetBlock();\n        if (block) {\n          block.setConnectionTracking(track);\n        }\n      }\n    }\n  }\n\n  /**\n   * Returns connections originating from this block.\n   *\n   * @param all If true, return all connections even hidden ones.\n   *     Otherwise, for a non-rendered block return an empty list, and for a\n   *     collapsed block don't return inputs connections.\n   * @returns Array of connections.\n   * @internal\n   */\n  override getConnections_(all: boolean): RenderedConnection[] {\n    const myConnections = [];\n    if (all || this.rendered) {\n      if (this.outputConnection) {\n        myConnections.push(this.outputConnection);\n      }\n      if (this.previousConnection) {\n        myConnections.push(this.previousConnection);\n      }\n      if (this.nextConnection) {\n        myConnections.push(this.nextConnection);\n      }\n      if (all || !this.collapsed_) {\n        for (let i = 0, input; (input = this.inputList[i]); i++) {\n          if (input.connection) {\n            myConnections.push(input.connection as RenderedConnection);\n          }\n        }\n      }\n    }\n    return myConnections;\n  }\n\n  /**\n   * Walks down a stack of blocks and finds the last next connection on the\n   * stack.\n   *\n   * @param ignoreShadows If true,the last connection on a non-shadow block will\n   *     be returned. If false, this will follow shadows to find the last\n   *     connection.\n   * @returns The last next connection on the stack, or null.\n   * @internal\n   */\n  override lastConnectionInStack(\n    ignoreShadows: boolean\n  ): RenderedConnection | null {\n    return super.lastConnectionInStack(ignoreShadows) as RenderedConnection;\n  }\n\n  /**\n   * Find the connection on this block that corresponds to the given connection\n   * on the other block.\n   * Used to match connections between a block and its insertion marker.\n   *\n   * @param otherBlock The other block to match against.\n   * @param conn The other connection to match.\n   * @returns The matching connection on this block, or null.\n   * @internal\n   */\n  override getMatchingConnection(\n    otherBlock: Block,\n    conn: Connection\n  ): RenderedConnection | null {\n    return super.getMatchingConnection(otherBlock, conn) as RenderedConnection;\n  }\n\n  /**\n   * Create a connection of the specified type.\n   *\n   * @param type The type of the connection to create.\n   * @returns A new connection of the specified type.\n   * @internal\n   */\n  override makeConnection_(type: ConnectionType): RenderedConnection {\n    return new RenderedConnection(this, type);\n  }\n\n  /**\n   * Return the next statement block directly connected to this block.\n   *\n   * @returns The next statement block or null.\n   */\n  override getNextBlock(): BlockSvg | null {\n    return super.getNextBlock() as BlockSvg;\n  }\n\n  /**\n   * Returns the block connected to the previous connection.\n   *\n   * @returns The previous statement block or null.\n   */\n  override getPreviousBlock(): BlockSvg | null {\n    return super.getPreviousBlock() as BlockSvg;\n  }\n\n  /**\n   * Bumps unconnected blocks out of alignment.\n   *\n   * Two blocks which aren't actually connected should not coincidentally line\n   * up on screen, because that creates confusion for end-users.\n   */\n  override bumpNeighbours() {\n    if (this.bumpNeighboursPid) return;\n    const group = eventUtils.getGroup();\n\n    this.bumpNeighboursPid = setTimeout(() => {\n      const oldGroup = eventUtils.getGroup();\n      eventUtils.setGroup(group);\n      this.getRootBlock().bumpNeighboursInternal();\n      eventUtils.setGroup(oldGroup);\n      this.bumpNeighboursPid = 0;\n    }, config.bumpDelay);\n  }\n\n  /**\n   * Bumps unconnected blocks out of alignment.\n   */\n  private bumpNeighboursInternal() {\n    const root = this.getRootBlock();\n    if (\n      this.isDeadOrDying() ||\n      this.workspace.isDragging() ||\n      root.isInFlyout\n    ) {\n      return;\n    }\n\n    function neighbourIsInStack(neighbour: RenderedConnection) {\n      return neighbour.getSourceBlock().getRootBlock() === root;\n    }\n\n    for (const conn of this.getConnections_(false)) {\n      if (conn.isSuperior()) {\n        // Recurse down the block stack.\n        conn.targetBlock()?.bumpNeighboursInternal();\n      }\n\n      for (const neighbour of conn.neighbours(config.snapRadius)) {\n        // Don't bump away from things that are in our stack.\n        if (neighbourIsInStack(neighbour)) continue;\n        // If both connections are connected, that's fine.\n        if (conn.isConnected() && neighbour.isConnected()) continue;\n\n        // Always bump the inferior connection.\n        if (conn.isSuperior()) {\n          neighbour.bumpAwayFrom(conn);\n        } else {\n          conn.bumpAwayFrom(neighbour);\n        }\n      }\n    }\n  }\n\n  /**\n   * Schedule snapping to grid and bumping neighbours to occur after a brief\n   * delay.\n   *\n   * @internal\n   */\n  scheduleSnapAndBump() {\n    // Ensure that any snap and bump are part of this move's event group.\n    const group = eventUtils.getGroup();\n\n    setTimeout(() => {\n      eventUtils.setGroup(group);\n      this.snapToGrid();\n      eventUtils.setGroup(false);\n    }, config.bumpDelay / 2);\n\n    this.bumpNeighbours();\n  }\n\n  /**\n   * Position a block so that it doesn't move the target block when connected.\n   * The block to position is usually either the first block in a dragged stack\n   * or an insertion marker.\n   *\n   * @param sourceConnection The connection on the moving block's stack.\n   * @param targetConnection The connection that should stay stationary as this\n   *     block is positioned.\n   * @internal\n   */\n  positionNearConnection(\n    sourceConnection: RenderedConnection,\n    targetConnection: RenderedConnection\n  ) {\n    // We only need to position the new block if it's before the existing one,\n    // otherwise its position is set by the previous block.\n    if (\n      sourceConnection.type === ConnectionType.NEXT_STATEMENT ||\n      sourceConnection.type === ConnectionType.INPUT_VALUE\n    ) {\n      const dx = targetConnection.x - sourceConnection.x;\n      const dy = targetConnection.y - sourceConnection.y;\n\n      this.moveBy(dx, dy);\n    }\n  }\n\n  /**\n   * @returns The first statement connection or null.\n   * @internal\n   */\n  override getFirstStatementConnection(): RenderedConnection | null {\n    return super.getFirstStatementConnection() as RenderedConnection | null;\n  }\n\n  /**\n   * Find all the blocks that are directly nested inside this one.\n   * Includes value and statement inputs, as well as any following statement.\n   * Excludes any connection on an output tab or any preceding statement.\n   * Blocks are optionally sorted by position; top to bottom.\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  override getChildren(ordered: boolean): BlockSvg[] {\n    return super.getChildren(ordered) as BlockSvg[];\n  }\n\n  /**\n   * Triggers a rerender after a delay to allow for batching.\n   *\n   * @returns A promise that resolves after the currently queued renders have\n   *     been completed. Used for triggering other behavior that relies on\n   *     updated size/position location for the block.\n   * @internal\n   */\n  queueRender(): Promise<void> {\n    return queueRender(this);\n  }\n\n  /**\n   * Immediately lays out and reflows a block based on its contents and\n   * settings.\n   *\n   * @param opt_bubble If false, just render this block.\n   *   If true, also render block's parent, grandparent, etc.  Defaults to true.\n   */\n  render(opt_bubble?: boolean) {\n    if (this.renderIsInProgress_) {\n      return; // Don't allow recursive renders.\n    }\n    this.renderIsInProgress_ = true;\n    try {\n      this.rendered = true;\n      dom.startTextWidthCache();\n\n      if (this.isCollapsed()) {\n        this.updateCollapsed_();\n      }\n      this.workspace.getRenderer().render(this);\n      this.updateConnectionAndIconLocations();\n\n      if (opt_bubble !== false) {\n        const parentBlock = this.getParent();\n        if (parentBlock) {\n          parentBlock.render(true);\n        } else {\n          // Top-most block. Fire an event to allow scrollbars to resize.\n          this.workspace.resizeContents();\n        }\n      }\n\n      dom.stopTextWidthCache();\n      this.updateMarkers_();\n    } finally {\n      this.renderIsInProgress_ = false;\n    }\n  }\n\n  /**\n   * Renders this block in a way that's compatible with the more efficient\n   * render management system.\n   *\n   * @internal\n   */\n  renderEfficiently() {\n    this.rendered = true;\n    dom.startTextWidthCache();\n\n    if (this.isCollapsed()) {\n      this.updateCollapsed_();\n    }\n    this.workspace.getRenderer().render(this);\n    this.tightenChildrenEfficiently();\n\n    dom.stopTextWidthCache();\n    this.updateMarkers_();\n  }\n\n  /**\n   * Tightens all children of this block so they are snuggly rendered against\n   * their parent connections.\n   *\n   * Does not update connection locations, so that they can be updated more\n   * efficiently by the render management system.\n   *\n   * @internal\n   */\n  tightenChildrenEfficiently() {\n    for (const input of this.inputList) {\n      const conn = input.connection as RenderedConnection;\n      if (conn) conn.tightenEfficiently();\n    }\n    if (this.nextConnection) this.nextConnection.tightenEfficiently();\n  }\n\n  /** Redraw any attached marker or cursor svgs if needed. */\n  protected updateMarkers_() {\n    if (this.workspace.keyboardAccessibilityMode && this.pathObject.cursorSvg) {\n      this.workspace.getCursor()!.draw();\n    }\n    if (this.workspace.keyboardAccessibilityMode && this.pathObject.markerSvg) {\n      // TODO(#4592): Update all markers on the block.\n      this.workspace.getMarker(MarkerManager.LOCAL_MARKER)!.draw();\n    }\n    for (const input of this.inputList) {\n      for (const field of input.fieldRow) {\n        field.updateMarkers_();\n      }\n    }\n  }\n\n  /**\n   * Update all of the connections on this block with the new locations\n   * calculated during rendering.  Also move all of the connected blocks based\n   * on the new connection locations.\n   *\n   * @internal\n   */\n  private updateConnectionAndIconLocations() {\n    const blockTL = this.getRelativeToSurfaceXY();\n    // Don't tighten previous or output connections because they are inferior\n    // connections.\n    if (this.previousConnection) {\n      this.previousConnection.moveToOffset(blockTL);\n    }\n    if (this.outputConnection) {\n      this.outputConnection.moveToOffset(blockTL);\n    }\n\n    for (let i = 0; i < this.inputList.length; i++) {\n      const conn = this.inputList[i].connection as RenderedConnection;\n      if (conn) {\n        conn.moveToOffset(blockTL);\n        if (conn.isConnected()) {\n          conn.tighten();\n        }\n      }\n    }\n\n    if (this.nextConnection) {\n      this.nextConnection.moveToOffset(blockTL);\n      if (this.nextConnection.isConnected()) {\n        this.nextConnection.tighten();\n      }\n    }\n\n    for (const icon of this.getIcons()) {\n      icon.onLocationChange(blockTL);\n    }\n  }\n\n  /**\n   * Add the cursor SVG to this block's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the block SVG\n   *     group.\n   * @internal\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    this.pathObject.setCursorSvg(cursorSvg);\n  }\n\n  /**\n   * Add the marker SVG to this block's SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the block SVG\n   *     group.\n   * @internal\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    this.pathObject.setMarkerSvg(markerSvg);\n  }\n\n  /**\n   * Returns a bounding box describing the dimensions of this block\n   * and any blocks stacked below it.\n   *\n   * @returns Object with height and width properties in workspace units.\n   * @internal\n   */\n  getHeightWidth(): {height: number; width: number} {\n    let height = this.height;\n    let width = this.width;\n    // Recursively add size of subsequent blocks.\n    const nextBlock = this.getNextBlock();\n    if (nextBlock) {\n      const nextHeightWidth = nextBlock.getHeightWidth();\n      const tabHeight = this.workspace\n        .getRenderer()\n        .getConstants().NOTCH_HEIGHT;\n      height += nextHeightWidth.height - tabHeight;\n      width = Math.max(width, nextHeightWidth.width);\n    }\n    return {height, width};\n  }\n\n  /**\n   * Visual effect to show that if the dragging block is dropped, this block\n   * will be replaced.  If a shadow block, it will disappear.  Otherwise it will\n   * bump.\n   *\n   * @param add True if highlighting should be added.\n   * @internal\n   */\n  fadeForReplacement(add: boolean) {\n    this.pathObject.updateReplacementFade(add);\n  }\n\n  /**\n   * Visual effect to show that if the dragging block is dropped it will connect\n   * to this input.\n   *\n   * @param conn The connection on the input to highlight.\n   * @param add True if highlighting should be added.\n   * @internal\n   */\n  highlightShapeForInput(conn: RenderedConnection, add: boolean) {\n    this.pathObject.updateShapeForInputHighlight(conn, add);\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a UI bubble.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Bubble');\n\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport type {IBubble} from './interfaces/i_bubble.js';\nimport type {ContainerRegion} from './metrics_manager.js';\nimport {Scrollbar} from './scrollbar.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as math from './utils/math.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for UI bubble.\n */\nexport class Bubble implements IBubble {\n  /** Width of the border around the bubble. */\n  static BORDER_WIDTH = 6;\n\n  /**\n   * Determines the thickness of the base of the arrow in relation to the size\n   * of the bubble.  Higher numbers result in thinner arrows.\n   */\n  static ARROW_THICKNESS = 5;\n\n  /** The number of degrees that the arrow bends counter-clockwise. */\n  static ARROW_ANGLE = 20;\n\n  /**\n   * The sharpness of the arrow's bend.  Higher numbers result in smoother\n   * arrows.\n   */\n  static ARROW_BEND = 4;\n\n  /** Distance between arrow point and anchor point. */\n  static ANCHOR_RADIUS = 8;\n\n  /** Mouse up event data. */\n  private static onMouseUpWrapper: browserEvents.Data | null = null;\n\n  /** Mouse move event data. */\n  private static onMouseMoveWrapper: browserEvents.Data | null = null;\n\n  workspace_: WorkspaceSvg;\n  content_: SVGElement;\n  shape_: SVGElement;\n\n  /** Flag to stop incremental rendering during construction. */\n  private readonly rendered: boolean;\n\n  /** The SVG group containing all parts of the bubble. */\n  private bubbleGroup: SVGGElement | null = null;\n\n  /**\n   * The SVG path for the arrow from the bubble to the icon on the block.\n   */\n  private bubbleArrow: SVGPathElement | null = null;\n\n  /** The SVG rect for the main body of the bubble. */\n  private bubbleBack: SVGRectElement | null = null;\n\n  /** The SVG group for the resize hash marks on some bubbles. */\n  private resizeGroup: SVGGElement | null = null;\n\n  /** Absolute coordinate of anchor point, in workspace coordinates. */\n  private anchorXY!: Coordinate;\n\n  /**\n   * Relative X coordinate of bubble with respect to the anchor's centre,\n   * in workspace units.\n   * In RTL mode the initial value is negated.\n   */\n  private relativeLeft = 0;\n\n  /**\n   * Relative Y coordinate of bubble with respect to the anchor's centre, in\n   * workspace units.\n   */\n  private relativeTop = 0;\n\n  /** Width of bubble, in workspace units. */\n  private width = 0;\n\n  /** Height of bubble, in workspace units. */\n  private height = 0;\n\n  /** Automatically position and reposition the bubble. */\n  private autoLayout = true;\n\n  /** Method to call on resize of bubble. */\n  private resizeCallback: (() => void) | null = null;\n\n  /** Method to call on move of bubble. */\n  private moveCallback: (() => void) | null = null;\n\n  /** Mouse down on bubbleBack event data. */\n  private onMouseDownBubbleWrapper: browserEvents.Data | null = null;\n\n  /** Mouse down on resizeGroup event data. */\n  private onMouseDownResizeWrapper: browserEvents.Data | null = null;\n\n  /**\n   * Describes whether this bubble has been disposed of (nodes and event\n   * listeners removed from the page) or not.\n   *\n   * @internal\n   */\n  disposed = false;\n  private arrowRadians: number;\n\n  /**\n   * @param workspace The workspace on which to draw the bubble.\n   * @param content SVG content for the bubble.\n   * @param shape SVG element to avoid eclipsing.\n   * @param anchorXY Absolute position of bubble's anchor point.\n   * @param bubbleWidth Width of bubble, or null if not resizable.\n   * @param bubbleHeight Height of bubble, or null if not resizable.\n   */\n  constructor(\n    workspace: WorkspaceSvg,\n    content: SVGElement,\n    shape: SVGElement,\n    anchorXY: Coordinate,\n    bubbleWidth: number | null,\n    bubbleHeight: number | null\n  ) {\n    this.rendered = false;\n    this.workspace_ = workspace;\n    this.content_ = content;\n    this.shape_ = shape;\n\n    let angle = Bubble.ARROW_ANGLE;\n    if (this.workspace_.RTL) {\n      angle = -angle;\n    }\n    this.arrowRadians = math.toRadians(angle);\n\n    const canvas = workspace.getBubbleCanvas();\n    canvas.appendChild(\n      this.createDom(content, !!(bubbleWidth && bubbleHeight))\n    );\n\n    this.setAnchorLocation(anchorXY);\n    if (!bubbleWidth || !bubbleHeight) {\n      const bBox = (this.content_ as SVGGraphicsElement).getBBox();\n      bubbleWidth = bBox.width + 2 * Bubble.BORDER_WIDTH;\n      bubbleHeight = bBox.height + 2 * Bubble.BORDER_WIDTH;\n    }\n    this.setBubbleSize(bubbleWidth, bubbleHeight);\n\n    // Render the bubble.\n    this.positionBubble();\n    this.renderArrow();\n    this.rendered = true;\n  }\n\n  /**\n   * Create the bubble's DOM.\n   *\n   * @param content SVG content for the bubble.\n   * @param hasResize Add diagonal resize gripper if true.\n   * @returns The bubble's SVG group.\n   */\n  private createDom(content: Element, hasResize: boolean): SVGElement {\n    /* Create the bubble.  Here's the markup that will be generated:\n        <g>\n          <g filter=\"url(#blocklyEmbossFilter837493)\">\n            <path d=\"... Z\" />\n            <rect class=\"blocklyDraggable\" rx=\"8\" ry=\"8\" width=\"180\"\n       height=\"180\"/>\n          </g>\n          <g transform=\"translate(165, 165)\" class=\"blocklyResizeSE\">\n            <polygon points=\"0,15 15,15 15,0\"/>\n            <line class=\"blocklyResizeLine\" x1=\"5\" y1=\"14\" x2=\"14\" y2=\"5\"/>\n            <line class=\"blocklyResizeLine\" x1=\"10\" y1=\"14\" x2=\"14\" y2=\"10\"/>\n          </g>\n          [...content goes here...]\n        </g>\n        */\n    this.bubbleGroup = dom.createSvgElement(Svg.G, {});\n    let filter: {filter?: string} = {\n      'filter':\n        'url(#' +\n        this.workspace_.getRenderer().getConstants().embossFilterId +\n        ')',\n    };\n    if (userAgent.JavaFx) {\n      // Multiple reports that JavaFX can't handle filters.\n      // https://github.com/google/blockly/issues/99\n      filter = {};\n    }\n    const bubbleEmboss = dom.createSvgElement(Svg.G, filter, this.bubbleGroup);\n    this.bubbleArrow = dom.createSvgElement(Svg.PATH, {}, bubbleEmboss);\n    this.bubbleBack = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyDraggable',\n        'x': 0,\n        'y': 0,\n        'rx': Bubble.BORDER_WIDTH,\n        'ry': Bubble.BORDER_WIDTH,\n      },\n      bubbleEmboss\n    );\n    if (hasResize) {\n      this.resizeGroup = dom.createSvgElement(\n        Svg.G,\n        {\n          'class': this.workspace_.RTL ? 'blocklyResizeSW' : 'blocklyResizeSE',\n        },\n        this.bubbleGroup\n      );\n      const size = 2 * Bubble.BORDER_WIDTH;\n      dom.createSvgElement(\n        Svg.POLYGON,\n        {'points': `0,${size} ${size},${size} ${size},0`},\n        this.resizeGroup\n      );\n      dom.createSvgElement(\n        Svg.LINE,\n        {\n          'class': 'blocklyResizeLine',\n          'x1': size / 3,\n          'y1': size - 1,\n          'x2': size - 1,\n          'y2': size / 3,\n        },\n        this.resizeGroup\n      );\n      dom.createSvgElement(\n        Svg.LINE,\n        {\n          'class': 'blocklyResizeLine',\n          'x1': (size * 2) / 3,\n          'y1': size - 1,\n          'x2': size - 1,\n          'y2': (size * 2) / 3,\n        },\n        this.resizeGroup\n      );\n    } else {\n      this.resizeGroup = null;\n    }\n\n    if (!this.workspace_.options.readOnly) {\n      this.onMouseDownBubbleWrapper = browserEvents.conditionalBind(\n        this.bubbleBack,\n        'pointerdown',\n        this,\n        this.bubbleMouseDown\n      );\n      if (this.resizeGroup) {\n        this.onMouseDownResizeWrapper = browserEvents.conditionalBind(\n          this.resizeGroup,\n          'pointerdown',\n          this,\n          this.resizeMouseDown\n        );\n      }\n    }\n    this.bubbleGroup.appendChild(content);\n    return this.bubbleGroup;\n  }\n\n  /**\n   * Return the root node of the bubble's SVG group.\n   *\n   * @returns The root SVG node of the bubble's group.\n   */\n  getSvgRoot(): SVGElement {\n    return this.bubbleGroup as SVGElement;\n  }\n\n  /**\n   * Expose the block's ID on the bubble's top-level SVG group.\n   *\n   * @param id ID of block.\n   */\n  setSvgId(id: string) {\n    this.bubbleGroup?.setAttribute('data-block-id', id);\n  }\n\n  /**\n   * Handle a pointerdown on bubble's border.\n   *\n   * @param e Pointer down event.\n   */\n  private bubbleMouseDown(e: PointerEvent) {\n    const gesture = this.workspace_.getGesture(e);\n    if (gesture) {\n      gesture.handleBubbleStart(e, this);\n    }\n  }\n\n  /**\n   * Show the context menu for this bubble.\n   *\n   * @param _e Mouse event.\n   * @internal\n   */\n  showContextMenu(_e: Event) {}\n  // NOP on bubbles, but used by the bubble dragger to pass events to\n  // workspace comments.\n\n  /**\n   * Get whether this bubble is deletable or not.\n   *\n   * @returns True if deletable.\n   * @internal\n   */\n  isDeletable(): boolean {\n    return false;\n  }\n\n  /**\n   * Update the style of this bubble when it is dragged over a delete area.\n   *\n   * @param _enable True if the bubble is about to be deleted, false otherwise.\n   */\n  setDeleteStyle(_enable: boolean) {}\n  // NOP if bubble is not deletable.\n\n  /**\n   * Handle a pointerdown on bubble's resize corner.\n   *\n   * @param e Pointer down event.\n   */\n  private resizeMouseDown(e: PointerEvent) {\n    this.promote();\n    Bubble.unbindDragEvents();\n    if (browserEvents.isRightButton(e)) {\n      // No right-click.\n      e.stopPropagation();\n      return;\n    }\n    // Left-click (or middle click)\n    this.workspace_.startDrag(\n      e,\n      new Coordinate(\n        this.workspace_.RTL ? -this.width : this.width,\n        this.height\n      )\n    );\n\n    Bubble.onMouseUpWrapper = browserEvents.conditionalBind(\n      document,\n      'pointerup',\n      this,\n      Bubble.bubbleMouseUp\n    );\n    Bubble.onMouseMoveWrapper = browserEvents.conditionalBind(\n      document,\n      'pointermove',\n      this,\n      this.resizeMouseMove\n    );\n    this.workspace_.hideChaff();\n    // This event has been handled.  No need to bubble up to the document.\n    e.stopPropagation();\n  }\n\n  /**\n   * Resize this bubble to follow the pointer.\n   *\n   * @param e Pointer move event.\n   */\n  private resizeMouseMove(e: PointerEvent) {\n    this.autoLayout = false;\n    const newXY = this.workspace_.moveDrag(e);\n    this.setBubbleSize(this.workspace_.RTL ? -newXY.x : newXY.x, newXY.y);\n    if (this.workspace_.RTL) {\n      // RTL requires the bubble to move its left edge.\n      this.positionBubble();\n    }\n  }\n\n  /**\n   * Register a function as a callback event for when the bubble is resized.\n   *\n   * @param callback The function to call on resize.\n   */\n  registerResizeEvent(callback: () => void) {\n    this.resizeCallback = callback;\n  }\n\n  /**\n   * Register a function as a callback event for when the bubble is moved.\n   *\n   * @param callback The function to call on move.\n   */\n  registerMoveEvent(callback: () => void) {\n    this.moveCallback = callback;\n  }\n\n  /**\n   * Move this bubble to the top of the stack.\n   *\n   * @returns Whether or not the bubble has been moved.\n   * @internal\n   */\n  promote(): boolean {\n    const svgGroup = this.bubbleGroup?.parentNode;\n    if (svgGroup?.lastChild !== this.bubbleGroup && this.bubbleGroup) {\n      svgGroup?.appendChild(this.bubbleGroup);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Notification that the anchor has moved.\n   * Update the arrow and bubble accordingly.\n   *\n   * @param xy Absolute location.\n   */\n  setAnchorLocation(xy: Coordinate) {\n    this.anchorXY = xy;\n    if (this.rendered) {\n      this.positionBubble();\n    }\n  }\n\n  /** Position the bubble so that it does not fall off-screen. */\n  private layoutBubble() {\n    // Get the metrics in workspace units.\n    const viewMetrics = this.workspace_\n      .getMetricsManager()\n      .getViewMetrics(true);\n\n    const optimalLeft = this.getOptimalRelativeLeft(viewMetrics);\n    const optimalTop = this.getOptimalRelativeTop(viewMetrics);\n    const bbox = (this.shape_ as SVGGraphicsElement).getBBox();\n\n    const topPosition = {\n      x: optimalLeft,\n      y: (-this.height -\n        this.workspace_.getRenderer().getConstants()\n          .MIN_BLOCK_HEIGHT) as number,\n    };\n    const startPosition = {x: -this.width - 30, y: optimalTop};\n    const endPosition = {x: bbox.width, y: optimalTop};\n    const bottomPosition = {x: optimalLeft, y: bbox.height};\n\n    const closerPosition =\n      bbox.width < bbox.height ? endPosition : bottomPosition;\n    const fartherPosition =\n      bbox.width < bbox.height ? bottomPosition : endPosition;\n\n    const topPositionOverlap = this.getOverlap(topPosition, viewMetrics);\n    const startPositionOverlap = this.getOverlap(startPosition, viewMetrics);\n    const closerPositionOverlap = this.getOverlap(closerPosition, viewMetrics);\n    const fartherPositionOverlap = this.getOverlap(\n      fartherPosition,\n      viewMetrics\n    );\n\n    // Set the position to whichever position shows the most of the bubble,\n    // with tiebreaks going in the order: top > start > close > far.\n    const mostOverlap = Math.max(\n      topPositionOverlap,\n      startPositionOverlap,\n      closerPositionOverlap,\n      fartherPositionOverlap\n    );\n    if (topPositionOverlap === mostOverlap) {\n      this.relativeLeft = topPosition.x;\n      this.relativeTop = topPosition.y;\n      return;\n    }\n    if (startPositionOverlap === mostOverlap) {\n      this.relativeLeft = startPosition.x;\n      this.relativeTop = startPosition.y;\n      return;\n    }\n    if (closerPositionOverlap === mostOverlap) {\n      this.relativeLeft = closerPosition.x;\n      this.relativeTop = closerPosition.y;\n      return;\n    }\n    // TODO: I believe relativeLeft_ should actually be called relativeStart_\n    //  and then the math should be fixed to reflect this. (hopefully it'll\n    //  make it look simpler)\n    this.relativeLeft = fartherPosition.x;\n    this.relativeTop = fartherPosition.y;\n  }\n\n  /**\n   * Calculate the what percentage of the bubble overlaps with the visible\n   * workspace (what percentage of the bubble is visible).\n   *\n   * @param relativeMin The position of the top-left corner of the bubble\n   *     relative to the anchor point.\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The percentage of the bubble that is visible.\n   */\n  private getOverlap(\n    relativeMin: {x: number; y: number},\n    viewMetrics: ContainerRegion\n  ): number {\n    // The position of the top-left corner of the bubble in workspace units.\n    const bubbleMin = {\n      x: this.workspace_.RTL\n        ? this.anchorXY.x - relativeMin.x - this.width\n        : relativeMin.x + this.anchorXY.x,\n      y: relativeMin.y + this.anchorXY.y,\n    };\n    // The position of the bottom-right corner of the bubble in workspace units.\n    const bubbleMax = {\n      x: bubbleMin.x + this.width,\n      y: bubbleMin.y + this.height,\n    };\n\n    // We could adjust these values to account for the scrollbars, but the\n    // bubbles should have been adjusted to not collide with them anyway, so\n    // giving the workspace a slightly larger \"bounding box\" shouldn't affect\n    // the calculation.\n\n    // The position of the top-left corner of the workspace.\n    const workspaceMin = {x: viewMetrics.left, y: viewMetrics.top};\n    // The position of the bottom-right corner of the workspace.\n    const workspaceMax = {\n      x: viewMetrics.left + viewMetrics.width,\n      y: viewMetrics.top + viewMetrics.height,\n    };\n\n    const overlapWidth =\n      Math.min(bubbleMax.x, workspaceMax.x) -\n      Math.max(bubbleMin.x, workspaceMin.x);\n    const overlapHeight =\n      Math.min(bubbleMax.y, workspaceMax.y) -\n      Math.max(bubbleMin.y, workspaceMin.y);\n    return Math.max(\n      0,\n      Math.min(1, (overlapWidth * overlapHeight) / (this.width * this.height))\n    );\n  }\n\n  /**\n   * Calculate what the optimal horizontal position of the top-left corner of\n   * the bubble is (relative to the anchor point) so that the most area of the\n   * bubble is shown.\n   *\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The optimal horizontal position of the top-left corner of the\n   *     bubble.\n   */\n  private getOptimalRelativeLeft(viewMetrics: ContainerRegion): number {\n    let relativeLeft = -this.width / 4;\n\n    // No amount of sliding left or right will give us a better overlap.\n    if (this.width > viewMetrics.width) {\n      return relativeLeft;\n    }\n\n    if (this.workspace_.RTL) {\n      // Bubble coordinates are flipped in RTL.\n      const bubbleRight = this.anchorXY.x - relativeLeft;\n      const bubbleLeft = bubbleRight - this.width;\n\n      const workspaceRight = viewMetrics.left + viewMetrics.width;\n      const workspaceLeft =\n        viewMetrics.left +\n        // Thickness in workspace units.\n        Scrollbar.scrollbarThickness / this.workspace_.scale;\n\n      if (bubbleLeft < workspaceLeft) {\n        // Slide the bubble right until it is onscreen.\n        relativeLeft = -(workspaceLeft - this.anchorXY.x + this.width);\n      } else if (bubbleRight > workspaceRight) {\n        // Slide the bubble left until it is onscreen.\n        relativeLeft = -(workspaceRight - this.anchorXY.x);\n      }\n    } else {\n      const bubbleLeft = relativeLeft + this.anchorXY.x;\n      const bubbleRight = bubbleLeft + this.width;\n\n      const workspaceLeft = viewMetrics.left;\n      const workspaceRight =\n        viewMetrics.left +\n        viewMetrics.width -\n        // Thickness in workspace units.\n        Scrollbar.scrollbarThickness / this.workspace_.scale;\n\n      if (bubbleLeft < workspaceLeft) {\n        // Slide the bubble right until it is onscreen.\n        relativeLeft = workspaceLeft - this.anchorXY.x;\n      } else if (bubbleRight > workspaceRight) {\n        // Slide the bubble left until it is onscreen.\n        relativeLeft = workspaceRight - this.anchorXY.x - this.width;\n      }\n    }\n\n    return relativeLeft;\n  }\n\n  /**\n   * Calculate what the optimal vertical position of the top-left corner of\n   * the bubble is (relative to the anchor point) so that the most area of the\n   * bubble is shown.\n   *\n   * @param viewMetrics The view metrics of the workspace the bubble will appear\n   *     in.\n   * @returns The optimal vertical position of the top-left corner of the\n   *     bubble.\n   */\n  private getOptimalRelativeTop(viewMetrics: ContainerRegion): number {\n    let relativeTop = -this.height / 4;\n\n    // No amount of sliding up or down will give us a better overlap.\n    if (this.height > viewMetrics.height) {\n      return relativeTop;\n    }\n\n    const bubbleTop = this.anchorXY.y + relativeTop;\n    const bubbleBottom = bubbleTop + this.height;\n    const workspaceTop = viewMetrics.top;\n    const workspaceBottom =\n      viewMetrics.top +\n      viewMetrics.height - // Thickness in workspace units.\n      Scrollbar.scrollbarThickness / this.workspace_.scale;\n\n    const anchorY = this.anchorXY.y;\n    if (bubbleTop < workspaceTop) {\n      // Slide the bubble down until it is onscreen.\n      relativeTop = workspaceTop - anchorY;\n    } else if (bubbleBottom > workspaceBottom) {\n      // Slide the bubble up until it is onscreen.\n      relativeTop = workspaceBottom - anchorY - this.height;\n    }\n\n    return relativeTop;\n  }\n\n  /** Move the bubble to a location relative to the anchor's centre. */\n  private positionBubble() {\n    let left = this.anchorXY.x;\n    if (this.workspace_.RTL) {\n      left -= this.relativeLeft + this.width;\n    } else {\n      left += this.relativeLeft;\n    }\n    const top = this.relativeTop + this.anchorXY.y;\n    this.moveTo(left, top);\n  }\n\n  /**\n   * Move the bubble group to the specified location in workspace coordinates.\n   *\n   * @param x The x position to move to.\n   * @param y The y position to move to.\n   * @internal\n   */\n  moveTo(x: number, y: number) {\n    this.bubbleGroup?.setAttribute(\n      'transform',\n      'translate(' + x + ',' + y + ')'\n    );\n  }\n\n  /**\n   * Triggers a move callback if one exists at the end of a drag.\n   *\n   * @param adding True if adding, false if removing.\n   * @internal\n   */\n  setDragging(adding: boolean) {\n    if (!adding && this.moveCallback) {\n      this.moveCallback();\n    }\n  }\n\n  /**\n   * Get the dimensions of this bubble.\n   *\n   * @returns The height and width of the bubble.\n   */\n  getBubbleSize(): Size {\n    return new Size(this.width, this.height);\n  }\n\n  /**\n   * Size this bubble.\n   *\n   * @param width Width of the bubble.\n   * @param height Height of the bubble.\n   */\n  setBubbleSize(width: number, height: number) {\n    const doubleBorderWidth = 2 * Bubble.BORDER_WIDTH;\n    // Minimum size of a bubble.\n    width = Math.max(width, doubleBorderWidth + 45);\n    height = Math.max(height, doubleBorderWidth + 20);\n    this.width = width;\n    this.height = height;\n    this.bubbleBack?.setAttribute('width', `${width}`);\n    this.bubbleBack?.setAttribute('height', `${height}`);\n    if (this.resizeGroup) {\n      if (this.workspace_.RTL) {\n        // Mirror the resize group.\n        const resizeSize = 2 * Bubble.BORDER_WIDTH;\n        this.resizeGroup.setAttribute(\n          'transform',\n          'translate(' +\n            resizeSize +\n            ',' +\n            (height - doubleBorderWidth) +\n            ') scale(-1 1)'\n        );\n      } else {\n        this.resizeGroup.setAttribute(\n          'transform',\n          'translate(' +\n            (width - doubleBorderWidth) +\n            ',' +\n            (height - doubleBorderWidth) +\n            ')'\n        );\n      }\n    }\n    if (this.autoLayout) {\n      this.layoutBubble();\n    }\n    this.positionBubble();\n    this.renderArrow();\n\n    // Allow the contents to resize.\n    if (this.resizeCallback) {\n      this.resizeCallback();\n    }\n  }\n\n  /** Draw the arrow between the bubble and the origin. */\n  private renderArrow() {\n    const steps = [];\n    // Find the relative coordinates of the center of the bubble.\n    const relBubbleX = this.width / 2;\n    const relBubbleY = this.height / 2;\n    // Find the relative coordinates of the center of the anchor.\n    let relAnchorX = -this.relativeLeft;\n    let relAnchorY = -this.relativeTop;\n    if (relBubbleX === relAnchorX && relBubbleY === relAnchorY) {\n      // Null case.  Bubble is directly on top of the anchor.\n      // Short circuit this rather than wade through divide by zeros.\n      steps.push('M ' + relBubbleX + ',' + relBubbleY);\n    } else {\n      // Compute the angle of the arrow's line.\n      const rise = relAnchorY - relBubbleY;\n      let run = relAnchorX - relBubbleX;\n      if (this.workspace_.RTL) {\n        run *= -1;\n      }\n      const hypotenuse = Math.sqrt(rise * rise + run * run);\n      let angle = Math.acos(run / hypotenuse);\n      if (rise < 0) {\n        angle = 2 * Math.PI - angle;\n      }\n      // Compute a line perpendicular to the arrow.\n      let rightAngle = angle + Math.PI / 2;\n      if (rightAngle > Math.PI * 2) {\n        rightAngle -= Math.PI * 2;\n      }\n      const rightRise = Math.sin(rightAngle);\n      const rightRun = Math.cos(rightAngle);\n\n      // Calculate the thickness of the base of the arrow.\n      const bubbleSize = this.getBubbleSize();\n      let thickness =\n        (bubbleSize.width + bubbleSize.height) / Bubble.ARROW_THICKNESS;\n      thickness = Math.min(thickness, bubbleSize.width, bubbleSize.height) / 4;\n\n      // Back the tip of the arrow off of the anchor.\n      const backoffRatio = 1 - Bubble.ANCHOR_RADIUS / hypotenuse;\n      relAnchorX = relBubbleX + backoffRatio * run;\n      relAnchorY = relBubbleY + backoffRatio * rise;\n\n      // Coordinates for the base of the arrow.\n      const baseX1 = relBubbleX + thickness * rightRun;\n      const baseY1 = relBubbleY + thickness * rightRise;\n      const baseX2 = relBubbleX - thickness * rightRun;\n      const baseY2 = relBubbleY - thickness * rightRise;\n\n      // Distortion to curve the arrow.\n      let swirlAngle = angle + this.arrowRadians;\n      if (swirlAngle > Math.PI * 2) {\n        swirlAngle -= Math.PI * 2;\n      }\n      const swirlRise = (Math.sin(swirlAngle) * hypotenuse) / Bubble.ARROW_BEND;\n      const swirlRun = (Math.cos(swirlAngle) * hypotenuse) / Bubble.ARROW_BEND;\n\n      steps.push('M' + baseX1 + ',' + baseY1);\n      steps.push(\n        'C' +\n          (baseX1 + swirlRun) +\n          ',' +\n          (baseY1 + swirlRise) +\n          ' ' +\n          relAnchorX +\n          ',' +\n          relAnchorY +\n          ' ' +\n          relAnchorX +\n          ',' +\n          relAnchorY\n      );\n      steps.push(\n        'C' +\n          relAnchorX +\n          ',' +\n          relAnchorY +\n          ' ' +\n          (baseX2 + swirlRun) +\n          ',' +\n          (baseY2 + swirlRise) +\n          ' ' +\n          baseX2 +\n          ',' +\n          baseY2\n      );\n    }\n    steps.push('z');\n    this.bubbleArrow?.setAttribute('d', steps.join(' '));\n  }\n\n  /**\n   * Change the colour of a bubble.\n   *\n   * @param hexColour Hex code of colour.\n   */\n  setColour(hexColour: string) {\n    this.bubbleBack?.setAttribute('fill', hexColour);\n    this.bubbleArrow?.setAttribute('fill', hexColour);\n  }\n\n  /** Dispose of this bubble. */\n  dispose() {\n    if (this.onMouseDownBubbleWrapper) {\n      browserEvents.unbind(this.onMouseDownBubbleWrapper);\n    }\n    if (this.onMouseDownResizeWrapper) {\n      browserEvents.unbind(this.onMouseDownResizeWrapper);\n    }\n    Bubble.unbindDragEvents();\n    dom.removeNode(this.bubbleGroup);\n    this.disposed = true;\n  }\n\n  /**\n   * Move this bubble during a drag.\n   *\n   * @param newLoc The location to translate to, in workspace coordinates.\n   * @internal\n   */\n  moveDuringDrag(newLoc: Coordinate) {\n    this.moveTo(newLoc.x, newLoc.y);\n    if (this.workspace_.RTL) {\n      this.relativeLeft = this.anchorXY.x - newLoc.x - this.width;\n    } else {\n      this.relativeLeft = newLoc.x - this.anchorXY.x;\n    }\n    this.relativeTop = newLoc.y - this.anchorXY.y;\n    this.renderArrow();\n  }\n\n  /**\n   * Return the coordinates of the top-left corner of this bubble's body\n   * relative to the drawing surface's origin (0,0), in workspace units.\n   *\n   * @returns Object with .x and .y properties.\n   */\n  getRelativeToSurfaceXY(): Coordinate {\n    return new Coordinate(\n      this.workspace_.RTL\n        ? -this.relativeLeft + this.anchorXY.x - this.width\n        : this.anchorXY.x + this.relativeLeft,\n      this.anchorXY.y + this.relativeTop\n    );\n  }\n\n  /**\n   * Set whether auto-layout of this bubble is enabled.  The first time a bubble\n   * is shown it positions itself to not cover any blocks.  Once a user has\n   * dragged it to reposition, it renders where the user put it.\n   *\n   * @param enable True if auto-layout should be enabled, false otherwise.\n   * @internal\n   */\n  setAutoLayout(enable: boolean) {\n    this.autoLayout = enable;\n  }\n\n  /** Stop binding to the global mouseup and mousemove events. */\n  private static unbindDragEvents() {\n    if (Bubble.onMouseUpWrapper) {\n      browserEvents.unbind(Bubble.onMouseUpWrapper);\n      Bubble.onMouseUpWrapper = null;\n    }\n    if (Bubble.onMouseMoveWrapper) {\n      browserEvents.unbind(Bubble.onMouseMoveWrapper);\n      Bubble.onMouseMoveWrapper = null;\n    }\n  }\n\n  /**\n   * Handle a pointerup event while dragging a bubble's border or resize handle.\n   *\n   * @param _e Pointer up event.\n   */\n  private static bubbleMouseUp(_e: PointerEvent) {\n    Touch.clearTouchIdentifier();\n    Bubble.unbindDragEvents();\n  }\n\n  /**\n   * Create the text for a non editable bubble.\n   *\n   * @param text The text to display.\n   * @returns The top-level node of the text.\n   * @internal\n   */\n  static textToDom(text: string): SVGTextElement {\n    const paragraph = dom.createSvgElement(Svg.TEXT, {\n      'class': 'blocklyText blocklyBubbleText blocklyNoPointerEvents',\n      'y': Bubble.BORDER_WIDTH,\n    });\n    const lines = text.split('\\n');\n    for (let i = 0; i < lines.length; i++) {\n      const tspanElement = dom.createSvgElement(\n        Svg.TSPAN,\n        {'dy': '1em', 'x': Bubble.BORDER_WIDTH},\n        paragraph\n      );\n      const textNode = document.createTextNode(lines[i]);\n      tspanElement.appendChild(textNode);\n    }\n    return paragraph;\n  }\n\n  /**\n   * Creates a bubble that can not be edited.\n   *\n   * @param paragraphElement The text element for the non editable bubble.\n   * @param block The block that the bubble is attached to.\n   * @param iconXY The coordinate of the icon.\n   * @returns The non editable bubble.\n   * @internal\n   */\n  static createNonEditableBubble(\n    paragraphElement: SVGTextElement,\n    block: BlockSvg,\n    iconXY: Coordinate\n  ): Bubble {\n    const bubble = new Bubble(\n      block.workspace!,\n      paragraphElement,\n      block.pathObject.svgPath,\n      iconXY,\n      null,\n      null\n    );\n    // Expose this bubble's block's ID on its top-level SVG group.\n    bubble.setSvgId(block.id);\n    if (block.RTL) {\n      // Right-align the paragraph.\n      // This cannot be done until the bubble is rendered on screen.\n      const maxWidth = paragraphElement.getBBox().width;\n      for (\n        let i = 0, textElement;\n        (textElement = paragraphElement.childNodes[i] as SVGTSpanElement);\n        i++\n      ) {\n        textElement.setAttribute('text-anchor', 'end');\n        textElement.setAttribute('x', String(maxWidth + Bubble.BORDER_WIDTH));\n      }\n    }\n    return bubble;\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for dragging a bubble visually.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.BubbleDragger');\n\nimport {ComponentManager} from './component_manager.js';\nimport type {CommentMove} from './events/events_comment_move.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IBubble} from './interfaces/i_bubble.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a bubble dragger.  It moves things on the bubble canvas around the\n * workspace when they are being dragged by a mouse or touch.  These can be\n * block comments, mutators, warnings, or workspace comments.\n */\nexport class BubbleDragger {\n  /** Which drag target the mouse pointer is over, if any. */\n  private dragTarget_: IDragTarget | null = null;\n\n  /** Whether the bubble would be deleted if dropped immediately. */\n  private wouldDeleteBubble_ = false;\n  private readonly startXY_: Coordinate;\n\n  /**\n   * @param bubble The item on the bubble canvas to drag.\n   * @param workspace The workspace to drag on.\n   */\n  constructor(private bubble: IBubble, private workspace: WorkspaceSvg) {\n    /**\n     * The location of the top left corner of the dragging bubble's body at the\n     * beginning of the drag, in workspace coordinates.\n     */\n    this.startXY_ = this.bubble.getRelativeToSurfaceXY();\n  }\n\n  /**\n   * Start dragging a bubble.\n   *\n   * @internal\n   */\n  startBubbleDrag() {\n    if (!eventUtils.getGroup()) {\n      eventUtils.setGroup(true);\n    }\n\n    this.workspace.setResizesEnabled(false);\n    if ((this.bubble as AnyDuringMigration).setAutoLayout) {\n      (this.bubble as AnyDuringMigration).setAutoLayout(false);\n    }\n\n    this.bubble.setDragging && this.bubble.setDragging(true);\n  }\n\n  /**\n   * Execute a step of bubble dragging, based on the given event.  Update the\n   * display accordingly.\n   *\n   * @param e The most recent move event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   * @internal\n   */\n  dragBubble(e: PointerEvent, currentDragDeltaXY: Coordinate) {\n    const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n    const newLoc = Coordinate.sum(this.startXY_, delta);\n    this.bubble.moveDuringDrag(newLoc);\n\n    const oldDragTarget = this.dragTarget_;\n    this.dragTarget_ = this.workspace.getDragTarget(e);\n\n    const oldWouldDeleteBubble = this.wouldDeleteBubble_;\n    this.wouldDeleteBubble_ = this.shouldDelete_(this.dragTarget_);\n    if (oldWouldDeleteBubble !== this.wouldDeleteBubble_) {\n      // Prevent unnecessary add/remove class calls.\n      this.updateCursorDuringBubbleDrag_();\n    }\n    // Call drag enter/exit/over after wouldDeleteBlock is called in\n    // shouldDelete_\n    if (this.dragTarget_ !== oldDragTarget) {\n      oldDragTarget && oldDragTarget.onDragExit(this.bubble);\n      this.dragTarget_ && this.dragTarget_.onDragEnter(this.bubble);\n    }\n    this.dragTarget_ && this.dragTarget_.onDragOver(this.bubble);\n  }\n\n  /**\n   * Whether ending the drag would delete the bubble.\n   *\n   * @param dragTarget The drag target that the bubblee is currently over.\n   * @returns Whether dropping the bubble immediately would delete the block.\n   */\n  private shouldDelete_(dragTarget: IDragTarget | null): boolean {\n    if (dragTarget) {\n      const componentManager = this.workspace.getComponentManager();\n      const isDeleteArea = componentManager.hasCapability(\n        dragTarget.id,\n        ComponentManager.Capability.DELETE_AREA\n      );\n      if (isDeleteArea) {\n        return (dragTarget as IDeleteArea).wouldDelete(this.bubble, false);\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Update the cursor (and possibly the trash can lid) to reflect whether the\n   * dragging bubble would be deleted if released immediately.\n   */\n  private updateCursorDuringBubbleDrag_() {\n    this.bubble.setDeleteStyle(this.wouldDeleteBubble_);\n  }\n\n  /**\n   * Finish a bubble drag and put the bubble back on the workspace.\n   *\n   * @param e The pointerup event.\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel units.\n   * @internal\n   */\n  endBubbleDrag(e: PointerEvent, currentDragDeltaXY: Coordinate) {\n    // Make sure internal state is fresh.\n    this.dragBubble(e, currentDragDeltaXY);\n\n    const preventMove =\n      this.dragTarget_ && this.dragTarget_.shouldPreventMove(this.bubble);\n    let newLoc;\n    if (preventMove) {\n      newLoc = this.startXY_;\n    } else {\n      const delta = this.pixelsToWorkspaceUnits_(currentDragDeltaXY);\n      newLoc = Coordinate.sum(this.startXY_, delta);\n    }\n    // Move the bubble to its final location.\n    this.bubble.moveTo(newLoc.x, newLoc.y);\n\n    if (this.dragTarget_) {\n      this.dragTarget_.onDrop(this.bubble);\n    }\n\n    if (this.wouldDeleteBubble_) {\n      // Fire a move event, so we know where to go back to for an undo.\n      this.fireMoveEvent_();\n      this.bubble.dispose();\n    } else {\n      // Put everything back onto the bubble canvas.\n      if (this.bubble.setDragging) {\n        this.bubble.setDragging(false);\n      }\n      this.fireMoveEvent_();\n    }\n    this.workspace.setResizesEnabled(true);\n\n    eventUtils.setGroup(false);\n  }\n\n  /** Fire a move event at the end of a bubble drag. */\n  private fireMoveEvent_() {\n    if (this.bubble instanceof WorkspaceCommentSvg) {\n      const event = new (eventUtils.get(eventUtils.COMMENT_MOVE))(\n        this.bubble\n      ) as CommentMove;\n      event.setOldCoordinate(this.startXY_);\n      event.recordNew();\n      eventUtils.fire(event);\n    }\n    // TODO (fenichel): move events for comments.\n    return;\n  }\n\n  /**\n   * Convert a coordinate object from pixels to workspace units, including a\n   * correction for mutator workspaces.\n   * This function does not consider differing origins.  It simply scales the\n   * input's x and y values.\n   *\n   * @param pixelCoord A coordinate with x and y values in CSS pixel units.\n   * @returns The input coordinate divided by the workspace scale.\n   */\n  private pixelsToWorkspaceUnits_(pixelCoord: Coordinate): Coordinate {\n    const result = new Coordinate(\n      pixelCoord.x / this.workspace.scale,\n      pixelCoord.y / this.workspace.scale\n    );\n    if (this.workspace.isMutator) {\n      // If we're in a mutator, its scale is always 1, purely because of some\n      // oddities in our rendering optimizations.  The actual scale is the same\n      // as the scale on the parent workspace. Fix that for dragging.\n      const mainScale = this.workspace.options.parentWorkspace!.scale;\n      result.scale(1 / mainScale);\n    }\n    return result;\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An object that encapsulates logic for checking whether a\n * potential connection is safe and valid.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ConnectionChecker');\n\nimport * as common from './common.js';\nimport {Connection} from './connection.js';\nimport {ConnectionType} from './connection_type.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport * as internalConstants from './internal_constants.js';\nimport * as registry from './registry.js';\nimport type {RenderedConnection} from './rendered_connection.js';\n\n/**\n * Class for connection type checking logic.\n */\nexport class ConnectionChecker implements IConnectionChecker {\n  /**\n   * Check whether the current connection can connect with the target\n   * connection.\n   *\n   * @param a Connection to check compatibility with.\n   * @param b Connection to check compatibility with.\n   * @param isDragging True if the connection is being made by dragging a block.\n   * @param opt_distance The max allowable distance between the connections for\n   *     drag checks.\n   * @returns Whether the connection is legal.\n   */\n  canConnect(\n    a: Connection | null,\n    b: Connection | null,\n    isDragging: boolean,\n    opt_distance?: number\n  ): boolean {\n    return (\n      this.canConnectWithReason(a, b, isDragging, opt_distance) ===\n      Connection.CAN_CONNECT\n    );\n  }\n\n  /**\n   * Checks whether the current connection can connect with the target\n   * connection, and return an error code if there are problems.\n   *\n   * @param a Connection to check compatibility with.\n   * @param b Connection to check compatibility with.\n   * @param isDragging True if the connection is being made by dragging a block.\n   * @param opt_distance The max allowable distance between the connections for\n   *     drag checks.\n   * @returns Connection.CAN_CONNECT if the connection is legal, an error code\n   *     otherwise.\n   */\n  canConnectWithReason(\n    a: Connection | null,\n    b: Connection | null,\n    isDragging: boolean,\n    opt_distance?: number\n  ): number {\n    const safety = this.doSafetyChecks(a, b);\n    if (safety !== Connection.CAN_CONNECT) {\n      return safety;\n    }\n\n    // If the safety checks passed, both connections are non-null.\n    const connOne = a!;\n    const connTwo = b!;\n    if (!this.doTypeChecks(connOne, connTwo)) {\n      return Connection.REASON_CHECKS_FAILED;\n    }\n\n    if (\n      isDragging &&\n      !this.doDragChecks(\n        a as RenderedConnection,\n        b as RenderedConnection,\n        opt_distance || 0\n      )\n    ) {\n      return Connection.REASON_DRAG_CHECKS_FAILED;\n    }\n\n    return Connection.CAN_CONNECT;\n  }\n\n  /**\n   * Helper method that translates a connection error code into a string.\n   *\n   * @param errorCode The error code.\n   * @param a One of the two connections being checked.\n   * @param b The second of the two connections being checked.\n   * @returns A developer-readable error string.\n   */\n  getErrorMessage(\n    errorCode: number,\n    a: Connection | null,\n    b: Connection | null\n  ): string {\n    switch (errorCode) {\n      case Connection.REASON_SELF_CONNECTION:\n        return 'Attempted to connect a block to itself.';\n      case Connection.REASON_DIFFERENT_WORKSPACES:\n        // Usually this means one block has been deleted.\n        return 'Blocks not on same workspace.';\n      case Connection.REASON_WRONG_TYPE:\n        return 'Attempt to connect incompatible types.';\n      case Connection.REASON_TARGET_NULL:\n        return 'Target connection is null.';\n      case Connection.REASON_CHECKS_FAILED: {\n        const connOne = a!;\n        const connTwo = b!;\n        let msg = 'Connection checks failed. ';\n        msg +=\n          connOne +\n          ' expected ' +\n          connOne.getCheck() +\n          ', found ' +\n          connTwo.getCheck();\n        return msg;\n      }\n      case Connection.REASON_SHADOW_PARENT:\n        return 'Connecting non-shadow to shadow block.';\n      case Connection.REASON_DRAG_CHECKS_FAILED:\n        return 'Drag checks failed.';\n      case Connection.REASON_PREVIOUS_AND_OUTPUT:\n        return 'Block would have an output and a previous connection.';\n      default:\n        return 'Unknown connection failure: this should never happen!';\n    }\n  }\n\n  /**\n   * Check that connecting the given connections is safe, meaning that it would\n   * not break any of Blockly's basic assumptions (e.g. no self connections).\n   *\n   * @param a The first of the connections to check.\n   * @param b The second of the connections to check.\n   * @returns An enum with the reason this connection is safe or unsafe.\n   */\n  doSafetyChecks(a: Connection | null, b: Connection | null): number {\n    if (!a || !b) {\n      return Connection.REASON_TARGET_NULL;\n    }\n    let superiorBlock;\n    let inferiorBlock;\n    let superiorConnection;\n    let inferiorConnection;\n    if (a.isSuperior()) {\n      superiorBlock = a.getSourceBlock();\n      inferiorBlock = b.getSourceBlock();\n      superiorConnection = a;\n      inferiorConnection = b;\n    } else {\n      inferiorBlock = a.getSourceBlock();\n      superiorBlock = b.getSourceBlock();\n      inferiorConnection = a;\n      superiorConnection = b;\n    }\n    if (superiorBlock === inferiorBlock) {\n      return Connection.REASON_SELF_CONNECTION;\n    } else if (\n      inferiorConnection.type !==\n      internalConstants.OPPOSITE_TYPE[superiorConnection.type]\n    ) {\n      return Connection.REASON_WRONG_TYPE;\n    } else if (superiorBlock.workspace !== inferiorBlock.workspace) {\n      return Connection.REASON_DIFFERENT_WORKSPACES;\n    } else if (superiorBlock.isShadow() && !inferiorBlock.isShadow()) {\n      return Connection.REASON_SHADOW_PARENT;\n    } else if (\n      inferiorConnection.type === ConnectionType.OUTPUT_VALUE &&\n      inferiorBlock.previousConnection &&\n      inferiorBlock.previousConnection.isConnected()\n    ) {\n      return Connection.REASON_PREVIOUS_AND_OUTPUT;\n    } else if (\n      inferiorConnection.type === ConnectionType.PREVIOUS_STATEMENT &&\n      inferiorBlock.outputConnection &&\n      inferiorBlock.outputConnection.isConnected()\n    ) {\n      return Connection.REASON_PREVIOUS_AND_OUTPUT;\n    }\n    return Connection.CAN_CONNECT;\n  }\n\n  /**\n   * Check whether this connection is compatible with another connection with\n   * respect to the value type system.  E.g. square_root(\"Hello\") is not\n   * compatible.\n   *\n   * @param a Connection to compare.\n   * @param b Connection to compare against.\n   * @returns True if the connections share a type.\n   */\n  doTypeChecks(a: Connection, b: Connection): boolean {\n    const checkArrayOne = a.getCheck();\n    const checkArrayTwo = b.getCheck();\n\n    if (!checkArrayOne || !checkArrayTwo) {\n      // One or both sides are promiscuous enough that anything will fit.\n      return true;\n    }\n    // Find any intersection in the check lists.\n    for (let i = 0; i < checkArrayOne.length; i++) {\n      if (checkArrayTwo.indexOf(checkArrayOne[i]) !== -1) {\n        return true;\n      }\n    }\n    // No intersection.\n    return false;\n  }\n\n  /**\n   * Check whether this connection can be made by dragging.\n   *\n   * @param a Connection to compare (on the block that's being dragged).\n   * @param b Connection to compare against.\n   * @param distance The maximum allowable distance between connections.\n   * @returns True if the connection is allowed during a drag.\n   */\n  doDragChecks(\n    a: RenderedConnection,\n    b: RenderedConnection,\n    distance: number\n  ): boolean {\n    if (a.distanceFrom(b) > distance) {\n      return false;\n    }\n\n    // Don't consider insertion markers.\n    if (b.getSourceBlock().isInsertionMarker()) {\n      return false;\n    }\n\n    switch (b.type) {\n      case ConnectionType.PREVIOUS_STATEMENT:\n        return this.canConnectToPrevious_(a, b);\n      case ConnectionType.OUTPUT_VALUE: {\n        // Don't offer to connect an already connected left (male) value plug to\n        // an available right (female) value plug.\n        if (\n          (b.isConnected() && !b.targetBlock()!.isInsertionMarker()) ||\n          a.isConnected()\n        ) {\n          return false;\n        }\n        break;\n      }\n      case ConnectionType.INPUT_VALUE: {\n        // Offering to connect the left (male) of a value block to an already\n        // connected value pair is ok, we'll splice it in.\n        // However, don't offer to splice into an immovable block.\n        if (\n          b.isConnected() &&\n          !b.targetBlock()!.isMovable() &&\n          !b.targetBlock()!.isShadow()\n        ) {\n          return false;\n        }\n        break;\n      }\n      case ConnectionType.NEXT_STATEMENT: {\n        // Don't let a block with no next connection bump other blocks out of\n        // the stack.  But covering up a shadow block or stack of shadow blocks\n        // is fine.  Similarly, replacing a terminal statement with another\n        // terminal statement is allowed.\n        if (\n          b.isConnected() &&\n          !a.getSourceBlock().nextConnection &&\n          !b.targetBlock()!.isShadow() &&\n          b.targetBlock()!.nextConnection\n        ) {\n          return false;\n        }\n\n        // Don't offer to splice into a stack where the connected block is\n        // immovable, unless the block is a shadow block.\n        if (\n          b.targetBlock() &&\n          !b.targetBlock()!.isMovable() &&\n          !b.targetBlock()!.isShadow()\n        ) {\n          return false;\n        }\n        break;\n      }\n      default:\n        // Unexpected connection type.\n        return false;\n    }\n\n    // Don't let blocks try to connect to themselves or ones they nest.\n    if (common.draggingConnections.indexOf(b) !== -1) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Helper function for drag checking.\n   *\n   * @param a The connection to check, which must be a statement input or next\n   *     connection.\n   * @param b A nearby connection to check, which must be a previous connection.\n   * @returns True if the connection is allowed, false otherwise.\n   */\n  protected canConnectToPrevious_(a: Connection, b: Connection): boolean {\n    if (a.targetConnection) {\n      // This connection is already occupied.\n      // A next connection will never disconnect itself mid-drag.\n      return false;\n    }\n\n    // Don't let blocks try to connect to themselves or ones they nest.\n    if (common.draggingConnections.indexOf(b) !== -1) {\n      return false;\n    }\n\n    if (!b.targetConnection) {\n      return true;\n    }\n\n    const targetBlock = b.targetBlock();\n    // If it is connected to a real block, game over.\n    if (!targetBlock!.isInsertionMarker()) {\n      return false;\n    }\n    // If it's connected to an insertion marker but that insertion marker\n    // is the first block in a stack, it's still fine.  If that insertion\n    // marker is in the middle of a stack, it won't work.\n    return !targetBlock!.getPreviousBlock();\n  }\n}\n\nregistry.register(\n  registry.Type.CONNECTION_CHECKER,\n  registry.DEFAULT,\n  ConnectionChecker\n);\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A database of all the rendered connections that could\n *    possibly be connected to (i.e. not collapsed, etc).\n *    Sorted by y coordinate.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ConnectionDB');\n\nimport {ConnectionType} from './connection_type.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport type {RenderedConnection} from './rendered_connection.js';\nimport type {Coordinate} from './utils/coordinate.js';\n\n/**\n * Database of connections.\n * Connections are stored in order of their vertical component.  This way\n * connections in an area may be looked up quickly using a binary search.\n */\nexport class ConnectionDB {\n  /** Array of connections sorted by y position in workspace units. */\n  private readonly connections: RenderedConnection[] = [];\n\n  /**\n   * @param connectionChecker The workspace's connection type checker, used to\n   *     decide if connections are valid during a drag.\n   */\n  constructor(private readonly connectionChecker: IConnectionChecker) {}\n\n  /**\n   * Add a connection to the database. Should not already exist in the database.\n   *\n   * @param connection The connection to be added.\n   * @param yPos The y position used to decide where to insert the connection.\n   * @internal\n   */\n  addConnection(connection: RenderedConnection, yPos: number) {\n    const index = this.calculateIndexForYPos(yPos);\n    this.connections.splice(index, 0, connection);\n  }\n\n  /**\n   * Finds the index of the given connection.\n   *\n   * Starts by doing a binary search to find the approximate location, then\n   * linearly searches nearby for the exact connection.\n   *\n   * @param conn The connection to find.\n   * @param yPos The y position used to find the index of the connection.\n   * @returns The index of the connection, or -1 if the connection was not\n   *     found.\n   */\n  private findIndexOfConnection(\n    conn: RenderedConnection,\n    yPos: number\n  ): number {\n    if (!this.connections.length) {\n      return -1;\n    }\n\n    const bestGuess = this.calculateIndexForYPos(yPos);\n    if (bestGuess >= this.connections.length) {\n      // Not in list\n      return -1;\n    }\n\n    yPos = conn.y;\n    // Walk forward and back on the y axis looking for the connection.\n    let pointer = bestGuess;\n    while (pointer >= 0 && this.connections[pointer].y === yPos) {\n      if (this.connections[pointer] === conn) {\n        return pointer;\n      }\n      pointer--;\n    }\n\n    pointer = bestGuess;\n    while (\n      pointer < this.connections.length &&\n      this.connections[pointer].y === yPos\n    ) {\n      if (this.connections[pointer] === conn) {\n        return pointer;\n      }\n      pointer++;\n    }\n    return -1;\n  }\n\n  /**\n   * Finds the correct index for the given y position.\n   *\n   * @param yPos The y position used to decide where to insert the connection.\n   * @returns The candidate index.\n   */\n  private calculateIndexForYPos(yPos: number): number {\n    if (!this.connections.length) {\n      return 0;\n    }\n    let pointerMin = 0;\n    let pointerMax = this.connections.length;\n    while (pointerMin < pointerMax) {\n      const pointerMid = Math.floor((pointerMin + pointerMax) / 2);\n      if (this.connections[pointerMid].y < yPos) {\n        pointerMin = pointerMid + 1;\n      } else if (this.connections[pointerMid].y > yPos) {\n        pointerMax = pointerMid;\n      } else {\n        pointerMin = pointerMid;\n        break;\n      }\n    }\n    return pointerMin;\n  }\n\n  /**\n   * Remove a connection from the database.  Must already exist in DB.\n   *\n   * @param connection The connection to be removed.\n   * @param yPos The y position used to find the index of the connection.\n   * @throws {Error} If the connection cannot be found in the database.\n   */\n  removeConnection(connection: RenderedConnection, yPos: number) {\n    const index = this.findIndexOfConnection(connection, yPos);\n    if (index === -1) {\n      throw Error('Unable to find connection in connectionDB.');\n    }\n    this.connections.splice(index, 1);\n  }\n\n  /**\n   * Find all nearby connections to the given connection.\n   * Type checking does not apply, since this function is used for bumping.\n   *\n   * @param connection The connection whose neighbours should be returned.\n   * @param maxRadius The maximum radius to another connection.\n   * @returns List of connections.\n   */\n  getNeighbours(\n    connection: RenderedConnection,\n    maxRadius: number\n  ): RenderedConnection[] {\n    const db = this.connections;\n    const currentX = connection.x;\n    const currentY = connection.y;\n\n    // Binary search to find the closest y location.\n    let pointerMin = 0;\n    let pointerMax = db.length - 2;\n    let pointerMid = pointerMax;\n    while (pointerMin < pointerMid) {\n      if (db[pointerMid].y < currentY) {\n        pointerMin = pointerMid;\n      } else {\n        pointerMax = pointerMid;\n      }\n      pointerMid = Math.floor((pointerMin + pointerMax) / 2);\n    }\n\n    const neighbours: RenderedConnection[] = [];\n    /**\n     * Computes if the current connection is within the allowed radius of\n     * another connection. This function is a closure and has access to outside\n     * variables.\n     *\n     * @param yIndex The other connection's index in the database.\n     * @returns True if the current connection's vertical distance from the\n     *     other connection is less than the allowed radius.\n     */\n    function checkConnection(yIndex: number): boolean {\n      const dx = currentX - db[yIndex].x;\n      const dy = currentY - db[yIndex].y;\n      const r = Math.sqrt(dx * dx + dy * dy);\n      if (r <= maxRadius) {\n        neighbours.push(db[yIndex]);\n      }\n      return dy < maxRadius;\n    }\n\n    // Walk forward and back on the y axis looking for the closest x,y point.\n    pointerMin = pointerMid;\n    pointerMax = pointerMid;\n    if (db.length) {\n      while (pointerMin >= 0 && checkConnection(pointerMin)) {\n        pointerMin--;\n      }\n      do {\n        pointerMax++;\n      } while (pointerMax < db.length && checkConnection(pointerMax));\n    }\n\n    return neighbours;\n  }\n\n  /**\n   * Is the candidate connection close to the reference connection.\n   * Extremely fast; only looks at Y distance.\n   *\n   * @param index Index in database of candidate connection.\n   * @param baseY Reference connection's Y value.\n   * @param maxRadius The maximum radius to another connection.\n   * @returns True if connection is in range.\n   */\n  private isInYRange(index: number, baseY: number, maxRadius: number): boolean {\n    return Math.abs(this.connections[index].y - baseY) <= maxRadius;\n  }\n\n  /**\n   * Find the closest compatible connection to this connection.\n   *\n   * @param conn The connection searching for a compatible mate.\n   * @param maxRadius The maximum radius to another connection.\n   * @param dxy Offset between this connection's location in the database and\n   *     the current location (as a result of dragging).\n   * @returns Contains two properties: 'connection' which is either another\n   *     connection or null, and 'radius' which is the distance.\n   */\n  searchForClosest(\n    conn: RenderedConnection,\n    maxRadius: number,\n    dxy: Coordinate\n  ): {connection: RenderedConnection | null; radius: number} {\n    if (!this.connections.length) {\n      // Don't bother.\n      return {connection: null, radius: maxRadius};\n    }\n\n    // Stash the values of x and y from before the drag.\n    const baseY = conn.y;\n    const baseX = conn.x;\n\n    conn.x = baseX + dxy.x;\n    conn.y = baseY + dxy.y;\n\n    // calculateIndexForYPos_ finds an index for insertion, which is always\n    // after any block with the same y index.  We want to search both forward\n    // and back, so search on both sides of the index.\n    const closestIndex = this.calculateIndexForYPos(conn.y);\n\n    let bestConnection = null;\n    let bestRadius = maxRadius;\n    let temp;\n\n    // Walk forward and back on the y axis looking for the closest x,y point.\n    let pointerMin = closestIndex - 1;\n    while (pointerMin >= 0 && this.isInYRange(pointerMin, conn.y, maxRadius)) {\n      temp = this.connections[pointerMin];\n      if (this.connectionChecker.canConnect(conn, temp, true, bestRadius)) {\n        bestConnection = temp;\n        bestRadius = temp.distanceFrom(conn);\n      }\n      pointerMin--;\n    }\n\n    let pointerMax = closestIndex;\n    while (\n      pointerMax < this.connections.length &&\n      this.isInYRange(pointerMax, conn.y, maxRadius)\n    ) {\n      temp = this.connections[pointerMax];\n      if (this.connectionChecker.canConnect(conn, temp, true, bestRadius)) {\n        bestConnection = temp;\n        bestRadius = temp.distanceFrom(conn);\n      }\n      pointerMax++;\n    }\n\n    // Reset the values of x and y.\n    conn.x = baseX;\n    conn.y = baseY;\n    // If there were no valid connections, bestConnection will be null.\n    return {connection: bestConnection, radius: bestRadius};\n  }\n\n  /**\n   * Initialize a set of connection DBs for a workspace.\n   *\n   * @param checker The workspace's connection checker, used to decide if\n   *     connections are valid during a drag.\n   * @returns Array of databases.\n   */\n  static init(checker: IConnectionChecker): ConnectionDB[] {\n    // Create four databases, one for each connection type.\n    const dbList = [];\n    dbList[ConnectionType.INPUT_VALUE] = new ConnectionDB(checker);\n    dbList[ConnectionType.OUTPUT_VALUE] = new ConnectionDB(checker);\n    dbList[ConnectionType.NEXT_STATEMENT] = new ConnectionDB(checker);\n    dbList[ConnectionType.PREVIOUS_STATEMENT] = new ConnectionDB(checker);\n    return dbList;\n  }\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a block move event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BlockMove');\n\nimport type {Block} from '../block.js';\nimport {ConnectionType} from '../connection_type.js';\nimport * as registry from '../registry.js';\nimport {Coordinate} from '../utils/coordinate.js';\n\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\ninterface BlockLocation {\n  parentId?: string;\n  inputName?: string;\n  coordinate?: Coordinate;\n}\n\n/**\n * Notifies listeners when a block is moved. This could be from one\n * connection to another, or from one location on the workspace to another.\n */\nexport class BlockMove extends BlockBase {\n  override type = eventUtils.BLOCK_MOVE;\n\n  /** The ID of the old parent block. Undefined if it was a top-level block. */\n  oldParentId?: string;\n\n  /**\n   * The name of the old input. Undefined if it was a top-level block or the\n   * parent's next block.\n   */\n  oldInputName?: string;\n\n  /**\n   * The old X and Y workspace coordinates of the block if it was a top level\n   * block. Undefined if it was not a top level block.\n   */\n  oldCoordinate?: Coordinate;\n\n  /** The ID of the new parent block. Undefined if it is a top-level block. */\n  newParentId?: string;\n\n  /**\n   * The name of the new input. Undefined if it is a top-level block or the\n   * parent's next block.\n   */\n  newInputName?: string;\n\n  /**\n   * The new X and Y workspace coordinates of the block if it is a top-level\n   * block. Undefined if it is not a top level block.\n   */\n  newCoordinate?: Coordinate;\n\n  /**\n   * An explanation of what this move is for.  Known values include:\n   *  'drag' -- A drag operation completed.\n   *  'bump' -- Block got bumped away from an invalid connection.\n   *  'snap' -- Block got shifted to line up with the grid.\n   *  'inbounds' -- Block got pushed back into a non-scrolling workspace.\n   *  'connect' -- Block got connected to another block.\n   *  'disconnect' -- Block got disconnected from another block.\n   *  'create' -- Block created via XML.\n   *  'cleanup' -- Workspace aligned top-level blocks.\n   * Event merging may create multiple reasons: ['drag', 'bump', 'snap'].\n   */\n  reason?: string[];\n\n  /** @param opt_block The moved block.  Undefined for a blank event. */\n  constructor(opt_block?: Block) {\n    super(opt_block);\n\n    if (!opt_block) {\n      return;\n    }\n    // Blank event to be populated by fromJson.\n    if (opt_block.isShadow()) {\n      // Moving shadow blocks is handled via disconnection.\n      this.recordUndo = false;\n    }\n\n    const location = this.currentLocation_();\n    this.oldParentId = location.parentId;\n    this.oldInputName = location.inputName;\n    this.oldCoordinate = location.coordinate;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BlockMoveJson {\n    const json = super.toJson() as BlockMoveJson;\n    json['oldParentId'] = this.oldParentId;\n    json['oldInputName'] = this.oldInputName;\n    if (this.oldCoordinate) {\n      json['oldCoordinate'] =\n        `${Math.round(this.oldCoordinate.x)}, ` +\n        `${Math.round(this.oldCoordinate.y)}`;\n    }\n    json['newParentId'] = this.newParentId;\n    json['newInputName'] = this.newInputName;\n    if (this.newCoordinate) {\n      json['newCoordinate'] =\n        `${Math.round(this.newCoordinate.x)}, ` +\n        `${Math.round(this.newCoordinate.y)}`;\n    }\n    if (this.reason) {\n      json['reason'] = this.reason;\n    }\n    if (!this.recordUndo) {\n      json['recordUndo'] = this.recordUndo;\n    }\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BlockMove, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BlockMoveJson,\n    workspace: Workspace,\n    event?: any\n  ): BlockMove {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BlockMove()\n    ) as BlockMove;\n    newEvent.oldParentId = json['oldParentId'];\n    newEvent.oldInputName = json['oldInputName'];\n    if (json['oldCoordinate']) {\n      const xy = json['oldCoordinate'].split(',');\n      newEvent.oldCoordinate = new Coordinate(Number(xy[0]), Number(xy[1]));\n    }\n    newEvent.newParentId = json['newParentId'];\n    newEvent.newInputName = json['newInputName'];\n    if (json['newCoordinate']) {\n      const xy = json['newCoordinate'].split(',');\n      newEvent.newCoordinate = new Coordinate(Number(xy[0]), Number(xy[1]));\n    }\n    if (json['reason'] !== undefined) {\n      newEvent.reason = json['reason'];\n    }\n    if (json['recordUndo'] !== undefined) {\n      newEvent.recordUndo = json['recordUndo'];\n    }\n    return newEvent;\n  }\n\n  /** Record the block's new location.  Called after the move. */\n  recordNew() {\n    const location = this.currentLocation_();\n    this.newParentId = location.parentId;\n    this.newInputName = location.inputName;\n    this.newCoordinate = location.coordinate;\n  }\n\n  /**\n   * Set the reason for a move event.\n   *\n   * @param reason Why is this move happening?  'drag', 'bump', 'snap', ...\n   */\n  setReason(reason: string[]) {\n    this.reason = reason;\n  }\n\n  /**\n   * Returns the parentId and input if the block is connected,\n   *   or the XY location if disconnected.\n   *\n   * @returns Collection of location info.\n   */\n  private currentLocation_(): BlockLocation {\n    const workspace = this.getEventWorkspace_();\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      throw new Error(\n        'The block associated with the block move event ' + 'could not be found'\n      );\n    }\n    const location = {} as BlockLocation;\n    const parent = block.getParent();\n    if (parent) {\n      location.parentId = parent.id;\n      const input = parent.getInputWithBlock(block);\n      if (input) {\n        location.inputName = input.name;\n      }\n    } else {\n      location.coordinate = block.getRelativeToSurfaceXY();\n    }\n    return location;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return (\n      this.oldParentId === this.newParentId &&\n      this.oldInputName === this.newInputName &&\n      Coordinate.equals(this.oldCoordinate, this.newCoordinate)\n    );\n  }\n\n  /**\n   * Run a move event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.blockId) {\n      throw new Error(\n        'The block ID is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    const block = workspace.getBlockById(this.blockId);\n    if (!block) {\n      console.warn(\"Can't move non-existent block: \" + this.blockId);\n      return;\n    }\n    const parentId = forward ? this.newParentId : this.oldParentId;\n    const inputName = forward ? this.newInputName : this.oldInputName;\n    const coordinate = forward ? this.newCoordinate : this.oldCoordinate;\n    let parentBlock: Block | null;\n    if (parentId) {\n      parentBlock = workspace.getBlockById(parentId);\n      if (!parentBlock) {\n        console.warn(\"Can't connect to non-existent block: \" + parentId);\n        return;\n      }\n    }\n    if (block.getParent()) {\n      block.unplug();\n    }\n    if (coordinate) {\n      const xy = block.getRelativeToSurfaceXY();\n      block.moveBy(coordinate.x - xy.x, coordinate.y - xy.y, this.reason);\n    } else {\n      let blockConnection = block.outputConnection;\n      if (\n        !blockConnection ||\n        (block.previousConnection && block.previousConnection.isConnected())\n      ) {\n        blockConnection = block.previousConnection;\n      }\n      let parentConnection;\n      const connectionType = blockConnection?.type;\n      if (inputName) {\n        const input = parentBlock!.getInput(inputName);\n        if (input) {\n          parentConnection = input.connection;\n        }\n      } else if (connectionType === ConnectionType.PREVIOUS_STATEMENT) {\n        parentConnection = parentBlock!.nextConnection;\n      }\n      if (parentConnection && blockConnection) {\n        blockConnection.connect(parentConnection);\n      } else {\n        console.warn(\"Can't connect to non-existent input: \" + inputName);\n      }\n    }\n  }\n}\n\nexport interface BlockMoveJson extends BlockBaseJson {\n  oldParentId?: string;\n  oldInputName?: string;\n  oldCoordinate?: string;\n  newParentId?: string;\n  newInputName?: string;\n  newCoordinate?: string;\n  reason?: string[];\n  recordUndo?: boolean;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.MOVE, BlockMove);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of bubble open.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.BubbleOpen');\n\nimport type {AbstractEventJson} from './events_abstract.js';\nimport type {BlockSvg} from '../block_svg.js';\nimport * as registry from '../registry.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Class for a bubble open event.\n */\nexport class BubbleOpen extends UiBase {\n  /** The ID of the block the bubble is attached to. */\n  blockId?: string;\n\n  /** True if the bubble is opening, false if closing. */\n  isOpen?: boolean;\n\n  /** The type of bubble; one of 'mutator', 'comment', or 'warning'. */\n  bubbleType?: BubbleType;\n\n  override type = eventUtils.BUBBLE_OPEN;\n\n  /**\n   * @param opt_block The associated block. Undefined for a blank event.\n   * @param opt_isOpen Whether the bubble is opening (false if closing).\n   *     Undefined for a blank event.\n   * @param opt_bubbleType The type of bubble. One of 'mutator', 'comment' or\n   *     'warning'. Undefined for a blank event.\n   */\n  constructor(\n    opt_block?: BlockSvg,\n    opt_isOpen?: boolean,\n    opt_bubbleType?: BubbleType\n  ) {\n    const workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    super(workspaceId);\n    if (!opt_block) return;\n\n    this.blockId = opt_block.id;\n    this.isOpen = opt_isOpen;\n    this.bubbleType = opt_bubbleType;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): BubbleOpenJson {\n    const json = super.toJson() as BubbleOpenJson;\n    if (this.isOpen === undefined) {\n      throw new Error(\n        'Whether this event is for opening the bubble is undefined. ' +\n          'Either pass the value to the constructor, or call fromJson'\n      );\n    }\n    if (!this.bubbleType) {\n      throw new Error(\n        'The type of bubble is undefined. Either pass the ' +\n          'value to the constructor, or call fromJson'\n      );\n    }\n    json['isOpen'] = this.isOpen;\n    json['bubbleType'] = this.bubbleType;\n    json['blockId'] = this.blockId || '';\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of BubbleOpen, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: BubbleOpenJson,\n    workspace: Workspace,\n    event?: any\n  ): BubbleOpen {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new BubbleOpen()\n    ) as BubbleOpen;\n    newEvent.isOpen = json['isOpen'];\n    newEvent.bubbleType = json['bubbleType'];\n    newEvent.blockId = json['blockId'];\n    return newEvent;\n  }\n}\n\nexport enum BubbleType {\n  MUTATOR = 'mutator',\n  COMMENT = 'comment',\n  WARNING = 'warning',\n}\n\nexport interface BubbleOpenJson extends AbstractEventJson {\n  isOpen: boolean;\n  bubbleType: BubbleType;\n  blockId: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.BUBBLE_OPEN, BubbleOpen);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of UI click in Blockly's editor.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.Click');\n\nimport type {Block} from '../block.js';\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that ome blockly element was clicked.\n */\nexport class Click extends UiBase {\n  /** The ID of the block that was clicked, if a block was clicked. */\n  blockId?: string;\n\n  /**\n   * The type of element that was clicked; one of 'block', 'workspace',\n   * or 'zoom_controls'.\n   */\n  targetType?: ClickTarget;\n  override type = eventUtils.CLICK;\n\n  /**\n   * @param opt_block The affected block. Null for click events that do not have\n   *     an associated block (i.e. workspace click). Undefined for a blank\n   *     event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Not used if block is passed. Undefined for a blank event.\n   * @param opt_targetType The type of element targeted by this click event.\n   *     Undefined for a blank event.\n   */\n  constructor(\n    opt_block?: Block | null,\n    opt_workspaceId?: string | null,\n    opt_targetType?: ClickTarget\n  ) {\n    let workspaceId = opt_block ? opt_block.workspace.id : opt_workspaceId;\n    if (workspaceId === null) {\n      workspaceId = undefined;\n    }\n    super(workspaceId);\n\n    this.blockId = opt_block ? opt_block.id : undefined;\n    this.targetType = opt_targetType;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): ClickJson {\n    const json = super.toJson() as ClickJson;\n    if (!this.targetType) {\n      throw new Error(\n        'The click target type is undefined. Either pass a block to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['targetType'] = this.targetType;\n    json['blockId'] = this.blockId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of Click, but we can't specify that due to the fact that parameters to\n   *     static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(json: ClickJson, workspace: Workspace, event?: any): Click {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new Click()\n    ) as Click;\n    newEvent.targetType = json['targetType'];\n    newEvent.blockId = json['blockId'];\n    return newEvent;\n  }\n}\n\nexport enum ClickTarget {\n  BLOCK = 'block',\n  WORKSPACE = 'workspace',\n  ZOOM_CONTROLS = 'zoom_controls',\n}\n\nexport interface ClickJson extends AbstractEventJson {\n  targetType: ClickTarget;\n  blockId?: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.CLICK, Click);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Base class for comment events.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.CommentBase');\n\nimport * as utilsXml from '../utils/xml.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\nimport * as Xml from '../xml.js';\n\nimport {\n  Abstract as AbstractEvent,\n  AbstractEventJson,\n} from './events_abstract.js';\nimport type {CommentCreate} from './events_comment_create.js';\nimport type {CommentDelete} from './events_comment_delete.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Abstract class for a comment event.\n */\nexport class CommentBase extends AbstractEvent {\n  override isBlank = true;\n\n  /** The ID of the comment that this event references. */\n  commentId?: string;\n\n  /**\n   * @param opt_comment The comment this event corresponds to.  Undefined for a\n   *     blank event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super();\n    /** Whether or not an event is blank. */\n    this.isBlank = !opt_comment;\n\n    if (!opt_comment) return;\n\n    this.commentId = opt_comment.id;\n    this.workspaceId = opt_comment.workspace.id;\n    this.group = eventUtils.getGroup();\n    this.recordUndo = eventUtils.getRecordUndo();\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentBaseJson {\n    const json = super.toJson() as CommentBaseJson;\n    if (!this.commentId) {\n      throw new Error(\n        'The comment ID is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['commentId'] = this.commentId;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentBase, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentBaseJson,\n    workspace: Workspace,\n    event?: any\n  ): CommentBase {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentBase()\n    ) as CommentBase;\n    newEvent.commentId = json['commentId'];\n    return newEvent;\n  }\n\n  /**\n   * Helper function for Comment[Create|Delete]\n   *\n   * @param event The event to run.\n   * @param create if True then Create, if False then Delete\n   */\n  static CommentCreateDeleteHelper(\n    event: CommentCreate | CommentDelete,\n    create: boolean\n  ) {\n    const workspace = event.getEventWorkspace_();\n    if (create) {\n      const xmlElement = utilsXml.createElement('xml');\n      if (!event.xml) {\n        throw new Error('Ecountered a comment event without proper xml');\n      }\n      xmlElement.appendChild(event.xml);\n      Xml.domToWorkspace(xmlElement, workspace);\n    } else {\n      if (!event.commentId) {\n        throw new Error(\n          'The comment ID is undefined. Either pass a comment to ' +\n            'the constructor, or call fromJson'\n        );\n      }\n      const comment = workspace.getCommentById(event.commentId);\n      if (comment) {\n        comment.dispose();\n      } else {\n        // Only complain about root-level block.\n        console.warn(\"Can't uncreate non-existent comment: \" + event.commentId);\n      }\n    }\n  }\n}\n\nexport interface CommentBaseJson extends AbstractEventJson {\n  commentId: string;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment change event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.CommentChange');\n\nimport * as registry from '../registry.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\n\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that the contents of a workspace comment has changed.\n */\nexport class CommentChange extends CommentBase {\n  override type = eventUtils.COMMENT_CHANGE;\n\n  // TODO(#6774): We should remove underscores.\n  /** The previous contents of the comment. */\n  oldContents_?: string;\n\n  /** The new contents of the comment. */\n  newContents_?: string;\n\n  /**\n   * @param opt_comment The comment that is being changed.  Undefined for a\n   *     blank event.\n   * @param opt_oldContents Previous contents of the comment.\n   * @param opt_newContents New contents of the comment.\n   */\n  constructor(\n    opt_comment?: WorkspaceComment,\n    opt_oldContents?: string,\n    opt_newContents?: string\n  ) {\n    super(opt_comment);\n\n    if (!opt_comment) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    this.oldContents_ =\n      typeof opt_oldContents === 'undefined' ? '' : opt_oldContents;\n    this.newContents_ =\n      typeof opt_newContents === 'undefined' ? '' : opt_newContents;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentChangeJson {\n    const json = super.toJson() as CommentChangeJson;\n    if (!this.oldContents_) {\n      throw new Error(\n        'The old contents is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.newContents_) {\n      throw new Error(\n        'The new contents is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['oldContents'] = this.oldContents_;\n    json['newContents'] = this.newContents_;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentChange, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentChangeJson,\n    workspace: Workspace,\n    event?: any\n  ): CommentChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentChange()\n    ) as CommentChange;\n    newEvent.oldContents_ = json['oldContents'];\n    newEvent.newContents_ = json['newContents'];\n    return newEvent;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return this.oldContents_ === this.newContents_;\n  }\n\n  /**\n   * Run a change event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.commentId) {\n      throw new Error(\n        'The comment ID is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    const comment = workspace.getCommentById(this.commentId);\n    if (!comment) {\n      console.warn(\"Can't change non-existent comment: \" + this.commentId);\n      return;\n    }\n    const contents = forward ? this.newContents_ : this.oldContents_;\n    if (!contents) {\n      if (forward) {\n        throw new Error(\n          'The new contents is undefined. Either pass a value to ' +\n            'the constructor, or call fromJson'\n        );\n      }\n      throw new Error(\n        'The old contents is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    comment.setContent(contents);\n  }\n}\n\nexport interface CommentChangeJson extends CommentBaseJson {\n  oldContents: string;\n  newContents: string;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.COMMENT_CHANGE,\n  CommentChange\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment creation event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.CommentCreate');\n\nimport * as registry from '../registry.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\nimport * as utilsXml from '../utils/xml.js';\nimport * as Xml from '../xml.js';\n\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a workspace comment was created.\n */\nexport class CommentCreate extends CommentBase {\n  override type = eventUtils.COMMENT_CREATE;\n\n  /** The XML representation of the created workspace comment. */\n  xml?: Element | DocumentFragment;\n\n  /**\n   * @param opt_comment The created comment.\n   *     Undefined for a blank event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super(opt_comment);\n\n    if (!opt_comment) {\n      return;\n    }\n    // Blank event to be populated by fromJson.\n    this.xml = opt_comment.toXmlWithXY();\n  }\n\n  // TODO (#1266): \"Full\" and \"minimal\" serialization.\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentCreateJson {\n    const json = super.toJson() as CommentCreateJson;\n    if (!this.xml) {\n      throw new Error(\n        'The comment XML is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['xml'] = Xml.domToText(this.xml);\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentCreate, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentCreateJson,\n    workspace: Workspace,\n    event?: any\n  ): CommentCreate {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentCreate()\n    ) as CommentCreate;\n    newEvent.xml = utilsXml.textToDom(json['xml']);\n    return newEvent;\n  }\n\n  /**\n   * Run a creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    CommentBase.CommentCreateDeleteHelper(this, forward);\n  }\n}\n\nexport interface CommentCreateJson extends CommentBaseJson {\n  xml: string;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.COMMENT_CREATE,\n  CommentCreate\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment deletion event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.CommentDelete');\n\nimport * as registry from '../registry.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\n\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport * as utilsXml from '../utils/xml.js';\nimport * as Xml from '../xml.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a workspace comment has been deleted.\n */\nexport class CommentDelete extends CommentBase {\n  override type = eventUtils.COMMENT_DELETE;\n\n  /** The XML representation of the deleted workspace comment. */\n  xml?: Element;\n\n  /**\n   * @param opt_comment The deleted comment.\n   *     Undefined for a blank event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super(opt_comment);\n\n    if (!opt_comment) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    this.xml = opt_comment.toXmlWithXY();\n  }\n\n  /**\n   * Run a creation event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    CommentBase.CommentCreateDeleteHelper(this, !forward);\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentDeleteJson {\n    const json = super.toJson() as CommentDeleteJson;\n    if (!this.xml) {\n      throw new Error(\n        'The comment XML is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['xml'] = Xml.domToText(this.xml);\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentDelete, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentDeleteJson,\n    workspace: Workspace,\n    event?: any\n  ): CommentDelete {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentDelete()\n    ) as CommentDelete;\n    newEvent.xml = utilsXml.textToDom(json['xml']);\n    return newEvent;\n  }\n}\n\nexport interface CommentDeleteJson extends CommentBaseJson {\n  xml: string;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.COMMENT_DELETE,\n  CommentDelete\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for comment move event.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.CommentMove');\n\nimport * as registry from '../registry.js';\nimport {Coordinate} from '../utils/coordinate.js';\nimport type {WorkspaceComment} from '../workspace_comment.js';\n\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a workspace comment has moved.\n */\nexport class CommentMove extends CommentBase {\n  override type = eventUtils.COMMENT_MOVE;\n\n  /** The comment that is being moved. */\n  comment_?: WorkspaceComment;\n\n  // TODO(#6774): We should remove underscores.\n  /** The location of the comment before the move, in workspace coordinates. */\n  oldCoordinate_?: Coordinate;\n\n  /** The location of the comment after the move, in workspace coordinates. */\n  newCoordinate_?: Coordinate;\n\n  /**\n   * @param opt_comment The comment that is being moved.  Undefined for a blank\n   *     event.\n   */\n  constructor(opt_comment?: WorkspaceComment) {\n    super(opt_comment);\n\n    if (!opt_comment) {\n      return; // Blank event to be populated by fromJson.\n    }\n\n    this.comment_ = opt_comment;\n    this.oldCoordinate_ = opt_comment.getRelativeToSurfaceXY();\n  }\n\n  /**\n   * Record the comment's new location.  Called after the move.  Can only be\n   * called once.\n   */\n  recordNew() {\n    if (this.newCoordinate_) {\n      throw Error(\n        'Tried to record the new position of a comment on the ' +\n          'same event twice.'\n      );\n    }\n    if (!this.comment_) {\n      throw new Error(\n        'The comment is undefined. Pass a comment to ' +\n          'the constructor if you want to use the record functionality'\n      );\n    }\n    this.newCoordinate_ = this.comment_.getRelativeToSurfaceXY();\n  }\n\n  /**\n   * Override the location before the move.  Use this if you don't create the\n   * event until the end of the move, but you know the original location.\n   *\n   * @param xy The location before the move, in workspace coordinates.\n   */\n  setOldCoordinate(xy: Coordinate) {\n    this.oldCoordinate_ = xy;\n  }\n\n  // TODO (#1266): \"Full\" and \"minimal\" serialization.\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): CommentMoveJson {\n    const json = super.toJson() as CommentMoveJson;\n    if (!this.oldCoordinate_) {\n      throw new Error(\n        'The old comment position is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.newCoordinate_) {\n      throw new Error(\n        'The new comment position is undefined. Either call recordNew, or ' +\n          'call fromJson'\n      );\n    }\n    json['oldCoordinate'] =\n      `${Math.round(this.oldCoordinate_.x)}, ` +\n      `${Math.round(this.oldCoordinate_.y)}`;\n    json['newCoordinate'] =\n      Math.round(this.newCoordinate_.x) +\n      ',' +\n      Math.round(this.newCoordinate_.y);\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of CommentMove, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: CommentMoveJson,\n    workspace: Workspace,\n    event?: any\n  ): CommentMove {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new CommentMove()\n    ) as CommentMove;\n    let xy = json['oldCoordinate'].split(',');\n    newEvent.oldCoordinate_ = new Coordinate(Number(xy[0]), Number(xy[1]));\n    xy = json['newCoordinate'].split(',');\n    newEvent.newCoordinate_ = new Coordinate(Number(xy[0]), Number(xy[1]));\n    return newEvent;\n  }\n\n  /**\n   * Does this event record any change of state?\n   *\n   * @returns False if something changed.\n   */\n  override isNull(): boolean {\n    return Coordinate.equals(this.oldCoordinate_, this.newCoordinate_);\n  }\n\n  /**\n   * Run a move event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.commentId) {\n      throw new Error(\n        'The comment ID is undefined. Either pass a comment to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    const comment = workspace.getCommentById(this.commentId);\n    if (!comment) {\n      console.warn(\"Can't move non-existent comment: \" + this.commentId);\n      return;\n    }\n\n    const target = forward ? this.newCoordinate_ : this.oldCoordinate_;\n    if (!target) {\n      throw new Error(\n        'Either oldCoordinate_ or newCoordinate_ is undefined. ' +\n          'Either pass a comment to the constructor and call recordNew, ' +\n          'or call fromJson'\n      );\n    }\n    // TODO: Check if the comment is being dragged, and give up if so.\n    const current = comment.getRelativeToSurfaceXY();\n    comment.moveBy(target.x - current.x, target.y - current.y);\n  }\n}\n\nexport interface CommentMoveJson extends CommentBaseJson {\n  oldCoordinate: string;\n  newCoordinate: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.COMMENT_MOVE, CommentMove);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of a marker move.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.MarkerMove');\n\nimport type {Block} from '../block.js';\nimport {ASTNode} from '../keyboard_nav/ast_node.js';\nimport * as registry from '../registry.js';\nimport type {Workspace} from '../workspace.js';\nimport {AbstractEventJson} from './events_abstract.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\n\n/**\n * Notifies listeners that a marker (used for keyboard navigation) has\n * moved.\n */\nexport class MarkerMove extends UiBase {\n  /** The ID of the block the marker is now on, if any. */\n  blockId?: string;\n\n  /** The old node the marker used to be on, if any. */\n  oldNode?: ASTNode;\n\n  /** The new node the marker is now on. */\n  newNode?: ASTNode;\n\n  /**\n   * True if this is a cursor event, false otherwise.\n   * For information about cursors vs markers see {@link\n   * https://blocklycodelabs.dev/codelabs/keyboard-navigation/index.html?index=..%2F..index#1}.\n   */\n  isCursor?: boolean;\n\n  override type = eventUtils.MARKER_MOVE;\n\n  /**\n   * @param opt_block The affected block. Null if current node is of type\n   *     workspace. Undefined for a blank event.\n   * @param isCursor Whether this is a cursor event. Undefined for a blank\n   *     event.\n   * @param opt_oldNode The old node the marker used to be on.\n   *    Undefined for a blank event.\n   * @param opt_newNode The new node the marker is now on.\n   *    Undefined for a blank event.\n   */\n  constructor(\n    opt_block?: Block | null,\n    isCursor?: boolean,\n    opt_oldNode?: ASTNode | null,\n    opt_newNode?: ASTNode\n  ) {\n    let workspaceId = opt_block ? opt_block.workspace.id : undefined;\n    if (opt_newNode && opt_newNode.getType() === ASTNode.types.WORKSPACE) {\n      workspaceId = (opt_newNode.getLocation() as Workspace).id;\n    }\n    super(workspaceId);\n\n    this.blockId = opt_block?.id;\n    this.oldNode = opt_oldNode || undefined;\n    this.newNode = opt_newNode;\n    this.isCursor = isCursor;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): MarkerMoveJson {\n    const json = super.toJson() as MarkerMoveJson;\n    if (this.isCursor === undefined) {\n      throw new Error(\n        'Whether this is a cursor event or not is undefined. Either pass ' +\n          'a value to the constructor, or call fromJson'\n      );\n    }\n    if (!this.newNode) {\n      throw new Error(\n        'The new node is undefined. Either pass a node to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['isCursor'] = this.isCursor;\n    json['blockId'] = this.blockId;\n    json['oldNode'] = this.oldNode;\n    json['newNode'] = this.newNode;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of MarkerMove, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: MarkerMoveJson,\n    workspace: Workspace,\n    event?: any\n  ): MarkerMove {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new MarkerMove()\n    ) as MarkerMove;\n    newEvent.isCursor = json['isCursor'];\n    newEvent.blockId = json['blockId'];\n    newEvent.oldNode = json['oldNode'];\n    newEvent.newNode = json['newNode'];\n    return newEvent;\n  }\n}\n\nexport interface MarkerMoveJson extends AbstractEventJson {\n  isCursor: boolean;\n  blockId?: string;\n  oldNode?: ASTNode;\n  newNode: ASTNode;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.MARKER_MOVE, MarkerMove);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of a theme update.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.ThemeChange');\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that the workspace theme has changed.\n */\nexport class ThemeChange extends UiBase {\n  /** The name of the new theme that has been set. */\n  themeName?: string;\n\n  override type = eventUtils.THEME_CHANGE;\n\n  /**\n   * @param opt_themeName The theme name. Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    event. Undefined for a blank event.\n   */\n  constructor(opt_themeName?: string, opt_workspaceId?: string) {\n    super(opt_workspaceId);\n    this.themeName = opt_themeName;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): ThemeChangeJson {\n    const json = super.toJson() as ThemeChangeJson;\n    if (!this.themeName) {\n      throw new Error(\n        'The theme name is undefined. Either pass a theme name to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['themeName'] = this.themeName;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of ThemeChange, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: ThemeChangeJson,\n    workspace: Workspace,\n    event?: any\n  ): ThemeChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new ThemeChange()\n    ) as ThemeChange;\n    newEvent.themeName = json['themeName'];\n    return newEvent;\n  }\n}\n\nexport interface ThemeChangeJson extends AbstractEventJson {\n  themeName: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.THEME_CHANGE, ThemeChange);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of selecting an item on the toolbox.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.ToolboxItemSelect');\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a toolbox item has been selected.\n */\nexport class ToolboxItemSelect extends UiBase {\n  /** The previously selected toolbox item. */\n  oldItem?: string;\n\n  /** The newly selected toolbox item. */\n  newItem?: string;\n\n  override type = eventUtils.TOOLBOX_ITEM_SELECT;\n\n  /**\n   * @param opt_oldItem The previously selected toolbox item.\n   *     Undefined for a blank event.\n   * @param opt_newItem The newly selected toolbox item. Undefined for a blank\n   *     event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   */\n  constructor(\n    opt_oldItem?: string | null,\n    opt_newItem?: string | null,\n    opt_workspaceId?: string\n  ) {\n    super(opt_workspaceId);\n    this.oldItem = opt_oldItem ?? undefined;\n    this.newItem = opt_newItem ?? undefined;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): ToolboxItemSelectJson {\n    const json = super.toJson() as ToolboxItemSelectJson;\n    json['oldItem'] = this.oldItem;\n    json['newItem'] = this.newItem;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of ToolboxItemSelect, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: ToolboxItemSelectJson,\n    workspace: Workspace,\n    event?: any\n  ): ToolboxItemSelect {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new ToolboxItemSelect()\n    ) as ToolboxItemSelect;\n    newEvent.oldItem = json['oldItem'];\n    newEvent.newItem = json['newItem'];\n    return newEvent;\n  }\n}\n\nexport interface ToolboxItemSelectJson extends AbstractEventJson {\n  oldItem?: string;\n  newItem?: string;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.TOOLBOX_ITEM_SELECT,\n  ToolboxItemSelect\n);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of trashcan flyout open and close.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.TrashcanOpen');\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\n\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners when the trashcan is opening or closing.\n */\nexport class TrashcanOpen extends UiBase {\n  /**\n   * True if the trashcan is currently opening (previously closed).\n   * False if it is currently closing (previously open).\n   */\n  isOpen?: boolean;\n  override type = eventUtils.TRASHCAN_OPEN;\n\n  /**\n   * @param opt_isOpen Whether the trashcan flyout is opening (false if\n   *     opening). Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   */\n  constructor(opt_isOpen?: boolean, opt_workspaceId?: string) {\n    super(opt_workspaceId);\n    this.isOpen = opt_isOpen;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): TrashcanOpenJson {\n    const json = super.toJson() as TrashcanOpenJson;\n    if (this.isOpen === undefined) {\n      throw new Error(\n        'Whether this is already open or not is undefined. Either pass ' +\n          'a value to the constructor, or call fromJson'\n      );\n    }\n    json['isOpen'] = this.isOpen;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of TrashcanOpen, but we can't specify that due to the fact that\n   *     parameters to static methods in subclasses must be supertypes of\n   *     parameters to static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: TrashcanOpenJson,\n    workspace: Workspace,\n    event?: any\n  ): TrashcanOpen {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new TrashcanOpen()\n    ) as TrashcanOpen;\n    newEvent.isOpen = json['isOpen'];\n    return newEvent;\n  }\n}\n\nexport interface TrashcanOpenJson extends AbstractEventJson {\n  isOpen: boolean;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.TRASHCAN_OPEN, TrashcanOpen);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.VarDelete');\n\nimport * as registry from '../registry.js';\nimport type {VariableModel} from '../variable_model.js';\n\nimport {VarBase, VarBaseJson} from './events_var_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a variable model has been deleted.\n *\n * @class\n */\nexport class VarDelete extends VarBase {\n  override type = eventUtils.VAR_DELETE;\n  /** The type of the variable that was deleted. */\n  varType?: string;\n  /** The name of the variable that was deleted. */\n  varName?: string;\n\n  /**\n   * @param opt_variable The deleted variable. Undefined for a blank event.\n   */\n  constructor(opt_variable?: VariableModel) {\n    super(opt_variable);\n\n    if (!opt_variable) {\n      return; // Blank event to be populated by fromJson.\n    }\n    this.varType = opt_variable.type;\n    this.varName = opt_variable.name;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): VarDeleteJson {\n    const json = super.toJson() as VarDeleteJson;\n    if (this.varType === undefined) {\n      throw new Error(\n        'The var type is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.varName) {\n      throw new Error(\n        'The var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['varType'] = this.varType;\n    json['varName'] = this.varName;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of VarDelete, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: VarDeleteJson,\n    workspace: Workspace,\n    event?: any\n  ): VarDelete {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new VarDelete()\n    ) as VarDelete;\n    newEvent.varType = json['varType'];\n    newEvent.varName = json['varName'];\n    return newEvent;\n  }\n\n  /**\n   * Run a variable deletion event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.varId) {\n      throw new Error(\n        'The var ID is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.varName) {\n      throw new Error(\n        'The var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (forward) {\n      workspace.deleteVariableById(this.varId);\n    } else {\n      workspace.createVariable(this.varName, this.varType, this.varId);\n    }\n  }\n}\n\nexport interface VarDeleteJson extends VarBaseJson {\n  varType: string;\n  varName: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.VAR_DELETE, VarDelete);\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.VarRename');\n\nimport * as registry from '../registry.js';\nimport type {VariableModel} from '../variable_model.js';\n\nimport {VarBase, VarBaseJson} from './events_var_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that a variable model was renamed.\n *\n * @class\n */\nexport class VarRename extends VarBase {\n  override type = eventUtils.VAR_RENAME;\n\n  /** The previous name of the variable. */\n  oldName?: string;\n\n  /** The new name of the variable. */\n  newName?: string;\n\n  /**\n   * @param opt_variable The renamed variable. Undefined for a blank event.\n   * @param newName The new name the variable will be changed to.\n   */\n  constructor(opt_variable?: VariableModel, newName?: string) {\n    super(opt_variable);\n\n    if (!opt_variable) {\n      return; // Blank event to be populated by fromJson.\n    }\n    this.oldName = opt_variable.name;\n    this.newName = typeof newName === 'undefined' ? '' : newName;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): VarRenameJson {\n    const json = super.toJson() as VarRenameJson;\n    if (!this.oldName) {\n      throw new Error(\n        'The old var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.newName) {\n      throw new Error(\n        'The new var name is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['oldName'] = this.oldName;\n    json['newName'] = this.newName;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of VarRename, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: VarRenameJson,\n    workspace: Workspace,\n    event?: any\n  ): VarRename {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new VarRename()\n    ) as VarRename;\n    newEvent.oldName = json['oldName'];\n    newEvent.newName = json['newName'];\n    return newEvent;\n  }\n\n  /**\n   * Run a variable rename event.\n   *\n   * @param forward True if run forward, false if run backward (undo).\n   */\n  override run(forward: boolean) {\n    const workspace = this.getEventWorkspace_();\n    if (!this.varId) {\n      throw new Error(\n        'The var ID is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.oldName) {\n      throw new Error(\n        'The old var name is undefined. Either pass a variable to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (!this.newName) {\n      throw new Error(\n        'The new var name is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (forward) {\n      workspace.renameVariableById(this.varId, this.newName);\n    } else {\n      workspace.renameVariableById(this.varId, this.oldName);\n    }\n  }\n}\n\nexport interface VarRenameJson extends VarBaseJson {\n  oldName: string;\n  newName: string;\n}\n\nregistry.register(registry.Type.EVENT, eventUtils.VAR_RENAME, VarRename);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Events fired as a result of a viewport change.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events.ViewportChange');\n\nimport * as registry from '../registry.js';\nimport {AbstractEventJson} from './events_abstract.js';\nimport {UiBase} from './events_ui_base.js';\nimport * as eventUtils from './utils.js';\nimport type {Workspace} from '../workspace.js';\n\n/**\n * Notifies listeners that the workspace surface's position or scale has\n * changed.\n *\n * Does not notify when the workspace itself resizes.\n */\nexport class ViewportChange extends UiBase {\n  /**\n   * Top edge of the visible portion of the workspace, relative to the\n   * workspace origin.\n   */\n  viewTop?: number;\n\n  /**\n   * The left edge of the visible portion of the workspace, relative to\n   * the workspace origin.\n   */\n  viewLeft?: number;\n\n  /** The scale of the workpace. */\n  scale?: number;\n\n  /** The previous scale of the workspace. */\n  oldScale?: number;\n\n  override type = eventUtils.VIEWPORT_CHANGE;\n\n  /**\n   * @param opt_top Top-edge of the visible portion of the workspace, relative\n   *     to the workspace origin. Undefined for a blank event.\n   * @param opt_left Left-edge of the visible portion of the workspace relative\n   *     to the workspace origin. Undefined for a blank event.\n   * @param opt_scale The scale of the workspace. Undefined for a blank event.\n   * @param opt_workspaceId The workspace identifier for this event.\n   *    Undefined for a blank event.\n   * @param opt_oldScale The old scale of the workspace. Undefined for a blank\n   *     event.\n   */\n  constructor(\n    opt_top?: number,\n    opt_left?: number,\n    opt_scale?: number,\n    opt_workspaceId?: string,\n    opt_oldScale?: number\n  ) {\n    super(opt_workspaceId);\n\n    this.viewTop = opt_top;\n    this.viewLeft = opt_left;\n    this.scale = opt_scale;\n    this.oldScale = opt_oldScale;\n  }\n\n  /**\n   * Encode the event as JSON.\n   *\n   * @returns JSON representation.\n   */\n  override toJson(): ViewportChangeJson {\n    const json = super.toJson() as ViewportChangeJson;\n    if (this.viewTop === undefined) {\n      throw new Error(\n        'The view top is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (this.viewLeft === undefined) {\n      throw new Error(\n        'The view left is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (this.scale === undefined) {\n      throw new Error(\n        'The scale is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    if (this.oldScale === undefined) {\n      throw new Error(\n        'The old scale is undefined. Either pass a value to ' +\n          'the constructor, or call fromJson'\n      );\n    }\n    json['viewTop'] = this.viewTop;\n    json['viewLeft'] = this.viewLeft;\n    json['scale'] = this.scale;\n    json['oldScale'] = this.oldScale;\n    return json;\n  }\n\n  /**\n   * Deserializes the JSON event.\n   *\n   * @param event The event to append new properties to. Should be a subclass\n   *     of Viewport, but we can't specify that due to the fact that parameters\n   *     to static methods in subclasses must be supertypes of parameters to\n   *     static methods in superclasses.\n   * @internal\n   */\n  static fromJson(\n    json: ViewportChangeJson,\n    workspace: Workspace,\n    event?: any\n  ): ViewportChange {\n    const newEvent = super.fromJson(\n      json,\n      workspace,\n      event ?? new ViewportChange()\n    ) as ViewportChange;\n    newEvent.viewTop = json['viewTop'];\n    newEvent.viewLeft = json['viewLeft'];\n    newEvent.scale = json['scale'];\n    newEvent.oldScale = json['oldScale'];\n    return newEvent;\n  }\n}\n\nexport interface ViewportChangeJson extends AbstractEventJson {\n  viewTop: number;\n  viewLeft: number;\n  scale: number;\n  oldScale: number;\n}\n\nregistry.register(\n  registry.Type.EVENT,\n  eventUtils.VIEWPORT_CHANGE,\n  ViewportChange\n);\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Events');\n\nimport {Abstract, AbstractEventJson} from './events_abstract.js';\nimport {BlockBase, BlockBaseJson} from './events_block_base.js';\nimport {BlockChange, BlockChangeJson} from './events_block_change.js';\nimport {BlockCreate, BlockCreateJson} from './events_block_create.js';\nimport {BlockDelete, BlockDeleteJson} from './events_block_delete.js';\nimport {BlockDrag, BlockDragJson} from './events_block_drag.js';\nimport {BlockMove, BlockMoveJson} from './events_block_move.js';\nimport {BubbleOpen, BubbleOpenJson, BubbleType} from './events_bubble_open.js';\nimport {Click, ClickJson, ClickTarget} from './events_click.js';\nimport {CommentBase, CommentBaseJson} from './events_comment_base.js';\nimport {CommentChange, CommentChangeJson} from './events_comment_change.js';\nimport {CommentCreate, CommentCreateJson} from './events_comment_create.js';\nimport {CommentDelete} from './events_comment_delete.js';\nimport {CommentMove, CommentMoveJson} from './events_comment_move.js';\nimport {MarkerMove, MarkerMoveJson} from './events_marker_move.js';\nimport {Selected, SelectedJson} from './events_selected.js';\nimport {ThemeChange, ThemeChangeJson} from './events_theme_change.js';\nimport {\n  ToolboxItemSelect,\n  ToolboxItemSelectJson,\n} from './events_toolbox_item_select.js';\nimport {TrashcanOpen, TrashcanOpenJson} from './events_trashcan_open.js';\nimport {UiBase} from './events_ui_base.js';\nimport {VarBase, VarBaseJson} from './events_var_base.js';\nimport {VarCreate, VarCreateJson} from './events_var_create.js';\nimport {VarDelete, VarDeleteJson} from './events_var_delete.js';\nimport {VarRename, VarRenameJson} from './events_var_rename.js';\nimport {ViewportChange, ViewportChangeJson} from './events_viewport.js';\nimport * as eventUtils from './utils.js';\nimport {FinishedLoading} from './workspace_events.js';\n\n// Events.\nexport {Abstract};\nexport {AbstractEventJson};\nexport {BubbleOpen};\nexport {BubbleOpenJson};\nexport {BubbleType};\nexport {BlockBase};\nexport {BlockBaseJson};\nexport {BlockChange};\nexport {BlockChangeJson};\nexport {BlockCreate};\nexport {BlockCreateJson};\nexport {BlockDelete};\nexport {BlockDeleteJson};\nexport {BlockDrag};\nexport {BlockDragJson};\nexport {BlockMove};\nexport {BlockMoveJson};\nexport {Click};\nexport {ClickJson};\nexport {ClickTarget};\nexport {CommentBase};\nexport {CommentBaseJson};\nexport {CommentChange};\nexport {CommentChangeJson};\nexport {CommentCreate};\nexport {CommentCreateJson};\nexport {CommentDelete};\nexport {CommentMove};\nexport {CommentMoveJson};\nexport {FinishedLoading};\nexport {MarkerMove};\nexport {MarkerMoveJson};\nexport {Selected};\nexport {SelectedJson};\nexport {ThemeChange};\nexport {ThemeChangeJson};\nexport {ToolboxItemSelect};\nexport {ToolboxItemSelectJson};\nexport {TrashcanOpen};\nexport {TrashcanOpenJson};\nexport {UiBase};\nexport {VarBase};\nexport {VarBaseJson};\nexport {VarCreate};\nexport {VarCreateJson};\nexport {VarDelete};\nexport {VarDeleteJson};\nexport {VarRename};\nexport {VarRenameJson};\nexport {ViewportChange};\nexport {ViewportChangeJson};\n\n// Event types.\nexport const BLOCK_CHANGE = eventUtils.BLOCK_CHANGE;\nexport const BLOCK_CREATE = eventUtils.BLOCK_CREATE;\nexport const BLOCK_DELETE = eventUtils.BLOCK_DELETE;\nexport const BLOCK_DRAG = eventUtils.BLOCK_DRAG;\nexport const BLOCK_MOVE = eventUtils.BLOCK_MOVE;\nexport const BUBBLE_OPEN = eventUtils.BUBBLE_OPEN;\nexport type BumpEvent = eventUtils.BumpEvent;\nexport const BUMP_EVENTS = eventUtils.BUMP_EVENTS;\nexport const CHANGE = eventUtils.CHANGE;\nexport const CLICK = eventUtils.CLICK;\nexport const COMMENT_CHANGE = eventUtils.COMMENT_CHANGE;\nexport const COMMENT_CREATE = eventUtils.COMMENT_CREATE;\nexport const COMMENT_DELETE = eventUtils.COMMENT_DELETE;\nexport const COMMENT_MOVE = eventUtils.COMMENT_MOVE;\nexport const CREATE = eventUtils.CREATE;\nexport const DELETE = eventUtils.DELETE;\nexport const FINISHED_LOADING = eventUtils.FINISHED_LOADING;\nexport const MARKER_MOVE = eventUtils.MARKER_MOVE;\nexport const MOVE = eventUtils.MOVE;\nexport const SELECTED = eventUtils.SELECTED;\nexport const THEME_CHANGE = eventUtils.THEME_CHANGE;\nexport const TOOLBOX_ITEM_SELECT = eventUtils.TOOLBOX_ITEM_SELECT;\nexport const TRASHCAN_OPEN = eventUtils.TRASHCAN_OPEN;\nexport const UI = eventUtils.UI;\nexport const VAR_CREATE = eventUtils.VAR_CREATE;\nexport const VAR_DELETE = eventUtils.VAR_DELETE;\nexport const VAR_RENAME = eventUtils.VAR_RENAME;\nexport const VIEWPORT_CHANGE = eventUtils.VIEWPORT_CHANGE;\n\n// Event utils.\nexport const clearPendingUndo = eventUtils.clearPendingUndo;\nexport const disable = eventUtils.disable;\nexport const enable = eventUtils.enable;\nexport const filter = eventUtils.filter;\nexport const fire = eventUtils.fire;\nexport const fromJson = eventUtils.fromJson;\nexport const getDescendantIds = eventUtils.getDescendantIds;\nexport const get = eventUtils.get;\nexport const getGroup = eventUtils.getGroup;\nexport const getRecordUndo = eventUtils.getRecordUndo;\nexport const isEnabled = eventUtils.isEnabled;\nexport const setGroup = eventUtils.setGroup;\nexport const setRecordUndo = eventUtils.setRecordUndo;\nexport const disableOrphans = eventUtils.disableOrphans;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.ConstantProvider');\n\nimport {ConnectionType} from '../../connection_type.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {Theme} from '../../theme.js';\nimport * as utilsColour from '../../utils/colour.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\nimport type {Shape} from '../common/constants.js';\n\n/** An object containing sizing and path information about inside corners. */\nexport interface InsideCorners {\n  width: number;\n  height: number;\n  pathTop: string;\n  pathBottom: string;\n  rightWidth: number;\n  rightHeight: number;\n  pathTopRight: string;\n  pathBottomRight: string;\n}\n\n/**\n * An object that provides constants for rendering blocks in Zelos mode.\n */\nexport class ConstantProvider extends BaseConstantProvider {\n  GRID_UNIT = 4;\n  STATEMENT_INPUT_SPACER_MIN_WIDTH: number;\n\n  override CURSOR_COLOUR = '#ffa200';\n\n  /**\n   * Radius of the cursor for input and output connections.\n   */\n  CURSOR_RADIUS = 5;\n\n  override JAGGED_TEETH_HEIGHT = 0;\n\n  override JAGGED_TEETH_WIDTH = 0;\n  override START_HAT_HEIGHT = 22;\n\n  override START_HAT_WIDTH = 96;\n\n  override SHAPES = {HEXAGONAL: 1, ROUND: 2, SQUARE: 3, PUZZLE: 4, NOTCH: 5};\n\n  /**\n   * Map of output/input shapes and the amount they should cause a block to be\n   * padded. Outer key is the outer shape, inner key is the inner shape.\n   * When a block with the outer shape contains an input block with the inner\n   * shape on its left or right edge, the block elements are aligned such that\n   * the padding specified is reached.\n   */\n  SHAPE_IN_SHAPE_PADDING: {[key: number]: {[key: number]: number}} = {\n    1: {\n      // Outer shape: hexagon.\n      0: 5 * this.GRID_UNIT, // Field in hexagon.\n      1: 2 * this.GRID_UNIT, // Hexagon in hexagon.\n      2: 5 * this.GRID_UNIT, // Round in hexagon.\n      3: 5 * this.GRID_UNIT, // Square in hexagon.\n    },\n    2: {\n      // Outer shape: round.\n      0: 3 * this.GRID_UNIT, // Field in round.\n      1: 3 * this.GRID_UNIT, // Hexagon in round.\n      2: 1 * this.GRID_UNIT, // Round in round.\n      3: 2 * this.GRID_UNIT, // Square in round.\n    },\n    3: {\n      // Outer shape: square.\n      0: 2 * this.GRID_UNIT, // Field in square.\n      1: 2 * this.GRID_UNIT, // Hexagon in square.\n      2: 2 * this.GRID_UNIT, // Round in square.\n      3: 2 * this.GRID_UNIT, // Square in square.\n    },\n  };\n\n  override FULL_BLOCK_FIELDS = true;\n\n  override FIELD_TEXT_FONTWEIGHT = 'bold';\n\n  override FIELD_TEXT_FONTFAMILY =\n    '\"Helvetica Neue\", \"Segoe UI\", Helvetica, sans-serif';\n\n  override FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW = true;\n\n  override FIELD_DROPDOWN_COLOURED_DIV = true;\n\n  override FIELD_DROPDOWN_SVG_ARROW = true;\n  override FIELD_TEXTINPUT_BOX_SHADOW = true;\n\n  override FIELD_COLOUR_FULL_BLOCK = true;\n  MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH: number;\n\n  /** The selected glow colour. */\n  SELECTED_GLOW_COLOUR = '#fff200';\n\n  /** The size of the selected glow. */\n  SELECTED_GLOW_SIZE = 0.5;\n\n  /** The replacement glow colour. */\n  REPLACEMENT_GLOW_COLOUR = '#fff200';\n\n  /** The size of the selected glow. */\n  REPLACEMENT_GLOW_SIZE = 2;\n\n  /**\n   * The ID of the selected glow filter, or the empty string if no filter is\n   * set.\n   */\n  selectedGlowFilterId = '';\n\n  /**\n   * The <filter> element to use for a selected glow, or null if not set.\n   */\n  private selectedGlowFilter: SVGElement | null = null;\n\n  /**\n   * The ID of the replacement glow filter, or the empty string if no filter\n   * is set.\n   */\n  replacementGlowFilterId = '';\n\n  /**\n   * The <filter> element to use for a replacement glow, or null if not set.\n   */\n  private replacementGlowFilter: SVGElement | null = null;\n\n  /**\n   * The object containing information about the hexagon used for a boolean\n   * reporter block. Null before init is called.\n   */\n  HEXAGONAL: Shape | null = null;\n\n  /**\n   * The object containing information about the hexagon used for a number or\n   * string reporter block. Null before init is called.\n   */\n  ROUNDED: Shape | null = null;\n\n  /**\n   * The object containing information about the hexagon used for a\n   * rectangular reporter block. Null before init is called.\n   */\n  SQUARED: Shape | null = null;\n\n  constructor() {\n    super();\n\n    this.SMALL_PADDING = this.GRID_UNIT;\n\n    this.MEDIUM_PADDING = 2 * this.GRID_UNIT;\n\n    this.MEDIUM_LARGE_PADDING = 3 * this.GRID_UNIT;\n\n    this.LARGE_PADDING = 4 * this.GRID_UNIT;\n\n    this.CORNER_RADIUS = 1 * this.GRID_UNIT;\n\n    this.NOTCH_WIDTH = 9 * this.GRID_UNIT;\n\n    this.NOTCH_HEIGHT = 2 * this.GRID_UNIT;\n\n    this.NOTCH_OFFSET_LEFT = 3 * this.GRID_UNIT;\n\n    this.STATEMENT_INPUT_NOTCH_OFFSET = this.NOTCH_OFFSET_LEFT;\n\n    this.MIN_BLOCK_WIDTH = 2 * this.GRID_UNIT;\n\n    this.MIN_BLOCK_HEIGHT = 12 * this.GRID_UNIT;\n\n    this.EMPTY_STATEMENT_INPUT_HEIGHT = 6 * this.GRID_UNIT;\n\n    this.TOP_ROW_MIN_HEIGHT = this.CORNER_RADIUS;\n\n    this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT = this.LARGE_PADDING;\n\n    this.BOTTOM_ROW_MIN_HEIGHT = this.CORNER_RADIUS;\n\n    this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT = 6 * this.GRID_UNIT;\n\n    this.STATEMENT_BOTTOM_SPACER = -this.NOTCH_HEIGHT;\n\n    /** Minimum statement input spacer width. */\n    this.STATEMENT_INPUT_SPACER_MIN_WIDTH = 40 * this.GRID_UNIT;\n\n    this.STATEMENT_INPUT_PADDING_LEFT = 4 * this.GRID_UNIT;\n\n    this.EMPTY_INLINE_INPUT_PADDING = 4 * this.GRID_UNIT;\n\n    this.EMPTY_INLINE_INPUT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.DUMMY_INPUT_MIN_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.DUMMY_INPUT_SHADOW_MIN_HEIGHT = 6 * this.GRID_UNIT;\n\n    this.CURSOR_WS_WIDTH = 20 * this.GRID_UNIT;\n\n    this.FIELD_TEXT_FONTSIZE = 3 * this.GRID_UNIT;\n\n    this.FIELD_BORDER_RECT_RADIUS = this.CORNER_RADIUS;\n\n    this.FIELD_BORDER_RECT_X_PADDING = 2 * this.GRID_UNIT;\n\n    this.FIELD_BORDER_RECT_Y_PADDING = 1.625 * this.GRID_UNIT;\n\n    this.FIELD_BORDER_RECT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT = 8 * this.GRID_UNIT;\n\n    this.FIELD_DROPDOWN_SVG_ARROW_PADDING = this.FIELD_BORDER_RECT_X_PADDING;\n\n    this.FIELD_COLOUR_DEFAULT_WIDTH = 2 * this.GRID_UNIT;\n\n    this.FIELD_COLOUR_DEFAULT_HEIGHT = 4 * this.GRID_UNIT;\n\n    this.FIELD_CHECKBOX_X_OFFSET = 1 * this.GRID_UNIT;\n\n    /** The maximum width of a dynamic connection shape. */\n    this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH = 12 * this.GRID_UNIT;\n  }\n\n  override setFontConstants_(theme: Theme) {\n    super.setFontConstants_(theme);\n\n    this.FIELD_BORDER_RECT_HEIGHT =\n      this.FIELD_TEXT_HEIGHT + this.FIELD_BORDER_RECT_Y_PADDING * 2;\n    this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT = this.FIELD_BORDER_RECT_HEIGHT;\n  }\n\n  override init() {\n    super.init();\n    this.HEXAGONAL = this.makeHexagonal();\n    this.ROUNDED = this.makeRounded();\n    this.SQUARED = this.makeSquared();\n\n    this.STATEMENT_INPUT_NOTCH_OFFSET =\n      this.NOTCH_OFFSET_LEFT +\n      (this.INSIDE_CORNERS as InsideCorners).rightWidth;\n  }\n\n  override setDynamicProperties_(theme: Theme) {\n    super.setDynamicProperties_(theme);\n\n    this.SELECTED_GLOW_COLOUR =\n      theme.getComponentStyle('selectedGlowColour') ||\n      this.SELECTED_GLOW_COLOUR;\n    const selectedGlowSize = Number(\n      theme.getComponentStyle('selectedGlowSize')\n    );\n    this.SELECTED_GLOW_SIZE =\n      selectedGlowSize && !isNaN(selectedGlowSize)\n        ? selectedGlowSize\n        : this.SELECTED_GLOW_SIZE;\n    this.REPLACEMENT_GLOW_COLOUR =\n      theme.getComponentStyle('replacementGlowColour') ||\n      this.REPLACEMENT_GLOW_COLOUR;\n    const replacementGlowSize = Number(\n      theme.getComponentStyle('replacementGlowSize')\n    );\n    this.REPLACEMENT_GLOW_SIZE =\n      replacementGlowSize && !isNaN(replacementGlowSize)\n        ? replacementGlowSize\n        : this.REPLACEMENT_GLOW_SIZE;\n  }\n\n  override dispose() {\n    super.dispose();\n    if (this.selectedGlowFilter) {\n      dom.removeNode(this.selectedGlowFilter);\n    }\n    if (this.replacementGlowFilter) {\n      dom.removeNode(this.replacementGlowFilter);\n    }\n  }\n\n  override makeStartHat() {\n    const height = this.START_HAT_HEIGHT;\n    const width = this.START_HAT_WIDTH;\n\n    const mainPath = svgPaths.curve('c', [\n      svgPaths.point(25, -height),\n      svgPaths.point(71, -height),\n      svgPaths.point(width, 0),\n    ]);\n    return {height, width, path: mainPath};\n  }\n\n  /**\n   * Create sizing and path information about a hexagonal shape.\n   *\n   * @returns An object containing sizing and path information about a hexagonal\n   *     shape for connections.\n   */\n  protected makeHexagonal(): Shape {\n    const maxWidth = this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;\n\n    /**\n     * Make the main path for the hexagonal connection shape out of two lines.\n     * The lines are defined with relative positions and require the block\n     * height. The 'up' and 'down' versions of the paths are the same, but the Y\n     * sign flips.  The 'left' and 'right' versions of the path are also the\n     * same, but the X sign flips.\n     *\n     * @param height The height of the block the connection is on.\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @param right True if the path is for the right side of the block.\n     * @returns A path fragment describing a rounded connection.\n     */\n    function makeMainPath(height: number, up: boolean, right: boolean): string {\n      const halfHeight = height / 2;\n      const width = halfHeight > maxWidth ? maxWidth : halfHeight;\n      const forward = up ? -1 : 1;\n      const direction = right ? -1 : 1;\n      const dy = (forward * height) / 2;\n      return (\n        svgPaths.lineTo(-direction * width, dy) +\n        svgPaths.lineTo(direction * width, dy)\n      );\n    }\n\n    return {\n      type: this.SHAPES.HEXAGONAL,\n      isDynamic: true,\n      width(height: number): number {\n        const halfHeight = height / 2;\n        return halfHeight > maxWidth ? maxWidth : halfHeight;\n      },\n      height(height: number): number {\n        return height;\n      },\n      connectionOffsetY(connectionHeight: number): number {\n        return connectionHeight / 2;\n      },\n      connectionOffsetX(connectionWidth: number): number {\n        return -connectionWidth;\n      },\n      pathDown(height: number): string {\n        return makeMainPath(height, false, false);\n      },\n      pathUp(height: number): string {\n        return makeMainPath(height, true, false);\n      },\n      pathRightDown(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n      pathRightUp(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n    };\n  }\n\n  /**\n   * Create sizing and path information about a rounded shape.\n   *\n   * @returns An object containing sizing and path information about a rounded\n   *     shape for connections.\n   */\n  protected makeRounded(): Shape {\n    const maxWidth = this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;\n    const maxHeight = maxWidth * 2;\n\n    /**\n     * Make the main path for the rounded connection shape out of two arcs and\n     * a line that joins them.  The arcs are defined with relative positions.\n     * Usually, the height of the block is split between the two arcs. In the\n     * case where the height of the block exceeds the maximum height, a line is\n     * drawn in between the two arcs. The 'up' and 'down' versions of the paths\n     * are the same, but the Y sign flips.  The 'up' and 'right' versions of the\n     * path flip the sweep-flag which moves the arc at negative angles.\n     *\n     * @param blockHeight The height of the block the connection is on.\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @param right True if the path is for the right side of the block.\n     * @returns A path fragment describing a rounded connection.\n     */\n    function makeMainPath(\n      blockHeight: number,\n      up: boolean,\n      right: boolean\n    ): string {\n      const remainingHeight =\n        blockHeight > maxHeight ? blockHeight - maxHeight : 0;\n      const height = blockHeight > maxHeight ? maxHeight : blockHeight;\n      const radius = height / 2;\n      return (\n        svgPaths.arc(\n          'a',\n          '0 0,1',\n          radius,\n          svgPaths.point((up ? -1 : 1) * radius, (up ? -1 : 1) * radius)\n        ) +\n        svgPaths.lineOnAxis('v', (right ? 1 : -1) * remainingHeight) +\n        svgPaths.arc(\n          'a',\n          '0 0,1',\n          radius,\n          svgPaths.point((up ? 1 : -1) * radius, (up ? -1 : 1) * radius)\n        )\n      );\n    }\n\n    return {\n      type: this.SHAPES.ROUND,\n      isDynamic: true,\n      width(height: number): number {\n        const halfHeight = height / 2;\n        return halfHeight > maxWidth ? maxWidth : halfHeight;\n      },\n      height(height: number): number {\n        return height;\n      },\n      connectionOffsetY(connectionHeight: number): number {\n        return connectionHeight / 2;\n      },\n      connectionOffsetX(connectionWidth: number): number {\n        return -connectionWidth;\n      },\n      pathDown(height: number): string {\n        return makeMainPath(height, false, false);\n      },\n      pathUp(height: number): string {\n        return makeMainPath(height, true, false);\n      },\n      pathRightDown(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n      pathRightUp(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n    };\n  }\n\n  /**\n   * Create sizing and path information about a squared shape.\n   *\n   * @returns An object containing sizing and path information about a squared\n   *     shape for connections.\n   */\n  protected makeSquared(): Shape {\n    const radius = this.CORNER_RADIUS;\n\n    /**\n     * Make the main path for the squared connection shape out of two corners\n     * and a single line in-between (a and v). These are defined in relative\n     * positions and require the height of the block.\n     * The 'left' and 'right' versions of the paths are the same, but the Y sign\n     * flips.  The 'up' and 'down' versions of the path determine where the\n     * corner point is placed and in turn the direction of the corners.\n     *\n     * @param height The height of the block the connection is on.\n     * @param up True if the path should be drawn from bottom to top, false\n     *     otherwise.\n     * @param right True if the path is for the right side of the block.\n     * @returns A path fragment describing a squared connection.\n     */\n    function makeMainPath(height: number, up: boolean, right: boolean): string {\n      const innerHeight = height - radius * 2;\n      return (\n        svgPaths.arc(\n          'a',\n          '0 0,1',\n          radius,\n          svgPaths.point((up ? -1 : 1) * radius, (up ? -1 : 1) * radius)\n        ) +\n        svgPaths.lineOnAxis('v', (right ? 1 : -1) * innerHeight) +\n        svgPaths.arc(\n          'a',\n          '0 0,1',\n          radius,\n          svgPaths.point((up ? 1 : -1) * radius, (up ? -1 : 1) * radius)\n        )\n      );\n    }\n\n    return {\n      type: this.SHAPES.SQUARE,\n      isDynamic: true,\n      width(_height: number): number {\n        return radius;\n      },\n      height(height: number): number {\n        return height;\n      },\n      connectionOffsetY(connectionHeight: number): number {\n        return connectionHeight / 2;\n      },\n      connectionOffsetX(connectionWidth: number): number {\n        return -connectionWidth;\n      },\n      pathDown(height: number): string {\n        return makeMainPath(height, false, false);\n      },\n      pathUp(height: number): string {\n        return makeMainPath(height, true, false);\n      },\n      pathRightDown(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n      pathRightUp(height: number): string {\n        return makeMainPath(height, false, true);\n      },\n    };\n  }\n\n  override shapeFor(connection: RenderedConnection): Shape {\n    let checks = connection.getCheck();\n    if (!checks && connection.targetConnection) {\n      checks = connection.targetConnection.getCheck();\n    }\n    let outputShape;\n    switch (connection.type) {\n      case ConnectionType.INPUT_VALUE:\n      case ConnectionType.OUTPUT_VALUE:\n        outputShape = connection.getSourceBlock().getOutputShape();\n        // If the block has an output shape set, use that instead.\n        if (outputShape !== null) {\n          switch (outputShape) {\n            case this.SHAPES.HEXAGONAL:\n              return this.HEXAGONAL!;\n            case this.SHAPES.ROUND:\n              return this.ROUNDED!;\n            case this.SHAPES.SQUARE:\n              return this.SQUARED!;\n          }\n        }\n        // Includes doesn't work in IE.\n        if (checks && checks.indexOf('Boolean') !== -1) {\n          return this.HEXAGONAL!;\n        }\n        if (checks && checks.indexOf('Number') !== -1) {\n          return this.ROUNDED!;\n        }\n        if (checks && checks.indexOf('String') !== -1) {\n          return this.ROUNDED!;\n        }\n        return this.ROUNDED!;\n      case ConnectionType.PREVIOUS_STATEMENT:\n      case ConnectionType.NEXT_STATEMENT:\n        return this.NOTCH!;\n      default:\n        throw Error('Unknown type');\n    }\n  }\n\n  override makeNotch() {\n    const width = this.NOTCH_WIDTH;\n    const height = this.NOTCH_HEIGHT;\n\n    const innerWidth = width / 3;\n    const curveWidth = innerWidth / 3;\n\n    const halfHeight = height / 2;\n    const quarterHeight = halfHeight / 2;\n\n    /**\n     * Make the main path for the notch.\n     *\n     * @param dir Direction multiplier to apply to horizontal offsets along the\n     *     path. Either 1 or -1.\n     * @returns A path fragment describing a notch.\n     */\n    function makeMainPath(dir: number): string {\n      return (\n        svgPaths.curve('c', [\n          svgPaths.point((dir * curveWidth) / 2, 0),\n          svgPaths.point((dir * curveWidth * 3) / 4, quarterHeight / 2),\n          svgPaths.point(dir * curveWidth, quarterHeight),\n        ]) +\n        svgPaths.line([svgPaths.point(dir * curveWidth, halfHeight)]) +\n        svgPaths.curve('c', [\n          svgPaths.point((dir * curveWidth) / 4, quarterHeight / 2),\n          svgPaths.point((dir * curveWidth) / 2, quarterHeight),\n          svgPaths.point(dir * curveWidth, quarterHeight),\n        ]) +\n        svgPaths.lineOnAxis('h', dir * innerWidth) +\n        svgPaths.curve('c', [\n          svgPaths.point((dir * curveWidth) / 2, 0),\n          svgPaths.point((dir * curveWidth * 3) / 4, -(quarterHeight / 2)),\n          svgPaths.point(dir * curveWidth, -quarterHeight),\n        ]) +\n        svgPaths.line([svgPaths.point(dir * curveWidth, -halfHeight)]) +\n        svgPaths.curve('c', [\n          svgPaths.point((dir * curveWidth) / 4, -(quarterHeight / 2)),\n          svgPaths.point((dir * curveWidth) / 2, -quarterHeight),\n          svgPaths.point(dir * curveWidth, -quarterHeight),\n        ])\n      );\n    }\n\n    const pathLeft = makeMainPath(1);\n    const pathRight = makeMainPath(-1);\n\n    return {\n      type: this.SHAPES.NOTCH,\n      width,\n      height,\n      pathLeft,\n      pathRight,\n    };\n  }\n\n  override makeInsideCorners() {\n    const radius = this.CORNER_RADIUS;\n\n    const innerTopLeftCorner = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius,\n      svgPaths.point(-radius, radius)\n    );\n\n    const innerTopRightCorner = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(-radius, radius)\n    );\n\n    const innerBottomLeftCorner = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius,\n      svgPaths.point(radius, radius)\n    );\n\n    const innerBottomRightCorner = svgPaths.arc(\n      'a',\n      '0 0,1',\n      radius,\n      svgPaths.point(radius, radius)\n    );\n\n    return {\n      width: radius,\n      height: radius,\n      pathTop: innerTopLeftCorner,\n      pathBottom: innerBottomLeftCorner,\n      rightWidth: radius,\n      rightHeight: radius,\n      pathTopRight: innerTopRightCorner,\n      pathBottomRight: innerBottomRightCorner,\n    };\n  }\n\n  override generateSecondaryColour_(colour: string) {\n    return utilsColour.blend('#000', colour, 0.15) || colour;\n  }\n\n  override generateTertiaryColour_(colour: string) {\n    return utilsColour.blend('#000', colour, 0.25) || colour;\n  }\n\n  override createDom(svg: SVGElement, tagName: string, selector: string) {\n    super.createDom(svg, tagName, selector);\n    /*\n        <defs>\n          ... filters go here ...\n        </defs>\n        */\n    const defs = dom.createSvgElement(Svg.DEFS, {}, svg);\n    // Using a dilate distorts the block shape.\n    // Instead use a gaussian blur, and then set all alpha to 1 with a transfer.\n    const selectedGlowFilter = dom.createSvgElement(\n      Svg.FILTER,\n      {\n        'id': 'blocklySelectedGlowFilter' + this.randomIdentifier,\n        'height': '160%',\n        'width': '180%',\n        'y': '-30%',\n        'x': '-40%',\n      },\n      defs\n    );\n    dom.createSvgElement(\n      Svg.FEGAUSSIANBLUR,\n      {'in': 'SourceGraphic', 'stdDeviation': this.SELECTED_GLOW_SIZE},\n      selectedGlowFilter\n    );\n    // Set all gaussian blur pixels to 1 opacity before applying flood\n    const selectedComponentTransfer = dom.createSvgElement(\n      Svg.FECOMPONENTTRANSFER,\n      {'result': 'outBlur'},\n      selectedGlowFilter\n    );\n    dom.createSvgElement(\n      Svg.FEFUNCA,\n      {'type': 'table', 'tableValues': '0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1'},\n      selectedComponentTransfer\n    );\n    // Color the highlight\n    dom.createSvgElement(\n      Svg.FEFLOOD,\n      {\n        'flood-color': this.SELECTED_GLOW_COLOUR,\n        'flood-opacity': 1,\n        'result': 'outColor',\n      },\n      selectedGlowFilter\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'outColor',\n        'in2': 'outBlur',\n        'operator': 'in',\n        'result': 'outGlow',\n      },\n      selectedGlowFilter\n    );\n    this.selectedGlowFilterId = selectedGlowFilter.id;\n    this.selectedGlowFilter = selectedGlowFilter;\n\n    // Using a dilate distorts the block shape.\n    // Instead use a gaussian blur, and then set all alpha to 1 with a transfer.\n    const replacementGlowFilter = dom.createSvgElement(\n      Svg.FILTER,\n      {\n        'id': 'blocklyReplacementGlowFilter' + this.randomIdentifier,\n        'height': '160%',\n        'width': '180%',\n        'y': '-30%',\n        'x': '-40%',\n      },\n      defs\n    );\n    dom.createSvgElement(\n      Svg.FEGAUSSIANBLUR,\n      {'in': 'SourceGraphic', 'stdDeviation': this.REPLACEMENT_GLOW_SIZE},\n      replacementGlowFilter\n    );\n    // Set all gaussian blur pixels to 1 opacity before applying flood\n    const replacementComponentTransfer = dom.createSvgElement(\n      Svg.FECOMPONENTTRANSFER,\n      {'result': 'outBlur'},\n      replacementGlowFilter\n    );\n    dom.createSvgElement(\n      Svg.FEFUNCA,\n      {'type': 'table', 'tableValues': '0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1'},\n      replacementComponentTransfer\n    );\n    // Color the highlight\n    dom.createSvgElement(\n      Svg.FEFLOOD,\n      {\n        'flood-color': this.REPLACEMENT_GLOW_COLOUR,\n        'flood-opacity': 1,\n        'result': 'outColor',\n      },\n      replacementGlowFilter\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'outColor',\n        'in2': 'outBlur',\n        'operator': 'in',\n        'result': 'outGlow',\n      },\n      replacementGlowFilter\n    );\n    dom.createSvgElement(\n      Svg.FECOMPOSITE,\n      {\n        'in': 'SourceGraphic',\n        'in2': 'outGlow',\n        'operator': 'over',\n      },\n      replacementGlowFilter\n    );\n    this.replacementGlowFilterId = replacementGlowFilter.id;\n    this.replacementGlowFilter = replacementGlowFilter;\n  }\n\n  override getCSS_(selector: string) {\n    return [\n      /* eslint-disable indent */\n      // Text.\n      `${selector} .blocklyText,`,\n      `${selector} .blocklyFlyoutLabelText {`,\n      `font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}` +\n        `pt ${this.FIELD_TEXT_FONTFAMILY};`,\n      `}`,\n\n      // Fields.\n      `${selector} .blocklyText {`,\n      `fill: #fff;`,\n      `}`,\n      `${selector} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,\n      `${selector} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,\n      `fill: ${this.FIELD_BORDER_RECT_COLOUR};`,\n      `}`,\n      `${selector} .blocklyNonEditableText>text,`,\n      `${selector} .blocklyEditableText>text,`,\n      `${selector} .blocklyNonEditableText>g>text,`,\n      `${selector} .blocklyEditableText>g>text {`,\n      `fill: #575E75;`,\n      `}`,\n\n      // Flyout labels.\n      `${selector} .blocklyFlyoutLabelText {`,\n      `fill: #575E75;`,\n      `}`,\n\n      // Bubbles.\n      `${selector} .blocklyText.blocklyBubbleText {`,\n      `fill: #575E75;`,\n      `}`,\n\n      // Editable field hover.\n      `${selector} .blocklyDraggable:not(.blocklyDisabled)`,\n      ` .blocklyEditableText:not(.editing):hover>rect,`,\n      `${selector} .blocklyDraggable:not(.blocklyDisabled)`,\n      ` .blocklyEditableText:not(.editing):hover>.blocklyPath {`,\n      `stroke: #fff;`,\n      `stroke-width: 2;`,\n      `}`,\n\n      // Text field input.\n      `${selector} .blocklyHtmlInput {`,\n      `font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\n      `font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,\n      `color: #575E75;`,\n      `}`,\n\n      // Dropdown field.\n      `${selector} .blocklyDropdownText {`,\n      `fill: #fff !important;`,\n      `}`,\n\n      // Widget and Dropdown Div\n      `${selector}.blocklyWidgetDiv .goog-menuitem,`,\n      `${selector}.blocklyDropDownDiv .goog-menuitem {`,\n      `font-family: ${this.FIELD_TEXT_FONTFAMILY};`,\n      `}`,\n      `${selector}.blocklyDropDownDiv .goog-menuitem-content {`,\n      `color: #fff;`,\n      `}`,\n\n      // Connection highlight.\n      `${selector} .blocklyHighlightedConnectionPath {`,\n      `stroke: ${this.SELECTED_GLOW_COLOUR};`,\n      `}`,\n\n      // Disabled outline paths.\n      `${selector} .blocklyDisabled > .blocklyOutlinePath {`,\n      `fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,\n      `}`,\n\n      // Insertion marker.\n      `${selector} .blocklyInsertionMarker>.blocklyPath {`,\n      `fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n      `stroke: none;`,\n      `}`,\n    ];\n  }\n}\n/* eslint-enable indent */\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Types');\n\nimport type {Measurable} from './base.js';\nimport type {Row} from './row.js';\n\n/**\n * Types of rendering elements.\n */\nclass TypesContainer {\n  [index: string]: number | Function;\n\n  NONE = 0; // None\n  FIELD = 1 << 0; // Field.\n  HAT = 1 << 1; // Hat.\n  ICON = 1 << 2; // Icon.\n  SPACER = 1 << 3; // Spacer.\n  BETWEEN_ROW_SPACER = 1 << 4; // Between Row Spacer.\n  IN_ROW_SPACER = 1 << 5; // In Row Spacer.\n  EXTERNAL_VALUE_INPUT = 1 << 6; // External Value Input.\n  INPUT = 1 << 7; // Input.\n  INLINE_INPUT = 1 << 8; // Inline Input.\n  STATEMENT_INPUT = 1 << 9; // Statement Input.\n  CONNECTION = 1 << 10; // Connection.\n  PREVIOUS_CONNECTION = 1 << 11; // Previous Connection.\n  NEXT_CONNECTION = 1 << 12; // Next Connection.\n  OUTPUT_CONNECTION = 1 << 13; // Output Connection.\n  CORNER = 1 << 14; // Corner.\n  LEFT_SQUARE_CORNER = 1 << 15; // Square Corner.\n  LEFT_ROUND_CORNER = 1 << 16; // Round Corner.\n  RIGHT_SQUARE_CORNER = 1 << 17; // Right Square Corner.\n  RIGHT_ROUND_CORNER = 1 << 18; // Right Round Corner.\n  JAGGED_EDGE = 1 << 19; // Jagged Edge.\n  ROW = 1 << 20; // Row.\n  TOP_ROW = 1 << 21; // Top Row.\n  BOTTOM_ROW = 1 << 22; // Bottom Row.\n  INPUT_ROW = 1 << 23; // Input Row.\n\n  /**\n   * A Left Corner Union Type.\n   */\n  LEFT_CORNER = this.LEFT_SQUARE_CORNER | this.LEFT_ROUND_CORNER;\n\n  /**\n   * A Right Corner Union Type.\n   */\n  RIGHT_CORNER = this.RIGHT_SQUARE_CORNER | this.RIGHT_ROUND_CORNER;\n\n  /**\n   * Next flag value to use for custom rendering element types.\n   * This must be updated to reflect the next enum flag value\n   * to use if additional elements are added to\n   * `Types`.\n   */\n  nextTypeValue_ = 1 << 24;\n\n  /**\n   * Get the enum flag value of an existing type or register a new type.\n   *\n   * @param type The name of the type.\n   * @returns The enum flag value associated with that type.\n   */\n  getType(type: string): number {\n    if (!Object.prototype.hasOwnProperty.call(this, type)) {\n      this[type] = this.nextTypeValue_;\n      this.nextTypeValue_ <<= 1;\n    }\n    return this[type] as number;\n  }\n\n  /**\n   * Whether a measurable stores information about a field.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a field.\n   */\n  isField(elem: Measurable): number {\n    return elem.type & this.FIELD;\n  }\n\n  /**\n   * Whether a measurable stores information about a hat.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a hat.\n   */\n  isHat(elem: Measurable): number {\n    return elem.type & this.HAT;\n  }\n\n  /**\n   * Whether a measurable stores information about an icon.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an icon.\n   */\n  isIcon(elem: Measurable): number {\n    return elem.type & this.ICON;\n  }\n\n  /**\n   * Whether a measurable stores information about a spacer.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a spacer.\n   */\n  isSpacer(elem: Measurable | Row): number {\n    return elem.type & this.SPACER;\n  }\n\n  /**\n   * Whether a measurable stores information about an in-row spacer.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an in-row spacer.\n   */\n  isInRowSpacer(elem: Measurable): number {\n    return elem.type & this.IN_ROW_SPACER;\n  }\n\n  /**\n   * Whether a measurable stores information about an input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an input.\n   */\n  isInput(elem: Measurable): number {\n    return elem.type & this.INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about an external input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an external input.\n   */\n  isExternalInput(elem: Measurable): number {\n    return elem.type & this.EXTERNAL_VALUE_INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about an inline input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about an inline input.\n   */\n  isInlineInput(elem: Measurable): number {\n    return elem.type & this.INLINE_INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about a statement input.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a statement input.\n   */\n  isStatementInput(elem: Measurable): number {\n    return elem.type & this.STATEMENT_INPUT;\n  }\n\n  /**\n   * Whether a measurable stores information about a previous connection.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a previous connection.\n   */\n  isPreviousConnection(elem: Measurable): number {\n    return elem.type & this.PREVIOUS_CONNECTION;\n  }\n\n  /**\n   * Whether a measurable stores information about a next connection.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a next connection.\n   */\n  isNextConnection(elem: Measurable): number {\n    return elem.type & this.NEXT_CONNECTION;\n  }\n\n  /**\n   * Whether a measurable stores information about a previous or next\n   * connection.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a previous or next\n   *     connection.\n   */\n  isPreviousOrNextConnection(elem: Measurable): number {\n    return elem.type & (this.PREVIOUS_CONNECTION | this.NEXT_CONNECTION);\n  }\n\n  /**\n   * Whether a measurable stores information about a left round corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a left round corner.\n   */\n  isLeftRoundedCorner(elem: Measurable): number {\n    return elem.type & this.LEFT_ROUND_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a right round corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a right round corner.\n   */\n  isRightRoundedCorner(elem: Measurable): number {\n    return elem.type & this.RIGHT_ROUND_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a left square corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a left square corner.\n   */\n  isLeftSquareCorner(elem: Measurable): number {\n    return elem.type & this.LEFT_SQUARE_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a right square corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a right square corner.\n   */\n  isRightSquareCorner(elem: Measurable): number {\n    return elem.type & this.RIGHT_SQUARE_CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a corner.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a corner.\n   */\n  isCorner(elem: Measurable): number {\n    return elem.type & this.CORNER;\n  }\n\n  /**\n   * Whether a measurable stores information about a jagged edge.\n   *\n   * @param elem The element to check.\n   * @returns 1 if the object stores information about a jagged edge.\n   */\n  isJaggedEdge(elem: Measurable): number {\n    return elem.type & this.JAGGED_EDGE;\n  }\n\n  /**\n   * Whether a measurable stores information about a row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a row.\n   */\n  isRow(row: Row): number {\n    return row.type & this.ROW;\n  }\n\n  /**\n   * Whether a measurable stores information about a between-row spacer.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a between-row spacer.\n   */\n  isBetweenRowSpacer(row: Row): number {\n    return row.type & this.BETWEEN_ROW_SPACER;\n  }\n\n  /**\n   * Whether a measurable stores information about a top row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a top row.\n   */\n  isTopRow(row: Row): number {\n    return row.type & this.TOP_ROW;\n  }\n\n  /**\n   * Whether a measurable stores information about a bottom row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a bottom row.\n   */\n  isBottomRow(row: Row): number {\n    return row.type & this.BOTTOM_ROW;\n  }\n\n  /**\n   * Whether a measurable stores information about a top or bottom row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about a top or bottom row.\n   */\n  isTopOrBottomRow(row: Row): number {\n    return row.type & (this.TOP_ROW | this.BOTTOM_ROW);\n  }\n\n  /**\n   * Whether a measurable stores information about an input row.\n   *\n   * @param row The row to check.\n   * @returns 1 if the object stores information about an input row.\n   */\n  isInputRow(row: Row): number {\n    return row.type & this.INPUT_ROW;\n  }\n}\n\nexport const Types = new TypesContainer();\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Measurable');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Types} from './types.js';\n\n/**\n * The base class to represent a part of a block that takes up space during\n * rendering.  The constructor for each non-spacer Measurable records the size\n * of the block element (e.g. field, statement input).\n */\nexport class Measurable {\n  width = 0;\n\n  height = 0;\n  type: number;\n  xPos = 0;\n\n  centerline = 0;\n  notchOffset: number;\n\n  /** The renderer's constant provider. */\n  protected readonly constants_: ConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    this.constants_ = constants;\n\n    this.type = Types.NONE;\n\n    this.notchOffset = this.constants_.NOTCH_OFFSET_LEFT;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Connection');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider, Shape} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * The base class to represent a connection and the space that it takes up on\n * the block.\n */\nexport class Connection extends Measurable {\n  shape: Shape;\n  isDynamicShape: boolean;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public connectionModel: RenderedConnection\n  ) {\n    super(constants);\n\n    this.shape = this.constants_.shapeFor(connectionModel);\n\n    this.isDynamicShape = 'isDynamic' in this.shape && this.shape.isDynamic;\n    this.type |= Types.CONNECTION;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Drawer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Coordinate} from '../../utils.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport {Connection} from '../measurables/connection.js';\nimport type {ExternalValueInput} from '../measurables/external_value_input.js';\nimport type {Field} from '../measurables/field.js';\nimport type {Icon} from '../measurables/icon.js';\nimport type {InlineInput} from '../measurables/inline_input.js';\nimport type {PreviousConnection} from '../measurables/previous_connection.js';\nimport type {Row} from '../measurables/row.js';\nimport {Types} from '../measurables/types.js';\n\nimport {isDynamicShape} from './constants.js';\nimport type {ConstantProvider, Notch, PuzzleTab} from './constants.js';\nimport type {RenderInfo} from './info.js';\nimport * as deprecation from '../../utils/deprecation.js';\n\n/**\n * An object that draws a block based on the given rendering information.\n */\nexport class Drawer {\n  block_: BlockSvg;\n  info_: RenderInfo;\n  topLeft_: Coordinate;\n  outlinePath_ = '';\n  inlinePath_ = '';\n  protected constants_: ConstantProvider;\n\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    this.block_ = block;\n    this.info_ = info;\n    this.topLeft_ = block.getRelativeToSurfaceXY();\n\n    /** The renderer's constant provider. */\n    this.constants_ = info.getRenderer().getConstants();\n  }\n\n  /**\n   * Draw the block to the workspace. Here \"drawing\" means setting SVG path\n   * elements and moving fields, icons, and connections on the screen.\n   *\n   * The pieces of the paths are pushed into arrays of \"steps\", which are then\n   * joined with spaces and set directly on the block.  This guarantees that\n   * the steps are separated by spaces for improved readability, but isn't\n   * required.\n   */\n  draw() {\n    this.drawOutline_();\n    this.drawInternals_();\n\n    this.block_.pathObject.setPath(this.outlinePath_ + '\\n' + this.inlinePath_);\n    if (this.info_.RTL) {\n      this.block_.pathObject.flipRTL();\n    }\n    this.recordSizeOnBlock_();\n  }\n\n  /**\n   * Hide icons that were marked as hidden.\n   *\n   * @deprecated Manually hiding icons is no longer necessary. To be removed\n   *     in v11.\n   */\n  protected hideHiddenIcons_() {\n    deprecation.warn('hideHiddenIcons_', 'v10', 'v11');\n  }\n\n  /**\n   * Save sizing information back to the block\n   * Most of the rendering information can be thrown away at the end of the\n   * render. Anything that needs to be kept around should be set in this\n   * function.\n   */\n  protected recordSizeOnBlock_() {\n    // This is used when the block is reporting its size to anyone else.\n    // The dark path adds to the size of the block in both X and Y.\n    this.block_.height = this.info_.height;\n    this.block_.width = this.info_.widthWithChildren;\n  }\n\n  /** Create the outline of the block.  This is a single continuous path. */\n  protected drawOutline_() {\n    this.drawTop_();\n    for (let r = 1; r < this.info_.rows.length - 1; r++) {\n      const row = this.info_.rows[r];\n      if (row.hasJaggedEdge) {\n        this.drawJaggedEdge_(row);\n      } else if (row.hasStatement) {\n        this.drawStatementInput_(row);\n      } else if (row.hasExternalInput) {\n        this.drawValueInput_(row);\n      } else {\n        this.drawRightSideRow_(row);\n      }\n    }\n    this.drawBottom_();\n    this.drawLeft_();\n  }\n\n  /**\n   * Add steps for the top corner of the block, taking into account\n   * details such as hats and rounded corners.\n   */\n  protected drawTop_() {\n    const topRow = this.info_.topRow;\n    const elements = topRow.elements;\n\n    this.positionPreviousConnection_();\n    this.outlinePath_ += svgPaths.moveBy(topRow.xPos, this.info_.startY);\n    for (let i = 0, elem; (elem = elements[i]); i++) {\n      if (Types.isLeftRoundedCorner(elem)) {\n        this.outlinePath_ += this.constants_.OUTSIDE_CORNERS.topLeft;\n      } else if (Types.isRightRoundedCorner(elem)) {\n        this.outlinePath_ += this.constants_.OUTSIDE_CORNERS.topRight;\n      } else if (\n        Types.isPreviousConnection(elem) &&\n        elem instanceof Connection\n      ) {\n        this.outlinePath_ += (\n          (elem as PreviousConnection).shape as Notch\n        ).pathLeft;\n      } else if (Types.isHat(elem)) {\n        this.outlinePath_ += this.constants_.START_HAT.path;\n      } else if (Types.isSpacer(elem)) {\n        this.outlinePath_ += svgPaths.lineOnAxis('h', elem.width);\n      }\n    }\n    // No branch for a square corner, because it's a no-op.\n    this.outlinePath_ += svgPaths.lineOnAxis('v', topRow.height);\n  }\n\n  /**\n   * Add steps for the jagged edge of a row on a collapsed block.\n   *\n   * @param row The row to draw the side of.\n   */\n  protected drawJaggedEdge_(row: Row) {\n    const remainder = row.height - this.constants_.JAGGED_TEETH.height;\n    this.outlinePath_ +=\n      this.constants_.JAGGED_TEETH.path + svgPaths.lineOnAxis('v', remainder);\n  }\n\n  /**\n   * Add steps for an external value input, rendered as a notch in the side\n   * of the block.\n   *\n   * @param row The row that this input belongs to.\n   */\n  protected drawValueInput_(row: Row) {\n    const input = row.getLastInput() as ExternalValueInput | InlineInput;\n    this.positionExternalValueConnection_(row);\n\n    const pathDown = isDynamicShape(input.shape)\n      ? input.shape.pathDown(input.height)\n      : (input.shape as PuzzleTab).pathDown;\n\n    this.outlinePath_ +=\n      svgPaths.lineOnAxis('H', input.xPos + input.width) +\n      pathDown +\n      svgPaths.lineOnAxis('v', row.height - input.connectionHeight);\n  }\n\n  /**\n   * Add steps for a statement input.\n   *\n   * @param row The row that this input belongs to.\n   */\n  protected drawStatementInput_(row: Row) {\n    const input = row.getLastInput();\n    if (!input) return;\n    // Where to start drawing the notch, which is on the right side in LTR.\n    const x = input.xPos + input.notchOffset + (input.shape as Notch).width;\n\n    const innerTopLeftCorner =\n      (input.shape as Notch).pathRight +\n      svgPaths.lineOnAxis(\n        'h',\n        -(input.notchOffset - this.constants_.INSIDE_CORNERS.width)\n      ) +\n      this.constants_.INSIDE_CORNERS.pathTop;\n\n    const innerHeight = row.height - 2 * this.constants_.INSIDE_CORNERS.height;\n\n    this.outlinePath_ +=\n      svgPaths.lineOnAxis('H', x) +\n      innerTopLeftCorner +\n      svgPaths.lineOnAxis('v', innerHeight) +\n      this.constants_.INSIDE_CORNERS.pathBottom +\n      svgPaths.lineOnAxis('H', row.xPos + row.width);\n\n    this.positionStatementInputConnection_(row);\n  }\n\n  /**\n   * Add steps for the right side of a row that does not have value or\n   * statement input connections.\n   *\n   * @param row The row to draw the side of.\n   */\n  protected drawRightSideRow_(row: Row) {\n    this.outlinePath_ += svgPaths.lineOnAxis('V', row.yPos + row.height);\n  }\n\n  /**\n   * Add steps for the bottom edge of a block, possibly including a notch\n   * for the next connection.\n   */\n  protected drawBottom_() {\n    const bottomRow = this.info_.bottomRow;\n    const elems = bottomRow.elements;\n    this.positionNextConnection_();\n\n    let rightCornerYOffset = 0;\n    let outlinePath = '';\n    for (let i = elems.length - 1, elem; (elem = elems[i]); i--) {\n      if (Types.isNextConnection(elem) && elem instanceof Connection) {\n        outlinePath += (elem.shape as Notch).pathRight;\n      } else if (Types.isLeftSquareCorner(elem)) {\n        outlinePath += svgPaths.lineOnAxis('H', bottomRow.xPos);\n      } else if (Types.isLeftRoundedCorner(elem)) {\n        outlinePath += this.constants_.OUTSIDE_CORNERS.bottomLeft;\n      } else if (Types.isRightRoundedCorner(elem)) {\n        outlinePath += this.constants_.OUTSIDE_CORNERS.bottomRight;\n        rightCornerYOffset = this.constants_.OUTSIDE_CORNERS.rightHeight;\n      } else if (Types.isSpacer(elem)) {\n        outlinePath += svgPaths.lineOnAxis('h', elem.width * -1);\n      }\n    }\n\n    this.outlinePath_ += svgPaths.lineOnAxis(\n      'V',\n      bottomRow.baseline - rightCornerYOffset\n    );\n    this.outlinePath_ += outlinePath;\n  }\n\n  /**\n   * Add steps for the left side of the block, which may include an output\n   * connection\n   */\n  protected drawLeft_() {\n    const outputConnection = this.info_.outputConnection;\n    this.positionOutputConnection_();\n\n    if (outputConnection) {\n      const tabBottom =\n        outputConnection.connectionOffsetY + outputConnection.height;\n      const pathUp = isDynamicShape(outputConnection.shape)\n        ? outputConnection.shape.pathUp(outputConnection.height)\n        : (outputConnection.shape as PuzzleTab).pathUp;\n\n      // Draw a line up to the bottom of the tab.\n      this.outlinePath_ += svgPaths.lineOnAxis('V', tabBottom) + pathUp;\n    }\n    // Close off the path.  This draws a vertical line up to the start of the\n    // block's path, which may be either a rounded or a sharp corner.\n    this.outlinePath_ += 'z';\n  }\n\n  /**\n   * Draw the internals of the block: inline inputs, fields, and icons.  These\n   * do not depend on the outer path for placement.\n   */\n  protected drawInternals_() {\n    for (let i = 0, row; (row = this.info_.rows[i]); i++) {\n      for (let j = 0, elem; (elem = row.elements[j]); j++) {\n        if (Types.isInlineInput(elem)) {\n          this.drawInlineInput_(elem as InlineInput);\n        } else if (Types.isIcon(elem) || Types.isField(elem)) {\n          this.layoutField_(elem as Field | Icon);\n        }\n      }\n    }\n  }\n\n  /**\n   * Push a field or icon's new position to its SVG root.\n   *\n   * @param fieldInfo The rendering information for the field or icon.\n   */\n  protected layoutField_(fieldInfo: Icon | Field) {\n    const yPos = fieldInfo.centerline - fieldInfo.height / 2;\n    let xPos = fieldInfo.xPos;\n    let scale = '';\n    if (this.info_.RTL) {\n      xPos = -(xPos + fieldInfo.width);\n      if (fieldInfo.flipRtl) {\n        xPos += fieldInfo.width;\n        scale = 'scale(-1 1)';\n      }\n    }\n\n    if (Types.isIcon(fieldInfo)) {\n      const icon = (fieldInfo as Icon).icon;\n      icon.setOffsetInBlock(new Coordinate(xPos, yPos));\n      if (this.info_.isInsertionMarker) {\n        icon.hideForInsertionMarker();\n      }\n    } else {\n      const svgGroup = (fieldInfo as Field).field.getSvgRoot()!;\n      svgGroup.setAttribute(\n        'transform',\n        'translate(' + xPos + ',' + yPos + ')' + scale\n      );\n      if (this.info_.isInsertionMarker) {\n        svgGroup.setAttribute('display', 'none');\n      }\n    }\n  }\n\n  /**\n   * Add steps for an inline input.\n   *\n   * @param input The information about the input to render.\n   */\n  protected drawInlineInput_(input: InlineInput) {\n    const width = input.width;\n    const height = input.height;\n    const yPos = input.centerline - height / 2;\n\n    const connectionTop = input.connectionOffsetY;\n    const connectionBottom = input.connectionHeight + connectionTop;\n    const connectionRight = input.xPos + input.connectionWidth;\n\n    this.inlinePath_ +=\n      svgPaths.moveTo(connectionRight, yPos) +\n      svgPaths.lineOnAxis('v', connectionTop) +\n      (input.shape as PuzzleTab).pathDown +\n      svgPaths.lineOnAxis('v', height - connectionBottom) +\n      svgPaths.lineOnAxis('h', width - input.connectionWidth) +\n      svgPaths.lineOnAxis('v', -height) +\n      'z';\n\n    this.positionInlineInputConnection_(input);\n  }\n\n  /**\n   * Position the connection on an inline value input, taking into account\n   * RTL and the small gap between the parent block and child block which lets\n   * the parent block's dark path show through.\n   *\n   * @param input The information about the input that the connection is on.\n   */\n  protected positionInlineInputConnection_(input: InlineInput) {\n    const yPos = input.centerline - input.height / 2;\n    // Move the connection.\n    if (input.connectionModel) {\n      // xPos already contains info about startX\n      let connX = input.xPos + input.connectionWidth + input.connectionOffsetX;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(\n        connX,\n        yPos + input.connectionOffsetY\n      );\n    }\n  }\n\n  /**\n   * Position the connection on a statement input, taking into account\n   * RTL and the small gap between the parent block and child block which lets\n   * the parent block's dark path show through.\n   *\n   * @param row The row that the connection is on.\n   */\n  protected positionStatementInputConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input?.connectionModel) {\n      let connX = row.xPos + row.statementEdge + input.notchOffset;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX, row.yPos);\n    }\n  }\n\n  /**\n   * Position the connection on an external value input, taking into account\n   * RTL and the small gap between the parent block and child block which lets\n   * the parent block's dark path show through.\n   *\n   * @param row The row that the connection is on.\n   */\n  protected positionExternalValueConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input && input.connectionModel) {\n      let connX = row.xPos + row.width;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX, row.yPos);\n    }\n  }\n\n  /** Position the previous connection on a block. */\n  protected positionPreviousConnection_() {\n    const topRow = this.info_.topRow;\n    if (topRow.connection) {\n      const x = topRow.xPos + topRow.notchOffset;\n      const connX = this.info_.RTL ? -x : x;\n      topRow.connection.connectionModel.setOffsetInBlock(connX, 0);\n    }\n  }\n\n  /** Position the next connection on a block. */\n  protected positionNextConnection_() {\n    const bottomRow = this.info_.bottomRow;\n\n    if (bottomRow.connection) {\n      const connInfo = bottomRow.connection;\n      const x = connInfo.xPos; // Already contains info about startX.\n      const connX = this.info_.RTL ? -x : x;\n      connInfo.connectionModel.setOffsetInBlock(connX, bottomRow.baseline);\n    }\n  }\n\n  /** Position the output connection on a block. */\n  protected positionOutputConnection_() {\n    if (this.info_.outputConnection) {\n      const x =\n        this.info_.startX + this.info_.outputConnection.connectionOffsetX;\n      const connX = this.info_.RTL ? -x : x;\n      this.block_.outputConnection.setOffsetInBlock(\n        connX,\n        this.info_.outputConnection.connectionOffsetY\n      );\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.Drawer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {BaseShape, DynamicShape, Notch} from '../common/constants.js';\nimport {Drawer as BaseDrawer} from '../common/drawer.js';\nimport type {InlineInput} from '../measurables/inline_input.js';\nimport type {Row} from '../measurables/row.js';\nimport type {SpacerRow} from '../measurables/spacer_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {InsideCorners} from './constants.js';\nimport type {RenderInfo} from './info.js';\nimport type {StatementInput} from './measurables/inputs.js';\nimport type {PathObject} from './path_object.js';\n\n/**\n * An object that draws a block based on the given rendering information.\n */\nexport class Drawer extends BaseDrawer {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override info_!: RenderInfo;\n\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    super(block, info);\n  }\n\n  override draw() {\n    const pathObject = this.block_.pathObject as PathObject;\n    pathObject.beginDrawing();\n    this.drawOutline_();\n    this.drawInternals_();\n\n    pathObject.setPath(this.outlinePath_ + '\\n' + this.inlinePath_);\n    if (this.info_.RTL) {\n      pathObject.flipRTL();\n    }\n    this.recordSizeOnBlock_();\n    if (this.info_.outputConnection) {\n      // Store the output connection shape type for parent blocks to use during\n      // rendering.\n      pathObject.outputShapeType = this.info_.outputConnection.shape.type;\n    }\n    pathObject.endDrawing();\n  }\n\n  override drawOutline_() {\n    if (\n      this.info_.outputConnection &&\n      this.info_.outputConnection.isDynamicShape &&\n      !this.info_.hasStatementInput &&\n      !this.info_.bottomRow.hasNextConnection\n    ) {\n      this.drawFlatTop_();\n      this.drawRightDynamicConnection_();\n      this.drawFlatBottom_();\n      this.drawLeftDynamicConnection_();\n    } else {\n      super.drawOutline_();\n    }\n  }\n\n  override drawLeft_() {\n    if (\n      this.info_.outputConnection &&\n      this.info_.outputConnection.isDynamicShape\n    ) {\n      this.drawLeftDynamicConnection_();\n    } else {\n      super.drawLeft_();\n    }\n  }\n\n  /**\n   * Add steps for the right side of a row that does not have value or\n   * statement input connections.\n   *\n   * @param row The row to draw the side of.\n   */\n  protected override drawRightSideRow_(row: Row) {\n    if (row.height <= 0) {\n      return;\n    }\n    if (Types.isSpacer(row)) {\n      const spacerRow = row as SpacerRow;\n      const precedesStatement = spacerRow.precedesStatement;\n      const followsStatement = spacerRow.followsStatement;\n      if (precedesStatement || followsStatement) {\n        const insideCorners = this.constants_.INSIDE_CORNERS as InsideCorners;\n        const cornerHeight = insideCorners.rightHeight;\n        const remainingHeight =\n          spacerRow.height - (precedesStatement ? cornerHeight : 0);\n        const bottomRightPath = followsStatement\n          ? insideCorners.pathBottomRight\n          : '';\n        const verticalPath =\n          remainingHeight > 0\n            ? svgPaths.lineOnAxis('V', spacerRow.yPos + remainingHeight)\n            : '';\n        const topRightPath = precedesStatement\n          ? insideCorners.pathTopRight\n          : '';\n        // Put all of the partial paths together.\n        this.outlinePath_ += bottomRightPath + verticalPath + topRightPath;\n        return;\n      }\n    }\n    this.outlinePath_ += svgPaths.lineOnAxis('V', row.yPos + row.height);\n  }\n\n  /**\n   * Add steps to draw the right side of an output with a dynamic connection.\n   */\n  protected drawRightDynamicConnection_() {\n    if (!this.info_.outputConnection) {\n      throw new Error(\n        `Cannot draw the output connection of a block that doesn't have one`\n      );\n    }\n    this.outlinePath_ += (\n      this.info_.outputConnection.shape as DynamicShape\n    ).pathRightDown(this.info_.outputConnection.height);\n  }\n\n  /**\n   * Add steps to draw the left side of an output with a dynamic connection.\n   */\n  protected drawLeftDynamicConnection_() {\n    if (!this.info_.outputConnection) {\n      throw new Error(\n        `Cannot draw the output connection of a block that doesn't have one`\n      );\n    }\n    this.positionOutputConnection_();\n\n    this.outlinePath_ += (\n      this.info_.outputConnection.shape as DynamicShape\n    ).pathUp(this.info_.outputConnection.height);\n\n    // Close off the path.  This draws a vertical line up to the start of the\n    // block's path, which may be either a rounded or a sharp corner.\n    this.outlinePath_ += 'z';\n  }\n\n  /** Add steps to draw a flat top row. */\n  protected drawFlatTop_() {\n    const topRow = this.info_.topRow;\n    this.positionPreviousConnection_();\n\n    this.outlinePath_ += svgPaths.moveBy(topRow.xPos, this.info_.startY);\n    this.outlinePath_ += svgPaths.lineOnAxis('h', topRow.width);\n  }\n\n  /** Add steps to draw a flat bottom row. */\n  protected drawFlatBottom_() {\n    const bottomRow = this.info_.bottomRow;\n    this.positionNextConnection_();\n\n    this.outlinePath_ += svgPaths.lineOnAxis('V', bottomRow.baseline);\n    this.outlinePath_ += svgPaths.lineOnAxis('h', -bottomRow.width);\n  }\n\n  override drawInlineInput_(input: InlineInput) {\n    this.positionInlineInputConnection_(input);\n\n    const inputName = input.input.name;\n    if (input.connectedBlock || this.info_.isInsertionMarker) {\n      return;\n    }\n\n    const width = input.width - input.connectionWidth * 2;\n    const height = input.height;\n    const yPos = input.centerline - height / 2;\n\n    const connectionRight = input.xPos + input.connectionWidth;\n\n    const outlinePath =\n      svgPaths.moveTo(connectionRight, yPos) +\n      svgPaths.lineOnAxis('h', width) +\n      (input.shape as DynamicShape).pathRightDown(input.height) +\n      svgPaths.lineOnAxis('h', -width) +\n      (input.shape as DynamicShape).pathUp(input.height) +\n      'z';\n    const pathObject = this.block_.pathObject as PathObject;\n    pathObject.setOutlinePath(inputName, outlinePath);\n  }\n\n  override drawStatementInput_(row: Row) {\n    const input = row.getLastInput() as StatementInput;\n    // Where to start drawing the notch, which is on the right side in LTR.\n    const x = input.xPos + input.notchOffset + (input.shape as BaseShape).width;\n\n    const insideCorners = this.constants_.INSIDE_CORNERS;\n    const innerTopLeftCorner =\n      (input.shape as Notch).pathRight +\n      svgPaths.lineOnAxis('h', -(input.notchOffset - insideCorners.width)) +\n      insideCorners.pathTop;\n\n    const innerHeight = row.height - 2 * insideCorners.height;\n\n    const innerBottomLeftCorner =\n      insideCorners.pathBottom +\n      svgPaths.lineOnAxis('h', input.notchOffset - insideCorners.width) +\n      (input.connectedBottomNextConnection\n        ? ''\n        : (input.shape as Notch).pathLeft);\n\n    this.outlinePath_ +=\n      svgPaths.lineOnAxis('H', x) +\n      innerTopLeftCorner +\n      svgPaths.lineOnAxis('v', innerHeight) +\n      innerBottomLeftCorner +\n      svgPaths.lineOnAxis('H', row.xPos + row.width);\n\n    this.positionStatementInputConnection_(row);\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Image field.  Used for pictures, icons, etc.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldImage');\n\nimport {Field, FieldConfig} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\n\n/**\n * Class for an image on a block.\n */\nexport class FieldImage extends Field<string> {\n  /**\n   * Vertical padding below the image, which is included in the reported height\n   * of the field.\n   */\n  private static readonly Y_PADDING = 1;\n  protected override size_: Size;\n  private readonly imageHeight: number;\n\n  /** The function to be called when this field is clicked. */\n  private clickHandler: ((p1: FieldImage) => void) | null = null;\n\n  /** The rendered field's image element. */\n  private imageElement: SVGImageElement | null = null;\n\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. This field should not.\n   */\n  override readonly EDITABLE = false;\n\n  /**\n   * Used to tell if the field needs to be rendered the next time the block is\n   * rendered. Image fields are statically sized, and only need to be\n   * rendered at initialization.\n   */\n  protected override isDirty_ = false;\n\n  /** Whether to flip this image in RTL. */\n  private flipRtl = false;\n\n  /** Alt text of this image. */\n  private altText = '';\n\n  /**\n   * @param src The URL of the image.\n   *     Also accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   * subclasses that want to handle configuration and setting the field value\n   * after their own constructors have run).\n   * @param width Width of the image.\n   * @param height Height of the image.\n   * @param alt Optional alt text for when block is collapsed.\n   * @param onClick Optional function to be called when the image is\n   *     clicked. If onClick is defined, alt must also be defined.\n   * @param flipRtl Whether to flip the icon in RTL.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/image#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    src: string | typeof Field.SKIP_SETUP,\n    width: string | number,\n    height: string | number,\n    alt?: string,\n    onClick?: (p1: FieldImage) => void,\n    flipRtl?: boolean,\n    config?: FieldImageConfig\n  ) {\n    super(Field.SKIP_SETUP);\n\n    const imageHeight = Number(parsing.replaceMessageReferences(height));\n    const imageWidth = Number(parsing.replaceMessageReferences(width));\n    if (isNaN(imageHeight) || isNaN(imageWidth)) {\n      throw Error(\n        'Height and width values of an image field must cast to' + ' numbers.'\n      );\n    }\n    if (imageHeight <= 0 || imageWidth <= 0) {\n      throw Error(\n        'Height and width values of an image field must be greater' + ' than 0.'\n      );\n    }\n\n    /** The size of the area rendered by the field. */\n    this.size_ = new Size(imageWidth, imageHeight + FieldImage.Y_PADDING);\n\n    /**\n     * Store the image height, since it is different from the field height.\n     */\n    this.imageHeight = imageHeight;\n\n    if (typeof onClick === 'function') {\n      this.clickHandler = onClick;\n    }\n\n    if (src === Field.SKIP_SETUP) return;\n\n    if (config) {\n      this.configure_(config);\n    } else {\n      this.flipRtl = !!flipRtl;\n      this.altText = parsing.replaceMessageReferences(alt) || '';\n    }\n    this.setValue(parsing.replaceMessageReferences(src));\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldImageConfig) {\n    super.configure_(config);\n    if (config.flipRtl) this.flipRtl = config.flipRtl;\n    if (config.alt) {\n      this.altText = parsing.replaceMessageReferences(config.alt);\n    }\n  }\n\n  /**\n   * Create the block UI for this image.\n   *\n   * @internal\n   */\n  override initView() {\n    this.imageElement = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'height': this.imageHeight + 'px',\n        'width': this.size_.width + 'px',\n        'alt': this.altText,\n      },\n      this.fieldGroup_\n    );\n    this.imageElement.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.value_ as string\n    );\n\n    if (this.clickHandler) {\n      this.imageElement.style.cursor = 'pointer';\n    }\n  }\n\n  override updateSize_() {}\n  // NOP\n\n  /**\n   * Ensure that the input value (the source URL) is a string.\n   *\n   * @param newValue The input value.\n   * @returns A string, or null if invalid.\n   */\n  protected override doClassValidation_(newValue?: any): string | null {\n    if (typeof newValue !== 'string') {\n      return null;\n    }\n    return newValue;\n  }\n\n  /**\n   * Update the value of this image field, and update the displayed image.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a string.\n   */\n  protected override doValueUpdate_(newValue: string) {\n    this.value_ = newValue;\n    if (this.imageElement) {\n      this.imageElement.setAttributeNS(dom.XLINK_NS, 'xlink:href', this.value_);\n    }\n  }\n\n  /**\n   * Get whether to flip this image in RTL\n   *\n   * @returns True if we should flip in RTL.\n   */\n  override getFlipRtl(): boolean {\n    return this.flipRtl;\n  }\n\n  /**\n   * Set the alt text of this image.\n   *\n   * @param alt New alt text.\n   */\n  setAlt(alt: string | null) {\n    if (alt === this.altText) {\n      return;\n    }\n    this.altText = alt || '';\n    if (this.imageElement) {\n      this.imageElement.setAttribute('alt', this.altText);\n    }\n  }\n\n  /**\n   * If field click is called, and click handler defined,\n   * call the handler.\n   */\n  protected override showEditor_() {\n    if (this.clickHandler) {\n      this.clickHandler(this);\n    }\n  }\n\n  /**\n   * Set the function that is called when this image  is clicked.\n   *\n   * @param func The function that is called when the image is clicked, or null\n   *     to remove.\n   */\n  setOnClickHandler(func: ((p1: FieldImage) => void) | null) {\n    this.clickHandler = func;\n  }\n\n  /**\n   * Use the `getText_` developer hook to override the field's text\n   * representation.\n   * Return the image alt text instead.\n   *\n   * @returns The image alt text.\n   */\n  protected override getText_(): string | null {\n    return this.altText;\n  }\n\n  /**\n   * Construct a FieldImage from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (src, width, height, alt, and\n   *     flipRtl).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldImageFromJsonConfig): FieldImage {\n    if (!options.src || !options.width || !options.height) {\n      throw new Error(\n        'src, width, and height values for an image field are' +\n          'required. The width and height must be non-zero.'\n      );\n    }\n    // `this` might be a subclass of FieldImage if that class doesn't override\n    // the static fromJson method.\n    return new this(\n      options.src,\n      options.width,\n      options.height,\n      undefined,\n      undefined,\n      undefined,\n      options\n    );\n  }\n}\n\nfieldRegistry.register('field_image', FieldImage);\n\nFieldImage.prototype.DEFAULT_VALUE = '';\n\n/**\n * Config options for the image field.\n */\nexport interface FieldImageConfig extends FieldConfig {\n  flipRtl?: boolean;\n  alt?: string;\n}\n\n/**\n * fromJson config options for the colour field.\n */\nexport interface FieldImageFromJsonConfig extends FieldImageConfig {\n  src?: string;\n  width?: number;\n  height?: number;\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Text input field.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldInput');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport {BlockSvg} from './block_svg.js';\nimport * as bumpObjects from './bump_objects.js';\nimport * as browserEvents from './browser_events.js';\nimport * as dialog from './dialog.js';\nimport * as dom from './utils/dom.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport {\n  Field,\n  FieldConfig,\n  FieldValidator,\n  UnattachedFieldError,\n} from './field.js';\nimport {Msg} from './msg.js';\nimport * as aria from './utils/aria.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport * as renderManagement from './render_management.js';\n\n/**\n * Supported types for FieldInput subclasses.\n *\n * @internal\n */\ntype InputTypes = string | number;\n\n/**\n * Abstract class for an editable input field.\n *\n * @typeParam T - The value stored on the field.\n * @internal\n */\nexport abstract class FieldInput<T extends InputTypes> extends Field<\n  string | T\n> {\n  /**\n   * Pixel size of input border radius.\n   * Should match blocklyText's border-radius in CSS.\n   */\n  static BORDERRADIUS = 4;\n\n  /** Allow browser to spellcheck this field. */\n  protected spellcheck_ = true;\n\n  /** The HTML input element. */\n  protected htmlInput_: HTMLInputElement | null = null;\n\n  /** True if the field's value is currently being edited via the UI. */\n  protected isBeingEdited_ = false;\n\n  /**\n   * True if the value currently displayed in the field's editory UI is valid.\n   */\n  protected isTextValid_ = false;\n\n  /** Key down event data. */\n  private onKeyDownWrapper_: browserEvents.Data | null = null;\n\n  /** Key input event data. */\n  private onKeyInputWrapper_: browserEvents.Data | null = null;\n\n  /**\n   * Whether the field should consider the whole parent block to be its click\n   * target.\n   */\n  fullBlockClickTarget_: boolean | null = false;\n\n  /** The workspace that this field belongs to. */\n  protected workspace_: WorkspaceSvg | null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  override CURSOR = 'text';\n\n  /**\n   * @param value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a string & returns a validated string, or null\n   *     to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/text-input#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    validator?: FieldInputValidator<T> | null,\n    config?: FieldInputConfig\n  ) {\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  protected override configure_(config: FieldInputConfig) {\n    super.configure_(config);\n    if (config.spellcheck !== undefined) {\n      this.spellcheck_ = config.spellcheck;\n    }\n  }\n\n  /** @internal */\n  override initView() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    if (this.getConstants()!.FULL_BLOCK_FIELDS) {\n      // Step one: figure out if this is the only field on this block.\n      // Rendering is quite different in that case.\n      let nFields = 0;\n      let nConnections = 0;\n      // Count the number of fields, excluding text fields\n      for (let i = 0, input; (input = block.inputList[i]); i++) {\n        for (let j = 0; input.fieldRow[j]; j++) {\n          nFields++;\n        }\n        if (input.connection) {\n          nConnections++;\n        }\n      }\n      // The special case is when this is the only non-label field on the block\n      // and it has an output but no inputs.\n      this.fullBlockClickTarget_ =\n        nFields <= 1 && block.outputConnection && !nConnections;\n    } else {\n      this.fullBlockClickTarget_ = false;\n    }\n\n    if (this.fullBlockClickTarget_) {\n      this.clickTarget_ = (this.sourceBlock_ as BlockSvg).getSvgRoot();\n    } else {\n      this.createBorderRect_();\n    }\n    this.createTextElement_();\n  }\n\n  /**\n   * Called by setValue if the text input is not valid. If the field is\n   * currently being edited it reverts value of the field to the previous\n   * value while allowing the display text to be handled by the htmlInput_.\n   *\n   * @param _invalidValue The input value that was determined to be invalid.\n   *    This is not used by the text input because its display value is stored\n   * on the htmlInput_.\n   */\n  protected override doValueInvalid_(_invalidValue: AnyDuringMigration) {\n    if (this.isBeingEdited_) {\n      this.isDirty_ = true;\n      this.isTextValid_ = false;\n      const oldValue = this.value_;\n      // Revert value when the text becomes invalid.\n      this.value_ = this.htmlInput_!.getAttribute('data-untyped-default-value');\n      if (this.sourceBlock_ && eventUtils.isEnabled()) {\n        eventUtils.fire(\n          new (eventUtils.get(eventUtils.BLOCK_CHANGE))(\n            this.sourceBlock_,\n            'field',\n            this.name || null,\n            oldValue,\n            this.value_\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   * Called by setValue if the text input is valid. Updates the value of the\n   * field, and updates the text of the field if it is not currently being\n   * edited (i.e. handled by the htmlInput_).\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a string.\n   */\n  protected override doValueUpdate_(newValue: string | T) {\n    this.isDirty_ = true;\n    this.isTextValid_ = true;\n    this.value_ = newValue;\n  }\n\n  /**\n   * Updates text field to match the colour/style of the block.\n   */\n  override applyColour() {\n    if (!this.sourceBlock_ || !this.getConstants()!.FULL_BLOCK_FIELDS) return;\n\n    const source = this.sourceBlock_ as BlockSvg;\n\n    if (this.borderRect_) {\n      this.borderRect_.setAttribute('stroke', source.style.colourTertiary);\n    } else {\n      source.pathObject.svgPath.setAttribute(\n        'fill',\n        this.getConstants()!.FIELD_BORDER_RECT_COLOUR\n      );\n    }\n  }\n\n  /**\n   * Updates the colour of the htmlInput given the current validity of the\n   * field's value.\n   */\n  protected override render_() {\n    super.render_();\n    // This logic is done in render_ rather than doValueInvalid_ or\n    // doValueUpdate_ so that the code is more centralized.\n    if (this.isBeingEdited_) {\n      this.resizeEditor_();\n      const htmlInput = this.htmlInput_ as HTMLElement;\n      if (!this.isTextValid_) {\n        dom.addClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, true);\n      } else {\n        dom.removeClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, false);\n      }\n    }\n  }\n\n  /**\n   * Set whether this field is spellchecked by the browser.\n   *\n   * @param check True if checked.\n   */\n  setSpellcheck(check: boolean) {\n    if (check === this.spellcheck_) {\n      return;\n    }\n    this.spellcheck_ = check;\n    if (this.htmlInput_) {\n      // AnyDuringMigration because:  Argument of type 'boolean' is not\n      // assignable to parameter of type 'string'.\n      this.htmlInput_.setAttribute(\n        'spellcheck',\n        this.spellcheck_ as AnyDuringMigration\n      );\n    }\n  }\n\n  /**\n   * Show an editor for the field.\n   * Shows the inline free-text editor on top of the text by default.\n   * Shows a prompt editor for mobile browsers if the modalInputs option is\n   * enabled.\n   *\n   * @param _e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   * @param quietInput True if editor should be created without focus.\n   *     Defaults to false.\n   */\n  protected override showEditor_(_e?: Event, quietInput = false) {\n    this.workspace_ = (this.sourceBlock_ as BlockSvg).workspace;\n    if (\n      !quietInput &&\n      this.workspace_.options.modalInputs &&\n      (userAgent.MOBILE || userAgent.ANDROID || userAgent.IPAD)\n    ) {\n      this.showPromptEditor_();\n    } else {\n      this.showInlineEditor_(quietInput);\n    }\n  }\n\n  /**\n   * Create and show a text input editor that is a prompt (usually a popup).\n   * Mobile browsers may have issues with in-line textareas (focus and\n   * keyboards).\n   */\n  private showPromptEditor_() {\n    dialog.prompt(\n      Msg['CHANGE_VALUE_TITLE'],\n      this.getText(),\n      (text: string | null) => {\n        // Text is null if user pressed cancel button.\n        if (text !== null) {\n          this.setValue(this.getValueFromEditorText_(text));\n        }\n      }\n    );\n  }\n\n  /**\n   * Create and show a text input editor that sits directly over the text input.\n   *\n   * @param quietInput True if editor should be created without focus.\n   */\n  private showInlineEditor_(quietInput: boolean) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    WidgetDiv.show(this, block.RTL, this.widgetDispose_.bind(this));\n    this.htmlInput_ = this.widgetCreate_() as HTMLInputElement;\n    this.isBeingEdited_ = true;\n\n    if (!quietInput) {\n      (this.htmlInput_ as HTMLElement).focus({\n        preventScroll: true,\n      });\n      this.htmlInput_.select();\n    }\n  }\n\n  /**\n   * Create the text input editor widget.\n   *\n   * @returns The newly created text input editor.\n   */\n  protected widgetCreate_(): HTMLElement {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    eventUtils.setGroup(true);\n    const div = WidgetDiv.getDiv();\n\n    const clickTarget = this.getClickTarget_();\n    if (!clickTarget) throw new Error('A click target has not been set.');\n    dom.addClass(clickTarget, 'editing');\n\n    const htmlInput = document.createElement('input');\n    htmlInput.className = 'blocklyHtmlInput';\n    // AnyDuringMigration because:  Argument of type 'boolean' is not assignable\n    // to parameter of type 'string'.\n    htmlInput.setAttribute(\n      'spellcheck',\n      this.spellcheck_ as AnyDuringMigration\n    );\n    const scale = this.workspace_!.getScale();\n    const fontSize = this.getConstants()!.FIELD_TEXT_FONTSIZE * scale + 'pt';\n    div!.style.fontSize = fontSize;\n    htmlInput.style.fontSize = fontSize;\n    let borderRadius = FieldInput.BORDERRADIUS * scale + 'px';\n\n    if (this.fullBlockClickTarget_) {\n      const bBox = this.getScaledBBox();\n\n      // Override border radius.\n      borderRadius = (bBox.bottom - bBox.top) / 2 + 'px';\n      // Pull stroke colour from the existing shadow block\n      const strokeColour = block.getParent()\n        ? (block.getParent() as BlockSvg).style.colourTertiary\n        : (this.sourceBlock_ as BlockSvg).style.colourTertiary;\n      htmlInput.style.border = 1 * scale + 'px solid ' + strokeColour;\n      div!.style.borderRadius = borderRadius;\n      div!.style.transition = 'box-shadow 0.25s ease 0s';\n      if (this.getConstants()!.FIELD_TEXTINPUT_BOX_SHADOW) {\n        div!.style.boxShadow =\n          'rgba(255, 255, 255, 0.3) 0 0 0 ' + 4 * scale + 'px';\n      }\n    }\n    htmlInput.style.borderRadius = borderRadius;\n\n    div!.appendChild(htmlInput);\n\n    htmlInput.value = htmlInput.defaultValue = this.getEditorText_(this.value_);\n    htmlInput.setAttribute('data-untyped-default-value', String(this.value_));\n\n    this.resizeEditor_();\n\n    this.bindInputEvents_(htmlInput);\n\n    return htmlInput;\n  }\n\n  /**\n   * Closes the editor, saves the results, and disposes of any events or\n   * DOM-references belonging to the editor.\n   */\n  protected widgetDispose_() {\n    // Non-disposal related things that we do when the editor closes.\n    this.isBeingEdited_ = false;\n    this.isTextValid_ = true;\n    // Make sure the field's node matches the field's internal value.\n    this.forceRerender();\n    this.onFinishEditing_(this.value_);\n    eventUtils.setGroup(false);\n\n    // Actual disposal.\n    this.unbindInputEvents_();\n    const style = WidgetDiv.getDiv()!.style;\n    style.width = 'auto';\n    style.height = 'auto';\n    style.fontSize = '';\n    style.transition = '';\n    style.boxShadow = '';\n    this.htmlInput_ = null;\n\n    const clickTarget = this.getClickTarget_();\n    if (!clickTarget) throw new Error('A click target has not been set.');\n    dom.removeClass(clickTarget, 'editing');\n  }\n\n  /**\n   * A callback triggered when the user is done editing the field via the UI.\n   *\n   * @param _value The new value of the field.\n   */\n  onFinishEditing_(_value: AnyDuringMigration) {}\n  // NOP by default.\n  // TODO(#2496): Support people passing a func into the field.\n\n  /**\n   * Bind handlers for user input on the text input field's editor.\n   *\n   * @param htmlInput The htmlInput to which event handlers will be bound.\n   */\n  protected bindInputEvents_(htmlInput: HTMLElement) {\n    // Trap Enter without IME and Esc to hide.\n    this.onKeyDownWrapper_ = browserEvents.conditionalBind(\n      htmlInput,\n      'keydown',\n      this,\n      this.onHtmlInputKeyDown_\n    );\n    // Resize after every input change.\n    this.onKeyInputWrapper_ = browserEvents.conditionalBind(\n      htmlInput,\n      'input',\n      this,\n      this.onHtmlInputChange_\n    );\n  }\n\n  /** Unbind handlers for user input and workspace size changes. */\n  protected unbindInputEvents_() {\n    if (this.onKeyDownWrapper_) {\n      browserEvents.unbind(this.onKeyDownWrapper_);\n      this.onKeyDownWrapper_ = null;\n    }\n    if (this.onKeyInputWrapper_) {\n      browserEvents.unbind(this.onKeyInputWrapper_);\n      this.onKeyInputWrapper_ = null;\n    }\n  }\n\n  /**\n   * Handle key down to the editor.\n   *\n   * @param e Keyboard event.\n   */\n  protected onHtmlInputKeyDown_(e: KeyboardEvent) {\n    if (e.key === 'Enter') {\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n    } else if (e.key === 'Escape') {\n      this.setValue(\n        this.htmlInput_!.getAttribute('data-untyped-default-value')\n      );\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n    } else if (e.key === 'Tab') {\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n      (this.sourceBlock_ as BlockSvg).tab(this, !e.shiftKey);\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * Handle a change to the editor.\n   *\n   * @param _e Keyboard event.\n   */\n  private onHtmlInputChange_(_e: Event) {\n    this.setValue(this.getValueFromEditorText_(this.htmlInput_!.value));\n\n    // Resize the widget div after the block has finished rendering.\n    renderManagement.finishQueuedRenders().then(() => {\n      this.resizeEditor_();\n    });\n  }\n\n  /**\n   * Set the HTML input value and the field's internal value. The difference\n   * between this and `setValue` is that this also updates the HTML input\n   * value whilst editing.\n   *\n   * @param newValue New value.\n   */\n  protected setEditorValue_(newValue: AnyDuringMigration) {\n    this.isDirty_ = true;\n    if (this.isBeingEdited_) {\n      // In the case this method is passed an invalid value, we still\n      // pass it through the transformation method `getEditorText` to deal\n      // with. Otherwise, the internal field's state will be inconsistent\n      // with what's shown to the user.\n      this.htmlInput_!.value = this.getEditorText_(newValue);\n    }\n    this.setValue(newValue);\n  }\n\n  /** Resize the editor to fit the text. */\n  protected resizeEditor_() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const div = WidgetDiv.getDiv();\n    const bBox = this.getScaledBBox();\n    div!.style.width = bBox.right - bBox.left + 'px';\n    div!.style.height = bBox.bottom - bBox.top + 'px';\n\n    // In RTL mode block fields and LTR input fields the left edge moves,\n    // whereas the right edge is fixed.  Reposition the editor.\n    const x = block.RTL ? bBox.right - div!.offsetWidth : bBox.left;\n    const xy = new Coordinate(x, bBox.top);\n\n    div!.style.left = xy.x + 'px';\n    div!.style.top = xy.y + 'px';\n  }\n\n  /**\n   * Handles repositioning the WidgetDiv used for input fields when the\n   * workspace is resized. Will bump the block into the viewport and update the\n   * position of the field if necessary.\n   *\n   * @returns True for rendered workspaces, as we never want to hide the widget\n   *     div.\n   */\n  override repositionForWindowResize(): boolean {\n    const block = this.getSourceBlock();\n    // This shouldn't be possible. We should never have a WidgetDiv if not using\n    // rendered blocks.\n    if (!(block instanceof BlockSvg)) return false;\n\n    bumpObjects.bumpIntoBounds(\n      this.workspace_!,\n      this.workspace_!.getMetricsManager().getViewMetrics(true),\n      block\n    );\n\n    this.resizeEditor_();\n\n    return true;\n  }\n\n  /**\n   * Returns whether or not the field is tab navigable.\n   *\n   * @returns True if the field is tab navigable.\n   */\n  override isTabNavigable(): boolean {\n    return true;\n  }\n\n  /**\n   * Use the `getText_` developer hook to override the field's text\n   * representation. When we're currently editing, return the current HTML value\n   * instead. Otherwise, return null which tells the field to use the default\n   * behaviour (which is a string cast of the field's value).\n   *\n   * @returns The HTML value if we're editing, otherwise null.\n   */\n  protected override getText_(): string | null {\n    if (this.isBeingEdited_ && this.htmlInput_) {\n      // We are currently editing, return the HTML input value instead.\n      return this.htmlInput_.value;\n    }\n    return null;\n  }\n\n  /**\n   * Transform the provided value into a text to show in the HTML input.\n   * Override this method if the field's HTML input representation is different\n   * than the field's value. This should be coupled with an override of\n   * `getValueFromEditorText_`.\n   *\n   * @param value The value stored in this field.\n   * @returns The text to show on the HTML input.\n   */\n  protected getEditorText_(value: AnyDuringMigration): string {\n    return `${value}`;\n  }\n\n  /**\n   * Transform the text received from the HTML input into a value to store\n   * in this field.\n   * Override this method if the field's HTML input representation is different\n   * than the field's value. This should be coupled with an override of\n   * `getEditorText_`.\n   *\n   * @param text Text received from the HTML input.\n   * @returns The value to store.\n   */\n  protected getValueFromEditorText_(text: string): AnyDuringMigration {\n    return text;\n  }\n}\n\n/**\n * Config options for the input field.\n *\n * @internal\n */\nexport interface FieldInputConfig extends FieldConfig {\n  spellcheck?: boolean;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n * @internal\n */\nexport type FieldInputValidator<T extends InputTypes> = FieldValidator<\n  string | T\n>;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Text input field.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldTextInput');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport {Field} from './field.js';\nimport {\n  FieldInput,\n  FieldInputConfig,\n  FieldInputValidator,\n} from './field_input.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as parsing from './utils/parsing.js';\n\n/**\n * Class for an editable text field.\n */\nexport class FieldTextInput extends FieldInput<string> {\n  /**\n   * @param value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a string & returns a validated string, or null\n   *     to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/text-input#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    validator?: FieldTextInputValidator | null,\n    config?: FieldTextInputConfig\n  ) {\n    super(value, validator, config);\n  }\n\n  /**\n   * Ensure that the input value casts to a valid string.\n   *\n   * @param newValue The input value.\n   * @returns A valid string, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration\n  ): string | null {\n    if (newValue === undefined) {\n      return null;\n    }\n    return `${newValue}`;\n  }\n\n  /**\n   * Construct a FieldTextInput from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and spellcheck).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldTextInputFromJsonConfig): FieldTextInput {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldTextInput if that class doesn't\n    // override the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_input', FieldTextInput);\n\nFieldTextInput.prototype.DEFAULT_VALUE = '';\n\n/**\n *  Config options for the text input field.\n */\nexport type FieldTextInputConfig = FieldInputConfig;\n\n/**\n * fromJson config options for the text input field.\n */\nexport interface FieldTextInputFromJsonConfig extends FieldTextInputConfig {\n  text?: string;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldTextInputValidator = FieldInputValidator<string>;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Row');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport type {Measurable} from './base.js';\nimport type {InRowSpacer} from './in_row_spacer.js';\nimport type {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object representing a single row on a rendered block and all of its\n * subcomponents.\n */\nexport class Row {\n  type: number;\n\n  /**\n   * An array of elements contained in this row.\n   */\n  elements: Measurable[] = [];\n\n  /**\n   * The height of the row.\n   */\n  height = 0;\n\n  /**\n   * The width of the row, from the left edge of the block to the right.\n   * Does not include child blocks unless they are inline.\n   */\n  width = 0;\n\n  /**\n   * The minimum height of the row.\n   */\n  minHeight = 0;\n\n  /**\n   * The minimum width of the row, from the left edge of the block to the\n   * right. Does not include child blocks unless they are inline.\n   */\n  minWidth = 0;\n\n  /**\n   * The width of the row, from the left edge of the block to the edge of the\n   * block or any connected child blocks.\n   */\n  widthWithConnectedBlocks = 0;\n\n  /**\n   * The Y position of the row relative to the origin of the block's svg\n   * group.\n   */\n  yPos = 0;\n\n  /**\n   * The X position of the row relative to the origin of the block's svg\n   * group.\n   */\n  xPos = 0;\n\n  /**\n   * Whether the row has any external inputs.\n   */\n  hasExternalInput = false;\n\n  /**\n   * Whether the row has any statement inputs.\n   */\n  hasStatement = false;\n\n  /**\n   * Where the left edge of all of the statement inputs on the block should\n   * be. This makes sure that statement inputs which are proceded by fields\n   * of varius widths are all aligned.\n   */\n  statementEdge = 0;\n\n  /**\n   * Whether the row has any inline inputs.\n   */\n  hasInlineInput = false;\n\n  /**\n   * Whether the row has any dummy inputs.\n   */\n  hasDummyInput = false;\n\n  /**\n   * Whether the row has a jagged edge.\n   */\n  hasJaggedEdge = false;\n  notchOffset: number;\n\n  /**\n   * Alignment of the row.\n   */\n  align: number | null = null;\n\n  protected readonly constants_: ConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    /** The renderer's constant provider. */\n    this.constants_ = constants;\n\n    /** The type of this rendering object. */\n    this.type = Types.ROW;\n\n    this.notchOffset = this.constants_.NOTCH_OFFSET_LEFT;\n  }\n\n  /**\n   * Get the last input on this row, if it has one.\n   *\n   * @returns The last input on the row, or null.\n   */\n  getLastInput(): InputConnection | null {\n    // TODO: Consider moving this to InputRow, if possible.\n    for (let i = this.elements.length - 1; i >= 0; i--) {\n      const elem = this.elements[i];\n      if (Types.isInput(elem)) {\n        return elem as InputConnection;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Inspect all subcomponents and populate all size properties on the row.\n   */\n  measure() {\n    throw Error('Unexpected attempt to measure a base Row.');\n  }\n\n  /**\n   * Determines whether this row should start with an element spacer.\n   *\n   * @returns Whether the row should start with a spacer.\n   */\n  startsWithElemSpacer(): boolean {\n    return true;\n  }\n\n  /**\n   * Determines whether this row should end with an element spacer.\n   *\n   * @returns Whether the row should end with a spacer.\n   */\n  endsWithElemSpacer(): boolean {\n    return true;\n  }\n\n  /**\n   * Convenience method to get the first spacer element on this row.\n   *\n   * @returns The first spacer element on this row.\n   */\n  getFirstSpacer(): InRowSpacer | null {\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      if (Types.isSpacer(elem)) {\n        return elem as InRowSpacer;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Convenience method to get the last spacer element on this row.\n   *\n   * @returns The last spacer element on this row.\n   */\n  getLastSpacer(): InRowSpacer | null {\n    for (let i = this.elements.length - 1; i >= 0; i--) {\n      const elem = this.elements[i];\n      if (Types.isSpacer(elem)) {\n        return elem as InRowSpacer;\n      }\n    }\n    return null;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.BottomRow');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport type {NextConnection} from './next_connection.js';\nimport {Row} from './row.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about what elements are in the bottom row of\n * a block as well as spacing information for the bottom row.\n * Elements in a bottom row can consist of corners, spacers and next\n * connections.\n */\nexport class BottomRow extends Row {\n  /**\n   * Whether this row has a next connection.\n   */\n  hasNextConnection = false;\n\n  /**\n   * The next connection on the row, if any.\n   */\n  connection: NextConnection | null = null;\n\n  /**\n   * The amount that the bottom of the block extends below the horizontal\n   * edge, e.g. because of a next connection.  Must be non-negative (see\n   * #2820).\n   */\n  descenderHeight = 0;\n\n  /**\n   * The Y position of the bottom edge of the block, relative to the origin\n   * of the block rendering.\n   */\n  baseline = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.BOTTOM_ROW;\n  }\n\n  /**\n   * Returns whether or not the bottom row has a left square corner.\n   *\n   * @param block The block whose bottom row this represents.\n   * @returns Whether or not the bottom row has a left square corner.\n   */\n  hasLeftSquareCorner(block: BlockSvg): boolean {\n    return !!block.outputConnection || !!block.getNextBlock();\n  }\n\n  /**\n   * Returns whether or not the bottom row has a right square corner.\n   *\n   * @param _block The block whose bottom row this represents.\n   * @returns Whether or not the bottom row has a right square corner.\n   */\n  hasRightSquareCorner(_block: BlockSvg): boolean {\n    return true;\n  }\n\n  override measure() {\n    let height = 0;\n    let width = 0;\n    let descenderHeight = 0;\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      width += elem.width;\n      if (!Types.isSpacer(elem)) {\n        // Note: this assumes that next connections have *only* descenderHeight,\n        // with no height above the baseline.\n        if (Types.isNextConnection(elem)) {\n          descenderHeight = Math.max(descenderHeight, elem.height);\n        } else {\n          height = Math.max(height, elem.height);\n        }\n      }\n    }\n    this.width = Math.max(this.minWidth, width);\n    this.height = Math.max(this.minHeight, height) + descenderHeight;\n    this.descenderHeight = descenderHeight;\n    this.widthWithConnectedBlocks = this.width;\n  }\n\n  override startsWithElemSpacer() {\n    return false;\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.InputConnection');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Input} from '../../inputs/input.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n/**\n * The base class to represent an input that takes up space on a block\n * during rendering.\n */\nexport class InputConnection extends Connection {\n  align: number;\n  connectedBlock: BlockSvg | null;\n  connectedBlockWidth: number;\n  connectedBlockHeight: number;\n  connectionOffsetX = 0;\n  connectionOffsetY = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, public input: Input) {\n    super(constants, input.connection as RenderedConnection);\n\n    this.type |= Types.INPUT;\n\n    this.align = input.align;\n\n    this.connectedBlock =\n      input.connection && input.connection.targetBlock()\n        ? (input.connection.targetBlock() as BlockSvg)\n        : null;\n\n    if (this.connectedBlock) {\n      const bBox = this.connectedBlock.getHeightWidth();\n      this.connectedBlockWidth = bBox.width;\n      this.connectedBlockHeight = bBox.height;\n    } else {\n      this.connectedBlockWidth = 0;\n      this.connectedBlockHeight = 0;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.ExternalValueInput');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../inputs/input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space an external value input\n * takes up during rendering\n */\nexport class ExternalValueInput extends InputConnection {\n  override height = 0;\n  override width: number;\n  override connectionOffsetY: number;\n  connectionHeight: number;\n  connectionWidth: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The external value input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n    this.type |= Types.EXTERNAL_VALUE_INPUT;\n    if (!this.connectedBlock) {\n      this.height = this.shape.height as number;\n    } else {\n      this.height =\n        this.connectedBlockHeight -\n        this.constants_.TAB_OFFSET_FROM_TOP -\n        this.constants_.MEDIUM_PADDING;\n    }\n\n    this.width =\n      (this.shape.width as number) +\n      this.constants_.EXTERNAL_VALUE_INPUT_PADDING;\n\n    this.connectionOffsetY = this.constants_.TAB_OFFSET_FROM_TOP;\n\n    this.connectionHeight = this.shape.height as number;\n\n    this.connectionWidth = this.shape.width as number;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Field');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Field as BlocklyField} from '../../field.js';\nimport type {Input} from '../../inputs/input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a field takes up during\n * rendering\n */\nexport class Field extends Measurable {\n  isEditable: boolean;\n  flipRtl: boolean;\n  override height: number;\n  override width: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param field The field to measure and store information for.\n   * @param parentInput The parent input for the field.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public field: BlocklyField,\n    public parentInput: Input\n  ) {\n    super(constants);\n\n    this.isEditable = field.EDITABLE;\n\n    this.flipRtl = field.getFlipRtl();\n    this.type |= Types.FIELD;\n\n    const size = this.field.getSize();\n\n    this.height = size.height;\n\n    this.width = size.width;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Hat');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a hat takes up during\n * rendering.\n */\nexport class Hat extends Measurable {\n  ascenderHeight: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.HAT;\n\n    this.height = this.constants_.START_HAT.height;\n    this.width = this.constants_.START_HAT.width;\n\n    this.ascenderHeight = this.height;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Icon');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {IIcon as BlocklyIcon} from '../../interfaces/i_icon.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\nimport {hasBubble} from '../../interfaces/i_has_bubble.js';\n\n/**\n * An object containing information about the space an icon takes up during\n * rendering.\n */\nexport class Icon extends Measurable {\n  /**\n   * @deprecated Will be removed in v11. Create a subclass of the Icon\n   *     measurable if this data is necessary for you.\n   */\n  isVisible: boolean;\n  flipRtl = false;\n\n  /**\n   * An object containing information about the space an icon takes up during\n   * rendering.\n   *\n   * @param constants The rendering constants provider.\n   * @param icon The icon to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, public icon: BlocklyIcon) {\n    super(constants);\n\n    this.isVisible = hasBubble(icon) && icon.bubbleIsVisible();\n    this.type |= Types.ICON;\n\n    const size = icon.getSize();\n    this.height = size.height;\n    this.width = size.width;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.InRowSpacer');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about a spacer between two elements on a\n * row.\n */\nexport class InRowSpacer extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @param width The width of the spacer.\n   */\n  constructor(constants: ConstantProvider, width: number) {\n    super(constants);\n    this.type |= Types.SPACER | Types.IN_ROW_SPACER;\n    this.width = width;\n    this.height = this.constants_.SPACER_DEFAULT_HEIGHT;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.InlineInput');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../inputs/input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space an inline input takes up\n * during rendering.\n */\nexport class InlineInput extends InputConnection {\n  connectionHeight: number;\n  connectionWidth: number;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The inline input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n    this.type |= Types.INLINE_INPUT;\n\n    if (!this.connectedBlock) {\n      this.height = this.constants_.EMPTY_INLINE_INPUT_HEIGHT;\n      this.width = this.constants_.EMPTY_INLINE_INPUT_PADDING;\n    } else {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.width = this.connectedBlockWidth;\n      this.height = this.connectedBlockHeight;\n    }\n\n    this.connectionHeight = !this.isDynamicShape\n      ? (this.shape.height as number)\n      : (this.shape.height as (p1: number) => number)(this.height);\n\n    this.connectionWidth = !this.isDynamicShape\n      ? (this.shape.width as number)\n      : (this.shape.width as (p1: number) => number)(this.height);\n    if (!this.connectedBlock) {\n      this.width += this.connectionWidth * (this.isDynamicShape ? 2 : 1);\n    }\n\n    this.connectionOffsetY =\n      'connectionOffsetY' in this.shape\n        ? this.shape.connectionOffsetY(this.connectionHeight)\n        : this.constants_.TAB_OFFSET_FROM_TOP;\n\n    this.connectionOffsetX =\n      'connectionOffsetX' in this.shape\n        ? this.shape.connectionOffsetX(this.connectionWidth)\n        : 0;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.StatementInput');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../inputs/input.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InputConnection} from './input_connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a statement input takes up\n * during rendering\n */\nexport class StatementInput extends InputConnection {\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The statement input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n    this.type |= Types.STATEMENT_INPUT;\n\n    if (!this.connectedBlock) {\n      this.height = this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT;\n    } else {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.height =\n        this.connectedBlockHeight + this.constants_.STATEMENT_BOTTOM_SPACER;\n    }\n    this.width =\n      this.constants_.STATEMENT_INPUT_NOTCH_OFFSET +\n      (this.shape.width as number);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.InputRow');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {ExternalValueInput} from './external_value_input.js';\nimport {InputConnection} from './input_connection.js';\nimport {Row} from './row.js';\nimport {StatementInput} from './statement_input.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about a row that holds one or more inputs.\n */\nexport class InputRow extends Row {\n  /**\n   * The total width of all blocks connected to this row.\n   */\n  connectedBlockWidths = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.INPUT_ROW;\n  }\n\n  /**\n   * Inspect all subcomponents and populate all size properties on the row.\n   */\n  override measure() {\n    this.width = this.minWidth;\n    this.height = this.minHeight;\n    let connectedBlockWidths = 0;\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      this.width += elem.width;\n      if (Types.isInput(elem) && elem instanceof InputConnection) {\n        if (Types.isStatementInput(elem) && elem instanceof StatementInput) {\n          connectedBlockWidths += elem.connectedBlockWidth;\n        } else if (\n          Types.isExternalInput(elem) &&\n          elem instanceof ExternalValueInput &&\n          elem.connectedBlockWidth !== 0\n        ) {\n          connectedBlockWidths +=\n            elem.connectedBlockWidth - elem.connectionWidth;\n        }\n      }\n      if (!Types.isSpacer(elem)) {\n        this.height = Math.max(this.height, elem.height);\n      }\n    }\n    this.connectedBlockWidths = connectedBlockWidths;\n    this.widthWithConnectedBlocks = this.width + connectedBlockWidths;\n  }\n\n  override endsWithElemSpacer() {\n    return !this.hasExternalInput && !this.hasStatement;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.JaggedEdge');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space the jagged edge of a\n * collapsed block takes up during rendering.\n */\nexport class JaggedEdge extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.JAGGED_EDGE;\n    this.height = this.constants_.JAGGED_TEETH.height;\n    this.width = this.constants_.JAGGED_TEETH.width;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.NextConnection');\n\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a next connection takes\n * up during rendering.\n */\nexport class NextConnection extends Connection {\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   */\n  constructor(\n    constants: ConstantProvider,\n    connectionModel: RenderedConnection\n  ) {\n    super(constants, connectionModel);\n    this.type |= Types.NEXT_CONNECTION;\n    this.height = this.shape.height as number;\n    this.width = this.shape.width as number;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.OutputConnection');\n\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space an output connection takes\n * up during rendering.\n */\nexport class OutputConnection extends Connection {\n  startX: number;\n  connectionOffsetY: number;\n  connectionOffsetX = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   */\n  constructor(\n    constants: ConstantProvider,\n    connectionModel: RenderedConnection\n  ) {\n    super(constants, connectionModel);\n    this.type |= Types.OUTPUT_CONNECTION;\n\n    this.height = !this.isDynamicShape ? (this.shape.height as number) : 0;\n    this.width = !this.isDynamicShape ? (this.shape.width as number) : 0;\n\n    this.startX = this.width;\n\n    this.connectionOffsetY = this.constants_.TAB_OFFSET_FROM_TOP;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.PreviousConnection');\n\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Connection} from './connection.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a previous connection takes\n * up during rendering.\n */\nexport class PreviousConnection extends Connection {\n  /**\n   * @param constants The rendering constants provider.\n   * @param connectionModel The connection object on the block that this\n   *     represents.\n   */\n  constructor(\n    constants: ConstantProvider,\n    connectionModel: RenderedConnection\n  ) {\n    super(constants, connectionModel);\n    this.type |= Types.PREVIOUS_CONNECTION;\n    this.height = this.shape.height as number;\n    this.width = this.shape.width as number;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.RoundCorner');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a rounded corner takes up\n * during rendering.\n */\nexport class RoundCorner extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @param opt_position The position of this corner.\n   */\n  constructor(constants: ConstantProvider, opt_position?: string) {\n    super(constants);\n    this.type =\n      (!opt_position || opt_position === 'left'\n        ? Types.LEFT_ROUND_CORNER\n        : Types.RIGHT_ROUND_CORNER) | Types.CORNER;\n    this.width = this.constants_.CORNER_RADIUS;\n    // The rounded corner extends into the next row by 4 so we only take the\n    // height that is aligned with this row.\n    this.height = this.constants_.CORNER_RADIUS / 2;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.SpacerRow');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {InRowSpacer} from './in_row_spacer.js';\nimport {Row} from './row.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about a spacer between two rows.\n */\nexport class SpacerRow extends Row {\n  followsStatement = false;\n\n  precedesStatement = false;\n\n  override widthWithConnectedBlocks = 0;\n  override elements: InRowSpacer[];\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param height The height of the spacer.\n   * @param width The width of the spacer.\n   */\n  constructor(\n    constants: ConstantProvider,\n    public override height: number,\n    public override width: number\n  ) {\n    super(constants);\n    this.type |= Types.SPACER | Types.BETWEEN_ROW_SPACER;\n\n    this.elements = [new InRowSpacer(this.constants_, width)];\n  }\n\n  override measure() {}\n}\n// NOP.  Width and height were set at creation.\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.SquareCorner');\n\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Measurable} from './base.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about the space a square corner takes up\n * during rendering.\n */\nexport class SquareCorner extends Measurable {\n  /**\n   * @param constants The rendering constants provider.\n   * @param opt_position The position of this corner.\n   */\n  constructor(constants: ConstantProvider, opt_position?: string) {\n    super(constants);\n    this.type =\n      (!opt_position || opt_position === 'left'\n        ? Types.LEFT_SQUARE_CORNER\n        : Types.RIGHT_SQUARE_CORNER) | Types.CORNER;\n    this.height = this.constants_.NO_PADDING;\n    this.width = this.constants_.NO_PADDING;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.TopRow');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\nimport {Hat} from './hat.js';\nimport type {PreviousConnection} from './previous_connection.js';\nimport {Row} from './row.js';\nimport {Types} from './types.js';\n\n/**\n * An object containing information about what elements are in the top row of a\n * block as well as sizing information for the top row.\n * Elements in a top row can consist of corners, hats, spacers, and previous\n * connections.\n * After this constructor is called, the row will contain all non-spacer\n * elements it needs.\n */\nexport class TopRow extends Row {\n  /**\n   * The starting point for drawing the row, in the y direction.\n   * This allows us to draw hats and similar shapes that don't start at the\n   * origin. Must be non-negative (see #2820).\n   */\n  capline = 0;\n\n  /** How much the row extends up above its capline. */\n  ascenderHeight = 0;\n\n  /** Whether the block has a previous connection. */\n  hasPreviousConnection = false;\n\n  /** The previous connection on the block, if any. */\n  connection: PreviousConnection | null = null;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n\n    this.type |= Types.TOP_ROW;\n  }\n\n  /**\n   * Returns whether or not the top row has a left square corner.\n   *\n   * @param block The block whose top row this represents.\n   * @returns Whether or not the top row has a left square corner.\n   */\n  hasLeftSquareCorner(block: BlockSvg): boolean {\n    const hasHat =\n      (block.hat ? block.hat === 'cap' : this.constants_.ADD_START_HATS) &&\n      !block.outputConnection &&\n      !block.previousConnection;\n    const prevBlock = block.getPreviousBlock();\n\n    return (\n      !!block.outputConnection ||\n      hasHat ||\n      (prevBlock ? prevBlock.getNextBlock() === block : false)\n    );\n  }\n\n  /**\n   * Returns whether or not the top row has a right square corner.\n   *\n   * @param _block The block whose top row this represents.\n   * @returns Whether or not the top row has a right square corner.\n   */\n  hasRightSquareCorner(_block: BlockSvg): boolean {\n    return true;\n  }\n\n  override measure() {\n    let height = 0;\n    let width = 0;\n    let ascenderHeight = 0;\n    for (let i = 0; i < this.elements.length; i++) {\n      const elem = this.elements[i];\n      width += elem.width;\n      if (!Types.isSpacer(elem)) {\n        if (Types.isHat(elem) && elem instanceof Hat) {\n          ascenderHeight = Math.max(ascenderHeight, elem.ascenderHeight);\n        } else {\n          height = Math.max(height, elem.height);\n        }\n      }\n    }\n    this.width = Math.max(this.minWidth, width);\n    this.height = Math.max(this.minHeight, height) + ascenderHeight;\n    this.ascenderHeight = ascenderHeight;\n    this.capline = this.ascenderHeight;\n    this.widthWithConnectedBlocks = this.width;\n  }\n\n  override startsWithElemSpacer() {\n    return false;\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.RenderInfo');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Align, Input} from '../../inputs/input.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {Measurable} from '../measurables/base.js';\nimport {BottomRow} from '../measurables/bottom_row.js';\nimport {DummyInput} from '../../inputs/dummy_input.js';\nimport {ExternalValueInput} from '../measurables/external_value_input.js';\nimport {Field} from '../measurables/field.js';\nimport {Hat} from '../measurables/hat.js';\nimport {Icon} from '../measurables/icon.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InlineInput} from '../measurables/inline_input.js';\nimport {InputRow} from '../measurables/input_row.js';\nimport {JaggedEdge} from '../measurables/jagged_edge.js';\nimport {NextConnection} from '../measurables/next_connection.js';\nimport {OutputConnection} from '../measurables/output_connection.js';\nimport {PreviousConnection} from '../measurables/previous_connection.js';\nimport {RoundCorner} from '../measurables/round_corner.js';\nimport type {Row} from '../measurables/row.js';\nimport {SpacerRow} from '../measurables/spacer_row.js';\nimport {SquareCorner} from '../measurables/square_corner.js';\nimport {StatementInput as StatementInputMeasurable} from '../measurables/statement_input.js';\nimport {StatementInput} from '../../inputs/statement_input.js';\nimport {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\nimport {ValueInput} from '../../inputs/value_input.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport type {Renderer} from './renderer.js';\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo {\n  block_: BlockSvg;\n  protected constants_: ConstantProvider;\n  outputConnection: OutputConnection | null;\n  isInline: boolean;\n  isCollapsed: boolean;\n  isInsertionMarker: boolean;\n  RTL: boolean;\n\n  /** The block renderer in use. */\n  protected readonly renderer_!: Renderer;\n\n  /** The height of the rendered block, including child blocks. */\n  height = 0;\n\n  /** The width of the rendered block, including child blocks. */\n  widthWithChildren = 0;\n\n  /**\n   * The width of the rendered block, excluding child blocks.  This is the\n   * right edge of the block when rendered LTR.\n   */\n  width = 0;\n  statementEdge = 0;\n\n  /** An array of Row objects containing sizing information. */\n  rows: Row[] = [];\n\n  /** An array of input rows on the block. */\n  inputRows: InputRow[] = [];\n\n  topRow: TopRow;\n  bottomRow: BottomRow;\n\n  // The position of the start point for drawing, relative to the block's\n  // location.\n  startX = 0;\n  startY = 0;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    this.renderer_ = renderer;\n\n    this.block_ = block;\n\n    /** The renderer's constant provider. */\n    this.constants_ = this.renderer_.getConstants();\n\n    /**\n     * A measurable representing the output connection if the block has one.\n     * Otherwise null.\n     */\n    this.outputConnection = block.outputConnection\n      ? new OutputConnection(this.constants_, block.outputConnection)\n      : null;\n\n    /**\n     * Whether the block should be rendered as a single line, either because\n     * it's inline or because it has been collapsed.\n     */\n    this.isInline = block.getInputsInline() && !block.isCollapsed();\n\n    /** Whether the block is collapsed. */\n    this.isCollapsed = block.isCollapsed();\n\n    /**\n     * Whether the block is an insertion marker.  Insertion markers are the same\n     * shape as normal blocks, but don't show fields.\n     */\n    this.isInsertionMarker = block.isInsertionMarker();\n\n    /** True if the block should be rendered right-to-left. */\n    this.RTL = block.RTL;\n\n    /**\n     * An object with rendering information about the top row of the block.\n     */\n    this.topRow = new TopRow(this.constants_);\n\n    /**\n     * An object with rendering information about the bottom row of the block.\n     */\n    this.bottomRow = new BottomRow(this.constants_);\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  getRenderer(): Renderer {\n    return this.renderer_;\n  }\n\n  /**\n   * Populate and return an object containing all sizing information needed to\n   * draw this block.\n   *\n   * This measure pass does not propagate changes to the block (although fields\n   * may choose to rerender when getSize() is called).  However, calling it\n   * repeatedly may be expensive.\n   */\n  measure() {\n    this.createRows_();\n    this.addElemSpacing_();\n    this.addRowSpacing_();\n    this.computeBounds_();\n    this.alignRowElements_();\n    this.finalize_();\n  }\n\n  /**\n   * Create rows of Measurable objects representing all renderable parts of the\n   * block.\n   */\n  protected createRows_() {\n    this.populateTopRow_();\n    this.rows.push(this.topRow);\n    let activeRow = new InputRow(this.constants_);\n    this.inputRows.push(activeRow);\n\n    // Icons always go on the first row, before anything else.\n    const icons = this.block_.getIcons();\n    for (let i = 0, icon; (icon = icons[i]); i++) {\n      const iconInfo = new Icon(this.constants_, icon);\n      if (!this.isCollapsed || icon.isShownWhenCollapsed()) {\n        activeRow.elements.push(iconInfo);\n      }\n    }\n\n    let lastInput = undefined;\n    // Loop across all of the inputs on the block, creating objects for anything\n    // that needs to be rendered and breaking the block up into visual rows.\n    for (let i = 0, input; (input = this.block_.inputList[i]); i++) {\n      if (!input.isVisible()) {\n        continue;\n      }\n      if (this.shouldStartNewRow_(input, lastInput)) {\n        // Finish this row and create a new one.\n        this.rows.push(activeRow);\n        activeRow = new InputRow(this.constants_);\n        this.inputRows.push(activeRow);\n      }\n\n      // All of the fields in an input go on the same row.\n      for (let j = 0, field; (field = input.fieldRow[j]); j++) {\n        activeRow.elements.push(new Field(this.constants_, field, input));\n      }\n      this.addInput_(input, activeRow);\n      lastInput = input;\n    }\n\n    if (this.isCollapsed) {\n      activeRow.hasJaggedEdge = true;\n      activeRow.elements.push(new JaggedEdge(this.constants_));\n    }\n\n    if (activeRow.elements.length || activeRow.hasDummyInput) {\n      this.rows.push(activeRow);\n    }\n    this.populateBottomRow_();\n    this.rows.push(this.bottomRow);\n  }\n\n  /**\n   * Create all non-spacer elements that belong on the top row.\n   */\n  protected populateTopRow_() {\n    const hasPrevious = !!this.block_.previousConnection;\n    const hasHat =\n      (this.block_.hat\n        ? this.block_.hat === 'cap'\n        : this.constants_.ADD_START_HATS) &&\n      !this.outputConnection &&\n      !hasPrevious;\n\n    let cornerClass = this.topRow.hasLeftSquareCorner(this.block_)\n      ? SquareCorner\n      : RoundCorner;\n    this.topRow.elements.push(new cornerClass(this.constants_));\n\n    if (hasHat) {\n      const hat = new Hat(this.constants_);\n      this.topRow.elements.push(hat);\n      this.topRow.capline = hat.ascenderHeight;\n    } else if (hasPrevious) {\n      this.topRow.hasPreviousConnection = true;\n      this.topRow.connection = new PreviousConnection(\n        this.constants_,\n        this.block_.previousConnection as RenderedConnection\n      );\n      this.topRow.elements.push(this.topRow.connection);\n    }\n\n    const precedesStatement =\n      this.block_.inputList.length &&\n      this.block_.inputList[0] instanceof StatementInput;\n\n    // This is the minimum height for the row. If one of its elements has a\n    // greater height it will be overwritten in the compute pass.\n    if (precedesStatement && !this.block_.isCollapsed()) {\n      this.topRow.minHeight =\n        this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT;\n    } else {\n      this.topRow.minHeight = this.constants_.TOP_ROW_MIN_HEIGHT;\n    }\n\n    cornerClass = this.topRow.hasRightSquareCorner(this.block_)\n      ? SquareCorner\n      : RoundCorner;\n    this.topRow.elements.push(new cornerClass(this.constants_, 'right'));\n  }\n\n  /**\n   * Create all non-spacer elements that belong on the bottom row.\n   */\n  protected populateBottomRow_() {\n    this.bottomRow.hasNextConnection = !!this.block_.nextConnection;\n\n    const followsStatement =\n      this.block_.inputList.length &&\n      this.block_.inputList[this.block_.inputList.length - 1] instanceof\n        StatementInput;\n\n    // This is the minimum height for the row. If one of its elements has a\n    // greater height it will be overwritten in the compute pass.\n    if (followsStatement) {\n      this.bottomRow.minHeight =\n        this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT;\n    } else {\n      this.bottomRow.minHeight = this.constants_.BOTTOM_ROW_MIN_HEIGHT;\n    }\n\n    const leftSquareCorner = this.bottomRow.hasLeftSquareCorner(this.block_);\n\n    if (leftSquareCorner) {\n      this.bottomRow.elements.push(new SquareCorner(this.constants_));\n    } else {\n      this.bottomRow.elements.push(new RoundCorner(this.constants_));\n    }\n\n    if (this.bottomRow.hasNextConnection) {\n      this.bottomRow.connection = new NextConnection(\n        this.constants_,\n        this.block_.nextConnection as RenderedConnection\n      );\n      this.bottomRow.elements.push(this.bottomRow.connection);\n    }\n\n    const rightSquareCorner = this.bottomRow.hasRightSquareCorner(this.block_);\n\n    if (rightSquareCorner) {\n      this.bottomRow.elements.push(new SquareCorner(this.constants_, 'right'));\n    } else {\n      this.bottomRow.elements.push(new RoundCorner(this.constants_, 'right'));\n    }\n  }\n\n  /**\n   * Add an input element to the active row, if needed, and record the type of\n   * the input on the row.\n   *\n   * @param input The input to record information about.\n   * @param activeRow The row that is currently being populated.\n   */\n  protected addInput_(input: Input, activeRow: Row) {\n    // Non-dummy inputs have visual representations onscreen.\n    if (this.isInline && input instanceof ValueInput) {\n      activeRow.elements.push(new InlineInput(this.constants_, input));\n      activeRow.hasInlineInput = true;\n    } else if (input instanceof StatementInput) {\n      activeRow.elements.push(\n        new StatementInputMeasurable(this.constants_, input)\n      );\n      activeRow.hasStatement = true;\n    } else if (input instanceof ValueInput) {\n      activeRow.elements.push(new ExternalValueInput(this.constants_, input));\n      activeRow.hasExternalInput = true;\n    } else if (input instanceof DummyInput) {\n      // Dummy inputs have no visual representation, but the information is\n      // still important.\n      activeRow.minHeight = Math.max(\n        activeRow.minHeight,\n        input.getSourceBlock() && input.getSourceBlock()!.isShadow()\n          ? this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT\n          : this.constants_.DUMMY_INPUT_MIN_HEIGHT\n      );\n      activeRow.hasDummyInput = true;\n    }\n    if (activeRow.align === null) {\n      activeRow.align = input.align;\n    }\n  }\n\n  /**\n   * Decide whether to start a new row between the two Blockly.Inputs.\n   *\n   * @param input The first input to consider\n   * @param lastInput The input that follows.\n   * @returns True if the next input should be rendered on a new row.\n   */\n  protected shouldStartNewRow_(input: Input, lastInput?: Input): boolean {\n    // If this is the first input, just add to the existing row.\n    // That row is either empty or has some icons in it.\n    if (!lastInput) {\n      return false;\n    }\n    // A statement input or an input following one always gets a new row.\n    if (\n      input instanceof StatementInput ||\n      lastInput instanceof StatementInput\n    ) {\n      return true;\n    }\n    // Value and dummy inputs get new row if inputs are not inlined.\n    if (input instanceof ValueInput || input instanceof DummyInput) {\n      return !this.isInline;\n    }\n    return false;\n  }\n\n  /** Add horizontal spacing between and around elements within each row. */\n  protected addElemSpacing_() {\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      const oldElems = row.elements;\n      row.elements = [];\n      // No spacing needed before the corner on the top row or the bottom row.\n      if (row.startsWithElemSpacer()) {\n        // There's a spacer before the first element in the row.\n        row.elements.push(\n          new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(null, oldElems[0])\n          )\n        );\n      }\n      if (!oldElems.length) {\n        continue;\n      }\n      for (let e = 0; e < oldElems.length - 1; e++) {\n        row.elements.push(oldElems[e]);\n        const spacing = this.getInRowSpacing_(oldElems[e], oldElems[e + 1]);\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n      row.elements.push(oldElems[oldElems.length - 1]);\n      if (row.endsWithElemSpacer()) {\n        // There's a spacer after the last element in the row.\n        row.elements.push(\n          new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(oldElems[oldElems.length - 1], null)\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   * Calculate the width of a spacer element in a row based on the previous and\n   * next elements in that row.  For instance, extra padding is added between\n   * two editable fields.\n   *\n   * @param prev The element before the spacer.\n   * @param next The element after the spacer.\n   * @returns The size of the spacing between the two elements.\n   */\n  protected getInRowSpacing_(\n    prev: Measurable | null,\n    next: Measurable | null\n  ): number {\n    if (!prev) {\n      // Statement input padding.\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n    }\n    // Between inputs and the end of the row.\n    if (prev && Types.isInput(prev) && !next) {\n      if (Types.isExternalInput(prev)) {\n        return this.constants_.NO_PADDING;\n      } else if (Types.isInlineInput(prev)) {\n        return this.constants_.LARGE_PADDING;\n      } else if (Types.isStatementInput(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n\n    // Spacing between a square corner and a previous or next connection\n    if (prev && Types.isLeftSquareCorner(prev) && next) {\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset;\n      }\n    }\n\n    // Spacing between a rounded corner and a previous or next connection.\n    if (prev && Types.isLeftRoundedCorner(prev) && next) {\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset - this.constants_.CORNER_RADIUS;\n      }\n    }\n\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  /**\n   * Figure out where the right edge of the block and right edge of statement\n   * inputs should be placed.\n   */\n  protected computeBounds_() {\n    let widestStatementRowFields = 0;\n    let blockWidth = 0;\n    let widestRowWithConnectedBlocks = 0;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      row.measure();\n      blockWidth = Math.max(blockWidth, row.width);\n      if (row.hasStatement) {\n        const statementInput = row.getLastInput();\n        const innerWidth = row.width - (statementInput?.width ?? 0);\n        widestStatementRowFields = Math.max(\n          widestStatementRowFields,\n          innerWidth\n        );\n      }\n      widestRowWithConnectedBlocks = Math.max(\n        widestRowWithConnectedBlocks,\n        row.widthWithConnectedBlocks\n      );\n    }\n\n    this.statementEdge = widestStatementRowFields;\n    this.width = blockWidth;\n\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      if (row.hasStatement) {\n        row.statementEdge = this.statementEdge;\n      }\n    }\n\n    this.widthWithChildren = Math.max(blockWidth, widestRowWithConnectedBlocks);\n\n    if (this.outputConnection) {\n      this.startX = this.outputConnection.width;\n      this.width += this.outputConnection.width;\n      this.widthWithChildren += this.outputConnection.width;\n    }\n  }\n\n  /**\n   * Extra spacing may be necessary to make sure that the right sides of all\n   * rows line up.  This can only be calculated after a first pass to calculate\n   * the sizes of all rows.\n   */\n  protected alignRowElements_() {\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      if (row.hasStatement) {\n        this.alignStatementRow_(row as InputRow);\n      } else {\n        const currentWidth = row.width;\n        const desiredWidth = this.getDesiredRowWidth_(row);\n        const missingSpace = desiredWidth - currentWidth;\n        if (missingSpace > 0) {\n          this.addAlignmentPadding_(row, missingSpace);\n        }\n        if (Types.isTopOrBottomRow(row)) {\n          row.widthWithConnectedBlocks = row.width;\n        }\n      }\n    }\n  }\n\n  /**\n   * Calculate the desired width of an input row.\n   *\n   * @param _row The input row.\n   * @returns The desired width of the input row.\n   */\n  protected getDesiredRowWidth_(_row: Row): number {\n    return this.width - this.startX;\n  }\n\n  /**\n   * Modify the given row to add the given amount of padding around its fields.\n   * The exact location of the padding is based on the alignment property of the\n   * last input in the field.\n   *\n   * @param row The row to add padding to.\n   * @param missingSpace How much padding to add.\n   */\n  protected addAlignmentPadding_(row: Row, missingSpace: number) {\n    const firstSpacer = row.getFirstSpacer();\n    const lastSpacer = row.getLastSpacer();\n    if (row.hasExternalInput || row.hasStatement) {\n      row.widthWithConnectedBlocks += missingSpace;\n    }\n\n    // Decide where the extra padding goes.\n    if (row.align === Align.LEFT && lastSpacer) {\n      // Add padding to the end of the row.\n      lastSpacer.width += missingSpace;\n    } else if (row.align === Align.CENTRE && firstSpacer && lastSpacer) {\n      // Split the padding between the beginning and end of the row.\n      firstSpacer.width += missingSpace / 2;\n      lastSpacer.width += missingSpace / 2;\n    } else if (row.align === Align.RIGHT && firstSpacer) {\n      // Add padding at the beginning of the row.\n      firstSpacer.width += missingSpace;\n    } else if (lastSpacer) {\n      // Default to left-aligning.\n      lastSpacer.width += missingSpace;\n    } else {\n      return;\n    }\n    row.width += missingSpace;\n  }\n\n  /**\n   * Align the elements of a statement row based on computed bounds.\n   * Unlike other types of rows, statement rows add space in multiple places.\n   *\n   * @param row The statement row to resize.\n   */\n  protected alignStatementRow_(row: InputRow) {\n    const statementInput = row.getLastInput();\n    if (!statementInput) return;\n    let currentWidth = row.width - statementInput.width;\n    let desiredWidth = this.statementEdge;\n    // Add padding before the statement input.\n    const missingSpace = desiredWidth - currentWidth;\n    if (missingSpace > 0) {\n      this.addAlignmentPadding_(row, missingSpace);\n    }\n    // Also widen the statement input to reach to the right side of the\n    // block. Note that this does not add padding.\n    currentWidth = row.width;\n    desiredWidth = this.getDesiredRowWidth_(row);\n    statementInput.width += desiredWidth - currentWidth;\n    statementInput.height = Math.max(statementInput.height, row.height);\n    row.width += desiredWidth - currentWidth;\n    row.widthWithConnectedBlocks = Math.max(\n      row.width,\n      this.statementEdge + row.connectedBlockWidths\n    );\n  }\n\n  /** Add spacers between rows and set their sizes. */\n  protected addRowSpacing_() {\n    const oldRows = this.rows;\n    this.rows = [];\n\n    for (let r = 0; r < oldRows.length; r++) {\n      this.rows.push(oldRows[r]);\n      if (r !== oldRows.length - 1) {\n        this.rows.push(this.makeSpacerRow_(oldRows[r], oldRows[r + 1]));\n      }\n    }\n  }\n\n  /**\n   * Create a spacer row to go between prev and next, and set its size.\n   *\n   * @param prev The previous row.\n   * @param next The next row.\n   * @returns The newly created spacer row.\n   */\n  protected makeSpacerRow_(prev: Row, next: Row): SpacerRow {\n    const height = this.getSpacerRowHeight_(prev, next);\n    const width = this.getSpacerRowWidth_(prev, next);\n    const spacer = new SpacerRow(this.constants_, height, width);\n    if (prev.hasStatement) {\n      spacer.followsStatement = true;\n    }\n    if (next.hasStatement) {\n      spacer.precedesStatement = true;\n    }\n    return spacer;\n  }\n\n  /**\n   * Calculate the width of a spacer row.\n   *\n   * @param _prev The row before the spacer.\n   * @param _next The row after the spacer.\n   * @returns The desired width of the spacer row between these two rows.\n   */\n  protected getSpacerRowWidth_(_prev: Row, _next: Row): number {\n    return this.width - this.startX;\n  }\n\n  /**\n   * Calculate the height of a spacer row.\n   *\n   * @param _prev The row before the spacer.\n   * @param _next The row after the spacer.\n   * @returns The desired height of the spacer row between these two rows.\n   */\n  protected getSpacerRowHeight_(_prev: Row, _next: Row): number {\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  /**\n   * Calculate the centerline of an element in a rendered row.\n   * This base implementation puts the centerline at the middle of the row\n   * vertically, with no special cases.  You will likely need extra logic to\n   * handle (at minimum) top and bottom rows.\n   *\n   * @param row The row containing the element.\n   * @param elem The element to place.\n   * @returns The desired centerline of the given element, as an offset from the\n   *     top left of the block.\n   */\n  protected getElemCenterline_(row: Row, elem: Measurable): number {\n    if (Types.isSpacer(elem)) {\n      return row.yPos + elem.height / 2;\n    }\n    if (Types.isBottomRow(row)) {\n      const bottomRow = row as BottomRow;\n      const baseline =\n        bottomRow.yPos + bottomRow.height - bottomRow.descenderHeight;\n      if (Types.isNextConnection(elem)) {\n        return baseline + elem.height / 2;\n      }\n      return baseline - elem.height / 2;\n    }\n    if (Types.isTopRow(row)) {\n      const topRow = row as TopRow;\n      if (Types.isHat(elem)) {\n        return topRow.capline - elem.height / 2;\n      }\n      return topRow.capline + elem.height / 2;\n    }\n    return row.yPos + row.height / 2;\n  }\n\n  /**\n   * Record final position information on elements on the given row, for use in\n   * drawing.  At minimum this records xPos and centerline on each element.\n   *\n   * @param row The row containing the elements.\n   */\n  protected recordElemPositions_(row: Row) {\n    let xCursor = row.xPos;\n    for (let j = 0, elem; (elem = row.elements[j]); j++) {\n      // Now that row heights are finalized, make spacers use the row height.\n      if (Types.isSpacer(elem)) {\n        elem.height = row.height;\n      }\n      elem.xPos = xCursor;\n      elem.centerline = this.getElemCenterline_(row, elem);\n      xCursor += elem.width;\n    }\n  }\n\n  /**\n   * Make any final changes to the rendering information object.  In particular,\n   * store the y position of each row, and record the height of the full block.\n   */\n  protected finalize_() {\n    // Performance note: this could be combined with the draw pass, if the time\n    // that this takes is excessive.  But it shouldn't be, because it only\n    // accesses and sets properties that already exist on the objects.\n    let widestRowWithConnectedBlocks = 0;\n    let yCursor = 0;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      row.yPos = yCursor;\n      row.xPos = this.startX;\n      yCursor += row.height;\n\n      widestRowWithConnectedBlocks = Math.max(\n        widestRowWithConnectedBlocks,\n        row.widthWithConnectedBlocks\n      );\n      this.recordElemPositions_(row);\n    }\n    if (this.outputConnection && this.block_.nextConnection) {\n      const target = this.block_.nextConnection.targetBlock();\n      if (target) {\n        // Include width of connected block in value to stack width measurement.\n        widestRowWithConnectedBlocks = Math.max(\n          widestRowWithConnectedBlocks,\n          target.getHeightWidth().width\n        );\n      }\n    }\n\n    this.widthWithChildren = widestRowWithConnectedBlocks + this.startX;\n\n    this.height = yCursor;\n    this.startY = this.topRow.capline;\n    this.bottomRow.baseline = yCursor - this.bottomRow.descenderHeight;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.BottomRow');\n\nimport type {BlockSvg} from '../../../block_svg.js';\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {BottomRow as BaseBottomRow} from '../../../renderers/measurables/bottom_row.js';\n\n/**\n * An object containing information about what elements are in the bottom row of\n * a block as well as spacing information for the top row.\n * Elements in a bottom row can consist of corners, spacers and next\n * connections.\n */\nexport class BottomRow extends BaseBottomRow {\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasLeftSquareCorner(block: BlockSvg) {\n    return !!block.outputConnection;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasRightSquareCorner(block: BlockSvg) {\n    return (\n      !!block.outputConnection &&\n      !block.statementInputCount &&\n      !block.nextConnection\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.StatementInput');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../../inputs/input.js';\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {StatementInput as BaseStatementInput} from '../../../renderers/measurables/statement_input.js';\n\n/**\n * An object containing information about the space a statement input takes up\n * during rendering.\n */\nexport class StatementInput extends BaseStatementInput {\n  connectedBottomNextConnection = false;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The statement input to measure and store information for.\n   */\n  constructor(constants: ConstantProvider, input: Input) {\n    super(constants, input);\n\n    if (this.connectedBlock) {\n      // Find the bottom-most connected block in the stack.\n      let block = this.connectedBlock;\n      let nextBlock;\n      while ((nextBlock = block.getNextBlock())) {\n        block = nextBlock;\n      }\n      if (!block.nextConnection) {\n        this.height = this.connectedBlockHeight;\n        this.connectedBottomNextConnection = true;\n      }\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.RightConnectionShape');\n\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {Measurable} from '../../../renderers/measurables/base.js';\nimport {Types} from '../../../renderers/measurables/types.js';\n\n/**\n * An object containing information about the space a right connection shape\n * takes up during rendering.\n */\nexport class RightConnectionShape extends Measurable {\n  // Size is dynamic\n  override height = 0;\n  override width = 0;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n    this.type |= Types.getType('RIGHT_CONNECTION');\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.TopRow');\n\nimport type {BlockSvg} from '../../../block_svg.js';\nimport type {ConstantProvider} from '../../../renderers/common/constants.js';\nimport {TopRow as BaseTopRow} from '../../../renderers/measurables/top_row.js';\n\n/**\n * An object containing information about what elements are in the top row of a\n * block as well as sizing information for the top row.\n * Elements in a top row can consist of corners, hats, spacers, and previous\n * connections.\n * After this constructor is called, the row will contain all non-spacer\n * elements it needs.\n */\nexport class TopRow extends BaseTopRow {\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    super(constants);\n  }\n\n  override endsWithElemSpacer() {\n    return false;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasLeftSquareCorner(block: BlockSvg) {\n    const hasHat =\n      (block.hat ? block.hat === 'cap' : this.constants_.ADD_START_HATS) &&\n      !block.outputConnection &&\n      !block.previousConnection;\n    return !!block.outputConnection || hasHat;\n  }\n\n  /** Render a round corner unless the block has an output connection. */\n  override hasRightSquareCorner(block: BlockSvg) {\n    return (\n      !!block.outputConnection &&\n      !block.statementInputCount &&\n      !block.nextConnection\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.RenderInfo');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {DummyInput} from '../../inputs/dummy_input.js';\nimport {FieldImage} from '../../field_image.js';\nimport {FieldLabel} from '../../field_label.js';\nimport {FieldTextInput} from '../../field_textinput.js';\nimport {Align, Input} from '../../inputs/input.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport type {Measurable} from '../measurables/base.js';\nimport {Field} from '../measurables/field.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport {InputConnection} from '../measurables/input_connection.js';\nimport {StatementInput} from '../../inputs/statement_input.js';\nimport type {Row} from '../measurables/row.js';\nimport type {SpacerRow} from '../measurables/spacer_row.js';\nimport {Types} from '../measurables/types.js';\nimport {ValueInput} from '../../inputs/value_input.js';\n\nimport type {ConstantProvider, InsideCorners} from './constants.js';\nimport {BottomRow} from './measurables/bottom_row.js';\nimport {StatementInput as StatementInputMeasurable} from './measurables/inputs.js';\nimport {RightConnectionShape} from './measurables/row_elements.js';\nimport {TopRow} from './measurables/top_row.js';\nimport type {PathObject} from './path_object.js';\nimport type {Renderer} from './renderer.js';\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo extends BaseRenderInfo {\n  override topRow: TopRow;\n  override bottomRow: BottomRow;\n  override constants_: ConstantProvider;\n  override renderer_: Renderer;\n\n  override isInline = true;\n  isMultiRow: boolean;\n  hasStatementInput: boolean;\n  rightSide: RightConnectionShape | null;\n  private readonly rightAlignedDummyInputs: WeakMap<Row, Input>;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n\n    this.renderer_ = renderer;\n\n    this.constants_ = this.renderer_.getConstants();\n\n    /**\n     * An object with rendering information about the top row of the block.\n     */\n    this.topRow = new TopRow(this.constants_);\n\n    /**\n     * An object with rendering information about the bottom row of the block.\n     */\n    this.bottomRow = new BottomRow(this.constants_);\n\n    /**\n     * Whether the block should be rendered as a multi-line block, either\n     * because it's not inline or because it has been collapsed.\n     */\n    this.isMultiRow = !block.getInputsInline() || block.isCollapsed();\n\n    /**\n     * Whether or not the block has a statement input in one of its rows.\n     */\n    this.hasStatementInput = block.statementInputCount > 0;\n\n    /**\n     * An object with rendering information about the right connection shape.\n     */\n    this.rightSide = this.outputConnection\n      ? new RightConnectionShape(this.constants_)\n      : null;\n\n    /**\n     * A map of rows to right aligned dummy inputs within those rows. Used to\n     * add padding between left and right aligned inputs.\n     */\n    this.rightAlignedDummyInputs = new WeakMap();\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_ as Renderer;\n  }\n\n  override measure() {\n    // Modifying parent measure method to add `adjustXPosition_`.\n    this.createRows_();\n    this.addElemSpacing_();\n    this.addRowSpacing_();\n    this.adjustXPosition_();\n    this.computeBounds_();\n    this.alignRowElements_();\n    this.finalize_();\n  }\n\n  override shouldStartNewRow_(input: Input, lastInput: Input): boolean {\n    // If this is the first input, just add to the existing row.\n    // That row is either empty or has some icons in it.\n    if (!lastInput) {\n      return false;\n    }\n    // A statement input or an input following one always gets a new row.\n    if (\n      input instanceof StatementInput ||\n      lastInput instanceof StatementInput\n    ) {\n      return true;\n    }\n    // Value and dummy inputs get new row if inputs are not inlined.\n    if (input instanceof ValueInput || input instanceof DummyInput) {\n      return !this.isInline || this.isMultiRow;\n    }\n    return false;\n  }\n\n  override getDesiredRowWidth_(row: Row): number {\n    if (row.hasStatement) {\n      const rightCornerWidth =\n        (this.constants_.INSIDE_CORNERS as InsideCorners).rightWidth || 0;\n      return this.width - this.startX - rightCornerWidth;\n    }\n    return super.getDesiredRowWidth_(row);\n  }\n\n  override getInRowSpacing_(\n    prev: Measurable | null,\n    next: Measurable | null\n  ): number {\n    if (!prev || !next) {\n      // No need for padding at the beginning or end of the row if the\n      // output shape is dynamic.\n      if (\n        this.outputConnection &&\n        this.outputConnection.isDynamicShape &&\n        !this.hasStatementInput &&\n        !this.bottomRow.hasNextConnection\n      ) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n    if (!prev) {\n      // Statement input padding.\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n    }\n    // Spacing between a rounded corner and a previous or next connection.\n    if (prev && Types.isLeftRoundedCorner(prev) && next) {\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset - this.constants_.CORNER_RADIUS;\n      }\n    }\n    // Spacing between a square corner and a hat.\n    if (prev && Types.isLeftSquareCorner(prev) && next && Types.isHat(next)) {\n      return this.constants_.NO_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowHeight_(prev: Row, next: Row): number {\n    // If we have an empty block add a spacer to increase the height.\n    if (Types.isTopRow(prev) && Types.isBottomRow(next)) {\n      return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;\n    }\n    const followsStatement = Types.isInputRow(prev) && prev.hasStatement;\n    const precedesStatement = Types.isInputRow(next) && next.hasStatement;\n    if (precedesStatement || followsStatement) {\n      const cornerHeight =\n        (this.constants_.INSIDE_CORNERS as InsideCorners).rightHeight || 0;\n      const height = Math.max(this.constants_.NOTCH_HEIGHT, cornerHeight);\n      return precedesStatement && followsStatement\n        ? Math.max(height, this.constants_.DUMMY_INPUT_MIN_HEIGHT)\n        : height;\n    }\n    // Top and bottom rows act as a spacer so we don't need any extra padding.\n    if (Types.isTopRow(prev)) {\n      const topRow = prev as TopRow;\n      if (\n        !topRow.hasPreviousConnection &&\n        (!this.outputConnection || this.hasStatementInput)\n      ) {\n        return Math.abs(\n          this.constants_.NOTCH_HEIGHT - this.constants_.CORNER_RADIUS\n        );\n      }\n      return this.constants_.NO_PADDING;\n    }\n    if (Types.isBottomRow(next)) {\n      const bottomRow = next as BottomRow;\n      if (!this.outputConnection) {\n        const topHeight =\n          Math.max(\n            this.topRow.minHeight,\n            Math.max(\n              this.constants_.NOTCH_HEIGHT,\n              this.constants_.CORNER_RADIUS\n            )\n          ) - this.constants_.CORNER_RADIUS;\n        return topHeight;\n      } else if (!bottomRow.hasNextConnection && this.hasStatementInput) {\n        return Math.abs(\n          this.constants_.NOTCH_HEIGHT - this.constants_.CORNER_RADIUS\n        );\n      }\n      return this.constants_.NO_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowWidth_(prev: Row, next: Row): number {\n    const width = this.width - this.startX;\n    if (\n      (Types.isInputRow(prev) && prev.hasStatement) ||\n      (Types.isInputRow(next) && next.hasStatement)\n    ) {\n      return Math.max(width, this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH);\n    }\n    return width;\n  }\n\n  override getElemCenterline_(row: Row, elem: Measurable): number {\n    if (\n      row.hasStatement &&\n      !Types.isSpacer(elem) &&\n      !Types.isStatementInput(elem)\n    ) {\n      return row.yPos + this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT / 2;\n    }\n    if (Types.isInlineInput(elem) && elem instanceof InputConnection) {\n      const connectedBlock = elem.connectedBlock;\n      if (\n        connectedBlock &&\n        connectedBlock.outputConnection &&\n        connectedBlock.nextConnection\n      ) {\n        return row.yPos + connectedBlock.height / 2;\n      }\n    }\n    return super.getElemCenterline_(row, elem);\n  }\n\n  override addInput_(input: Input, activeRow: Row) {\n    // If we have two dummy inputs on the same row, one aligned left and the\n    // other right, keep track of the right aligned dummy input so we can add\n    // padding later.\n    if (\n      input instanceof DummyInput &&\n      activeRow.hasDummyInput &&\n      activeRow.align === Align.LEFT &&\n      input.align === Align.RIGHT\n    ) {\n      this.rightAlignedDummyInputs.set(activeRow, input);\n    } else if (input instanceof StatementInput) {\n      // Handle statements without next connections correctly.\n      activeRow.elements.push(\n        new StatementInputMeasurable(this.constants_, input)\n      );\n      activeRow.hasStatement = true;\n\n      if (activeRow.align === null) {\n        activeRow.align = input.align;\n      }\n      return;\n    }\n    super.addInput_(input, activeRow);\n  }\n\n  override addAlignmentPadding_(row: Row, missingSpace: number) {\n    if (this.rightAlignedDummyInputs.get(row)) {\n      let alignmentDivider;\n      for (let i = 0; i < row.elements.length; i++) {\n        const elem = row.elements[i];\n        if (Types.isSpacer(elem)) {\n          alignmentDivider = elem;\n        }\n        if (\n          Types.isField(elem) &&\n          elem instanceof Field &&\n          elem.parentInput === this.rightAlignedDummyInputs.get(row)\n        ) {\n          break;\n        }\n      }\n      if (alignmentDivider) {\n        alignmentDivider.width += missingSpace;\n        row.width += missingSpace;\n        return;\n      }\n    }\n    super.addAlignmentPadding_(row, missingSpace);\n  }\n\n  /**\n   * Adjust the x position of fields to bump all non-label fields in the first\n   * row past the notch position.  This must be called before `computeBounds`\n   * is called.\n   */\n  protected adjustXPosition_() {\n    const notchTotalWidth =\n      this.constants_.NOTCH_OFFSET_LEFT + this.constants_.NOTCH_WIDTH;\n    let minXPos = notchTotalWidth;\n    // Run through every input row on the block and only apply bump logic to the\n    // first input row (if the block has prev connection) and every input row\n    // that has a prev and next notch.\n    for (let i = 2; i < this.rows.length - 1; i += 2) {\n      const prevSpacer = this.rows[i - 1] as SpacerRow;\n      const row = this.rows[i];\n      const nextSpacer = this.rows[i + 1] as SpacerRow;\n\n      const hasPrevNotch =\n        i === 2\n          ? !!this.topRow.hasPreviousConnection\n          : !!prevSpacer.followsStatement;\n      const hasNextNotch =\n        i + 2 >= this.rows.length - 1\n          ? !!this.bottomRow.hasNextConnection\n          : !!nextSpacer.precedesStatement;\n\n      if (Types.isInputRow(row) && row.hasStatement) {\n        row.measure();\n        minXPos =\n          row.width - (row.getLastInput()?.width ?? 0) + notchTotalWidth;\n      } else if (\n        hasPrevNotch &&\n        (i === 2 || hasNextNotch) &&\n        Types.isInputRow(row) &&\n        !row.hasStatement\n      ) {\n        let xCursor = row.xPos;\n        let prevInRowSpacer = null;\n        for (let j = 0; j < row.elements.length; j++) {\n          const elem = row.elements[j];\n          if (Types.isSpacer(elem)) {\n            prevInRowSpacer = elem;\n          }\n          if (prevInRowSpacer && (Types.isField(elem) || Types.isInput(elem))) {\n            if (\n              xCursor < minXPos &&\n              !(\n                Types.isField(elem) &&\n                elem instanceof Field &&\n                (elem.field instanceof FieldLabel ||\n                  elem.field instanceof FieldImage)\n              )\n            ) {\n              const difference = minXPos - xCursor;\n              prevInRowSpacer.width += difference;\n            }\n          }\n          xCursor += elem.width;\n        }\n      }\n    }\n  }\n\n  /**\n   * Finalize the output connection info.  In particular, set the height of the\n   * output connection to match that of the block.  For the right side, add a\n   * right connection shape element and have it match the dimensions of the\n   * output connection.\n   */\n  protected finalizeOutputConnection_() {\n    // Dynamic output connections depend on the height of the block.\n    if (!this.outputConnection || !this.outputConnection.isDynamicShape) {\n      return;\n    }\n    const outputConnectionShape = this.outputConnection.shape;\n    if (\n      !('isDynamic' in outputConnectionShape && outputConnectionShape.isDynamic)\n    ) {\n      return;\n    }\n\n    let yCursor = 0;\n    // Determine the block height.\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      row.yPos = yCursor;\n      yCursor += row.height;\n    }\n    this.height = yCursor;\n\n    // Adjust the height of the output connection.\n    const blockHeight = this.bottomRow.hasNextConnection\n      ? this.height - this.bottomRow.descenderHeight\n      : this.height;\n    const connectionHeight = outputConnectionShape.height(blockHeight);\n    const connectionWidth = outputConnectionShape.width(blockHeight);\n\n    this.outputConnection.height = connectionHeight;\n    this.outputConnection.width = connectionWidth;\n    this.outputConnection.startX = connectionWidth;\n    this.outputConnection.connectionOffsetY =\n      outputConnectionShape.connectionOffsetY(connectionHeight);\n    this.outputConnection.connectionOffsetX =\n      outputConnectionShape.connectionOffsetX(connectionWidth);\n\n    // Add the right connection measurable.\n    // Don't add it if we have a value-to-statement or a value-to-stack block.\n    let rightConnectionWidth = 0;\n    if (!this.hasStatementInput && !this.bottomRow.hasNextConnection) {\n      rightConnectionWidth = connectionWidth;\n      this.rightSide!.height = connectionHeight;\n      this.rightSide!.width = rightConnectionWidth;\n      this.rightSide!.centerline = connectionHeight / 2;\n      this.rightSide!.xPos = this.width + rightConnectionWidth;\n    }\n    this.startX = connectionWidth;\n    this.width += connectionWidth + rightConnectionWidth;\n    this.widthWithChildren += connectionWidth + rightConnectionWidth;\n  }\n\n  /**\n   * Finalize horizontal alignment of elements on the block.  In particular,\n   * reduce the implicit spacing created by the left and right output connection\n   * shapes by adding setting negative spacing onto the leftmost and rightmost\n   * spacers.\n   */\n  protected finalizeHorizontalAlignment_() {\n    if (\n      !this.outputConnection ||\n      this.hasStatementInput ||\n      this.bottomRow.hasNextConnection\n    ) {\n      return;\n    }\n    let totalNegativeSpacing = 0;\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      if (!Types.isInputRow(row)) {\n        continue;\n      }\n      const firstElem = row.elements[1];\n      const lastElem = row.elements[row.elements.length - 2];\n      let leftNegPadding = this.getNegativeSpacing_(firstElem);\n      let rightNegPadding = this.getNegativeSpacing_(lastElem);\n      totalNegativeSpacing = leftNegPadding + rightNegPadding;\n      const minBlockWidth =\n        this.constants_.MIN_BLOCK_WIDTH + this.outputConnection.width * 2;\n      if (this.width - totalNegativeSpacing < minBlockWidth) {\n        // Maintain a minimum block width, split negative spacing between left\n        // and right edge.\n        totalNegativeSpacing = this.width - minBlockWidth;\n        leftNegPadding = totalNegativeSpacing / 2;\n        rightNegPadding = totalNegativeSpacing / 2;\n      }\n      // Add a negative spacer on the start and end of the block.\n      row.elements.unshift(new InRowSpacer(this.constants_, -leftNegPadding));\n      row.elements.push(new InRowSpacer(this.constants_, -rightNegPadding));\n    }\n    if (totalNegativeSpacing) {\n      this.width -= totalNegativeSpacing;\n      this.widthWithChildren -= totalNegativeSpacing;\n      this.rightSide!.xPos -= totalNegativeSpacing;\n      for (let i = 0; i < this.rows.length; i++) {\n        const row = this.rows[i];\n        if (Types.isTopOrBottomRow(row)) {\n          row.elements[1].width -= totalNegativeSpacing;\n        }\n        row.width -= totalNegativeSpacing;\n        row.widthWithConnectedBlocks -= totalNegativeSpacing;\n      }\n    }\n  }\n\n  /**\n   * Calculate the spacing to reduce the left and right edges by based on the\n   * outer and inner connection shape.\n   *\n   * @param elem The first or last element on a block.\n   * @returns The amount of spacing to reduce the first or last spacer.\n   */\n  protected getNegativeSpacing_(elem: Measurable): number {\n    if (!elem || !this.outputConnection) {\n      return 0;\n    }\n    const connectionWidth = this.outputConnection.width;\n    const outerShape = this.outputConnection.shape.type;\n    const constants = this.constants_;\n    if (this.isMultiRow && this.inputRows.length > 1) {\n      switch (outerShape) {\n        case constants.SHAPES.ROUND: {\n          // Special case for multi-row round reporter blocks.\n          const maxWidth = this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;\n          const width = this.height / 2 > maxWidth ? maxWidth : this.height / 2;\n          const topPadding = this.constants_.SMALL_PADDING;\n          const roundPadding =\n            width * (1 - Math.sin(Math.acos((width - topPadding) / width)));\n          return connectionWidth - roundPadding;\n        }\n        default:\n          return 0;\n      }\n    }\n    if (Types.isInlineInput(elem) && elem instanceof InputConnection) {\n      const connectedBlock = elem.connectedBlock;\n      const innerShape = connectedBlock\n        ? (connectedBlock.pathObject as PathObject).outputShapeType\n        : elem.shape.type;\n      if (innerShape == null) {\n        return 0;\n      }\n      // Special case for value to stack / value to statement blocks.\n      if (\n        connectedBlock &&\n        connectedBlock.outputConnection &&\n        (connectedBlock.statementInputCount || connectedBlock.nextConnection)\n      ) {\n        return 0;\n      }\n      // Special case for hexagonal output.\n      if (\n        outerShape === constants.SHAPES.HEXAGONAL &&\n        outerShape !== innerShape\n      ) {\n        return 0;\n      }\n      return (\n        connectionWidth -\n        this.constants_.SHAPE_IN_SHAPE_PADDING[outerShape][innerShape]\n      );\n    } else if (Types.isField(elem) && elem instanceof Field) {\n      // Special case for text inputs.\n      if (\n        outerShape === constants.SHAPES.ROUND &&\n        elem.field instanceof FieldTextInput\n      ) {\n        return connectionWidth - 2.75 * constants.GRID_UNIT;\n      }\n      return (\n        connectionWidth - this.constants_.SHAPE_IN_SHAPE_PADDING[outerShape][0]\n      );\n    } else if (Types.isIcon(elem)) {\n      return this.constants_.SMALL_PADDING;\n    }\n    return 0;\n  }\n\n  /**\n   * Finalize vertical alignment of rows on a block.  In particular, reduce the\n   * implicit spacing when a non-shadow block is connected to any of an input\n   * row's inline inputs.\n   */\n  protected finalizeVerticalAlignment_() {\n    if (this.outputConnection) {\n      return;\n    }\n    // Run through every input row on the block and only apply tight nesting\n    // logic to input rows that have a prev and next notch.\n    for (let i = 2; i < this.rows.length - 1; i += 2) {\n      const prevSpacer = this.rows[i - 1] as SpacerRow;\n      const row = this.rows[i];\n      const nextSpacer = this.rows[i + 1] as SpacerRow;\n\n      const firstRow = i === 2;\n      const hasPrevNotch = firstRow\n        ? !!this.topRow.hasPreviousConnection\n        : !!prevSpacer.followsStatement;\n      const hasNextNotch =\n        i + 2 >= this.rows.length - 1\n          ? !!this.bottomRow.hasNextConnection\n          : !!nextSpacer.precedesStatement;\n\n      if (hasPrevNotch) {\n        const elem = row.elements[1];\n        const hasSingleTextOrImageField =\n          row.elements.length === 3 &&\n          elem instanceof Field &&\n          (elem.field instanceof FieldLabel ||\n            elem.field instanceof FieldImage);\n        if (!firstRow && hasSingleTextOrImageField) {\n          // Remove some padding if we have a single image or text field.\n          prevSpacer.height -= this.constants_.SMALL_PADDING;\n          nextSpacer.height -= this.constants_.SMALL_PADDING;\n          row.height -= this.constants_.MEDIUM_PADDING;\n        } else if (!firstRow && !hasNextNotch) {\n          // Add a small padding so the notch doesn't clash with inputs/fields.\n          prevSpacer.height += this.constants_.SMALL_PADDING;\n        } else if (hasNextNotch) {\n          // Determine if the input row has non-shadow connected blocks.\n          let hasNonShadowConnectedBlocks = false;\n          const minVerticalTightNestingHeight = 40;\n          for (let j = 0; j < row.elements.length; j++) {\n            const elem = row.elements[j];\n            if (\n              elem instanceof InputConnection &&\n              Types.isInlineInput(elem) &&\n              elem.connectedBlock &&\n              !elem.connectedBlock.isShadow() &&\n              elem.connectedBlock.getHeightWidth().height >=\n                minVerticalTightNestingHeight\n            ) {\n              hasNonShadowConnectedBlocks = true;\n              break;\n            }\n          }\n          // Apply tight-nesting if we have both a prev and next notch and the\n          // block has non-shadow connected blocks.\n          if (hasNonShadowConnectedBlocks) {\n            prevSpacer.height -= this.constants_.SMALL_PADDING;\n            nextSpacer.height -= this.constants_.SMALL_PADDING;\n          }\n        }\n      }\n    }\n  }\n\n  override finalize_() {\n    this.finalizeOutputConnection_();\n    this.finalizeHorizontalAlignment_();\n    this.finalizeVerticalAlignment_();\n    super.finalize_();\n\n    if (this.rightSide) {\n      this.widthWithChildren += this.rightSide.width;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.MarkerSvg');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport '../../events/events_marker_move.js';\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport * as eventUtils from '../../events/utils.js';\nimport type {Field} from '../../field.js';\nimport type {IASTNodeLocationSvg} from '../../interfaces/i_ast_node_location_svg.js';\nimport {ASTNode} from '../../keyboard_nav/ast_node.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\n\nimport type {ConstantProvider, Notch, PuzzleTab} from './constants.js';\n\n/** The name of the CSS class for a cursor. */\nconst CURSOR_CLASS = 'blocklyCursor';\n\n/** The name of the CSS class for a marker. */\nconst MARKER_CLASS = 'blocklyMarker';\n\n/**\n * What we multiply the height by to get the height of the marker.\n * Only used for the block and block connections.\n */\nconst HEIGHT_MULTIPLIER = 3 / 4;\n\n/**\n * Class for a marker, containing methods for graphically rendering a marker as\n * SVG.\n */\nexport class MarkerSvg {\n  /**\n   * The workspace, field, or block that the marker SVG element should be\n   * attached to.\n   */\n  private parent: IASTNodeLocationSvg | null = null;\n\n  /** The current SVG element for the marker. */\n  currentMarkerSvg: SVGElement | null = null;\n  colour_: string;\n\n  /** The root SVG group containing the marker. */\n  protected markerSvg_: SVGGElement | null = null;\n  protected svgGroup_: SVGGElement | null = null;\n\n  protected markerBlock_: SVGPathElement | null = null;\n\n  protected markerInput_: SVGPathElement | null = null;\n  protected markerSvgLine_: SVGRectElement | null = null;\n\n  protected markerSvgRect_: SVGRectElement | null = null;\n\n  /** The constants necessary to draw the marker. */\n  protected constants_: ConstantProvider;\n\n  /**\n   * @param workspace The workspace the marker belongs to.\n   * @param constants The constants for the renderer.\n   * @param marker The marker to draw.\n   */\n  constructor(\n    private readonly workspace: WorkspaceSvg,\n    constants: ConstantProvider,\n    private readonly marker: Marker\n  ) {\n    this.constants_ = constants;\n\n    const defaultColour = this.isCursor()\n      ? this.constants_.CURSOR_COLOUR\n      : this.constants_.MARKER_COLOUR;\n\n    /** The colour of the marker. */\n    this.colour_ = marker.colour || defaultColour;\n  }\n\n  /**\n   * Return the root node of the SVG or null if none exists.\n   *\n   * @returns The root SVG node.\n   */\n  getSvgRoot(): SVGElement | null {\n    return this.svgGroup_;\n  }\n\n  /**\n   * Get the marker.\n   *\n   * @returns The marker to draw for.\n   */\n  getMarker(): Marker {\n    return this.marker;\n  }\n\n  /**\n   * True if the marker should be drawn as a cursor, false otherwise.\n   * A cursor is drawn as a flashing line. A marker is drawn as a solid line.\n   *\n   * @returns True if the marker is a cursor, false otherwise.\n   */\n  isCursor(): boolean {\n    return this.marker.type === 'cursor';\n  }\n\n  /**\n   * Create the DOM element for the marker.\n   *\n   * @returns The marker controls SVG group.\n   */\n  createDom(): SVGElement {\n    const className = this.isCursor() ? CURSOR_CLASS : MARKER_CLASS;\n\n    this.svgGroup_ = dom.createSvgElement(Svg.G, {'class': className});\n\n    this.createDomInternal_();\n    return this.svgGroup_;\n  }\n\n  /**\n   * Attaches the SVG root of the marker to the SVG group of the parent.\n   *\n   * @param newParent The workspace, field, or block that the marker SVG element\n   *     should be attached to.\n   */\n  protected setParent_(newParent: IASTNodeLocationSvg) {\n    if (!this.isCursor()) {\n      if (this.parent) {\n        this.parent.setMarkerSvg(null);\n      }\n      newParent.setMarkerSvg(this.getSvgRoot());\n    } else {\n      if (this.parent) {\n        this.parent.setCursorSvg(null);\n      }\n      newParent.setCursorSvg(this.getSvgRoot());\n    }\n    this.parent = newParent;\n  }\n\n  /**\n   * Update the marker.\n   *\n   * @param oldNode The previous node the marker was on or null.\n   * @param curNode The node that we want to draw the marker for.\n   */\n  draw(oldNode: ASTNode, curNode: ASTNode) {\n    if (!curNode) {\n      this.hide();\n      return;\n    }\n\n    this.constants_ = this.workspace.getRenderer().getConstants();\n\n    const defaultColour = this.isCursor()\n      ? this.constants_.CURSOR_COLOUR\n      : this.constants_.MARKER_COLOUR;\n    this.colour_ = this.marker.colour || defaultColour;\n    this.applyColour_(curNode);\n\n    this.showAtLocation_(curNode);\n\n    this.fireMarkerEvent(oldNode, curNode);\n\n    // Ensures the marker will be visible immediately after the move.\n    const animate = this.currentMarkerSvg!.childNodes[0];\n    if (animate !== undefined) {\n      (animate as SVGAnimationElement).beginElement &&\n        (animate as SVGAnimationElement).beginElement();\n    }\n  }\n\n  /**\n   * Update the marker's visible state based on the type of curNode..\n   *\n   * @param curNode The node that we want to draw the marker for.\n   */\n  protected showAtLocation_(curNode: ASTNode) {\n    const curNodeAsConnection = curNode.getLocation() as Connection;\n    const connectionType = curNodeAsConnection.type;\n    if (curNode.getType() === ASTNode.types.BLOCK) {\n      this.showWithBlock_(curNode);\n    } else if (curNode.getType() === ASTNode.types.OUTPUT) {\n      this.showWithOutput_(curNode);\n    } else if (connectionType === ConnectionType.INPUT_VALUE) {\n      this.showWithInput_(curNode);\n    } else if (connectionType === ConnectionType.NEXT_STATEMENT) {\n      this.showWithNext_(curNode);\n    } else if (curNode.getType() === ASTNode.types.PREVIOUS) {\n      this.showWithPrevious_(curNode);\n    } else if (curNode.getType() === ASTNode.types.FIELD) {\n      this.showWithField_(curNode);\n    } else if (curNode.getType() === ASTNode.types.WORKSPACE) {\n      this.showWithCoordinates_(curNode);\n    } else if (curNode.getType() === ASTNode.types.STACK) {\n      this.showWithStack_(curNode);\n    }\n  }\n\n  /**************************\n   * Display\n   **************************/\n\n  /**\n   * Show the marker as a combination of the previous connection and block,\n   * the output connection and block, or just the block.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  private showWithBlockPrevOutput(curNode: ASTNode) {\n    const block = curNode.getSourceBlock() as BlockSvg;\n    const width = block.width;\n    const height = block.height;\n    const markerHeight = height * HEIGHT_MULTIPLIER;\n    const markerOffset = this.constants_.CURSOR_BLOCK_PADDING;\n\n    if (block.previousConnection) {\n      const connectionShape = this.constants_.shapeFor(\n        block.previousConnection\n      ) as Notch;\n      this.positionPrevious_(\n        width,\n        markerOffset,\n        markerHeight,\n        connectionShape\n      );\n    } else if (block.outputConnection) {\n      const connectionShape = this.constants_.shapeFor(\n        block.outputConnection\n      ) as PuzzleTab;\n      this.positionOutput_(width, height, connectionShape);\n    } else {\n      this.positionBlock_(width, markerOffset, markerHeight);\n    }\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a block.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithBlock_(curNode: ASTNode) {\n    this.showWithBlockPrevOutput(curNode);\n  }\n\n  /**\n   * Position and display the marker for a previous connection.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithPrevious_(curNode: ASTNode) {\n    this.showWithBlockPrevOutput(curNode);\n  }\n\n  /**\n   * Position and display the marker for an output connection.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithOutput_(curNode: ASTNode) {\n    this.showWithBlockPrevOutput(curNode);\n  }\n\n  /**\n   * Position and display the marker for a workspace coordinate.\n   * This is a horizontal line.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithCoordinates_(curNode: ASTNode) {\n    const wsCoordinate = curNode.getWsCoordinate();\n    let x = wsCoordinate.x;\n    const y = wsCoordinate.y;\n\n    if (this.workspace.RTL) {\n      x -= this.constants_.CURSOR_WS_WIDTH;\n    }\n\n    this.positionLine_(x, y, this.constants_.CURSOR_WS_WIDTH);\n    this.setParent_(this.workspace);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a field.\n   * This is a box around the field.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithField_(curNode: ASTNode) {\n    const field = curNode.getLocation() as Field;\n    const width = field.getSize().width;\n    const height = field.getSize().height;\n\n    this.positionRect_(0, 0, width, height);\n    this.setParent_(field);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for an input.\n   * This is a puzzle piece.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithInput_(curNode: ASTNode) {\n    const connection = curNode.getLocation() as RenderedConnection;\n    const sourceBlock = connection.getSourceBlock();\n\n    this.positionInput_(connection);\n    this.setParent_(sourceBlock);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a next connection.\n   * This is a horizontal line.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithNext_(curNode: ASTNode) {\n    const connection = curNode.getLocation() as RenderedConnection;\n    const targetBlock = connection.getSourceBlock();\n    let x = 0;\n    const y = connection.getOffsetInBlock().y;\n    const width = targetBlock.getHeightWidth().width;\n    if (this.workspace.RTL) {\n      x = -width;\n    }\n    this.positionLine_(x, y, width);\n    this.setParent_(targetBlock);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position and display the marker for a stack.\n   * This is a box with extra padding around the entire stack of blocks.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  protected showWithStack_(curNode: ASTNode) {\n    const block = curNode.getLocation() as BlockSvg;\n\n    // Gets the height and width of entire stack.\n    const heightWidth = block.getHeightWidth();\n\n    // Add padding so that being on a stack looks different than being on a\n    // block.\n    const width = heightWidth.width + this.constants_.CURSOR_STACK_PADDING;\n    const height = heightWidth.height + this.constants_.CURSOR_STACK_PADDING;\n\n    // Shift the rectangle slightly to upper left so padding is equal on all\n    // sides.\n    const xPadding = -this.constants_.CURSOR_STACK_PADDING / 2;\n    const yPadding = -this.constants_.CURSOR_STACK_PADDING / 2;\n\n    let x = xPadding;\n    const y = yPadding;\n\n    if (this.workspace.RTL) {\n      x = -(width + xPadding);\n    }\n    this.positionRect_(x, y, width, height);\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  /** Show the current marker. */\n  protected showCurrent_() {\n    this.hide();\n    if (this.currentMarkerSvg) {\n      this.currentMarkerSvg.style.display = '';\n    }\n  }\n\n  /**************************\n   * Position\n   **************************/\n\n  /**\n   * Position the marker for a block.\n   * Displays an outline of the top half of a rectangle around a block.\n   *\n   * @param width The width of the block.\n   * @param markerOffset The extra padding for around the block.\n   * @param markerHeight The height of the marker.\n   */\n  protected positionBlock_(\n    width: number,\n    markerOffset: number,\n    markerHeight: number\n  ) {\n    const markerPath =\n      svgPaths.moveBy(-markerOffset, markerHeight) +\n      svgPaths.lineOnAxis('V', -markerOffset) +\n      svgPaths.lineOnAxis('H', width + markerOffset * 2) +\n      svgPaths.lineOnAxis('V', markerHeight);\n    if (!this.markerBlock_) {\n      throw new Error(\n        'createDom should be called before positioning the marker'\n      );\n    }\n    this.markerBlock_.setAttribute('d', markerPath);\n    if (this.workspace.RTL) {\n      this.flipRtl(this.markerBlock_);\n    }\n    this.currentMarkerSvg = this.markerBlock_;\n  }\n\n  /**\n   * Position the marker for an input connection.\n   * Displays a filled in puzzle piece.\n   *\n   * @param connection The connection to position marker around.\n   */\n  protected positionInput_(connection: RenderedConnection) {\n    const x = connection.getOffsetInBlock().x;\n    const y = connection.getOffsetInBlock().y;\n\n    const path =\n      svgPaths.moveTo(0, 0) +\n      (this.constants_.shapeFor(connection) as PuzzleTab).pathDown;\n\n    this.markerInput_!.setAttribute('d', path);\n    this.markerInput_!.setAttribute(\n      'transform',\n      'translate(' +\n        x +\n        ',' +\n        y +\n        ')' +\n        (this.workspace.RTL ? ' scale(-1 1)' : '')\n    );\n    this.currentMarkerSvg = this.markerInput_;\n  }\n\n  /**\n   * Move and show the marker at the specified coordinate in workspace units.\n   * Displays a horizontal line.\n   *\n   * @param x The new x, in workspace units.\n   * @param y The new y, in workspace units.\n   * @param width The new width, in workspace units.\n   */\n  protected positionLine_(x: number, y: number, width: number) {\n    if (!this.markerSvgLine_) {\n      throw new Error('createDom should be called before positioning the line');\n    }\n    this.markerSvgLine_.setAttribute('x', `${x}`);\n    this.markerSvgLine_.setAttribute('y', `${y}`);\n    this.markerSvgLine_.setAttribute('width', `${width}`);\n    this.currentMarkerSvg = this.markerSvgLine_;\n  }\n\n  /**\n   * Position the marker for an output connection.\n   * Displays a puzzle outline and the top and bottom path.\n   *\n   * @param width The width of the block.\n   * @param height The height of the block.\n   * @param connectionShape The shape object for the connection.\n   */\n  protected positionOutput_(\n    width: number,\n    height: number,\n    connectionShape: PuzzleTab\n  ) {\n    if (!this.markerBlock_) {\n      throw new Error(\n        'createDom should be called before positioning the output'\n      );\n    }\n    const markerPath =\n      svgPaths.moveBy(width, 0) +\n      svgPaths.lineOnAxis('h', -(width - connectionShape.width)) +\n      svgPaths.lineOnAxis('v', this.constants_.TAB_OFFSET_FROM_TOP) +\n      connectionShape.pathDown +\n      svgPaths.lineOnAxis('V', height) +\n      svgPaths.lineOnAxis('H', width);\n    this.markerBlock_.setAttribute('d', markerPath);\n    if (this.workspace.RTL) {\n      this.flipRtl(this.markerBlock_);\n    }\n    this.currentMarkerSvg = this.markerBlock_;\n  }\n\n  /**\n   * Position the marker for a previous connection.\n   * Displays a half rectangle with a notch in the top to represent the previous\n   * connection.\n   *\n   * @param width The width of the block.\n   * @param markerOffset The offset of the marker from around the block.\n   * @param markerHeight The height of the marker.\n   * @param connectionShape The shape object for the connection.\n   */\n  protected positionPrevious_(\n    width: number,\n    markerOffset: number,\n    markerHeight: number,\n    connectionShape: Notch\n  ) {\n    if (!this.markerBlock_) {\n      throw new Error(\n        'createDom should be called before positioning the previous connection marker'\n      );\n    }\n    const markerPath =\n      svgPaths.moveBy(-markerOffset, markerHeight) +\n      svgPaths.lineOnAxis('V', -markerOffset) +\n      svgPaths.lineOnAxis('H', this.constants_.NOTCH_OFFSET_LEFT) +\n      connectionShape.pathLeft +\n      svgPaths.lineOnAxis('H', width + markerOffset * 2) +\n      svgPaths.lineOnAxis('V', markerHeight);\n    this.markerBlock_.setAttribute('d', markerPath);\n    if (this.workspace.RTL) {\n      this.flipRtl(this.markerBlock_);\n    }\n    this.currentMarkerSvg = this.markerBlock_;\n  }\n\n  /**\n   * Move and show the marker at the specified coordinate in workspace units.\n   * Displays a filled in rectangle.\n   *\n   * @param x The new x, in workspace units.\n   * @param y The new y, in workspace units.\n   * @param width The new width, in workspace units.\n   * @param height The new height, in workspace units.\n   */\n  protected positionRect_(x: number, y: number, width: number, height: number) {\n    if (!this.markerSvgRect_) {\n      throw new Error('createDom should be called before positioning the rect');\n    }\n    this.markerSvgRect_.setAttribute('x', `${x}`);\n    this.markerSvgRect_.setAttribute('y', `${y}`);\n    this.markerSvgRect_.setAttribute('width', `${width}`);\n    this.markerSvgRect_.setAttribute('height', `${height}`);\n    this.currentMarkerSvg = this.markerSvgRect_;\n  }\n\n  /**\n   * Flip the SVG paths in RTL.\n   *\n   * @param markerSvg The marker that we want to flip.\n   */\n  private flipRtl(markerSvg: SVGElement) {\n    markerSvg.setAttribute('transform', 'scale(-1 1)');\n  }\n\n  /** Hide the marker. */\n  hide() {\n    if (\n      !this.markerSvgLine_ ||\n      !this.markerSvgRect_ ||\n      !this.markerInput_ ||\n      !this.markerBlock_\n    ) {\n      throw new Error('createDom should be called before hiding the marker');\n    }\n    this.markerSvgLine_.style.display = 'none';\n    this.markerSvgRect_.style.display = 'none';\n    this.markerInput_.style.display = 'none';\n    this.markerBlock_.style.display = 'none';\n  }\n\n  /**\n   * Fire event for the marker or marker.\n   *\n   * @param oldNode The old node the marker used to be on.\n   * @param curNode The new node the marker is currently on.\n   */\n  private fireMarkerEvent(oldNode: ASTNode, curNode: ASTNode) {\n    const curBlock = curNode.getSourceBlock();\n    const event = new (eventUtils.get(eventUtils.MARKER_MOVE))(\n      curBlock,\n      this.isCursor(),\n      oldNode,\n      curNode\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Get the properties to make a marker blink.\n   *\n   * @returns The object holding attributes to make the marker blink.\n   */\n  protected getBlinkProperties_(): {[key: string]: string} {\n    return {\n      'attributeType': 'XML',\n      'attributeName': 'fill',\n      'dur': '1s',\n      'values': this.colour_ + ';transparent;transparent;',\n      'repeatCount': 'indefinite',\n    };\n  }\n\n  /**\n   * Create the marker SVG.\n   *\n   * @returns The SVG node created.\n   */\n  protected createDomInternal_(): Element {\n    /* This markup will be generated and added to the .svgGroup_:\n        <g>\n          <rect width=\"100\" height=\"5\">\n            <animate attributeType=\"XML\" attributeName=\"fill\" dur=\"1s\"\n              values=\"transparent;transparent;#fff;transparent\"\n        repeatCount=\"indefinite\" />\n          </rect>\n        </g>\n        */\n\n    this.markerSvg_ = dom.createSvgElement(\n      Svg.G,\n      {\n        'width': this.constants_.CURSOR_WS_WIDTH,\n        'height': this.constants_.WS_CURSOR_HEIGHT,\n      },\n      this.svgGroup_\n    );\n\n    // A horizontal line used to represent a workspace coordinate or next\n    // connection.\n    this.markerSvgLine_ = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'width': this.constants_.CURSOR_WS_WIDTH,\n        'height': this.constants_.WS_CURSOR_HEIGHT,\n        'style': 'display: none',\n      },\n      this.markerSvg_\n    );\n\n    // A filled in rectangle used to represent a stack.\n    this.markerSvgRect_ = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': 'blocklyVerticalMarker',\n        'rx': 10,\n        'ry': 10,\n        'style': 'display: none',\n      },\n      this.markerSvg_\n    );\n\n    // A filled in puzzle piece used to represent an input value.\n    this.markerInput_ = dom.createSvgElement(\n      Svg.PATH,\n      {'transform': '', 'style': 'display: none'},\n      this.markerSvg_\n    );\n\n    // A path used to represent a previous connection and a block, an output\n    // connection and a block, or a block.\n    this.markerBlock_ = dom.createSvgElement(\n      Svg.PATH,\n      {\n        'transform': '',\n        'style': 'display: none',\n        'fill': 'none',\n        'stroke-width': this.constants_.CURSOR_STROKE_WIDTH,\n      },\n      this.markerSvg_\n    );\n\n    // Markers and stack markers don't blink.\n    if (this.isCursor()) {\n      const blinkProperties = this.getBlinkProperties_();\n      dom.createSvgElement(Svg.ANIMATE, blinkProperties, this.markerSvgLine_);\n      dom.createSvgElement(Svg.ANIMATE, blinkProperties, this.markerInput_);\n      dom.createSvgElement(\n        Svg.ANIMATE,\n        {...blinkProperties, attributeName: 'stroke'},\n        this.markerBlock_\n      );\n    }\n\n    return this.markerSvg_;\n  }\n\n  /**\n   * Apply the marker's colour.\n   *\n   * @param _curNode The node that we want to draw the marker for.\n   */\n  protected applyColour_(_curNode: ASTNode) {\n    if (\n      !this.markerSvgLine_ ||\n      !this.markerSvgRect_ ||\n      !this.markerInput_ ||\n      !this.markerBlock_\n    ) {\n      throw new Error(\n        'createDom should be called before applying color to the markerj'\n      );\n    }\n    this.markerSvgLine_.setAttribute('fill', this.colour_);\n    this.markerSvgRect_.setAttribute('stroke', this.colour_);\n    this.markerInput_.setAttribute('fill', this.colour_);\n    this.markerBlock_.setAttribute('stroke', this.colour_);\n\n    if (this.isCursor()) {\n      const values = this.colour_ + ';transparent;transparent;';\n      this.markerSvgLine_.firstElementChild!.setAttribute('values', values);\n      this.markerInput_.firstElementChild!.setAttribute('values', values);\n      this.markerBlock_.firstElementChild!.setAttribute('values', values);\n    }\n  }\n\n  /** Dispose of this marker. */\n  dispose() {\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.MarkerSvg');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {ASTNode} from '../../keyboard_nav/ast_node.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\nimport type {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\nimport {MarkerSvg as BaseMarkerSvg} from '../common/marker_svg.js';\n\nimport type {ConstantProvider as ZelosConstantProvider} from './constants.js';\n\n/**\n * Class to draw a marker.\n */\nexport class MarkerSvg extends BaseMarkerSvg {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  constants_!: ZelosConstantProvider;\n\n  private markerCircle: SVGCircleElement | null = null;\n\n  /**\n   * @param workspace The workspace the marker belongs to.\n   * @param constants The constants for the renderer.\n   * @param marker The marker to draw.\n   */\n  constructor(\n    workspace: WorkspaceSvg,\n    constants: BaseConstantProvider,\n    marker: Marker\n  ) {\n    super(workspace, constants, marker);\n  }\n\n  /**\n   * Position and display the marker for an input or an output connection.\n   *\n   * @param curNode The node to draw the marker for.\n   */\n  private showWithInputOutput(curNode: ASTNode) {\n    const block = curNode.getSourceBlock() as BlockSvg;\n    const connection = curNode.getLocation() as RenderedConnection;\n    const offsetInBlock = connection.getOffsetInBlock();\n\n    this.positionCircle(offsetInBlock.x, offsetInBlock.y);\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  override showWithOutput_(curNode: ASTNode) {\n    this.showWithInputOutput(curNode);\n  }\n\n  override showWithInput_(curNode: ASTNode) {\n    this.showWithInputOutput(curNode);\n  }\n\n  /**\n   * Draw a rectangle around the block.\n   *\n   * @param curNode The current node of the marker.\n   */\n  override showWithBlock_(curNode: ASTNode) {\n    const block = curNode.getLocation() as BlockSvg;\n\n    // Gets the height and width of entire stack.\n    const heightWidth = block.getHeightWidth();\n    // Add padding so that being on a stack looks different than being on a\n    // block.\n    this.positionRect_(0, 0, heightWidth.width, heightWidth.height);\n    this.setParent_(block);\n    this.showCurrent_();\n  }\n\n  /**\n   * Position the circle we use for input and output connections.\n   *\n   * @param x The x position of the circle.\n   * @param y The y position of the circle.\n   */\n  private positionCircle(x: number, y: number) {\n    this.markerCircle?.setAttribute('cx', `${x}`);\n    this.markerCircle?.setAttribute('cy', `${y}`);\n    this.currentMarkerSvg = this.markerCircle;\n  }\n\n  override hide() {\n    super.hide();\n    if (this.markerCircle) {\n      this.markerCircle.style.display = 'none';\n    }\n  }\n\n  override createDomInternal_() {\n    /* clang-format off */\n    /* This markup will be generated and added to the .svgGroup_:\n        <g>\n          <rect width=\"100\" height=\"5\">\n            <animate attributeType=\"XML\" attributeName=\"fill\" dur=\"1s\"\n              values=\"transparent;transparent;#fff;transparent\" repeatCount=\"indefinite\" />\n          </rect>\n        </g>\n        */\n    /* clang-format on */\n    super.createDomInternal_();\n\n    this.markerCircle = dom.createSvgElement(\n      Svg.CIRCLE,\n      {\n        'r': this.constants_.CURSOR_RADIUS,\n        'style': 'display: none',\n        'stroke-width': this.constants_.CURSOR_STROKE_WIDTH,\n      },\n      this.markerSvg_\n    );\n\n    // Markers and stack cursors don't blink.\n    if (this.isCursor()) {\n      const blinkProperties = this.getBlinkProperties_();\n      dom.createSvgElement(Svg.ANIMATE, blinkProperties, this.markerCircle!);\n    }\n\n    return this.markerSvg_!;\n  }\n\n  override applyColour_(curNode: ASTNode) {\n    super.applyColour_(curNode);\n\n    this.markerCircle?.setAttribute('fill', this.colour_);\n    this.markerCircle?.setAttribute('stroke', this.colour_);\n\n    if (this.isCursor()) {\n      const values = this.colour_ + ';transparent;transparent;';\n      this.markerCircle?.firstElementChild!.setAttribute('values', values);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.PathObject');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport type {BlockStyle} from '../../theme.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport type {IPathObject} from './i_path_object.js';\n\n/**\n * An object that handles creating and setting each of the SVG elements\n * used by the renderer.\n */\nexport class PathObject implements IPathObject {\n  svgRoot: SVGElement;\n  svgPath: SVGElement;\n\n  /**\n   * Holds the cursors svg element when the cursor is attached to the block.\n   * This is null if there is no cursor on the block.\n   */\n  cursorSvg: SVGElement | null = null;\n\n  /**\n   * Holds the markers svg element when the marker is attached to the block.\n   * This is null if there is no marker on the block.\n   */\n  markerSvg: SVGElement | null = null;\n\n  constants: ConstantProvider;\n  style: BlockStyle;\n\n  /**\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @param constants The renderer's constants.\n   */\n  constructor(\n    root: SVGElement,\n    style: BlockStyle,\n    constants: ConstantProvider\n  ) {\n    this.constants = constants;\n    this.style = style;\n    this.svgRoot = root;\n\n    /** The primary path of the block. */\n    this.svgPath = dom.createSvgElement(\n      Svg.PATH,\n      {'class': 'blocklyPath'},\n      this.svgRoot\n    );\n  }\n\n  /**\n   * Set the path generated by the renderer onto the respective SVG element.\n   *\n   * @param pathString The path.\n   */\n  setPath(pathString: string) {\n    this.svgPath.setAttribute('d', pathString);\n  }\n\n  /**\n   * Flip the SVG paths in RTL.\n   */\n  flipRTL() {\n    // Mirror the block's path.\n    this.svgPath.setAttribute('transform', 'scale(-1 1)');\n  }\n\n  /**\n   * Add the cursor SVG to this block's SVG group.\n   *\n   * @param cursorSvg The SVG root of the cursor to be added to the block SVG\n   *     group.\n   */\n  setCursorSvg(cursorSvg: SVGElement) {\n    if (!cursorSvg) {\n      this.cursorSvg = null;\n      return;\n    }\n\n    this.svgRoot.appendChild(cursorSvg);\n    this.cursorSvg = cursorSvg;\n  }\n\n  /**\n   * Add the marker SVG to this block's SVG group.\n   *\n   * @param markerSvg The SVG root of the marker to be added to the block SVG\n   *     group.\n   */\n  setMarkerSvg(markerSvg: SVGElement) {\n    if (!markerSvg) {\n      this.markerSvg = null;\n      return;\n    }\n\n    if (this.cursorSvg) {\n      this.svgRoot.insertBefore(markerSvg, this.cursorSvg);\n    } else {\n      this.svgRoot.appendChild(markerSvg);\n    }\n    this.markerSvg = markerSvg;\n  }\n\n  /**\n   * Apply the stored colours to the block's path, taking into account whether\n   * the paths belong to a shadow block.\n   *\n   * @param block The source block.\n   */\n  applyColour(block: BlockSvg) {\n    this.svgPath.setAttribute('stroke', this.style.colourTertiary);\n    this.svgPath.setAttribute('fill', this.style.colourPrimary);\n\n    this.updateShadow_(block.isShadow());\n    this.updateDisabled_(!block.isEnabled() || block.getInheritedDisabled());\n  }\n\n  /**\n   * Set the style.\n   *\n   * @param blockStyle The block style to use.\n   */\n  setStyle(blockStyle: BlockStyle) {\n    this.style = blockStyle;\n  }\n\n  /**\n   * Add or remove the given CSS class on the path object's root SVG element.\n   *\n   * @param className The name of the class to add or remove\n   * @param add True if the class should be added.  False if it should be\n   *     removed.\n   */\n  protected setClass_(className: string, add: boolean) {\n    if (!className) {\n      return;\n    }\n    if (add) {\n      dom.addClass(this.svgRoot, className);\n    } else {\n      dom.removeClass(this.svgRoot, className);\n    }\n  }\n\n  /**\n   * Set whether the block shows a highlight or not.  Block highlighting is\n   * often used to visually mark blocks currently being executed.\n   *\n   * @param enable True if highlighted.\n   */\n  updateHighlighted(enable: boolean) {\n    if (enable) {\n      this.svgPath.setAttribute(\n        'filter',\n        'url(#' + this.constants.embossFilterId + ')'\n      );\n    } else {\n      this.svgPath.setAttribute('filter', 'none');\n    }\n  }\n\n  /**\n   * Updates the look of the block to reflect a shadow state.\n   *\n   * @param shadow True if the block is a shadow block.\n   */\n  protected updateShadow_(shadow: boolean) {\n    if (shadow) {\n      this.svgPath.setAttribute('stroke', 'none');\n      this.svgPath.setAttribute('fill', this.style.colourSecondary);\n    }\n  }\n\n  /**\n   * Updates the look of the block to reflect a disabled state.\n   *\n   * @param disabled True if disabled.\n   */\n  protected updateDisabled_(disabled: boolean) {\n    this.setClass_('blocklyDisabled', disabled);\n    if (disabled) {\n      this.svgPath.setAttribute(\n        'fill',\n        'url(#' + this.constants.disabledPatternId + ')'\n      );\n    }\n  }\n\n  /**\n   * Add or remove styling showing that a block is selected.\n   *\n   * @param enable True if selection is enabled, false otherwise.\n   */\n  updateSelected(enable: boolean) {\n    this.setClass_('blocklySelected', enable);\n  }\n\n  /**\n   * Add or remove styling showing that a block is dragged over a delete area.\n   *\n   * @param enable True if the block is being dragged over a delete area, false\n   *     otherwise.\n   */\n  updateDraggingDelete(enable: boolean) {\n    this.setClass_('blocklyDraggingDelete', enable);\n  }\n\n  /**\n   * Add or remove styling showing that a block is an insertion marker.\n   *\n   * @param enable True if the block is an insertion marker, false otherwise.\n   */\n  updateInsertionMarker(enable: boolean) {\n    this.setClass_('blocklyInsertionMarker', enable);\n  }\n\n  /**\n   * Add or remove styling showing that a block is movable.\n   *\n   * @param enable True if the block is movable, false otherwise.\n   */\n  updateMovable(enable: boolean) {\n    this.setClass_('blocklyDraggable', enable);\n  }\n\n  /**\n   * Add or remove styling that shows that if the dragging block is dropped,\n   * this block will be replaced.  If a shadow block, it will disappear.\n   * Otherwise it will bump.\n   *\n   * @param enable True if styling should be added.\n   */\n  updateReplacementFade(enable: boolean) {\n    this.setClass_('blocklyReplaceable', enable);\n  }\n\n  /**\n   * Add or remove styling that shows that if the dragging block is dropped,\n   * this block will be connected to the input.\n   *\n   * @param _conn The connection on the input to highlight.\n   * @param _enable True if styling should be added.\n   */\n  updateShapeForInputHighlight(_conn: Connection, _enable: boolean) {\n    // NOOP\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.PathObject');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport type {BlockStyle} from '../../theme.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport {PathObject as BasePathObject} from '../common/path_object.js';\n\nimport type {ConstantProvider} from './constants.js';\n\n/**\n * An object that handles creating and setting each of the SVG elements\n * used by the renderer.\n */\nexport class PathObject extends BasePathObject {\n  /** The selected path of the block. */\n  private svgPathSelected: SVGElement | null = null;\n\n  /** The outline paths on the block. */\n  private readonly outlines = new Map<string, SVGElement>();\n\n  /**\n   * A set used to determine which outlines were used during a draw pass.  The\n   * set is initialized with a reference to all the outlines in\n   * `this.outlines`. Every time we use an outline during the draw pass, the\n   * reference is removed from this set.\n   */\n  private remainingOutlines = new Set<string>();\n\n  /**\n   * The type of block's output connection shape.  This is set when a block\n   * with an output connection is drawn.\n   */\n  outputShapeType: number | null = null;\n\n  public override constants: ConstantProvider;\n\n  /**\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @param constants The renderer's constants.\n   */\n  constructor(\n    root: SVGElement,\n    style: BlockStyle,\n    constants: ConstantProvider\n  ) {\n    super(root, style, constants);\n\n    this.constants = constants;\n  }\n\n  override setPath(pathString: string) {\n    super.setPath(pathString);\n    if (this.svgPathSelected) {\n      this.svgPathSelected.setAttribute('d', pathString);\n    }\n  }\n\n  override applyColour(block: BlockSvg) {\n    super.applyColour(block);\n    // Set shadow stroke colour.\n    const parent = block.getParent();\n    if (block.isShadow() && parent) {\n      this.svgPath.setAttribute('stroke', parent.style.colourTertiary);\n    }\n\n    // Apply colour to outlines.\n    for (const outline of this.outlines.values()) {\n      outline.setAttribute('fill', this.style.colourTertiary);\n    }\n  }\n\n  override flipRTL() {\n    super.flipRTL();\n    // Mirror each input outline path.\n    for (const outline of this.outlines.values()) {\n      outline.setAttribute('transform', 'scale(-1 1)');\n    }\n  }\n\n  override updateSelected(enable: boolean) {\n    this.setClass_('blocklySelected', enable);\n    if (enable) {\n      if (!this.svgPathSelected) {\n        this.svgPathSelected = this.svgPath.cloneNode(true) as SVGElement;\n        this.svgPathSelected.setAttribute('fill', 'none');\n        this.svgPathSelected.setAttribute(\n          'filter',\n          'url(#' + this.constants.selectedGlowFilterId + ')'\n        );\n        this.svgRoot.appendChild(this.svgPathSelected);\n      }\n    } else {\n      if (this.svgPathSelected) {\n        this.svgRoot.removeChild(this.svgPathSelected);\n        this.svgPathSelected = null;\n      }\n    }\n  }\n\n  override updateReplacementFade(enable: boolean) {\n    this.setClass_('blocklyReplaceable', enable);\n    if (enable) {\n      this.svgPath.setAttribute(\n        'filter',\n        'url(#' + this.constants.replacementGlowFilterId + ')'\n      );\n    } else {\n      this.svgPath.removeAttribute('filter');\n    }\n  }\n\n  override updateShapeForInputHighlight(conn: Connection, enable: boolean) {\n    const name = conn.getParentInput()!.name;\n    const outlinePath = this.getOutlinePath(name);\n    if (!outlinePath) {\n      return;\n    }\n    if (enable) {\n      outlinePath.setAttribute(\n        'filter',\n        'url(#' + this.constants.replacementGlowFilterId + ')'\n      );\n    } else {\n      outlinePath.removeAttribute('filter');\n    }\n  }\n\n  /**\n   * Method that's called when the drawer is about to draw the block.\n   */\n  beginDrawing() {\n    this.remainingOutlines.clear();\n    for (const key of this.outlines.keys()) {\n      this.remainingOutlines.add(key);\n    }\n  }\n\n  /**\n   * Method that's called when the drawer is done drawing.\n   */\n  endDrawing() {\n    // Go through all remaining outlines that were not used this draw pass, and\n    // remove them.\n    if (this.remainingOutlines.size) {\n      for (const key of this.remainingOutlines) {\n        this.removeOutlinePath(key);\n      }\n    }\n    this.remainingOutlines.clear();\n  }\n\n  /**\n   * Set the path generated by the renderer for an outline path on the\n   * respective outline path SVG element.\n   *\n   * @param name The input name.\n   * @param pathString The path.\n   */\n  setOutlinePath(name: string, pathString: string) {\n    const outline = this.getOutlinePath(name);\n    outline.setAttribute('d', pathString);\n    outline.setAttribute('fill', this.style.colourTertiary);\n  }\n\n  /**\n   * Create's an outline path for the specified input.\n   *\n   * @param name The input name.\n   * @returns The SVG outline path.\n   */\n  private getOutlinePath(name: string): SVGElement {\n    if (!this.outlines.has(name)) {\n      this.outlines.set(\n        name,\n        dom.createSvgElement(\n          Svg.PATH,\n          {\n            'class': 'blocklyOutlinePath', // IE doesn't like paths without the\n            // data definition, set empty\n            // default\n            'd': '',\n          },\n          this.svgRoot\n        )\n      );\n    }\n    this.remainingOutlines.delete(name);\n    return this.outlines.get(name)!;\n  }\n\n  /**\n   * Remove an outline path that is associated with the specified input.\n   *\n   * @param name The input name.\n   */\n  private removeOutlinePath(name: string) {\n    this.outlines.get(name)?.parentNode?.removeChild(this.outlines.get(name)!);\n    this.outlines.delete(name);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.blockRendering.Renderer');\n\nimport type {Block} from '../../block.js';\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Connection} from '../../connection.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport {\n  InsertionMarkerManager,\n  PreviewType,\n} from '../../insertion_marker_manager.js';\nimport type {IRegistrable} from '../../interfaces/i_registrable.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle, Theme} from '../../theme.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport type {IPathObject} from './i_path_object.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {PathObject} from './path_object.js';\n\n/**\n * The base class for a block renderer.\n */\nexport class Renderer implements IRegistrable {\n  /** The renderer's constant provider. */\n  protected constants_!: ConstantProvider;\n\n  protected name: string;\n\n  /**\n   * Rendering constant overrides, passed in through options.\n   */\n  protected overrides: object | null = null;\n\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    this.name = name;\n  }\n\n  /**\n   * Gets the class name that identifies this renderer.\n   *\n   * @returns The CSS class name.\n   */\n  getClassName(): string {\n    return this.name + '-renderer';\n  }\n\n  /**\n   * Initialize the renderer.\n   *\n   * @param theme The workspace theme object.\n   * @param opt_rendererOverrides Rendering constant overrides.\n   */\n  init(\n    theme: Theme,\n    opt_rendererOverrides?: {[rendererConstant: string]: any}\n  ) {\n    this.constants_ = this.makeConstants_();\n    if (opt_rendererOverrides) {\n      this.overrides = opt_rendererOverrides;\n      Object.assign(this.constants_, opt_rendererOverrides);\n    }\n    this.constants_.setTheme(theme);\n    this.constants_.init();\n  }\n\n  /**\n   * Create any DOM elements that this renderer needs.\n   * If you need to create additional DOM elements, override the\n   * {@link ConstantProvider#createDom} method instead.\n   *\n   * @param svg The root of the workspace's SVG.\n   * @param theme The workspace theme object.\n   * @internal\n   */\n  createDom(svg: SVGElement, theme: Theme) {\n    this.constants_.createDom(\n      svg,\n      this.name + '-' + theme.name,\n      '.' + this.getClassName() + '.' + theme.getClassName()\n    );\n  }\n\n  /**\n   * Refresh the renderer after a theme change.\n   *\n   * @param svg The root of the workspace's SVG.\n   * @param theme The workspace theme object.\n   */\n  refreshDom(svg: SVGElement, theme: Theme) {\n    const previousConstants = this.getConstants();\n    previousConstants.dispose();\n    this.constants_ = this.makeConstants_();\n    if (this.overrides) {\n      Object.assign(this.constants_, this.overrides);\n    }\n    // Ensure the constant provider's random identifier does not change.\n    this.constants_.randomIdentifier = previousConstants.randomIdentifier;\n    this.constants_.setTheme(theme);\n    this.constants_.init();\n    this.createDom(svg, theme);\n  }\n\n  /**\n   * Dispose of this renderer.\n   * Delete all DOM elements that this renderer and its constants created.\n   */\n  dispose() {\n    if (this.constants_) {\n      this.constants_.dispose();\n    }\n  }\n\n  /**\n   * Create a new instance of the renderer's constant provider.\n   *\n   * @returns The constant provider.\n   */\n  protected makeConstants_(): ConstantProvider {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected makeDrawer_(block: BlockSvg, info: RenderInfo): Drawer {\n    return new Drawer(block, info);\n  }\n\n  /**\n   * Create a new instance of the renderer's marker drawer.\n   *\n   * @param workspace The workspace the marker belongs to.\n   * @param marker The marker.\n   * @returns The object in charge of drawing the marker.\n   */\n  makeMarkerDrawer(workspace: WorkspaceSvg, marker: Marker): MarkerSvg {\n    return new MarkerSvg(workspace, this.getConstants(), marker);\n  }\n\n  /**\n   * Create a new instance of a renderer path object.\n   *\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @returns The renderer path object.\n   */\n  makePathObject(root: SVGElement, style: BlockStyle): IPathObject {\n    return new PathObject(root, style, this.constants_);\n  }\n\n  /**\n   * Get the current renderer's constant provider.  We assume that when this is\n   * called, the renderer has already been initialized.\n   *\n   * @returns The constant provider.\n   */\n  getConstants(): ConstantProvider {\n    return this.constants_;\n  }\n\n  /**\n   * Determine whether or not to highlight a connection.\n   *\n   * @param _conn The connection to determine whether or not to highlight.\n   * @returns True if we should highlight the connection.\n   */\n  shouldHighlightConnection(_conn: Connection): boolean {\n    return true;\n  }\n\n  /**\n   * Checks if an orphaned block can connect to the \"end\" of the topBlock's\n   * block-clump. If the clump is a row the end is the last input. If the clump\n   * is a stack, the end is the last next connection. If the clump is neither,\n   * then this returns false.\n   *\n   * @param topBlock The top block of the block clump we want to try and connect\n   *     to.\n   * @param orphanBlock The orphan block that wants to find a home.\n   * @param localType The type of the connection being dragged.\n   * @returns Whether there is a home for the orphan or not.\n   */\n  protected orphanCanConnectAtEnd(\n    topBlock: BlockSvg,\n    orphanBlock: BlockSvg,\n    localType: number\n  ): boolean {\n    const orphanConnection =\n      localType === ConnectionType.OUTPUT_VALUE\n        ? orphanBlock.outputConnection\n        : orphanBlock.previousConnection;\n    return !!Connection.getConnectionForOrphanedConnection(\n      topBlock as Block,\n      orphanConnection as Connection\n    );\n  }\n\n  /**\n   * Chooses a connection preview method based on the available connection, the\n   * current dragged connection, and the block being dragged.\n   *\n   * @param closest The available connection.\n   * @param local The connection currently being dragged.\n   * @param topBlock The block currently being dragged.\n   * @returns The preview type to display.\n   */\n  getConnectionPreviewMethod(\n    closest: RenderedConnection,\n    local: RenderedConnection,\n    topBlock: BlockSvg\n  ): PreviewType {\n    if (\n      local.type === ConnectionType.OUTPUT_VALUE ||\n      local.type === ConnectionType.PREVIOUS_STATEMENT\n    ) {\n      if (\n        !closest.isConnected() ||\n        this.orphanCanConnectAtEnd(\n          topBlock,\n          closest.targetBlock() as BlockSvg,\n          local.type\n        )\n      ) {\n        return InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER;\n      }\n      return InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE;\n    }\n\n    return InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER;\n  }\n\n  /**\n   * Render the block.\n   *\n   * @param block The block to render.\n   * @internal\n   */\n  render(block: BlockSvg) {\n    const info = this.makeRenderInfo_(block);\n    info.measure();\n    this.makeDrawer_(block, info).draw();\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos.Renderer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Connection} from '../../connection.js';\nimport {ConnectionType} from '../../connection_type.js';\nimport {InsertionMarkerManager} from '../../insertion_marker_manager.js';\nimport type {Marker} from '../../keyboard_nav/marker.js';\nimport type {RenderedConnection} from '../../rendered_connection.js';\nimport type {BlockStyle} from '../../theme.js';\nimport type {WorkspaceSvg} from '../../workspace_svg.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport type {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {PathObject} from './path_object.js';\n\n/**\n * The zelos renderer. This renderer emulates Scratch-style and MakeCode-style\n * rendering.\n *\n * Zelos is the ancient Greek spirit of rivalry and emulation.\n */\nexport class Renderer extends BaseRenderer {\n  protected override constants_!: ConstantProvider;\n\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Create a new instance of the renderer's constant provider.\n   *\n   * @returns The constant provider.\n   */\n  protected override makeConstants_(): ConstantProvider {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected override makeDrawer_(\n    block: BlockSvg,\n    info: BaseRenderInfo\n  ): Drawer {\n    return new Drawer(block, info as RenderInfo);\n  }\n\n  /**\n   * Create a new instance of the renderer's cursor drawer.\n   *\n   * @param workspace The workspace the cursor belongs to.\n   * @param marker The marker.\n   * @returns The object in charge of drawing the marker.\n   */\n  override makeMarkerDrawer(\n    workspace: WorkspaceSvg,\n    marker: Marker\n  ): MarkerSvg {\n    return new MarkerSvg(workspace, this.getConstants(), marker);\n  }\n\n  /**\n   * Create a new instance of a renderer path object.\n   *\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @returns The renderer path object.\n   */\n  override makePathObject(root: SVGElement, style: BlockStyle): PathObject {\n    return new PathObject(root, style, this.getConstants() as ConstantProvider);\n  }\n\n  /**\n   * Get the current renderer's constant provider.  We assume that when this is\n   * called, the renderer has already been initialized.\n   *\n   * @returns The constant provider.\n   */\n  override getConstants(): ConstantProvider {\n    return this.constants_;\n  }\n\n  override shouldHighlightConnection(conn: Connection) {\n    return (\n      conn.type !== ConnectionType.INPUT_VALUE &&\n      conn.type !== ConnectionType.OUTPUT_VALUE\n    );\n  }\n\n  override getConnectionPreviewMethod(\n    closest: RenderedConnection,\n    local: RenderedConnection,\n    topBlock: BlockSvg\n  ) {\n    if (local.type === ConnectionType.OUTPUT_VALUE) {\n      if (!closest.isConnected()) {\n        return InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE;\n      }\n      // TODO: Returning this is a total hack, because we don't want to show\n      //   a replacement fade, we want to show an outline affect.\n      //   Sadly zelos does not support showing an outline around filled\n      //   inputs, so we have to pretend like the connected block is getting\n      //   replaced.\n      return InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE;\n    }\n\n    return super.getConnectionPreviewMethod(closest, local, topBlock);\n  }\n}\n\nblockRendering.register('zelos', Renderer);\n","/** @file Re-exports of Blockly.zelos.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.zelos');\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\nimport {MarkerSvg} from './marker_svg.js';\nimport {BottomRow} from './measurables/bottom_row.js';\nimport {StatementInput} from './measurables/inputs.js';\nimport {RightConnectionShape} from './measurables/row_elements.js';\nimport {TopRow} from './measurables/top_row.js';\nimport {PathObject} from './path_object.js';\nimport {Renderer} from './renderer.js';\n\nexport {\n  BottomRow,\n  ConstantProvider,\n  Drawer,\n  MarkerSvg,\n  PathObject,\n  Renderer,\n  RenderInfo,\n  RightConnectionShape,\n  StatementInput,\n  TopRow,\n};\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The abstract class for a component with custom behaviour when a\n * block or bubble is dragged over or dropped on top of it.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.DragTarget');\n\nimport type {IDragTarget} from './interfaces/i_drag_target.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\nimport type {Rect} from './utils/rect.js';\n\n/**\n * Abstract class for a component with custom behaviour when a block or bubble\n * is dragged over or dropped on top of it.\n */\nexport class DragTarget implements IDragTarget {\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  id!: string;\n\n  /**\n   * Constructor for DragTarget. It exists to add the id property and should not\n   * be called directly, only by a subclass.\n   */\n  constructor() {}\n\n  /**\n   * Handles when a cursor with a block or bubble enters this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDragEnter(_dragElement: IDraggable) {}\n  // no-op\n\n  /**\n   * Handles when a cursor with a block or bubble is dragged over this drag\n   * target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDragOver(_dragElement: IDraggable) {}\n  // no-op\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDragExit(_dragElement: IDraggable) {}\n  // no-op\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  onDrop(_dragElement: IDraggable) {}\n  // no-op\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to the Blockly injection div.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  getClientRect(): Rect | null {\n    return null;\n  }\n\n  /**\n   * Returns whether the provided block or bubble should not be moved after\n   * being dropped on this component. If true, the element will return to where\n   * it was when the drag started.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   * @returns Whether the block or bubble provided should be returned to drag\n   *     start.\n   */\n  shouldPreventMove(_dragElement: IDraggable): boolean {\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The abstract class for a component that can delete a block or\n * bubble that is dropped on top of it.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.DeleteArea');\n\nimport {BlockSvg} from './block_svg.js';\nimport {DragTarget} from './drag_target.js';\nimport type {IDeleteArea} from './interfaces/i_delete_area.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\n\n/**\n * Abstract class for a component that can delete a block or bubble that is\n * dropped on top of it.\n */\nexport class DeleteArea extends DragTarget implements IDeleteArea {\n  /**\n   * Whether the last block or bubble dragged over this delete area would be\n   * deleted if dropped on this component.\n   * This property is not updated after the block or bubble is deleted.\n   */\n  protected wouldDelete_ = false;\n\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override id!: string;\n\n  /**\n   * Constructor for DeleteArea. Should not be called directly, only by a\n   * subclass.\n   */\n  constructor() {\n    super();\n  }\n\n  /**\n   * Returns whether the provided block or bubble would be deleted if dropped on\n   * this area.\n   * This method should check if the element is deletable and is always called\n   * before onDragEnter/onDragOver/onDragExit.\n   *\n   * @param element The block or bubble currently being dragged.\n   * @param couldConnect Whether the element could could connect to another.\n   * @returns Whether the element provided would be deleted if dropped on this\n   *     area.\n   */\n  wouldDelete(element: IDraggable, couldConnect: boolean): boolean {\n    if (element instanceof BlockSvg) {\n      const block = element;\n      const couldDeleteBlock = !block.getParent() && block.isDeletable();\n      this.updateWouldDelete_(couldDeleteBlock && !couldConnect);\n    } else {\n      this.updateWouldDelete_(element.isDeletable());\n    }\n    return this.wouldDelete_;\n  }\n\n  /**\n   * Updates the internal wouldDelete_ state.\n   *\n   * @param wouldDelete The new value for the wouldDelete state.\n   */\n  protected updateWouldDelete_(wouldDelete: boolean) {\n    this.wouldDelete_ = wouldDelete;\n  }\n}\n","/**\n * @license\n * Copyright 2013 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Angle input field.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldAngle');\n\nimport {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as Css from './css.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Field, UnattachedFieldError} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {\n  FieldInput,\n  FieldInputConfig,\n  FieldInputValidator,\n} from './field_input.js';\nimport * as dom from './utils/dom.js';\nimport * as math from './utils/math.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n/**\n * Class for an editable angle field.\n */\nexport class FieldAngle extends FieldInput<number> {\n  /** Half the width of protractor image. */\n  static readonly HALF = 100 / 2;\n\n  /**\n   * Radius of protractor circle.  Slightly smaller than protractor size since\n   * otherwise SVG crops off half the border at the edges.\n   */\n  static readonly RADIUS: number = FieldAngle.HALF - 1;\n\n  /**\n   * Default property describing which direction makes an angle field's value\n   * increase. Angle increases clockwise (true) or counterclockwise (false).\n   */\n  static readonly CLOCKWISE = false;\n\n  /**\n   * The default offset of 0 degrees (and all angles). Always offsets in the\n   * counterclockwise direction, regardless of the field's clockwise property.\n   * Usually either 0 (0 = right) or 90 (0 = up).\n   */\n  static readonly OFFSET = 0;\n\n  /**\n   * The default maximum angle to allow before wrapping.\n   * Usually either 360 (for 0 to 359.9) or 180 (for -179.9 to 180).\n   */\n  static readonly WRAP = 360;\n\n  /**\n   * The default amount to round angles to when using a mouse or keyboard nav\n   * input. Must be a positive integer to support keyboard navigation.\n   */\n  static readonly ROUND = 15;\n\n  /**\n   * Whether the angle should increase as the angle picker is moved clockwise\n   * (true) or counterclockwise (false).\n   */\n  private clockwise = FieldAngle.CLOCKWISE;\n\n  /**\n   * The offset of zero degrees (and all other angles).\n   */\n  private offset = FieldAngle.OFFSET;\n\n  /**\n   * The maximum angle to allow before wrapping.\n   */\n  private wrap = FieldAngle.WRAP;\n\n  /**\n   * The amount to round angles to when using a mouse or keyboard nav input.\n   */\n  private round = FieldAngle.ROUND;\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  /** Dynamic red line pointing at the value's angle. */\n  private line: SVGLineElement | null = null;\n\n  /** Dynamic pink area extending from 0 to the value's angle. */\n  private gauge: SVGPathElement | null = null;\n\n  /** The degree symbol for this field. */\n  protected symbol_: SVGTSpanElement | null = null;\n\n  /**\n   * @param value The initial value of the field. Should cast to a number.\n   *     Defaults to 0. Also accepts Field.SKIP_SETUP if you wish to skip setup\n   *     (only used by subclasses that want to handle configuration and setting\n   *     the field value after their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a number & returns a validated number, or null\n   *     to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/angle#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | number | typeof Field.SKIP_SETUP,\n    validator?: FieldAngleValidator,\n    config?: FieldAngleConfig\n  ) {\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldAngleConfig) {\n    super.configure_(config);\n\n    switch (config.mode) {\n      case Mode.COMPASS:\n        this.clockwise = true;\n        this.offset = 90;\n        break;\n      case Mode.PROTRACTOR:\n        // This is the default mode, so we could do nothing. But just to\n        // future-proof, we'll set it anyway.\n        this.clockwise = false;\n        this.offset = 0;\n        break;\n    }\n\n    // Allow individual settings to override the mode setting.\n    if (config.clockwise) this.clockwise = config.clockwise;\n    if (config.offset) this.offset = config.offset;\n    if (config.wrap) this.wrap = config.wrap;\n    if (config.round) this.round = config.round;\n  }\n\n  /**\n   * Create the block UI for this field.\n   *\n   * @internal\n   */\n  override initView() {\n    super.initView();\n    // Add the degree symbol to the left of the number,\n    // even in RTL (issue #2380).\n    this.symbol_ = dom.createSvgElement(Svg.TSPAN, {});\n    this.symbol_.appendChild(document.createTextNode('°'));\n    this.getTextElement().appendChild(this.symbol_);\n  }\n\n  /** Updates the angle when the field rerenders. */\n  protected override render_() {\n    super.render_();\n    this.updateGraph();\n  }\n\n  /**\n   * Create and show the angle field's editor.\n   *\n   * @param e Optional mouse event that triggered the field to open,\n   *     or undefined if triggered programmatically.\n   */\n  protected override showEditor_(e?: Event) {\n    // Mobile browsers have issues with in-line textareas (focus & keyboards).\n    const noFocus = userAgent.MOBILE || userAgent.ANDROID || userAgent.IPAD;\n    super.showEditor_(e, noFocus);\n\n    const editor = this.dropdownCreate();\n    dropDownDiv.getContentDiv().appendChild(editor);\n\n    if (this.sourceBlock_ instanceof BlockSvg) {\n      dropDownDiv.setColour(\n        this.sourceBlock_.style.colourPrimary,\n        this.sourceBlock_.style.colourTertiary\n      );\n    }\n\n    dropDownDiv.showPositionedByField(this, this.dropdownDispose.bind(this));\n\n    this.updateGraph();\n  }\n\n  /**\n   * Creates the angle dropdown editor.\n   *\n   * @returns The newly created slider.\n   */\n  private dropdownCreate(): SVGSVGElement {\n    const svg = dom.createSvgElement(Svg.SVG, {\n      'xmlns': dom.SVG_NS,\n      'xmlns:html': dom.HTML_NS,\n      'xmlns:xlink': dom.XLINK_NS,\n      'version': '1.1',\n      'height': FieldAngle.HALF * 2 + 'px',\n      'width': FieldAngle.HALF * 2 + 'px',\n      'style': 'touch-action: none',\n    });\n    const circle = dom.createSvgElement(\n      Svg.CIRCLE,\n      {\n        'cx': FieldAngle.HALF,\n        'cy': FieldAngle.HALF,\n        'r': FieldAngle.RADIUS,\n        'class': 'blocklyAngleCircle',\n      },\n      svg\n    );\n    this.gauge = dom.createSvgElement(\n      Svg.PATH,\n      {'class': 'blocklyAngleGauge'},\n      svg\n    );\n    this.line = dom.createSvgElement(\n      Svg.LINE,\n      {\n        'x1': FieldAngle.HALF,\n        'y1': FieldAngle.HALF,\n        'class': 'blocklyAngleLine',\n      },\n      svg\n    );\n    // Draw markers around the edge.\n    for (let angle = 0; angle < 360; angle += 15) {\n      dom.createSvgElement(\n        Svg.LINE,\n        {\n          'x1': FieldAngle.HALF + FieldAngle.RADIUS,\n          'y1': FieldAngle.HALF,\n          'x2':\n            FieldAngle.HALF + FieldAngle.RADIUS - (angle % 45 === 0 ? 10 : 5),\n          'y2': FieldAngle.HALF,\n          'class': 'blocklyAngleMarks',\n          'transform':\n            'rotate(' +\n            angle +\n            ',' +\n            FieldAngle.HALF +\n            ',' +\n            FieldAngle.HALF +\n            ')',\n        },\n        svg\n      );\n    }\n\n    // The angle picker is different from other fields in that it updates on\n    // mousemove even if it's not in the middle of a drag.  In future we may\n    // change this behaviour.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(svg, 'click', this, this.hide)\n    );\n    // On touch devices, the picker's value is only updated with a drag. Add\n    // a click handler on the drag surface to update the value if the surface\n    // is clicked.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        circle,\n        'pointerdown',\n        this,\n        this.onMouseMove_,\n        true\n      )\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        circle,\n        'pointermove',\n        this,\n        this.onMouseMove_,\n        true\n      )\n    );\n    return svg;\n  }\n\n  /** Disposes of events and DOM-references belonging to the angle editor. */\n  private dropdownDispose() {\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n    this.gauge = null;\n    this.line = null;\n  }\n\n  /** Hide the editor. */\n  private hide() {\n    dropDownDiv.hideIfOwner(this);\n    WidgetDiv.hide();\n  }\n\n  /**\n   * Set the angle to match the mouse's position.\n   *\n   * @param e Mouse move event.\n   */\n  protected onMouseMove_(e: PointerEvent) {\n    // Calculate angle.\n    const bBox = this.gauge!.ownerSVGElement!.getBoundingClientRect();\n    const dx = e.clientX - bBox.left - FieldAngle.HALF;\n    const dy = e.clientY - bBox.top - FieldAngle.HALF;\n    let angle = Math.atan(-dy / dx);\n    if (isNaN(angle)) {\n      // This shouldn't happen, but let's not let this error propagate further.\n      return;\n    }\n    angle = math.toDegrees(angle);\n    // 0: East, 90: North, 180: West, 270: South.\n    if (dx < 0) {\n      angle += 180;\n    } else if (dy > 0) {\n      angle += 360;\n    }\n\n    // Do offsetting.\n    if (this.clockwise) {\n      angle = this.offset + 360 - angle;\n    } else {\n      angle = 360 - (this.offset - angle);\n    }\n\n    this.displayMouseOrKeyboardValue(angle);\n  }\n\n  /**\n   * Handles and displays values that are input via mouse or arrow key input.\n   * These values need to be rounded and wrapped before being displayed so\n   * that the text input's value is appropriate.\n   *\n   * @param angle New angle.\n   */\n  private displayMouseOrKeyboardValue(angle: number) {\n    if (this.round) {\n      angle = Math.round(angle / this.round) * this.round;\n    }\n    angle = this.wrapValue(angle);\n    if (angle !== this.value_) {\n      this.setEditorValue_(angle);\n    }\n  }\n\n  /** Redraw the graph with the current angle. */\n  private updateGraph() {\n    if (!this.gauge || !this.line) {\n      return;\n    }\n    // Always display the input (i.e. getText) even if it is invalid.\n    let angleDegrees = Number(this.getText()) + this.offset;\n    angleDegrees %= 360;\n    let angleRadians = math.toRadians(angleDegrees);\n    const path = ['M ', FieldAngle.HALF, ',', FieldAngle.HALF];\n    let x2 = FieldAngle.HALF;\n    let y2 = FieldAngle.HALF;\n    if (!isNaN(angleRadians)) {\n      const clockwiseFlag = Number(this.clockwise);\n      const angle1 = math.toRadians(this.offset);\n      const x1 = Math.cos(angle1) * FieldAngle.RADIUS;\n      const y1 = Math.sin(angle1) * -FieldAngle.RADIUS;\n      if (clockwiseFlag) {\n        angleRadians = 2 * angle1 - angleRadians;\n      }\n      x2 += Math.cos(angleRadians) * FieldAngle.RADIUS;\n      y2 -= Math.sin(angleRadians) * FieldAngle.RADIUS;\n      // Don't ask how the flag calculations work.  They just do.\n      let largeFlag = Math.abs(\n        Math.floor((angleRadians - angle1) / Math.PI) % 2\n      );\n      if (clockwiseFlag) {\n        largeFlag = 1 - largeFlag;\n      }\n      path.push(\n        ' l ',\n        x1,\n        ',',\n        y1,\n        ' A ',\n        FieldAngle.RADIUS,\n        ',',\n        FieldAngle.RADIUS,\n        ' 0 ',\n        largeFlag,\n        ' ',\n        clockwiseFlag,\n        ' ',\n        x2,\n        ',',\n        y2,\n        ' z'\n      );\n    }\n    this.gauge.setAttribute('d', path.join(''));\n    this.line.setAttribute('x2', `${x2}`);\n    this.line.setAttribute('y2', `${y2}`);\n  }\n\n  /**\n   * Handle key down to the editor.\n   *\n   * @param e Keyboard event.\n   */\n  protected override onHtmlInputKeyDown_(e: KeyboardEvent) {\n    super.onHtmlInputKeyDown_(e);\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n\n    let multiplier = 0;\n    switch (e.key) {\n      case 'ArrowLeft':\n        // decrement (increment in RTL)\n        multiplier = block.RTL ? 1 : -1;\n        break;\n      case 'ArrowRight':\n        // increment (decrement in RTL)\n        multiplier = block.RTL ? -1 : 1;\n        break;\n      case 'ArrowDown':\n        // decrement\n        multiplier = -1;\n        break;\n      case 'ArrowUp':\n        // increment\n        multiplier = 1;\n        break;\n    }\n    if (multiplier) {\n      const value = this.getValue() as number;\n      this.displayMouseOrKeyboardValue(value + multiplier * this.round);\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Ensure that the input value is a valid angle.\n   *\n   * @param newValue The input value.\n   * @returns A valid angle, or null if invalid.\n   */\n  protected override doClassValidation_(newValue?: any): number | null {\n    const value = Number(newValue);\n    if (isNaN(value) || !isFinite(value)) {\n      return null;\n    }\n    return this.wrapValue(value);\n  }\n\n  /**\n   * Wraps the value so that it is in the range (-360 + wrap, wrap).\n   *\n   * @param value The value to wrap.\n   * @returns The wrapped value.\n   */\n  private wrapValue(value: number): number {\n    value %= 360;\n    if (value < 0) {\n      value += 360;\n    }\n    if (value > this.wrap) {\n      value -= 360;\n    }\n    return value;\n  }\n\n  /**\n   * Construct a FieldAngle from a JSON arg object.\n   *\n   * @param options A JSON object with options (angle).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldAngleFromJsonConfig): FieldAngle {\n    // `this` might be a subclass of FieldAngle if that class doesn't override\n    // the static fromJson method.\n    return new this(options.angle, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_angle', FieldAngle);\n\nFieldAngle.prototype.DEFAULT_VALUE = 0;\n\n/**\n * CSS for angle field.\n */\nCss.register(`\n.blocklyAngleCircle {\n  stroke: #444;\n  stroke-width: 1;\n  fill: #ddd;\n  fill-opacity: 0.8;\n}\n\n.blocklyAngleMarks {\n  stroke: #444;\n  stroke-width: 1;\n}\n\n.blocklyAngleGauge {\n  fill: #f88;\n  fill-opacity: 0.8;\n  pointer-events: none;\n}\n\n.blocklyAngleLine {\n  stroke: #f00;\n  stroke-width: 2;\n  stroke-linecap: round;\n  pointer-events: none;\n}\n`);\n\n/**\n * The two main modes of the angle field.\n * Compass specifies:\n *   - clockwise: true\n *   - offset: 90\n *   - wrap: 0\n *   - round: 15\n *\n * Protractor specifies:\n *   - clockwise: false\n *   - offset: 0\n *   - wrap: 0\n *   - round: 15\n */\nexport enum Mode {\n  COMPASS = 'compass',\n  PROTRACTOR = 'protractor',\n}\n\n/**\n * Extra configuration options for the angle field.\n */\nexport interface FieldAngleConfig extends FieldInputConfig {\n  mode?: Mode;\n  clockwise?: boolean;\n  offset?: number;\n  wrap?: number;\n  round?: number;\n}\n\n/**\n * fromJson configuration options for the angle field.\n */\nexport interface FieldAngleFromJsonConfig extends FieldAngleConfig {\n  angle?: number;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldAngleValidator = FieldInputValidator<number>;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Checkbox field.  Checked or not checked.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldCheckbox');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport * as dom from './utils/dom.js';\nimport {Field, FieldConfig, FieldValidator} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\n\ntype BoolString = 'TRUE' | 'FALSE';\ntype CheckboxBool = BoolString | boolean;\n\n/**\n * Class for a checkbox field.\n */\nexport class FieldCheckbox extends Field<CheckboxBool> {\n  /** Default character for the checkmark. */\n  static readonly CHECK_CHAR = '✓';\n  private checkChar: string;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * Mouse cursor style when over the hotspot that initiates editability.\n   */\n  override CURSOR = 'default';\n\n  /**\n   * NOTE: The default value is set in `Field`, so maintain that value instead\n   * of overwriting it here or in the constructor.\n   */\n  override value_: boolean | null = this.value_;\n\n  /**\n   * @param value The initial value of the field. Should either be 'TRUE',\n   *     'FALSE' or a boolean. Defaults to 'FALSE'. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param validator  A function that is called to validate changes to the\n   *     field's value. Takes in a value ('TRUE' or 'FALSE') & returns a\n   *     validated value ('TRUE' or 'FALSE'), or null to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/checkbox#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: CheckboxBool | typeof Field.SKIP_SETUP,\n    validator?: FieldCheckboxValidator,\n    config?: FieldCheckboxConfig\n  ) {\n    super(Field.SKIP_SETUP);\n\n    /**\n     * Character for the check mark. Used to apply a different check mark\n     * character to individual fields.\n     */\n    this.checkChar = FieldCheckbox.CHECK_CHAR;\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldCheckboxConfig) {\n    super.configure_(config);\n    if (config.checkCharacter) this.checkChar = config.checkCharacter;\n  }\n\n  /**\n   * Saves this field's value.\n   *\n   * @returns The boolean value held by this field.\n   * @internal\n   */\n  override saveState(): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(FieldCheckbox);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    return this.getValueBoolean();\n  }\n\n  /**\n   * Create the block UI for this checkbox.\n   *\n   * @internal\n   */\n  override initView() {\n    super.initView();\n\n    const textElement = this.getTextElement();\n    dom.addClass(textElement, 'blocklyCheckbox');\n    textElement.style.display = this.value_ ? 'block' : 'none';\n  }\n\n  override render_() {\n    if (this.textContent_) {\n      this.textContent_.nodeValue = this.getDisplayText_();\n    }\n    this.updateSize_(this.getConstants()!.FIELD_CHECKBOX_X_OFFSET);\n  }\n\n  override getDisplayText_() {\n    return this.checkChar;\n  }\n\n  /**\n   * Set the character used for the check mark.\n   *\n   * @param character The character to use for the check mark, or null to use\n   *     the default.\n   */\n  setCheckCharacter(character: string | null) {\n    this.checkChar = character || FieldCheckbox.CHECK_CHAR;\n    this.forceRerender();\n  }\n\n  /** Toggle the state of the checkbox on click. */\n  protected override showEditor_() {\n    this.setValue(!this.value_);\n  }\n\n  /**\n   * Ensure that the input value is valid ('TRUE' or 'FALSE').\n   *\n   * @param newValue The input value.\n   * @returns A valid value ('TRUE' or 'FALSE), or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration\n  ): BoolString | null {\n    if (newValue === true || newValue === 'TRUE') {\n      return 'TRUE';\n    }\n    if (newValue === false || newValue === 'FALSE') {\n      return 'FALSE';\n    }\n    return null;\n  }\n\n  /**\n   * Update the value of the field, and update the checkElement.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a either 'TRUE' or 'FALSE'.\n   */\n  protected override doValueUpdate_(newValue: BoolString) {\n    this.value_ = this.convertValueToBool_(newValue);\n    // Update visual.\n    if (this.textElement_) {\n      this.textElement_.style.display = this.value_ ? 'block' : 'none';\n    }\n  }\n\n  /**\n   * Get the value of this field, either 'TRUE' or 'FALSE'.\n   *\n   * @returns The value of this field.\n   */\n  override getValue(): BoolString {\n    return this.value_ ? 'TRUE' : 'FALSE';\n  }\n\n  /**\n   * Get the boolean value of this field.\n   *\n   * @returns The boolean value of this field.\n   */\n  getValueBoolean(): boolean | null {\n    return this.value_;\n  }\n\n  /**\n   * Get the text of this field. Used when the block is collapsed.\n   *\n   * @returns Text representing the value of this field ('true' or 'false').\n   */\n  override getText(): string {\n    return String(this.convertValueToBool_(this.value_));\n  }\n\n  /**\n   * Convert a value into a pure boolean.\n   *\n   * Converts 'TRUE' to true and 'FALSE' to false correctly, everything else\n   * is cast to a boolean.\n   *\n   * @param value The value to convert.\n   * @returns The converted value.\n   */\n  private convertValueToBool_(value: CheckboxBool | null): boolean {\n    if (typeof value === 'string') return value === 'TRUE';\n    return !!value;\n  }\n\n  /**\n   * Construct a FieldCheckbox from a JSON arg object.\n   *\n   * @param options A JSON object with options (checked).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldCheckboxFromJsonConfig): FieldCheckbox {\n    // `this` might be a subclass of FieldCheckbox if that class doesn't\n    // 'override' the static fromJson method.\n    return new this(options.checked, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_checkbox', FieldCheckbox);\n\nFieldCheckbox.prototype.DEFAULT_VALUE = false;\n\n/**\n * Config options for the checkbox field.\n */\nexport interface FieldCheckboxConfig extends FieldConfig {\n  checkCharacter?: string;\n}\n\n/**\n * fromJson config options for the checkbox field.\n */\nexport interface FieldCheckboxFromJsonConfig extends FieldCheckboxConfig {\n  checked?: boolean;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldCheckboxValidator = FieldValidator<CheckboxBool>;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Colour input field.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldColour');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as Css from './css.js';\nimport * as dom from './utils/dom.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Field, FieldConfig, FieldValidator} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as aria from './utils/aria.js';\nimport * as colour from './utils/colour.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {Size} from './utils/size.js';\n\n/**\n * Class for a colour input field.\n */\nexport class FieldColour extends Field<string> {\n  /**\n   * An array of colour strings for the palette.\n   * Copied from goog.ui.ColorPicker.SIMPLE_GRID_COLORS\n   * All colour pickers use this unless overridden with setColours.\n   */\n  // prettier-ignore\n  static COLOURS: string[] = [\n    // grays\n    '#ffffff', '#cccccc', '#c0c0c0', '#999999',\n    '#666666', '#333333', '#000000',  // reds\n    '#ffcccc', '#ff6666', '#ff0000', '#cc0000',\n    '#990000', '#660000', '#330000',  // oranges\n    '#ffcc99', '#ff9966', '#ff9900', '#ff6600',\n    '#cc6600', '#993300', '#663300',  // yellows\n    '#ffff99', '#ffff66', '#ffcc66', '#ffcc33',\n    '#cc9933', '#996633', '#663333',  // olives\n    '#ffffcc', '#ffff33', '#ffff00', '#ffcc00',\n    '#999900', '#666600', '#333300',  // greens\n    '#99ff99', '#66ff99', '#33ff33', '#33cc00',\n    '#009900', '#006600', '#003300',  // turquoises\n    '#99ffff', '#33ffff', '#66cccc', '#00cccc',\n    '#339999', '#336666', '#003333',  // blues\n    '#ccffff', '#66ffff', '#33ccff', '#3366ff',\n    '#3333ff', '#000099', '#000066',  // purples\n    '#ccccff', '#9999ff', '#6666cc', '#6633ff',\n    '#6600cc', '#333399', '#330099',  // violets\n    '#ffccff', '#ff99ff', '#cc66cc', '#cc33cc',\n    '#993399', '#663366', '#330033',\n  ];\n\n  /**\n   * An array of tooltip strings for the palette.  If not the same length as\n   * COLOURS, the colour's hex code will be used for any missing titles.\n   * All colour pickers use this unless overridden with setColours.\n   */\n  static TITLES: string[] = [];\n\n  /**\n   * Number of columns in the palette.\n   * All colour pickers use this unless overridden with setColumns.\n   */\n  static COLUMNS = 7;\n\n  /** The field's colour picker element. */\n  private picker: HTMLElement | null = null;\n\n  /** Index of the currently highlighted element. */\n  private highlightedIndex: number | null = null;\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /** Mouse cursor style when over the hotspot that initiates the editor. */\n  override CURSOR = 'default';\n\n  /**\n   * Used to tell if the field needs to be rendered the next time the block is\n   * rendered. Colour fields are statically sized, and only need to be\n   * rendered at initialization.\n   */\n  protected override isDirty_ = false;\n\n  /** Array of colours used by this field.  If null, use the global list. */\n  private colours: string[] | null = null;\n\n  /**\n   * Array of colour tooltips used by this field.  If null, use the global\n   * list.\n   */\n  private titles: string[] | null = null;\n\n  /**\n   * Number of colour columns used by this field.  If 0, use the global\n   * setting. By default use the global constants for columns.\n   */\n  private columns = 0;\n\n  /**\n   * @param value The initial value of the field. Should be in '#rrggbb'\n   *     format. Defaults to the first value in the default colour array. Also\n   *     accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   *     subclasses that want to handle configuration and setting the field\n   *     value after their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a colour string & returns a validated colour\n   *     string ('#rrggbb' format), or null to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/colour}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    validator?: FieldColourValidator,\n    config?: FieldColourConfig\n  ) {\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldColourConfig) {\n    super.configure_(config);\n    if (config.colourOptions) this.colours = config.colourOptions;\n    if (config.colourTitles) this.titles = config.colourTitles;\n    if (config.columns) this.columns = config.columns;\n  }\n\n  /**\n   * Create the block UI for this colour field.\n   *\n   * @internal\n   */\n  override initView() {\n    this.size_ = new Size(\n      this.getConstants()!.FIELD_COLOUR_DEFAULT_WIDTH,\n      this.getConstants()!.FIELD_COLOUR_DEFAULT_HEIGHT\n    );\n    if (!this.getConstants()!.FIELD_COLOUR_FULL_BLOCK) {\n      this.createBorderRect_();\n      this.getBorderRect().style['fillOpacity'] = '1';\n    } else if (this.sourceBlock_ instanceof BlockSvg) {\n      this.clickTarget_ = this.sourceBlock_.getSvgRoot();\n    }\n  }\n\n  /**\n   * Updates text field to match the colour/style of the block.\n   */\n  override applyColour() {\n    if (!this.getConstants()!.FIELD_COLOUR_FULL_BLOCK) {\n      if (this.borderRect_) {\n        this.borderRect_.style.fill = this.getValue() as string;\n      }\n    } else if (this.sourceBlock_ instanceof BlockSvg) {\n      this.sourceBlock_.pathObject.svgPath.setAttribute(\n        'fill',\n        this.getValue() as string\n      );\n      this.sourceBlock_.pathObject.svgPath.setAttribute('stroke', '#fff');\n    }\n  }\n\n  /**\n   * Ensure that the input value is a valid colour.\n   *\n   * @param newValue The input value.\n   * @returns A valid colour, or null if invalid.\n   */\n  protected override doClassValidation_(newValue?: any): string | null {\n    if (typeof newValue !== 'string') {\n      return null;\n    }\n    return colour.parse(newValue);\n  }\n\n  /**\n   * Update the value of this colour field, and update the displayed colour.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a colour in '#rrggbb' format.\n   */\n  protected override doValueUpdate_(newValue: string) {\n    this.value_ = newValue;\n    if (this.borderRect_) {\n      this.borderRect_.style.fill = newValue;\n    } else if (\n      this.sourceBlock_ &&\n      this.sourceBlock_.rendered &&\n      this.sourceBlock_ instanceof BlockSvg\n    ) {\n      this.sourceBlock_.pathObject.svgPath.setAttribute('fill', newValue);\n      this.sourceBlock_.pathObject.svgPath.setAttribute('stroke', '#fff');\n    }\n  }\n\n  /**\n   * Get the text for this field.  Used when the block is collapsed.\n   *\n   * @returns Text representing the value of this field.\n   */\n  override getText(): string {\n    let colour = this.value_ as string;\n    // Try to use #rgb format if possible, rather than #rrggbb.\n    if (/^#(.)\\1(.)\\2(.)\\3$/.test(colour)) {\n      colour = '#' + colour[1] + colour[3] + colour[5];\n    }\n    return colour;\n  }\n\n  /**\n   * Set a custom colour grid for this field.\n   *\n   * @param colours Array of colours for this block, or null to use default\n   *     (FieldColour.COLOURS).\n   * @param titles Optional array of colour tooltips, or null to use default\n   *     (FieldColour.TITLES).\n   * @returns Returns itself (for method chaining).\n   */\n  setColours(colours: string[], titles?: string[]): FieldColour {\n    this.colours = colours;\n    if (titles) {\n      this.titles = titles;\n    }\n    return this;\n  }\n\n  /**\n   * Set a custom grid size for this field.\n   *\n   * @param columns Number of columns for this block, or 0 to use default\n   *     (FieldColour.COLUMNS).\n   * @returns Returns itself (for method chaining).\n   */\n  setColumns(columns: number): FieldColour {\n    this.columns = columns;\n    return this;\n  }\n\n  /** Create and show the colour field's editor. */\n  protected override showEditor_() {\n    this.dropdownCreate();\n    dropDownDiv.getContentDiv().appendChild(this.picker!);\n\n    dropDownDiv.showPositionedByField(this, this.dropdownDispose.bind(this));\n\n    // Focus so we can start receiving keyboard events.\n    this.picker!.focus({preventScroll: true});\n  }\n\n  /**\n   * Handle a click on a colour cell.\n   *\n   * @param e Mouse event.\n   */\n  private onClick(e: PointerEvent) {\n    const cell = e.target as Element;\n    const colour = cell && cell.getAttribute('data-colour');\n    if (colour !== null) {\n      this.setValue(colour);\n      dropDownDiv.hideIfOwner(this);\n    }\n  }\n\n  /**\n   * Handle a key down event. Navigate around the grid with the\n   * arrow keys. Enter selects the highlighted colour.\n   *\n   * @param e Keyboard event.\n   */\n  private onKeyDown(e: KeyboardEvent) {\n    let handled = true;\n    let highlighted: HTMLElement | null;\n    switch (e.key) {\n      case 'ArrowUp':\n        this.moveHighlightBy(0, -1);\n        break;\n      case 'ArrowDown':\n        this.moveHighlightBy(0, 1);\n        break;\n      case 'ArrowLeft':\n        this.moveHighlightBy(-1, 0);\n        break;\n      case 'ArrowRight':\n        this.moveHighlightBy(1, 0);\n        break;\n      case 'Enter':\n        // Select the highlighted colour.\n        highlighted = this.getHighlighted();\n        if (highlighted) {\n          const colour = highlighted.getAttribute('data-colour');\n          if (colour !== null) {\n            this.setValue(colour);\n          }\n        }\n        dropDownDiv.hideWithoutAnimation();\n        break;\n      default:\n        handled = false;\n    }\n    if (handled) {\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Move the currently highlighted position by dx and dy.\n   *\n   * @param dx Change of x.\n   * @param dy Change of y.\n   */\n  private moveHighlightBy(dx: number, dy: number) {\n    if (!this.highlightedIndex) {\n      return;\n    }\n\n    const colours = this.colours || FieldColour.COLOURS;\n    const columns = this.columns || FieldColour.COLUMNS;\n\n    // Get the current x and y coordinates.\n    let x = this.highlightedIndex % columns;\n    let y = Math.floor(this.highlightedIndex / columns);\n\n    // Add the offset.\n    x += dx;\n    y += dy;\n\n    if (dx < 0) {\n      // Move left one grid cell, even in RTL.\n      // Loop back to the end of the previous row if we have room.\n      if (x < 0 && y > 0) {\n        x = columns - 1;\n        y--;\n      } else if (x < 0) {\n        x = 0;\n      }\n    } else if (dx > 0) {\n      // Move right one grid cell, even in RTL.\n      // Loop to the start of the next row, if there's room.\n      if (x > columns - 1 && y < Math.floor(colours.length / columns) - 1) {\n        x = 0;\n        y++;\n      } else if (x > columns - 1) {\n        x--;\n      }\n    } else if (dy < 0) {\n      // Move up one grid cell, stop at the top.\n      if (y < 0) {\n        y = 0;\n      }\n    } else if (dy > 0) {\n      // Move down one grid cell, stop at the bottom.\n      if (y > Math.floor(colours.length / columns) - 1) {\n        y = Math.floor(colours.length / columns) - 1;\n      }\n    }\n\n    // Move the highlight to the new coordinates.\n    const cell = this.picker!.childNodes[y].childNodes[x] as Element;\n    const index = y * columns + x;\n    this.setHighlightedCell(cell, index);\n  }\n\n  /**\n   * Handle a mouse move event. Highlight the hovered colour.\n   *\n   * @param e Mouse event.\n   */\n  private onMouseMove(e: PointerEvent) {\n    const cell = e.target as Element;\n    const index = cell && Number(cell.getAttribute('data-index'));\n    if (index !== null && index !== this.highlightedIndex) {\n      this.setHighlightedCell(cell, index);\n    }\n  }\n\n  /** Handle a mouse enter event. Focus the picker. */\n  private onMouseEnter() {\n    this.picker?.focus({preventScroll: true});\n  }\n\n  /**\n   * Handle a mouse leave event. Blur the picker and unhighlight\n   * the currently highlighted colour.\n   */\n  private onMouseLeave() {\n    this.picker?.blur();\n    const highlighted = this.getHighlighted();\n    if (highlighted) {\n      dom.removeClass(highlighted, 'blocklyColourHighlighted');\n    }\n  }\n\n  /**\n   * Returns the currently highlighted item (if any).\n   *\n   * @returns Highlighted item (null if none).\n   */\n  private getHighlighted(): HTMLElement | null {\n    if (!this.highlightedIndex) {\n      return null;\n    }\n\n    const columns = this.columns || FieldColour.COLUMNS;\n    const x = this.highlightedIndex % columns;\n    const y = Math.floor(this.highlightedIndex / columns);\n    const row = this.picker!.childNodes[y];\n    if (!row) {\n      return null;\n    }\n    return row.childNodes[x] as HTMLElement;\n  }\n\n  /**\n   * Update the currently highlighted cell.\n   *\n   * @param cell The new cell to highlight.\n   * @param index The index of the new cell.\n   */\n  private setHighlightedCell(cell: Element, index: number) {\n    // Unhighlight the current item.\n    const highlighted = this.getHighlighted();\n    if (highlighted) {\n      dom.removeClass(highlighted, 'blocklyColourHighlighted');\n    }\n    // Highlight new item.\n    dom.addClass(cell, 'blocklyColourHighlighted');\n    // Set new highlighted index.\n    this.highlightedIndex = index;\n\n    // Update accessibility roles.\n    const cellId = cell.getAttribute('id');\n    if (cellId && this.picker) {\n      aria.setState(this.picker, aria.State.ACTIVEDESCENDANT, cellId);\n    }\n  }\n\n  /** Create a colour picker dropdown editor. */\n  private dropdownCreate() {\n    const columns = this.columns || FieldColour.COLUMNS;\n    const colours = this.colours || FieldColour.COLOURS;\n    const titles = this.titles || FieldColour.TITLES;\n    const selectedColour = this.getValue();\n    // Create the palette.\n    const table = document.createElement('table');\n    table.className = 'blocklyColourTable';\n    table.tabIndex = 0;\n    table.dir = 'ltr';\n    aria.setRole(table, aria.Role.GRID);\n    aria.setState(table, aria.State.EXPANDED, true);\n    aria.setState(\n      table,\n      aria.State.ROWCOUNT,\n      Math.floor(colours.length / columns)\n    );\n    aria.setState(table, aria.State.COLCOUNT, columns);\n    let row: Element;\n    for (let i = 0; i < colours.length; i++) {\n      if (i % columns === 0) {\n        row = document.createElement('tr');\n        aria.setRole(row, aria.Role.ROW);\n        table.appendChild(row);\n      }\n      const cell = document.createElement('td');\n      row!.appendChild(cell);\n      // This becomes the value, if clicked.\n      cell.setAttribute('data-colour', colours[i]);\n      cell.title = titles[i] || colours[i];\n      cell.id = idGenerator.getNextUniqueId();\n      cell.setAttribute('data-index', `${i}`);\n      aria.setRole(cell, aria.Role.GRIDCELL);\n      aria.setState(cell, aria.State.LABEL, colours[i]);\n      aria.setState(cell, aria.State.SELECTED, colours[i] === selectedColour);\n      cell.style.backgroundColor = colours[i];\n      if (colours[i] === selectedColour) {\n        cell.className = 'blocklyColourSelected';\n        this.highlightedIndex = i;\n      }\n    }\n\n    // Configure event handler on the table to listen for any event in a cell.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        table,\n        'pointerdown',\n        this,\n        this.onClick,\n        true\n      )\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        table,\n        'pointermove',\n        this,\n        this.onMouseMove,\n        true\n      )\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        table,\n        'pointerenter',\n        this,\n        this.onMouseEnter,\n        true\n      )\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        table,\n        'pointerleave',\n        this,\n        this.onMouseLeave,\n        true\n      )\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        table,\n        'keydown',\n        this,\n        this.onKeyDown,\n        false\n      )\n    );\n\n    this.picker = table;\n  }\n\n  /** Disposes of events and DOM-references belonging to the colour editor. */\n  private dropdownDispose() {\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n    this.picker = null;\n    this.highlightedIndex = null;\n  }\n\n  /**\n   * Construct a FieldColour from a JSON arg object.\n   *\n   * @param options A JSON object with options (colour).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldColourFromJsonConfig): FieldColour {\n    // `this` might be a subclass of FieldColour if that class doesn't override\n    // the static fromJson method.\n    return new this(options.colour, undefined, options);\n  }\n}\n\n/** The default value for this field. */\nFieldColour.prototype.DEFAULT_VALUE = FieldColour.COLOURS[0];\n\nfieldRegistry.register('field_colour', FieldColour);\n\n/**\n * CSS for colour picker.\n */\nCss.register(`\n.blocklyColourTable {\n  border-collapse: collapse;\n  display: block;\n  outline: none;\n  padding: 1px;\n}\n\n.blocklyColourTable>tr>td {\n  border: 0.5px solid #888;\n  box-sizing: border-box;\n  cursor: pointer;\n  display: inline-block;\n  height: 20px;\n  padding: 0;\n  width: 20px;\n}\n\n.blocklyColourTable>tr>td.blocklyColourHighlighted {\n  border-color: #eee;\n  box-shadow: 2px 2px 7px 2px rgba(0, 0, 0, 0.3);\n  position: relative;\n}\n\n.blocklyColourSelected, .blocklyColourSelected:hover {\n  border-color: #eee !important;\n  outline: 1px solid #333;\n  position: relative;\n}\n`);\n\n/**\n * Config options for the colour field.\n */\nexport interface FieldColourConfig extends FieldConfig {\n  colourOptions?: string[];\n  colourTitles?: string[];\n  columns?: number;\n}\n\n/**\n * fromJson config options for the colour field.\n */\nexport interface FieldColourFromJsonConfig extends FieldColourConfig {\n  colour?: string;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldColourValidator = FieldValidator<string>;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Non-editable, serializable text field. Behaves like a\n *    normal label but is serialized to XML. It may only be\n *    edited programmatically.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldLabelSerializable');\n\nimport {\n  FieldLabel,\n  FieldLabelConfig,\n  FieldLabelFromJsonConfig,\n} from './field_label.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as parsing from './utils/parsing.js';\n\n/**\n * Class for a non-editable, serializable text field.\n */\nexport class FieldLabelSerializable extends FieldLabel {\n  /**\n   * Editable fields usually show some sort of UI indicating they are\n   * editable. This field should not.\n   */\n  override EDITABLE = false;\n\n  /**\n   * Serializable fields are saved by the XML renderer, non-serializable\n   * fields are not.  This field should be serialized, but only edited\n   * programmatically.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * @param value The initial value of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined.\n   * @param textClass Optional CSS class for the field's text.\n   * @param config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/label-serializable#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(value?: string, textClass?: string, config?: FieldLabelConfig) {\n    super(String(value ?? ''), textClass, config);\n  }\n\n  /**\n   * Construct a FieldLabelSerializable from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and class).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(\n    options: FieldLabelFromJsonConfig\n  ): FieldLabelSerializable {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldLabelSerializable if that class\n    // doesn't override the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_label_serializable', FieldLabelSerializable);\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Text Area field.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldMultilineInput');\n\nimport * as Css from './css.js';\nimport {Field, UnattachedFieldError} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {\n  FieldTextInput,\n  FieldTextInputConfig,\n  FieldTextInputValidator,\n} from './field_textinput.js';\nimport * as aria from './utils/aria.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport {Svg} from './utils/svg.js';\nimport * as userAgent from './utils/useragent.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n/**\n * Class for an editable text area field.\n */\nexport class FieldMultilineInput extends FieldTextInput {\n  /**\n   * The SVG group element that will contain a text element for each text row\n   *     when initialized.\n   */\n  textGroup: SVGGElement | null = null;\n\n  /**\n   * Defines the maximum number of lines of field.\n   * If exceeded, scrolling functionality is enabled.\n   */\n  protected maxLines_ = Infinity;\n\n  /** Whether Y overflow is currently occurring. */\n  protected isOverflowedY_ = false;\n\n  /**\n   * @param value The initial content of the field. Should cast to a string.\n   *     Defaults to an empty string if null or undefined. Also accepts\n   *     Field.SKIP_SETUP if you wish to skip setup (only used by subclasses\n   *     that want to handle configuration and setting the field value after\n   *     their own constructors have run).\n   * @param validator An optional function that is called to validate any\n   *     constraints on what the user entered.  Takes the new text as an\n   *     argument and returns either the accepted text, a replacement text, or\n   *     null to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/multiline-text-input#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | typeof Field.SKIP_SETUP,\n    validator?: FieldMultilineInputValidator,\n    config?: FieldMultilineInputConfig\n  ) {\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldMultilineInputConfig) {\n    super.configure_(config);\n    if (config.maxLines) this.setMaxLines(config.maxLines);\n  }\n\n  /**\n   * Serializes this field's value to XML. Should only be called by Blockly.Xml.\n   *\n   * @param fieldElement The element to populate with info about the field's\n   *     state.\n   * @returns The element containing info about the field's state.\n   * @internal\n   */\n  override toXml(fieldElement: Element): Element {\n    // Replace '\\n' characters with HTML-escaped equivalent '&#10'. This is\n    // needed so the plain-text representation of the XML produced by\n    // `Blockly.Xml.domToText` will appear on a single line (this is a\n    // limitation of the plain-text format).\n    fieldElement.textContent = (this.getValue() as string).replace(\n      /\\n/g,\n      '&#10;'\n    );\n    return fieldElement;\n  }\n\n  /**\n   * Sets the field's value based on the given XML element. Should only be\n   * called by Blockly.Xml.\n   *\n   * @param fieldElement The element containing info about the field's state.\n   * @internal\n   */\n  override fromXml(fieldElement: Element) {\n    this.setValue(fieldElement.textContent!.replace(/&#10;/g, '\\n'));\n  }\n\n  /**\n   * Saves this field's value.\n   * This function only exists for subclasses of FieldMultilineInput which\n   * predate the load/saveState API and only define to/fromXml.\n   *\n   * @returns The state of this field.\n   * @internal\n   */\n  override saveState(): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(FieldMultilineInput);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    return this.getValue();\n  }\n\n  /**\n   * Sets the field's value based on the given state.\n   * This function only exists for subclasses of FieldMultilineInput which\n   * predate the load/saveState API and only define to/fromXml.\n   *\n   * @param state The state of the variable to assign to this variable field.\n   * @internal\n   */\n  override loadState(state: AnyDuringMigration) {\n    if (this.loadLegacyState(Field, state)) {\n      return;\n    }\n    this.setValue(state);\n  }\n\n  /**\n   * Create the block UI for this field.\n   *\n   * @internal\n   */\n  override initView() {\n    this.createBorderRect_();\n    this.textGroup = dom.createSvgElement(\n      Svg.G,\n      {\n        'class': 'blocklyEditableText',\n      },\n      this.fieldGroup_\n    );\n  }\n\n  /**\n   * Get the text from this field as displayed on screen.  May differ from\n   * getText due to ellipsis, and other formatting.\n   *\n   * @returns Currently displayed text.\n   */\n  protected override getDisplayText_(): string {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    let textLines = this.getText();\n    if (!textLines) {\n      // Prevent the field from disappearing if empty.\n      return Field.NBSP;\n    }\n    const lines = textLines.split('\\n');\n    textLines = '';\n    const displayLinesNumber = this.isOverflowedY_\n      ? this.maxLines_\n      : lines.length;\n    for (let i = 0; i < displayLinesNumber; i++) {\n      let text = lines[i];\n      if (text.length > this.maxDisplayLength) {\n        // Truncate displayed string and add an ellipsis ('...').\n        text = text.substring(0, this.maxDisplayLength - 4) + '...';\n      } else if (this.isOverflowedY_ && i === displayLinesNumber - 1) {\n        text = text.substring(0, text.length - 3) + '...';\n      }\n      // Replace whitespace with non-breaking spaces so the text doesn't\n      // collapse.\n      text = text.replace(/\\s/g, Field.NBSP);\n\n      textLines += text;\n      if (i !== displayLinesNumber - 1) {\n        textLines += '\\n';\n      }\n    }\n    if (block.RTL) {\n      // The SVG is LTR, force value to be RTL.\n      textLines += '\\u200F';\n    }\n    return textLines;\n  }\n\n  /**\n   * Called by setValue if the text input is valid. Updates the value of the\n   * field, and updates the text of the field if it is not currently being\n   * edited (i.e. handled by the htmlInput_). Is being redefined here to update\n   * overflow state of the field.\n   *\n   * @param newValue The value to be saved. The default validator guarantees\n   *     that this is a string.\n   */\n  protected override doValueUpdate_(newValue: string) {\n    super.doValueUpdate_(newValue);\n    if (this.value_ !== null) {\n      this.isOverflowedY_ = this.value_.split('\\n').length > this.maxLines_;\n    }\n  }\n\n  /** Updates the text of the textElement. */\n  protected override render_() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    // Remove all text group children.\n    let currentChild;\n    const textGroup = this.textGroup;\n    while ((currentChild = textGroup!.firstChild)) {\n      textGroup!.removeChild(currentChild);\n    }\n\n    // Add in text elements into the group.\n    const lines = this.getDisplayText_().split('\\n');\n    let y = 0;\n    for (let i = 0; i < lines.length; i++) {\n      const lineHeight =\n        this.getConstants()!.FIELD_TEXT_HEIGHT +\n        this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING;\n      const span = dom.createSvgElement(\n        Svg.TEXT,\n        {\n          'class': 'blocklyText blocklyMultilineText',\n          'x': this.getConstants()!.FIELD_BORDER_RECT_X_PADDING,\n          'y': y + this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING,\n          'dy': this.getConstants()!.FIELD_TEXT_BASELINE,\n        },\n        textGroup\n      );\n      span.appendChild(document.createTextNode(lines[i]));\n      y += lineHeight;\n    }\n\n    if (this.isBeingEdited_) {\n      const htmlInput = this.htmlInput_ as HTMLElement;\n      if (this.isOverflowedY_) {\n        dom.addClass(htmlInput, 'blocklyHtmlTextAreaInputOverflowedY');\n      } else {\n        dom.removeClass(htmlInput, 'blocklyHtmlTextAreaInputOverflowedY');\n      }\n    }\n\n    this.updateSize_();\n\n    if (this.isBeingEdited_) {\n      if (block.RTL) {\n        // in RTL, we need to let the browser reflow before resizing\n        // in order to get the correct bounding box of the borderRect\n        // avoiding issue #2777.\n        setTimeout(this.resizeEditor_.bind(this), 0);\n      } else {\n        this.resizeEditor_();\n      }\n      const htmlInput = this.htmlInput_ as HTMLElement;\n      if (!this.isTextValid_) {\n        dom.addClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, true);\n      } else {\n        dom.removeClass(htmlInput, 'blocklyInvalidInput');\n        aria.setState(htmlInput, aria.State.INVALID, false);\n      }\n    }\n  }\n\n  /** Updates the size of the field based on the text. */\n  protected override updateSize_() {\n    const nodes = (this.textGroup as SVGElement).childNodes;\n    const fontSize = this.getConstants()!.FIELD_TEXT_FONTSIZE;\n    const fontWeight = this.getConstants()!.FIELD_TEXT_FONTWEIGHT;\n    const fontFamily = this.getConstants()!.FIELD_TEXT_FONTFAMILY;\n    let totalWidth = 0;\n    let totalHeight = 0;\n    for (let i = 0; i < nodes.length; i++) {\n      const tspan = nodes[i] as SVGTextElement;\n      const textWidth = dom.getFastTextWidth(\n        tspan,\n        fontSize,\n        fontWeight,\n        fontFamily\n      );\n      if (textWidth > totalWidth) {\n        totalWidth = textWidth;\n      }\n      totalHeight +=\n        this.getConstants()!.FIELD_TEXT_HEIGHT +\n        (i > 0 ? this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING : 0);\n    }\n    if (this.isBeingEdited_) {\n      // The default width is based on the longest line in the display text,\n      // but when it's being edited, width should be calculated based on the\n      // absolute longest line, even if it would be truncated after editing.\n      // Otherwise we would get wrong editor width when there are more\n      // lines than this.maxLines_.\n      const actualEditorLines = String(this.value_).split('\\n');\n      const dummyTextElement = dom.createSvgElement(Svg.TEXT, {\n        'class': 'blocklyText blocklyMultilineText',\n      });\n\n      for (let i = 0; i < actualEditorLines.length; i++) {\n        if (actualEditorLines[i].length > this.maxDisplayLength) {\n          actualEditorLines[i] = actualEditorLines[i].substring(\n            0,\n            this.maxDisplayLength\n          );\n        }\n        dummyTextElement.textContent = actualEditorLines[i];\n        const lineWidth = dom.getFastTextWidth(\n          dummyTextElement,\n          fontSize,\n          fontWeight,\n          fontFamily\n        );\n        if (lineWidth > totalWidth) {\n          totalWidth = lineWidth;\n        }\n      }\n\n      const scrollbarWidth =\n        this.htmlInput_!.offsetWidth - this.htmlInput_!.clientWidth;\n      totalWidth += scrollbarWidth;\n    }\n    if (this.borderRect_) {\n      totalHeight += this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING * 2;\n      totalWidth += this.getConstants()!.FIELD_BORDER_RECT_X_PADDING * 2;\n      this.borderRect_.setAttribute('width', `${totalWidth}`);\n      this.borderRect_.setAttribute('height', `${totalHeight}`);\n    }\n    this.size_.width = totalWidth;\n    this.size_.height = totalHeight;\n\n    this.positionBorderRect_();\n  }\n\n  /**\n   * Show the inline free-text editor on top of the text.\n   * Overrides the default behaviour to force rerender in order to\n   * correct block size, based on editor text.\n   *\n   * @param e Optional mouse event that triggered the field to open, or\n   *     undefined if triggered programmatically.\n   * @param quietInput True if editor should be created without focus.\n   *     Defaults to false.\n   */\n  override showEditor_(e?: Event, quietInput?: boolean) {\n    super.showEditor_(e, quietInput);\n    this.forceRerender();\n  }\n\n  /**\n   * Create the text input editor widget.\n   *\n   * @returns The newly created text input editor.\n   */\n  protected override widgetCreate_(): HTMLTextAreaElement {\n    const div = WidgetDiv.getDiv();\n    const scale = this.workspace_!.getScale();\n\n    const htmlInput = document.createElement('textarea');\n    htmlInput.className = 'blocklyHtmlInput blocklyHtmlTextAreaInput';\n    htmlInput.setAttribute('spellcheck', String(this.spellcheck_));\n    const fontSize = this.getConstants()!.FIELD_TEXT_FONTSIZE * scale + 'pt';\n    div!.style.fontSize = fontSize;\n    htmlInput.style.fontSize = fontSize;\n    const borderRadius = FieldTextInput.BORDERRADIUS * scale + 'px';\n    htmlInput.style.borderRadius = borderRadius;\n    const paddingX = this.getConstants()!.FIELD_BORDER_RECT_X_PADDING * scale;\n    const paddingY =\n      (this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING * scale) / 2;\n    htmlInput.style.padding =\n      paddingY + 'px ' + paddingX + 'px ' + paddingY + 'px ' + paddingX + 'px';\n    const lineHeight =\n      this.getConstants()!.FIELD_TEXT_HEIGHT +\n      this.getConstants()!.FIELD_BORDER_RECT_Y_PADDING;\n    htmlInput.style.lineHeight = lineHeight * scale + 'px';\n\n    div!.appendChild(htmlInput);\n\n    htmlInput.value = htmlInput.defaultValue = this.getEditorText_(this.value_);\n    htmlInput.setAttribute('data-untyped-default-value', String(this.value_));\n    htmlInput.setAttribute('data-old-value', '');\n    if (userAgent.GECKO) {\n      // In FF, ensure the browser reflows before resizing to avoid issue #2777.\n      setTimeout(this.resizeEditor_.bind(this), 0);\n    } else {\n      this.resizeEditor_();\n    }\n\n    this.bindInputEvents_(htmlInput);\n\n    return htmlInput;\n  }\n\n  /**\n   * Sets the maxLines config for this field.\n   *\n   * @param maxLines Defines the maximum number of lines allowed, before\n   *     scrolling functionality is enabled.\n   */\n  setMaxLines(maxLines: number) {\n    if (\n      typeof maxLines === 'number' &&\n      maxLines > 0 &&\n      maxLines !== this.maxLines_\n    ) {\n      this.maxLines_ = maxLines;\n      this.forceRerender();\n    }\n  }\n\n  /**\n   * Returns the maxLines config of this field.\n   *\n   * @returns The maxLines config value.\n   */\n  getMaxLines(): number {\n    return this.maxLines_;\n  }\n\n  /**\n   * Handle key down to the editor. Override the text input definition of this\n   * so as to not close the editor when enter is typed in.\n   *\n   * @param e Keyboard event.\n   */\n  protected override onHtmlInputKeyDown_(e: KeyboardEvent) {\n    if (e.key !== 'Enter') {\n      super.onHtmlInputKeyDown_(e);\n    }\n  }\n\n  /**\n   * Construct a FieldMultilineInput from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (text, and spellcheck).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(\n    options: FieldMultilineInputFromJsonConfig\n  ): FieldMultilineInput {\n    const text = parsing.replaceMessageReferences(options.text);\n    // `this` might be a subclass of FieldMultilineInput if that class doesn't\n    // override the static fromJson method.\n    return new this(text, undefined, options);\n  }\n}\n\nfieldRegistry.register('field_multilinetext', FieldMultilineInput);\n\n/**\n * CSS for multiline field.\n */\nCss.register(`\n.blocklyHtmlTextAreaInput {\n  font-family: monospace;\n  resize: none;\n  overflow: hidden;\n  height: 100%;\n  text-align: left;\n}\n\n.blocklyHtmlTextAreaInputOverflowedY {\n  overflow-y: scroll;\n}\n`);\n\n/**\n * Config options for the multiline input field.\n */\nexport interface FieldMultilineInputConfig extends FieldTextInputConfig {\n  maxLines?: number;\n}\n\n/**\n * fromJson config options for the multiline input field.\n */\nexport interface FieldMultilineInputFromJsonConfig\n  extends FieldMultilineInputConfig {\n  text?: string;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldMultilineInputValidator = FieldTextInputValidator;\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Number input field\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldNumber');\n\nimport {Field} from './field.js';\nimport * as fieldRegistry from './field_registry.js';\nimport {\n  FieldInput,\n  FieldInputConfig,\n  FieldInputValidator,\n} from './field_input.js';\nimport * as aria from './utils/aria.js';\n\n/**\n * Class for an editable number field.\n */\nexport class FieldNumber extends FieldInput<number> {\n  /** The minimum value this number field can contain. */\n  protected min_ = -Infinity;\n\n  /** The maximum value this number field can contain. */\n  protected max_ = Infinity;\n\n  /** The multiple to which this fields value is rounded. */\n  protected precision_ = 0;\n\n  /**\n   * The number of decimal places to allow, or null to allow any number of\n   * decimal digits.\n   */\n  private decimalPlaces: number | null = null;\n\n  /** Don't spellcheck numbers.  Our validator does a better job. */\n  protected override spellcheck_ = false;\n\n  /**\n   * @param value The initial value of the field. Should cast to a number.\n   *     Defaults to 0. Also accepts Field.SKIP_SETUP if you wish to skip setup\n   *     (only used by subclasses that want to handle configuration and setting\n   *     the field value after their own constructors have run).\n   * @param min Minimum value. Will only be used if config is not\n   *     provided.\n   * @param max Maximum value. Will only be used if config is not\n   *     provided.\n   * @param precision Precision for value. Will only be used if config\n   *     is not provided.\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a number & returns a validated number, or null\n   *     to abort the change.\n   * @param config A map of options used to configure the field.\n   *     See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/number#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    value?: string | number | typeof Field.SKIP_SETUP,\n    min?: string | number | null,\n    max?: string | number | null,\n    precision?: string | number | null,\n    validator?: FieldNumberValidator | null,\n    config?: FieldNumberConfig\n  ) {\n    // Pass SENTINEL so that we can define properties before value validation.\n    super(Field.SKIP_SETUP);\n\n    if (value === Field.SKIP_SETUP) return;\n    if (config) {\n      this.configure_(config);\n    } else {\n      this.setConstraints(min, max, precision);\n    }\n    this.setValue(value);\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldNumberConfig) {\n    super.configure_(config);\n    this.setMinInternal(config.min);\n    this.setMaxInternal(config.max);\n    this.setPrecisionInternal(config.precision);\n  }\n\n  /**\n   * Set the maximum, minimum and precision constraints on this field.\n   * Any of these properties may be undefined or NaN to be disabled.\n   * Setting precision (usually a power of 10) enforces a minimum step between\n   * values. That is, the user's value will rounded to the closest multiple of\n   * precision. The least significant digit place is inferred from the\n   * precision. Integers values can be enforces by choosing an integer\n   * precision.\n   *\n   * @param min Minimum value.\n   * @param max Maximum value.\n   * @param precision Precision for value.\n   */\n  setConstraints(\n    min: number | string | undefined | null,\n    max: number | string | undefined | null,\n    precision: number | string | undefined | null\n  ) {\n    this.setMinInternal(min);\n    this.setMaxInternal(max);\n    this.setPrecisionInternal(precision);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the minimum value this field can contain. Updates the value to\n   * reflect.\n   *\n   * @param min Minimum value.\n   */\n  setMin(min: number | string | undefined | null) {\n    this.setMinInternal(min);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the minimum value this field can contain. Called internally to avoid\n   * value updates.\n   *\n   * @param min Minimum value.\n   */\n  private setMinInternal(min: number | string | undefined | null) {\n    if (min == null) {\n      this.min_ = -Infinity;\n    } else {\n      min = Number(min);\n      if (!isNaN(min)) {\n        this.min_ = min;\n      }\n    }\n  }\n\n  /**\n   * Returns the current minimum value this field can contain. Default is\n   * -Infinity.\n   *\n   * @returns The current minimum value this field can contain.\n   */\n  getMin(): number {\n    return this.min_;\n  }\n\n  /**\n   * Sets the maximum value this field can contain. Updates the value to\n   * reflect.\n   *\n   * @param max Maximum value.\n   */\n  setMax(max: number | string | undefined | null) {\n    this.setMaxInternal(max);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the maximum value this field can contain. Called internally to avoid\n   * value updates.\n   *\n   * @param max Maximum value.\n   */\n  private setMaxInternal(max: number | string | undefined | null) {\n    if (max == null) {\n      this.max_ = Infinity;\n    } else {\n      max = Number(max);\n      if (!isNaN(max)) {\n        this.max_ = max;\n      }\n    }\n  }\n\n  /**\n   * Returns the current maximum value this field can contain. Default is\n   * Infinity.\n   *\n   * @returns The current maximum value this field can contain.\n   */\n  getMax(): number {\n    return this.max_;\n  }\n\n  /**\n   * Sets the precision of this field's value, i.e. the number to which the\n   * value is rounded. Updates the field to reflect.\n   *\n   * @param precision The number to which the field's value is rounded.\n   */\n  setPrecision(precision: number | string | undefined | null) {\n    this.setPrecisionInternal(precision);\n    this.setValue(this.getValue());\n  }\n\n  /**\n   * Sets the precision of this field's value. Called internally to avoid\n   * value updates.\n   *\n   * @param precision The number to which the field's value is rounded.\n   */\n  private setPrecisionInternal(precision: number | string | undefined | null) {\n    this.precision_ = Number(precision) || 0;\n    let precisionString = String(this.precision_);\n    if (precisionString.indexOf('e') !== -1) {\n      // String() is fast.  But it turns .0000001 into '1e-7'.\n      // Use the much slower toLocaleString to access all the digits.\n      precisionString = this.precision_.toLocaleString('en-US', {\n        maximumFractionDigits: 20,\n      });\n    }\n    const decimalIndex = precisionString.indexOf('.');\n    if (decimalIndex === -1) {\n      // If the precision is 0 (float) allow any number of decimals,\n      // otherwise allow none.\n      this.decimalPlaces = precision ? 0 : null;\n    } else {\n      this.decimalPlaces = precisionString.length - decimalIndex - 1;\n    }\n  }\n\n  /**\n   * Returns the current precision of this field. The precision being the\n   * number to which the field's value is rounded. A precision of 0 means that\n   * the value is not rounded.\n   *\n   * @returns The number to which this field's value is rounded.\n   */\n  getPrecision(): number {\n    return this.precision_;\n  }\n\n  /**\n   * Ensure that the input value is a valid number (must fulfill the\n   * constraints placed on the field).\n   *\n   * @param newValue The input value.\n   * @returns A valid number, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration\n  ): number | null {\n    if (newValue === null) {\n      return null;\n    }\n\n    // Clean up text.\n    newValue = `${newValue}`;\n    // TODO: Handle cases like 'ten', '1.203,14', etc.\n    // 'O' is sometimes mistaken for '0' by inexperienced users.\n    newValue = newValue.replace(/O/gi, '0');\n    // Strip out thousands separators.\n    newValue = newValue.replace(/,/g, '');\n    // Ignore case of 'Infinity'.\n    newValue = newValue.replace(/infinity/i, 'Infinity');\n\n    // Clean up number.\n    let n = Number(newValue || 0);\n    if (isNaN(n)) {\n      // Invalid number.\n      return null;\n    }\n    // Get the value in range.\n    n = Math.min(Math.max(n, this.min_), this.max_);\n    // Round to nearest multiple of precision.\n    if (this.precision_ && isFinite(n)) {\n      n = Math.round(n / this.precision_) * this.precision_;\n    }\n    // Clean up floating point errors.\n    if (this.decimalPlaces !== null) {\n      n = Number(n.toFixed(this.decimalPlaces));\n    }\n    return n;\n  }\n\n  /**\n   * Create the number input editor widget.\n   *\n   * @returns The newly created number input editor.\n   */\n  protected override widgetCreate_(): HTMLInputElement {\n    const htmlInput = super.widgetCreate_() as HTMLInputElement;\n\n    // Set the accessibility state\n    if (this.min_ > -Infinity) {\n      htmlInput.min = `${this.min_}`;\n      aria.setState(htmlInput, aria.State.VALUEMIN, this.min_);\n    }\n    if (this.max_ < Infinity) {\n      htmlInput.max = `${this.max_}`;\n      aria.setState(htmlInput, aria.State.VALUEMAX, this.max_);\n    }\n    return htmlInput;\n  }\n\n  /**\n   * Construct a FieldNumber from a JSON arg object.\n   *\n   * @param options A JSON object with options (value, min, max, and precision).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static fromJson(options: FieldNumberFromJsonConfig): FieldNumber {\n    // `this` might be a subclass of FieldNumber if that class doesn't override\n    // the static fromJson method.\n    return new this(\n      options.value,\n      undefined,\n      undefined,\n      undefined,\n      undefined,\n      options\n    );\n  }\n}\n\nfieldRegistry.register('field_number', FieldNumber);\n\nFieldNumber.prototype.DEFAULT_VALUE = 0;\n\n/**\n * Config options for the number field.\n */\nexport interface FieldNumberConfig extends FieldInputConfig {\n  min?: number;\n  max?: number;\n  precision?: number;\n}\n\n/**\n * fromJson config options for the number field.\n */\nexport interface FieldNumberFromJsonConfig extends FieldNumberConfig {\n  value?: number;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldNumberValidator = FieldInputValidator<number>;\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Variable input field.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FieldVariable');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_block_change.js';\n\nimport type {Block} from './block.js';\nimport {Field, FieldConfig, UnattachedFieldError} from './field.js';\nimport {\n  FieldDropdown,\n  FieldDropdownValidator,\n  MenuGenerator,\n  MenuOption,\n} from './field_dropdown.js';\nimport * as fieldRegistry from './field_registry.js';\nimport * as internalConstants from './internal_constants.js';\nimport type {Menu} from './menu.js';\nimport type {MenuItem} from './menuitem.js';\nimport {Msg} from './msg.js';\nimport * as parsing from './utils/parsing.js';\nimport {Size} from './utils/size.js';\nimport {VariableModel} from './variable_model.js';\nimport * as Variables from './variables.js';\nimport * as Xml from './xml.js';\n\n/**\n * Class for a variable's dropdown field.\n */\nexport class FieldVariable extends FieldDropdown {\n  protected override menuGenerator_: MenuGenerator | undefined;\n  defaultVariableName: string;\n\n  /** The type of the default variable for this field. */\n  private defaultType = '';\n\n  /**\n   * All of the types of variables that will be available in this field's\n   * dropdown.\n   */\n  variableTypes: string[] | null = [];\n  protected override size_: Size;\n\n  /** The variable model associated with this field. */\n  private variable: VariableModel | null = null;\n\n  /**\n   * Serializable fields are saved by the serializer, non-serializable fields\n   * are not. Editable fields should also be serializable.\n   */\n  override SERIALIZABLE = true;\n\n  /**\n   * @param varName The default name for the variable.\n   *     If null, a unique variable name will be generated.\n   *     Also accepts Field.SKIP_SETUP if you wish to skip setup (only used by\n   * subclasses that want to handle configuration and setting the field value\n   * after their own constructors have run).\n   * @param validator A function that is called to validate changes to the\n   *     field's value. Takes in a variable ID  & returns a validated variable\n   *     ID, or null to abort the change.\n   * @param variableTypes A list of the types of variables to include in the\n   *     dropdown. Will only be used if config is not provided.\n   * @param defaultType The type of variable to create if this field's value\n   *     is not explicitly set.  Defaults to ''. Will only be used if config\n   *     is not provided.\n   * @param config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/variable#creation}\n   * for a list of properties this parameter supports.\n   */\n  constructor(\n    varName: string | null | typeof Field.SKIP_SETUP,\n    validator?: FieldVariableValidator,\n    variableTypes?: string[],\n    defaultType?: string,\n    config?: FieldVariableConfig\n  ) {\n    super(Field.SKIP_SETUP);\n\n    /**\n     * An array of options for a dropdown list,\n     * or a function which generates these options.\n     */\n    this.menuGenerator_ = FieldVariable.dropdownCreate as MenuGenerator;\n\n    /**\n     * The initial variable name passed to this field's constructor, or an\n     * empty string if a name wasn't provided. Used to create the initial\n     * variable.\n     */\n    this.defaultVariableName = typeof varName === 'string' ? varName : '';\n\n    /** The size of the area rendered by the field. */\n    this.size_ = new Size(0, 0);\n\n    if (varName === Field.SKIP_SETUP) return;\n\n    if (config) {\n      this.configure_(config);\n    } else {\n      this.setTypes(variableTypes, defaultType);\n    }\n    if (validator) {\n      this.setValidator(validator);\n    }\n  }\n\n  /**\n   * Configure the field based on the given map of options.\n   *\n   * @param config A map of options to configure the field based on.\n   */\n  protected override configure_(config: FieldVariableConfig) {\n    super.configure_(config);\n    this.setTypes(config.variableTypes, config.defaultType);\n  }\n\n  /**\n   * Initialize the model for this field if it has not already been initialized.\n   * If the value has not been set to a variable by the first render, we make up\n   * a variable rather than let the value be invalid.\n   *\n   * @internal\n   */\n  override initModel() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    if (this.variable) {\n      return; // Initialization already happened.\n    }\n    const variable = Variables.getOrCreateVariablePackage(\n      block.workspace,\n      null,\n      this.defaultVariableName,\n      this.defaultType\n    );\n    // Don't call setValue because we don't want to cause a rerender.\n    this.doValueUpdate_(variable.getId());\n  }\n\n  override shouldAddBorderRect_() {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    return (\n      super.shouldAddBorderRect_() &&\n      (!this.getConstants()!.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW ||\n        block.type !== 'variables_get')\n    );\n  }\n\n  /**\n   * Initialize this field based on the given XML.\n   *\n   * @param fieldElement The element containing information about the variable\n   *     field's state.\n   */\n  override fromXml(fieldElement: Element) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const id = fieldElement.getAttribute('id');\n    const variableName = fieldElement.textContent;\n    // 'variabletype' should be lowercase, but until July 2019 it was sometimes\n    // recorded as 'variableType'.  Thus we need to check for both.\n    const variableType =\n      fieldElement.getAttribute('variabletype') ||\n      fieldElement.getAttribute('variableType') ||\n      '';\n\n    // AnyDuringMigration because:  Argument of type 'string | null' is not\n    // assignable to parameter of type 'string | undefined'.\n    const variable = Variables.getOrCreateVariablePackage(\n      block.workspace,\n      id,\n      variableName as AnyDuringMigration,\n      variableType\n    );\n\n    // This should never happen :)\n    if (variableType !== null && variableType !== variable.type) {\n      throw Error(\n        \"Serialized variable type with id '\" +\n          variable.getId() +\n          \"' had type \" +\n          variable.type +\n          ', and ' +\n          'does not match variable field that references it: ' +\n          Xml.domToText(fieldElement) +\n          '.'\n      );\n    }\n\n    this.setValue(variable.getId());\n  }\n\n  /**\n   * Serialize this field to XML.\n   *\n   * @param fieldElement The element to populate with info about the field's\n   *     state.\n   * @returns The element containing info about the field's state.\n   */\n  override toXml(fieldElement: Element): Element {\n    // Make sure the variable is initialized.\n    this.initModel();\n\n    fieldElement.id = this.variable!.getId();\n    fieldElement.textContent = this.variable!.name;\n    if (this.variable!.type) {\n      fieldElement.setAttribute('variabletype', this.variable!.type);\n    }\n    return fieldElement;\n  }\n\n  /**\n   * Saves this field's value.\n   *\n   * @param doFullSerialization If true, the variable field will serialize the\n   *     full state of the field being referenced (ie ID, name, and type) rather\n   *     than just a reference to it (ie ID).\n   * @returns The state of the variable field.\n   * @internal\n   */\n  override saveState(doFullSerialization?: boolean): AnyDuringMigration {\n    const legacyState = this.saveLegacyState(FieldVariable);\n    if (legacyState !== null) {\n      return legacyState;\n    }\n    // Make sure the variable is initialized.\n    this.initModel();\n    const state = {'id': this.variable!.getId()};\n    if (doFullSerialization) {\n      (state as AnyDuringMigration)['name'] = this.variable!.name;\n      (state as AnyDuringMigration)['type'] = this.variable!.type;\n    }\n    return state;\n  }\n\n  /**\n   * Sets the field's value based on the given state.\n   *\n   * @param state The state of the variable to assign to this variable field.\n   * @internal\n   */\n  override loadState(state: AnyDuringMigration) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    if (this.loadLegacyState(FieldVariable, state)) {\n      return;\n    }\n    // This is necessary so that blocks in the flyout can have custom var names.\n    const variable = Variables.getOrCreateVariablePackage(\n      block.workspace,\n      state['id'] || null,\n      state['name'],\n      state['type'] || ''\n    );\n    this.setValue(variable.getId());\n  }\n\n  /**\n   * Attach this field to a block.\n   *\n   * @param block The block containing this field.\n   */\n  override setSourceBlock(block: Block) {\n    if (block.isShadow()) {\n      throw Error('Variable fields are not allowed to exist on shadow blocks.');\n    }\n    super.setSourceBlock(block);\n  }\n\n  /**\n   * Get the variable's ID.\n   *\n   * @returns Current variable's ID.\n   */\n  override getValue(): string | null {\n    return this.variable ? this.variable.getId() : null;\n  }\n\n  /**\n   * Get the text from this field, which is the selected variable's name.\n   *\n   * @returns The selected variable's name, or the empty string if no variable\n   *     is selected.\n   */\n  override getText(): string {\n    return this.variable ? this.variable.name : '';\n  }\n\n  /**\n   * Get the variable model for the selected variable.\n   * Not guaranteed to be in the variable map on the workspace (e.g. if accessed\n   * after the variable has been deleted).\n   *\n   * @returns The selected variable, or null if none was selected.\n   * @internal\n   */\n  getVariable(): VariableModel | null {\n    return this.variable;\n  }\n\n  /**\n   * Gets the validation function for this field, or null if not set.\n   * Returns null if the variable is not set, because validators should not\n   * run on the initial setValue call, because the field won't be attached to\n   * a block and workspace at that point.\n   *\n   * @returns Validation function, or null.\n   */\n  override getValidator(): FieldVariableValidator | null {\n    // Validators shouldn't operate on the initial setValue call.\n    // Normally this is achieved by calling setValidator after setValue, but\n    // this is not a possibility with variable fields.\n    if (this.variable) {\n      return this.validator_;\n    }\n    return null;\n  }\n\n  /**\n   * Ensure that the ID belongs to a valid variable of an allowed type.\n   *\n   * @param newValue The ID of the new variable to set.\n   * @returns The validated ID, or null if invalid.\n   */\n  protected override doClassValidation_(\n    newValue?: AnyDuringMigration\n  ): string | null {\n    if (newValue === null) {\n      return null;\n    }\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    const newId = newValue as string;\n    const variable = Variables.getVariable(block.workspace, newId);\n    if (!variable) {\n      console.warn(\n        \"Variable id doesn't point to a real variable! \" + 'ID was ' + newId\n      );\n      return null;\n    }\n    // Type Checks.\n    const type = variable.type;\n    if (!this.typeIsAllowed(type)) {\n      console.warn(\"Variable type doesn't match this field!  Type was \" + type);\n      return null;\n    }\n    return newId;\n  }\n\n  /**\n   * Update the value of this variable field, as well as its variable and text.\n   *\n   * The variable ID should be valid at this point, but if a variable field\n   * validator returns a bad ID, this could break.\n   *\n   * @param newId The value to be saved.\n   */\n  protected override doValueUpdate_(newId: string) {\n    const block = this.getSourceBlock();\n    if (!block) {\n      throw new UnattachedFieldError();\n    }\n    this.variable = Variables.getVariable(block.workspace, newId as string);\n    super.doValueUpdate_(newId);\n  }\n\n  /**\n   * Check whether the given variable type is allowed on this field.\n   *\n   * @param type The type to check.\n   * @returns True if the type is in the list of allowed types.\n   */\n  private typeIsAllowed(type: string): boolean {\n    const typeList = this.getVariableTypes();\n    if (!typeList) {\n      return true; // If it's null, all types are valid.\n    }\n    for (let i = 0; i < typeList.length; i++) {\n      if (type === typeList[i]) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Return a list of variable types to include in the dropdown.\n   *\n   * @returns Array of variable types.\n   * @throws {Error} if variableTypes is an empty array.\n   */\n  private getVariableTypes(): string[] {\n    let variableTypes = this.variableTypes;\n    if (variableTypes === null) {\n      // If variableTypes is null, return all variable types.\n      if (this.sourceBlock_ && !this.sourceBlock_.isDeadOrDying()) {\n        return this.sourceBlock_.workspace.getVariableTypes();\n      }\n    }\n    variableTypes = variableTypes || [''];\n    if (variableTypes.length === 0) {\n      // Throw an error if variableTypes is an empty list.\n      const name = this.getText();\n      throw Error(\n        \"'variableTypes' of field variable \" + name + ' was an empty list'\n      );\n    }\n    return variableTypes;\n  }\n\n  /**\n   * Parse the optional arguments representing the allowed variable types and\n   * the default variable type.\n   *\n   * @param variableTypes A list of the types of variables to include in the\n   *     dropdown.  If null or undefined, variables of all types will be\n   *     displayed in the dropdown.\n   * @param defaultType The type of the variable to create if this field's\n   *     value is not explicitly set.  Defaults to ''.\n   */\n  private setTypes(variableTypes: string[] | null = null, defaultType = '') {\n    // If you expected that the default type would be the same as the only entry\n    // in the variable types array, tell the Blockly team by commenting on\n    // #1499.\n    // Set the allowable variable types.  Null means all types on the workspace.\n    if (Array.isArray(variableTypes)) {\n      variableTypes = variableTypes;\n      // Make sure the default type is valid.\n      let isInArray = false;\n      for (let i = 0; i < variableTypes.length; i++) {\n        if (variableTypes[i] === defaultType) {\n          isInArray = true;\n        }\n      }\n      if (!isInArray) {\n        throw Error(\n          \"Invalid default type '\" +\n            defaultType +\n            \"' in \" +\n            'the definition of a FieldVariable'\n        );\n      }\n    } else if (variableTypes !== null) {\n      throw Error(\n        \"'variableTypes' was not an array in the definition of \" +\n          'a FieldVariable'\n      );\n    }\n    // Only update the field once all checks pass.\n    this.defaultType = defaultType;\n    this.variableTypes = variableTypes;\n  }\n\n  /**\n   * Refreshes the name of the variable by grabbing the name of the model.\n   * Used when a variable gets renamed, but the ID stays the same. Should only\n   * be called by the block.\n   *\n   * @internal\n   */\n  override refreshVariableName() {\n    this.forceRerender();\n  }\n\n  /**\n   * Handle the selection of an item in the variable dropdown menu.\n   * Special case the 'Rename variable...' and 'Delete variable...' options.\n   * In the rename case, prompt the user for a new name.\n   *\n   * @param menu The Menu component clicked.\n   * @param menuItem The MenuItem selected within menu.\n   */\n  protected override onItemSelected_(menu: Menu, menuItem: MenuItem) {\n    const id = menuItem.getValue();\n    // Handle special cases.\n    if (this.sourceBlock_ && !this.sourceBlock_.isDeadOrDying()) {\n      if (id === internalConstants.RENAME_VARIABLE_ID) {\n        // Rename variable.\n        Variables.renameVariable(\n          this.sourceBlock_.workspace,\n          this.variable as VariableModel\n        );\n        return;\n      } else if (id === internalConstants.DELETE_VARIABLE_ID) {\n        // Delete variable.\n        this.sourceBlock_.workspace.deleteVariableById(this.variable!.getId());\n        return;\n      }\n    }\n    // Handle unspecial case.\n    this.setValue(id);\n  }\n\n  /**\n   * Overrides referencesVariables(), indicating this field refers to a\n   * variable.\n   *\n   * @returns True.\n   * @internal\n   */\n  override referencesVariables(): boolean {\n    return true;\n  }\n\n  /**\n   * Construct a FieldVariable from a JSON arg object,\n   * dereferencing any string table references.\n   *\n   * @param options A JSON object with options (variable, variableTypes, and\n   *     defaultType).\n   * @returns The new field instance.\n   * @nocollapse\n   * @internal\n   */\n  static override fromJson(\n    options: FieldVariableFromJsonConfig\n  ): FieldVariable {\n    const varName = parsing.replaceMessageReferences(options.variable);\n    // `this` might be a subclass of FieldVariable if that class doesn't\n    // override the static fromJson method.\n    return new this(varName, undefined, undefined, undefined, options);\n  }\n\n  /**\n   * Return a sorted list of variable names for variable dropdown menus.\n   * Include a special option at the end for creating a new variable name.\n   *\n   * @returns Array of variable names/id tuples.\n   */\n  static dropdownCreate(this: FieldVariable): MenuOption[] {\n    if (!this.variable) {\n      throw Error(\n        'Tried to call dropdownCreate on a variable field with no' +\n          ' variable selected.'\n      );\n    }\n    const name = this.getText();\n    let variableModelList: VariableModel[] = [];\n    if (this.sourceBlock_ && !this.sourceBlock_.isDeadOrDying()) {\n      const variableTypes = this.getVariableTypes();\n      // Get a copy of the list, so that adding rename and new variable options\n      // doesn't modify the workspace's list.\n      for (let i = 0; i < variableTypes.length; i++) {\n        const variableType = variableTypes[i];\n        const variables =\n          this.sourceBlock_.workspace.getVariablesOfType(variableType);\n        variableModelList = variableModelList.concat(variables);\n      }\n    }\n    variableModelList.sort(VariableModel.compareByName);\n\n    const options: [string, string][] = [];\n    for (let i = 0; i < variableModelList.length; i++) {\n      // Set the UUID as the internal representation of the variable.\n      options[i] = [variableModelList[i].name, variableModelList[i].getId()];\n    }\n    options.push([\n      Msg['RENAME_VARIABLE'],\n      internalConstants.RENAME_VARIABLE_ID,\n    ]);\n    if (Msg['DELETE_VARIABLE']) {\n      options.push([\n        Msg['DELETE_VARIABLE'].replace('%1', name),\n        internalConstants.DELETE_VARIABLE_ID,\n      ]);\n    }\n\n    return options;\n  }\n}\n\nfieldRegistry.register('field_variable', FieldVariable);\n\n/**\n * Config options for the variable field.\n */\nexport interface FieldVariableConfig extends FieldConfig {\n  variableTypes?: string[];\n  defaultType?: string;\n}\n\n/**\n * fromJson config options for the variable field.\n */\nexport interface FieldVariableFromJsonConfig extends FieldVariableConfig {\n  variable?: string;\n}\n\n/**\n * A function that is called to validate changes to the field's value before\n * they are set.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/fields/validators#return_values}\n * @param newValue The value to be validated.\n * @returns One of three instructions for setting the new value: `T`, `null`,\n * or `undefined`.\n *\n * - `T` to set this function's returned value instead of `newValue`.\n *\n * - `null` to invoke `doValueInvalid_` and not set a value.\n *\n * - `undefined` to set `newValue` as is.\n */\nexport type FieldVariableValidator = FieldDropdownValidator;\n","/**\n * @license\n * Copyright 2016 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Class for a button in the flyout.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FlyoutButton');\n\nimport * as browserEvents from './browser_events.js';\nimport * as Css from './css.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as parsing from './utils/parsing.js';\nimport * as style from './utils/style.js';\nimport {Svg} from './utils/svg.js';\nimport type * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a button or label in the flyout.\n */\nexport class FlyoutButton {\n  /** The horizontal margin around the text in the button. */\n  static TEXT_MARGIN_X = 5;\n\n  /** The vertical margin around the text in the button. */\n  static TEXT_MARGIN_Y = 2;\n\n  /** The radius of the flyout button's borders. */\n  static BORDER_RADIUS = 4;\n\n  private readonly text: string;\n  private readonly position: Coordinate;\n  private readonly callbackKey: string;\n  private readonly cssClass: string | null;\n\n  /** Mouse up event data. */\n  private onMouseUpWrapper: browserEvents.Data | null = null;\n  info: toolbox.ButtonOrLabelInfo;\n\n  /** The width of the button's rect. */\n  width = 0;\n\n  /** The height of the button's rect. */\n  height = 0;\n\n  /** The root SVG group for the button or label. */\n  private svgGroup: SVGGElement | null = null;\n\n  /** The SVG element with the text of the label or button. */\n  private svgText: SVGTextElement | null = null;\n\n  /**\n   * @param workspace The workspace in which to place this button.\n   * @param targetWorkspace The flyout's target workspace.\n   * @param json The JSON specifying the label/button.\n   * @param isLabel_ Whether this button should be styled as a label.\n   * @internal\n   */\n  constructor(\n    private readonly workspace: WorkspaceSvg,\n    private readonly targetWorkspace: WorkspaceSvg,\n    json: toolbox.ButtonOrLabelInfo,\n    private readonly isLabel_: boolean\n  ) {\n    this.text = json['text'];\n\n    this.position = new Coordinate(0, 0);\n\n    /** The key to the function called when this button is clicked. */\n    this.callbackKey =\n      (json as AnyDuringMigration)[\n        'callbackKey'\n      ] /* Check the lower case version\n                                                   too to satisfy IE */ ||\n      (json as AnyDuringMigration)['callbackkey'];\n\n    /** If specified, a CSS class to add to this button. */\n    this.cssClass = (json as AnyDuringMigration)['web-class'] || null;\n\n    /** The JSON specifying the label / button. */\n    this.info = json;\n  }\n\n  /**\n   * Create the button elements.\n   *\n   * @returns The button's SVG group.\n   */\n  createDom(): SVGElement {\n    let cssClass = this.isLabel_ ? 'blocklyFlyoutLabel' : 'blocklyFlyoutButton';\n    if (this.cssClass) {\n      cssClass += ' ' + this.cssClass;\n    }\n\n    this.svgGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': cssClass},\n      this.workspace.getCanvas()\n    );\n\n    let shadow;\n    if (!this.isLabel_) {\n      // Shadow rectangle (light source does not mirror in RTL).\n      shadow = dom.createSvgElement(\n        Svg.RECT,\n        {\n          'class': 'blocklyFlyoutButtonShadow',\n          'rx': FlyoutButton.BORDER_RADIUS,\n          'ry': FlyoutButton.BORDER_RADIUS,\n          'x': 1,\n          'y': 1,\n        },\n        this.svgGroup!\n      );\n    }\n    // Background rectangle.\n    const rect = dom.createSvgElement(\n      Svg.RECT,\n      {\n        'class': this.isLabel_\n          ? 'blocklyFlyoutLabelBackground'\n          : 'blocklyFlyoutButtonBackground',\n        'rx': FlyoutButton.BORDER_RADIUS,\n        'ry': FlyoutButton.BORDER_RADIUS,\n      },\n      this.svgGroup!\n    );\n\n    const svgText = dom.createSvgElement(\n      Svg.TEXT,\n      {\n        'class': this.isLabel_ ? 'blocklyFlyoutLabelText' : 'blocklyText',\n        'x': 0,\n        'y': 0,\n        'text-anchor': 'middle',\n      },\n      this.svgGroup!\n    );\n    let text = parsing.replaceMessageReferences(this.text);\n    if (this.workspace.RTL) {\n      // Force text to be RTL by adding an RLM.\n      text += '\\u200F';\n    }\n    svgText.textContent = text;\n    if (this.isLabel_) {\n      this.svgText = svgText;\n      this.workspace\n        .getThemeManager()\n        .subscribe(this.svgText, 'flyoutForegroundColour', 'fill');\n    }\n\n    const fontSize = style.getComputedStyle(svgText, 'fontSize');\n    const fontWeight = style.getComputedStyle(svgText, 'fontWeight');\n    const fontFamily = style.getComputedStyle(svgText, 'fontFamily');\n    this.width = dom.getFastTextWidthWithSizeString(\n      svgText,\n      fontSize,\n      fontWeight,\n      fontFamily\n    );\n    const fontMetrics = dom.measureFontMetrics(\n      text,\n      fontSize,\n      fontWeight,\n      fontFamily\n    );\n    this.height = fontMetrics.height;\n\n    if (!this.isLabel_) {\n      this.width += 2 * FlyoutButton.TEXT_MARGIN_X;\n      this.height += 2 * FlyoutButton.TEXT_MARGIN_Y;\n      shadow?.setAttribute('width', String(this.width));\n      shadow?.setAttribute('height', String(this.height));\n    }\n    rect.setAttribute('width', String(this.width));\n    rect.setAttribute('height', String(this.height));\n\n    svgText.setAttribute('x', String(this.width / 2));\n    svgText.setAttribute(\n      'y',\n      String(this.height / 2 - fontMetrics.height / 2 + fontMetrics.baseline)\n    );\n\n    this.updateTransform();\n\n    // AnyDuringMigration because:  Argument of type 'SVGGElement | null' is not\n    // assignable to parameter of type 'EventTarget'.\n    this.onMouseUpWrapper = browserEvents.conditionalBind(\n      this.svgGroup as AnyDuringMigration,\n      'pointerup',\n      this,\n      this.onMouseUp\n    );\n    return this.svgGroup!;\n  }\n\n  /** Correctly position the flyout button and make it visible. */\n  show() {\n    this.updateTransform();\n    this.svgGroup!.setAttribute('display', 'block');\n  }\n\n  /** Update SVG attributes to match internal state. */\n  private updateTransform() {\n    this.svgGroup!.setAttribute(\n      'transform',\n      'translate(' + this.position.x + ',' + this.position.y + ')'\n    );\n  }\n\n  /**\n   * Move the button to the given x, y coordinates.\n   *\n   * @param x The new x coordinate.\n   * @param y The new y coordinate.\n   */\n  moveTo(x: number, y: number) {\n    this.position.x = x;\n    this.position.y = y;\n    this.updateTransform();\n  }\n\n  /** @returns Whether or not the button is a label. */\n  isLabel(): boolean {\n    return this.isLabel_;\n  }\n\n  /**\n   * Location of the button.\n   *\n   * @returns x, y coordinates.\n   * @internal\n   */\n  getPosition(): Coordinate {\n    return this.position;\n  }\n\n  /** @returns Text of the button. */\n  getButtonText(): string {\n    return this.text;\n  }\n\n  /**\n   * Get the button's target workspace.\n   *\n   * @returns The target workspace of the flyout where this button resides.\n   */\n  getTargetWorkspace(): WorkspaceSvg {\n    return this.targetWorkspace;\n  }\n\n  /** Dispose of this button. */\n  dispose() {\n    if (this.onMouseUpWrapper) {\n      browserEvents.unbind(this.onMouseUpWrapper);\n    }\n    if (this.svgGroup) {\n      dom.removeNode(this.svgGroup);\n    }\n    if (this.svgText) {\n      this.workspace.getThemeManager().unsubscribe(this.svgText);\n    }\n  }\n\n  /**\n   * Do something when the button is clicked.\n   *\n   * @param e Pointer up event.\n   */\n  private onMouseUp(e: PointerEvent) {\n    const gesture = this.targetWorkspace.getGesture(e);\n    if (gesture) {\n      gesture.cancel();\n    }\n\n    if (this.isLabel_ && this.callbackKey) {\n      console.warn(\n        'Labels should not have callbacks. Label text: ' + this.text\n      );\n    } else if (\n      !this.isLabel_ &&\n      !(\n        this.callbackKey &&\n        this.targetWorkspace.getButtonCallback(this.callbackKey)\n      )\n    ) {\n      console.warn('Buttons should have callbacks. Button text: ' + this.text);\n    } else if (!this.isLabel_) {\n      const callback = this.targetWorkspace.getButtonCallback(this.callbackKey);\n      if (callback) {\n        callback(this);\n      }\n    }\n  }\n}\n\n/** CSS for buttons and labels. See css.js for use. */\nCss.register(`\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n`);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Calculates and reports workspace metrics.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.MetricsManager');\n\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IMetricsManager} from './interfaces/i_metrics_manager.js';\nimport type {IToolbox} from './interfaces/i_toolbox.js';\nimport * as registry from './registry.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Size} from './utils/size.js';\nimport * as toolboxUtils from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * The manager for all workspace metrics calculations.\n */\nexport class MetricsManager implements IMetricsManager {\n  /** The workspace to calculate metrics for. */\n  protected readonly workspace_: WorkspaceSvg;\n\n  /** @param workspace The workspace to calculate metrics for. */\n  constructor(workspace: WorkspaceSvg) {\n    this.workspace_ = workspace;\n  }\n\n  /**\n   * Gets the dimensions of the given workspace component, in pixel coordinates.\n   *\n   * @param elem The element to get the dimensions of, or null.  It should be a\n   *     toolbox or flyout, and should implement getWidth() and getHeight().\n   * @returns An object containing width and height attributes, which will both\n   *     be zero if elem did not exist.\n   */\n  protected getDimensionsPx_(elem: IToolbox | null | IFlyout): Size {\n    let width = 0;\n    let height = 0;\n    if (elem) {\n      width = elem.getWidth();\n      height = elem.getHeight();\n    }\n    return new Size(width, height);\n  }\n\n  /**\n   * Gets the width and the height of the flyout in pixel\n   * coordinates. By default, will get metrics for either a simple flyout (owned\n   * directly by the workspace) or for the flyout owned by the toolbox. If you\n   * pass `opt_own` as `true` then only metrics for the simple flyout will be\n   * returned, and it will return 0 for the width and height if the workspace\n   * has a category toolbox instead of a simple toolbox.\n   *\n   * @param opt_own Whether to only return the workspace's own flyout metrics.\n   * @returns The width and height of the flyout.\n   */\n  getFlyoutMetrics(opt_own?: boolean): ToolboxMetrics {\n    const flyoutDimensions = this.getDimensionsPx_(\n      this.workspace_.getFlyout(opt_own)\n    );\n    return {\n      width: flyoutDimensions.width,\n      height: flyoutDimensions.height,\n      position: this.workspace_.toolboxPosition,\n    };\n  }\n\n  /**\n   * Gets the width, height and position of the toolbox on the workspace in\n   * pixel coordinates. Returns 0 for the width and height if the workspace has\n   * a simple toolbox instead of a category toolbox. To get the width and height\n   * of a simple toolbox, see {@link MetricsManager#getFlyoutMetrics}.\n   *\n   * @returns The object with the width, height and position of the toolbox.\n   */\n  getToolboxMetrics(): ToolboxMetrics {\n    const toolboxDimensions = this.getDimensionsPx_(\n      this.workspace_.getToolbox()\n    );\n\n    return {\n      width: toolboxDimensions.width,\n      height: toolboxDimensions.height,\n      position: this.workspace_.toolboxPosition,\n    };\n  }\n\n  /**\n   * Gets the width and height of the workspace's parent SVG element in pixel\n   * coordinates. This area includes the toolbox and the visible workspace area.\n   *\n   * @returns The width and height of the workspace's parent SVG element.\n   */\n  getSvgMetrics(): Size {\n    return this.workspace_.getCachedParentSvgSize();\n  }\n\n  /**\n   * Gets the absolute left and absolute top in pixel coordinates.\n   * This is where the visible workspace starts in relation to the SVG\n   * container.\n   *\n   * @returns The absolute metrics for the workspace.\n   */\n  getAbsoluteMetrics(): AbsoluteMetrics {\n    let absoluteLeft = 0;\n    const toolboxMetrics = this.getToolboxMetrics();\n    const flyoutMetrics = this.getFlyoutMetrics(true);\n    const doesToolboxExist = !!this.workspace_.getToolbox();\n    const doesFlyoutExist = !!this.workspace_.getFlyout(true);\n    const toolboxPosition = doesToolboxExist\n      ? toolboxMetrics.position\n      : flyoutMetrics.position;\n\n    const atLeft = toolboxPosition === toolboxUtils.Position.LEFT;\n    const atTop = toolboxPosition === toolboxUtils.Position.TOP;\n    if (doesToolboxExist && atLeft) {\n      absoluteLeft = toolboxMetrics.width;\n    } else if (doesFlyoutExist && atLeft) {\n      absoluteLeft = flyoutMetrics.width;\n    }\n    let absoluteTop = 0;\n    if (doesToolboxExist && atTop) {\n      absoluteTop = toolboxMetrics.height;\n    } else if (doesFlyoutExist && atTop) {\n      absoluteTop = flyoutMetrics.height;\n    }\n\n    return {\n      top: absoluteTop,\n      left: absoluteLeft,\n    };\n  }\n\n  /**\n   * Gets the metrics for the visible workspace in either pixel or workspace\n   * coordinates. The visible workspace does not include the toolbox or flyout.\n   *\n   * @param opt_getWorkspaceCoordinates True to get the view metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @returns The width, height, top and left of the viewport in either\n   *     workspace coordinates or pixel coordinates.\n   */\n  getViewMetrics(opt_getWorkspaceCoordinates?: boolean): ContainerRegion {\n    const scale = opt_getWorkspaceCoordinates ? this.workspace_.scale : 1;\n    const svgMetrics = this.getSvgMetrics();\n    const toolboxMetrics = this.getToolboxMetrics();\n    const flyoutMetrics = this.getFlyoutMetrics(true);\n    const doesToolboxExist = !!this.workspace_.getToolbox();\n    const toolboxPosition = doesToolboxExist\n      ? toolboxMetrics.position\n      : flyoutMetrics.position;\n\n    if (this.workspace_.getToolbox()) {\n      if (\n        toolboxPosition === toolboxUtils.Position.TOP ||\n        toolboxPosition === toolboxUtils.Position.BOTTOM\n      ) {\n        svgMetrics.height -= toolboxMetrics.height;\n      } else if (\n        toolboxPosition === toolboxUtils.Position.LEFT ||\n        toolboxPosition === toolboxUtils.Position.RIGHT\n      ) {\n        svgMetrics.width -= toolboxMetrics.width;\n      }\n    } else if (this.workspace_.getFlyout(true)) {\n      if (\n        toolboxPosition === toolboxUtils.Position.TOP ||\n        toolboxPosition === toolboxUtils.Position.BOTTOM\n      ) {\n        svgMetrics.height -= flyoutMetrics.height;\n      } else if (\n        toolboxPosition === toolboxUtils.Position.LEFT ||\n        toolboxPosition === toolboxUtils.Position.RIGHT\n      ) {\n        svgMetrics.width -= flyoutMetrics.width;\n      }\n    }\n    return {\n      height: svgMetrics.height / scale,\n      width: svgMetrics.width / scale,\n      top: -this.workspace_.scrollY / scale,\n      left: -this.workspace_.scrollX / scale,\n    };\n  }\n\n  /**\n   * Gets content metrics in either pixel or workspace coordinates.\n   * The content area is a rectangle around all the top bounded elements on the\n   * workspace (workspace comments and blocks).\n   *\n   * @param opt_getWorkspaceCoordinates True to get the content metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @returns The metrics for the content container.\n   */\n  getContentMetrics(opt_getWorkspaceCoordinates?: boolean): ContainerRegion {\n    const scale = opt_getWorkspaceCoordinates ? 1 : this.workspace_.scale;\n    // Block bounding box is in workspace coordinates.\n    const blockBox = this.workspace_.getBlocksBoundingBox();\n\n    return {\n      height: (blockBox.bottom - blockBox.top) * scale,\n      width: (blockBox.right - blockBox.left) * scale,\n      top: blockBox.top * scale,\n      left: blockBox.left * scale,\n    };\n  }\n\n  /**\n   * Returns whether the scroll area has fixed edges.\n   *\n   * @returns Whether the scroll area has fixed edges.\n   * @internal\n   */\n  hasFixedEdges(): boolean {\n    // This exists for optimization of bump logic.\n    return (\n      !this.workspace_.isMovableHorizontally() ||\n      !this.workspace_.isMovableVertically()\n    );\n  }\n\n  /**\n   * Computes the fixed edges of the scroll area.\n   *\n   * @param opt_viewMetrics The view metrics if they have been previously\n   *     computed. Passing in null may cause the view metrics to be computed\n   *     again, if it is needed.\n   * @returns The fixed edges of the scroll area.\n   */\n  protected getComputedFixedEdges_(\n    opt_viewMetrics?: ContainerRegion\n  ): FixedEdges {\n    if (!this.hasFixedEdges()) {\n      // Return early if there are no edges.\n      return {};\n    }\n\n    const hScrollEnabled = this.workspace_.isMovableHorizontally();\n    const vScrollEnabled = this.workspace_.isMovableVertically();\n\n    const viewMetrics = opt_viewMetrics || this.getViewMetrics(false);\n\n    const edges = {} as FixedEdges;\n    if (!vScrollEnabled) {\n      edges.top = viewMetrics.top;\n      edges.bottom = viewMetrics.top + viewMetrics.height;\n    }\n    if (!hScrollEnabled) {\n      edges.left = viewMetrics.left;\n      edges.right = viewMetrics.left + viewMetrics.width;\n    }\n    return edges;\n  }\n\n  /**\n   * Returns the content area with added padding.\n   *\n   * @param viewMetrics The view metrics.\n   * @param contentMetrics The content metrics.\n   * @returns The padded content area.\n   */\n  protected getPaddedContent_(\n    viewMetrics: ContainerRegion,\n    contentMetrics: ContainerRegion\n  ): {top: number; bottom: number; left: number; right: number} {\n    const contentBottom = contentMetrics.top + contentMetrics.height;\n    const contentRight = contentMetrics.left + contentMetrics.width;\n\n    const viewWidth = viewMetrics.width;\n    const viewHeight = viewMetrics.height;\n    const halfWidth = viewWidth / 2;\n    const halfHeight = viewHeight / 2;\n\n    // Add a padding around the content that is at least half a screen wide.\n    // Ensure padding is wide enough that blocks can scroll over entire screen.\n    const top = Math.min(\n      contentMetrics.top - halfHeight,\n      contentBottom - viewHeight\n    );\n    const left = Math.min(\n      contentMetrics.left - halfWidth,\n      contentRight - viewWidth\n    );\n    const bottom = Math.max(\n      contentBottom + halfHeight,\n      contentMetrics.top + viewHeight\n    );\n    const right = Math.max(\n      contentRight + halfWidth,\n      contentMetrics.left + viewWidth\n    );\n\n    return {top, bottom, left, right};\n  }\n\n  /**\n   * Returns the metrics for the scroll area of the workspace.\n   *\n   * @param opt_getWorkspaceCoordinates True to get the scroll metrics in\n   *     workspace coordinates, false to get them in pixel coordinates.\n   * @param opt_viewMetrics The view metrics if they have been previously\n   *     computed. Passing in null may cause the view metrics to be computed\n   *     again, if it is needed.\n   * @param opt_contentMetrics The content metrics if they have been previously\n   *     computed. Passing in null may cause the content metrics to be computed\n   *     again, if it is needed.\n   * @returns The metrics for the scroll container.\n   */\n  getScrollMetrics(\n    opt_getWorkspaceCoordinates?: boolean,\n    opt_viewMetrics?: ContainerRegion,\n    opt_contentMetrics?: ContainerRegion\n  ): ContainerRegion {\n    const scale = opt_getWorkspaceCoordinates ? this.workspace_.scale : 1;\n    const viewMetrics = opt_viewMetrics || this.getViewMetrics(false);\n    const contentMetrics = opt_contentMetrics || this.getContentMetrics();\n    const fixedEdges = this.getComputedFixedEdges_(viewMetrics);\n\n    // Add padding around content.\n    const paddedContent = this.getPaddedContent_(viewMetrics, contentMetrics);\n\n    // Use combination of fixed bounds and padded content to make scroll area.\n    const top =\n      fixedEdges.top !== undefined ? fixedEdges.top : paddedContent.top;\n    const left =\n      fixedEdges.left !== undefined ? fixedEdges.left : paddedContent.left;\n    const bottom =\n      fixedEdges.bottom !== undefined\n        ? fixedEdges.bottom\n        : paddedContent.bottom;\n    const right =\n      fixedEdges.right !== undefined ? fixedEdges.right : paddedContent.right;\n\n    return {\n      top: top / scale,\n      left: left / scale,\n      width: (right - left) / scale,\n      height: (bottom - top) / scale,\n    };\n  }\n\n  /**\n   * Returns common metrics used by UI elements.\n   *\n   * @returns The UI metrics.\n   */\n  getUiMetrics(): UiMetrics {\n    return {\n      viewMetrics: this.getViewMetrics(),\n      absoluteMetrics: this.getAbsoluteMetrics(),\n      toolboxMetrics: this.getToolboxMetrics(),\n    };\n  }\n\n  /**\n   * Returns an object with all the metrics required to size scrollbars for a\n   * top level workspace.  The following properties are computed:\n   * Coordinate system: pixel coordinates, -left, -up, +right, +down\n   * .viewHeight: Height of the visible portion of the workspace.\n   * .viewWidth: Width of the visible portion of the workspace.\n   * .contentHeight: Height of the content.\n   * .contentWidth: Width of the content.\n   * .scrollHeight: Height of the scroll area.\n   * .scrollWidth: Width of the scroll area.\n   * .svgHeight: Height of the Blockly div (the view + the toolbox,\n   *    simple or otherwise),\n   * .svgWidth: Width of the Blockly div (the view + the toolbox,\n   *    simple or otherwise),\n   * .viewTop: Top-edge of the visible portion of the workspace, relative to\n   *     the workspace origin.\n   * .viewLeft: Left-edge of the visible portion of the workspace, relative to\n   *     the workspace origin.\n   * .contentTop: Top-edge of the content, relative to the workspace origin.\n   * .contentLeft: Left-edge of the content relative to the workspace origin.\n   * .scrollTop: Top-edge of the scroll area, relative to the workspace origin.\n   * .scrollLeft: Left-edge of the scroll area relative to the workspace origin.\n   * .absoluteTop: Top-edge of the visible portion of the workspace, relative\n   *     to the blocklyDiv.\n   * .absoluteLeft: Left-edge of the visible portion of the workspace, relative\n   *     to the blocklyDiv.\n   * .toolboxWidth: Width of the toolbox, if it exists.  Otherwise zero.\n   * .toolboxHeight: Height of the toolbox, if it exists.  Otherwise zero.\n   * .flyoutWidth: Width of the flyout if it is always open.  Otherwise zero.\n   * .flyoutHeight: Height of the flyout if it is always open.  Otherwise zero.\n   * .toolboxPosition: Top, bottom, left or right. Use TOOLBOX_AT constants to\n   *     compare.\n   *\n   * @returns Contains size and position metrics of a top level workspace.\n   */\n  getMetrics(): Metrics {\n    const toolboxMetrics = this.getToolboxMetrics();\n    const flyoutMetrics = this.getFlyoutMetrics(true);\n    const svgMetrics = this.getSvgMetrics();\n    const absoluteMetrics = this.getAbsoluteMetrics();\n    const viewMetrics = this.getViewMetrics();\n    const contentMetrics = this.getContentMetrics();\n    const scrollMetrics = this.getScrollMetrics(\n      false,\n      viewMetrics,\n      contentMetrics\n    );\n\n    return {\n      contentHeight: contentMetrics.height,\n      contentWidth: contentMetrics.width,\n      contentTop: contentMetrics.top,\n      contentLeft: contentMetrics.left,\n\n      scrollHeight: scrollMetrics.height,\n      scrollWidth: scrollMetrics.width,\n      scrollTop: scrollMetrics.top,\n      scrollLeft: scrollMetrics.left,\n\n      viewHeight: viewMetrics.height,\n      viewWidth: viewMetrics.width,\n      viewTop: viewMetrics.top,\n      viewLeft: viewMetrics.left,\n\n      absoluteTop: absoluteMetrics.top,\n      absoluteLeft: absoluteMetrics.left,\n\n      svgHeight: svgMetrics.height,\n      svgWidth: svgMetrics.width,\n\n      toolboxWidth: toolboxMetrics.width,\n      toolboxHeight: toolboxMetrics.height,\n      toolboxPosition: toolboxMetrics.position,\n\n      flyoutWidth: flyoutMetrics.width,\n      flyoutHeight: flyoutMetrics.height,\n    };\n  }\n}\n\nexport namespace MetricsManager {\n  /**\n   * Describes the width, height and location of the toolbox on the main\n   * workspace.\n   */\n  export interface ToolboxMetrics {\n    width: number;\n    height: number;\n    position: toolboxUtils.Position;\n  }\n\n  /** Describes where the viewport starts in relation to the workspace SVG. */\n  export interface AbsoluteMetrics {\n    left: number;\n    top: number;\n  }\n\n  /**\n   * All the measurements needed to describe the size and location of a\n   * container.\n   */\n  export interface ContainerRegion {\n    height: number;\n    width: number;\n    top: number;\n    left: number;\n  }\n\n  /** Describes fixed edges of the workspace. */\n  export interface FixedEdges {\n    top?: number;\n    bottom?: number;\n    left?: number;\n    right?: number;\n  }\n\n  /** Common metrics used for UI elements. */\n  export interface UiMetrics {\n    viewMetrics: ContainerRegion;\n    absoluteMetrics: AbsoluteMetrics;\n    toolboxMetrics: ToolboxMetrics;\n  }\n}\n\nexport type ToolboxMetrics = MetricsManager.ToolboxMetrics;\nexport type AbsoluteMetrics = MetricsManager.AbsoluteMetrics;\nexport type ContainerRegion = MetricsManager.ContainerRegion;\nexport type FixedEdges = MetricsManager.FixedEdges;\nexport type UiMetrics = MetricsManager.UiMetrics;\n\nregistry.register(\n  registry.Type.METRICS_MANAGER,\n  registry.DEFAULT,\n  MetricsManager\n);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Calculates and reports flyout workspace metrics.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.FlyoutMetricsManager');\n\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport {ContainerRegion, MetricsManager} from './metrics_manager.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Calculates metrics for a flyout's workspace.\n * The metrics are mainly used to size scrollbars for the flyout.\n */\nexport class FlyoutMetricsManager extends MetricsManager {\n  /** The flyout that owns the workspace to calculate metrics for. */\n  protected flyout_: IFlyout;\n\n  /**\n   * @param workspace The flyout's workspace.\n   * @param flyout The flyout.\n   */\n  constructor(workspace: WorkspaceSvg, flyout: IFlyout) {\n    super(workspace);\n    this.flyout_ = flyout;\n  }\n\n  /**\n   * Gets the bounding box of the blocks on the flyout's workspace.\n   * This is in workspace coordinates.\n   *\n   * @returns The bounding box of the blocks on the workspace.\n   */\n  private getBoundingBox_():\n    | SVGRect\n    | {height: number; y: number; width: number; x: number} {\n    let blockBoundingBox;\n    try {\n      blockBoundingBox = this.workspace_.getCanvas().getBBox();\n    } catch (e) {\n      // Firefox has trouble with hidden elements (Bug 528969).\n      // 2021 Update: It looks like this was fixed around Firefox 77 released in\n      // 2020.\n      blockBoundingBox = {height: 0, y: 0, width: 0, x: 0};\n    }\n    return blockBoundingBox;\n  }\n\n  override getContentMetrics(opt_getWorkspaceCoordinates?: boolean) {\n    // The bounding box is in workspace coordinates.\n    const blockBoundingBox = this.getBoundingBox_();\n    const scale = opt_getWorkspaceCoordinates ? 1 : this.workspace_.scale;\n\n    return {\n      height: blockBoundingBox.height * scale,\n      width: blockBoundingBox.width * scale,\n      top: blockBoundingBox.y * scale,\n      left: blockBoundingBox.x * scale,\n    };\n  }\n\n  override getScrollMetrics(\n    opt_getWorkspaceCoordinates?: boolean,\n    opt_viewMetrics?: ContainerRegion,\n    opt_contentMetrics?: ContainerRegion\n  ) {\n    const contentMetrics = opt_contentMetrics || this.getContentMetrics();\n    const margin = this.flyout_.MARGIN * this.workspace_.scale;\n    const scale = opt_getWorkspaceCoordinates ? this.workspace_.scale : 1;\n\n    // The left padding isn't just the margin. Some blocks are also offset by\n    // tabWidth so that value and statement blocks line up.\n    // The contentMetrics.left value is equivalent to the variable left padding.\n    const leftPadding = contentMetrics.left;\n\n    return {\n      height: (contentMetrics.height + 2 * margin) / scale,\n      width: (contentMetrics.width + leftPadding + margin) / scale,\n      top: 0,\n      left: 0,\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a pair of scrollbars.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ScrollbarPair');\n\nimport * as eventUtils from './events/utils.js';\nimport {Scrollbar} from './scrollbar.js';\nimport * as dom from './utils/dom.js';\nimport type {Metrics} from './utils/metrics.js';\nimport {Svg} from './utils/svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a pair of scrollbars.  Horizontal and vertical.\n */\nexport class ScrollbarPair {\n  hScroll: Scrollbar | null = null;\n  vScroll: Scrollbar | null = null;\n  corner_: SVGRectElement | null = null;\n\n  /** Previously recorded metrics from the workspace. */\n  private oldHostMetrics_: Metrics | null = null;\n\n  /**\n   * @param workspace Workspace to bind the scrollbars to.\n   * @param addHorizontal Whether to add a horizontal scrollbar.\n   *    Defaults to true.\n   * @param addVertical Whether to add a vertical scrollbar. Defaults to true.\n   * @param opt_class A class to be applied to these scrollbars.\n   * @param opt_margin The margin to apply to these scrollbars.\n   */\n  constructor(\n    private workspace: WorkspaceSvg,\n    addHorizontal?: boolean,\n    addVertical?: boolean,\n    opt_class?: string,\n    opt_margin?: number\n  ) {\n    addHorizontal = addHorizontal === undefined ? true : addHorizontal;\n    addVertical = addVertical === undefined ? true : addVertical;\n    const isPair = addHorizontal && addVertical;\n\n    if (addHorizontal) {\n      this.hScroll = new Scrollbar(\n        workspace,\n        true,\n        isPair,\n        opt_class,\n        opt_margin\n      );\n    }\n    if (addVertical) {\n      this.vScroll = new Scrollbar(\n        workspace,\n        false,\n        isPair,\n        opt_class,\n        opt_margin\n      );\n    }\n\n    if (isPair) {\n      this.corner_ = dom.createSvgElement(Svg.RECT, {\n        'height': Scrollbar.scrollbarThickness,\n        'width': Scrollbar.scrollbarThickness,\n        'class': 'blocklyScrollbarBackground',\n      });\n      dom.insertAfter(this.corner_, workspace.getBubbleCanvas());\n    }\n  }\n\n  /**\n   * Dispose of this pair of scrollbars.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    dom.removeNode(this.corner_);\n    this.corner_ = null;\n    this.oldHostMetrics_ = null;\n    if (this.hScroll) {\n      this.hScroll.dispose();\n      this.hScroll = null;\n    }\n    if (this.vScroll) {\n      this.vScroll.dispose();\n      this.vScroll = null;\n    }\n  }\n\n  /**\n   * Recalculate both of the scrollbars' locations and lengths.\n   * Also reposition the corner rectangle.\n   */\n  resize() {\n    // Look up the host metrics once, and use for both scrollbars.\n    const hostMetrics = this.workspace.getMetrics();\n    if (!hostMetrics) {\n      // Host element is likely not visible.\n      return;\n    }\n\n    // Only change the scrollbars if there has been a change in metrics.\n    let resizeH = false;\n    let resizeV = false;\n    if (\n      !this.oldHostMetrics_ ||\n      this.oldHostMetrics_.viewWidth !== hostMetrics.viewWidth ||\n      this.oldHostMetrics_.viewHeight !== hostMetrics.viewHeight ||\n      this.oldHostMetrics_.absoluteTop !== hostMetrics.absoluteTop ||\n      this.oldHostMetrics_.absoluteLeft !== hostMetrics.absoluteLeft\n    ) {\n      // The window has been resized or repositioned.\n      resizeH = true;\n      resizeV = true;\n    } else {\n      // Has the content been resized or moved?\n      if (\n        !this.oldHostMetrics_ ||\n        this.oldHostMetrics_.scrollWidth !== hostMetrics.scrollWidth ||\n        this.oldHostMetrics_.viewLeft !== hostMetrics.viewLeft ||\n        this.oldHostMetrics_.scrollLeft !== hostMetrics.scrollLeft\n      ) {\n        resizeH = true;\n      }\n      if (\n        !this.oldHostMetrics_ ||\n        this.oldHostMetrics_.scrollHeight !== hostMetrics.scrollHeight ||\n        this.oldHostMetrics_.viewTop !== hostMetrics.viewTop ||\n        this.oldHostMetrics_.scrollTop !== hostMetrics.scrollTop\n      ) {\n        resizeV = true;\n      }\n    }\n\n    if (resizeH || resizeV) {\n      try {\n        eventUtils.disable();\n        if (this.hScroll && resizeH) {\n          this.hScroll.resize(hostMetrics);\n        }\n        if (this.vScroll && resizeV) {\n          this.vScroll.resize(hostMetrics);\n        }\n      } finally {\n        eventUtils.enable();\n      }\n      this.workspace.maybeFireViewportChangeEvent();\n    }\n\n    if (this.hScroll && this.vScroll) {\n      // Reposition the corner square.\n      if (\n        !this.oldHostMetrics_ ||\n        this.oldHostMetrics_.viewWidth !== hostMetrics.viewWidth ||\n        this.oldHostMetrics_.absoluteLeft !== hostMetrics.absoluteLeft\n      ) {\n        this.corner_?.setAttribute('x', String(this.vScroll.position.x));\n      }\n      if (\n        !this.oldHostMetrics_ ||\n        this.oldHostMetrics_.viewHeight !== hostMetrics.viewHeight ||\n        this.oldHostMetrics_.absoluteTop !== hostMetrics.absoluteTop\n      ) {\n        this.corner_?.setAttribute('y', String(this.hScroll.position.y));\n      }\n    }\n\n    // Cache the current metrics to potentially short-cut the next resize event.\n    this.oldHostMetrics_ = hostMetrics;\n  }\n\n  /**\n   * Returns whether scrolling horizontally is enabled.\n   *\n   * @returns True if horizontal scroll is enabled.\n   */\n  canScrollHorizontally(): boolean {\n    return !!this.hScroll;\n  }\n\n  /**\n   * Returns whether scrolling vertically is enabled.\n   *\n   * @returns True if vertical scroll is enabled.\n   */\n  canScrollVertically(): boolean {\n    return !!this.vScroll;\n  }\n\n  /**\n   * Record the origin of the workspace that the scrollbar is in, in pixels\n   * relative to the injection div origin. This is for times when the scrollbar\n   * is used in an object whose origin isn't the same as the main workspace\n   * (e.g. in a flyout.)\n   *\n   * @param x The x coordinate of the scrollbar's origin, in CSS pixels.\n   * @param y The y coordinate of the scrollbar's origin, in CSS pixels.\n   * @internal\n   */\n  setOrigin(x: number, y: number) {\n    if (this.hScroll) {\n      this.hScroll.setOrigin(x, y);\n    }\n    if (this.vScroll) {\n      this.vScroll.setOrigin(x, y);\n    }\n  }\n\n  /**\n   * Set the handles of both scrollbars.\n   *\n   * @param x The horizontal content displacement, relative to the view in\n   *     pixels.\n   * @param y The vertical content displacement, relative to the view in pixels.\n   * @param updateMetrics Whether to update metrics on this set call.\n   *    Defaults to true.\n   */\n  set(x: number, y: number, updateMetrics: boolean) {\n    // This function is equivalent to:\n    //   this.hScroll.set(x);\n    //   this.vScroll.set(y);\n    // However, that calls setMetrics twice which causes a chain of\n    // getAttribute->setAttribute->getAttribute resulting in an extra layout\n    // pass. Combining them speeds up rendering.\n    if (this.hScroll) {\n      this.hScroll.set(x, false);\n    }\n    if (this.vScroll) {\n      this.vScroll.set(y, false);\n    }\n\n    if (updateMetrics || updateMetrics === undefined) {\n      // Update metrics.\n      const xyRatio: {x?: number; y?: number} = {};\n      if (this.hScroll) {\n        xyRatio.x = this.hScroll.getRatio_();\n      }\n      if (this.vScroll) {\n        xyRatio.y = this.vScroll.getRatio_();\n      }\n      this.workspace.setMetrics(xyRatio);\n    }\n  }\n\n  /**\n   * Set the handle of the horizontal scrollbar to be at a certain position in\n   *    CSS pixels relative to its parents.\n   *\n   * @param x Horizontal scroll value.\n   */\n  setX(x: number) {\n    if (this.hScroll) {\n      this.hScroll.set(x, true);\n    }\n  }\n\n  /**\n   * Set the handle of the vertical scrollbar to be at a certain position in\n   *    CSS pixels relative to its parents.\n   *\n   * @param y Vertical scroll value.\n   */\n  setY(y: number) {\n    if (this.vScroll) {\n      this.vScroll.set(y, true);\n    }\n  }\n\n  /**\n   * Set whether this scrollbar's container is visible.\n   *\n   * @param visible Whether the container is visible.\n   */\n  setContainerVisible(visible: boolean) {\n    if (this.hScroll) {\n      this.hScroll.setContainerVisible(visible);\n    }\n    if (this.vScroll) {\n      this.vScroll.setContainerVisible(visible);\n    }\n  }\n\n  /**\n   * If any of the scrollbars are visible. Non-paired scrollbars may disappear\n   * when they aren't needed.\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    let isVisible = false;\n    if (this.hScroll) {\n      isVisible = this.hScroll.isVisible();\n    }\n    if (this.vScroll) {\n      isVisible = isVisible || this.vScroll.isVisible();\n    }\n    return isVisible;\n  }\n\n  /**\n   * Recalculates the scrollbars' locations within their path and length.\n   * This should be called when the contents of the workspace have changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeContent(hostMetrics: Metrics) {\n    if (this.hScroll) {\n      this.hScroll.resizeContentHorizontal(hostMetrics);\n    }\n    if (this.vScroll) {\n      this.vScroll.resizeContentVertical(hostMetrics);\n    }\n  }\n\n  /**\n   * Recalculates the scrollbars' locations on the screen and path length.\n   * This should be called when the layout or size of the window has changed.\n   *\n   * @param hostMetrics A data structure describing all the required dimensions,\n   *     possibly fetched from the host object.\n   */\n  resizeView(hostMetrics: Metrics) {\n    if (this.hScroll) {\n      this.hScroll.resizeViewHorizontal(hostMetrics);\n    }\n    if (this.vScroll) {\n      this.vScroll.resizeViewVertical(hostMetrics);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Methods for dragging a workspace visually.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WorkspaceDragger');\n\nimport * as common from './common.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a workspace dragger.  It moves the workspace around when it is\n * being dragged by a mouse or touch.\n *\n */\nexport class WorkspaceDragger {\n  private readonly horizontalScrollEnabled_: boolean;\n  private readonly verticalScrollEnabled_: boolean;\n  protected startScrollXY_: Coordinate;\n\n  /** @param workspace The workspace to drag. */\n  constructor(private workspace: WorkspaceSvg) {\n    /** Whether horizontal scroll is enabled. */\n    this.horizontalScrollEnabled_ = this.workspace.isMovableHorizontally();\n\n    /** Whether vertical scroll is enabled. */\n    this.verticalScrollEnabled_ = this.workspace.isMovableVertically();\n\n    /**\n     * The scroll position of the workspace at the beginning of the drag.\n     * Coordinate system: pixel coordinates.\n     */\n    this.startScrollXY_ = new Coordinate(workspace.scrollX, workspace.scrollY);\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    // AnyDuringMigration because:  Type 'null' is not assignable to type\n    // 'WorkspaceSvg'.\n    this.workspace = null as AnyDuringMigration;\n  }\n\n  /**\n   * Start dragging the workspace.\n   *\n   * @internal\n   */\n  startDrag() {\n    if (common.getSelected()) {\n      common.getSelected()!.unselect();\n    }\n  }\n\n  /**\n   * Finish dragging the workspace and put everything back where it belongs.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel coordinates.\n   * @internal\n   */\n  endDrag(currentDragDeltaXY: Coordinate) {\n    // Make sure everything is up to date.\n    this.drag(currentDragDeltaXY);\n  }\n\n  /**\n   * Move the workspace based on the most recent mouse movements.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at the start of the drag, in pixel coordinates.\n   * @internal\n   */\n  drag(currentDragDeltaXY: Coordinate) {\n    const newXY = Coordinate.sum(this.startScrollXY_, currentDragDeltaXY);\n\n    if (this.horizontalScrollEnabled_ && this.verticalScrollEnabled_) {\n      this.workspace.scroll(newXY.x, newXY.y);\n    } else if (this.horizontalScrollEnabled_) {\n      this.workspace.scroll(newXY.x, this.workspace.scrollY);\n    } else if (this.verticalScrollEnabled_) {\n      this.workspace.scroll(this.workspace.scrollX, newXY.y);\n    } else {\n      throw new TypeError('Invalid state.');\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The class representing an in-progress gesture, e.g. a drag,\n * tap, or pinch to zoom.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Gesture');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_click.js';\n\nimport * as blockAnimations from './block_animations.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport {BubbleDragger} from './bubble_dragger.js';\nimport * as common from './common.js';\nimport {config} from './config.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport * as eventUtils from './events/utils.js';\nimport type {Field} from './field.js';\nimport type {IBlockDragger} from './interfaces/i_block_dragger.js';\nimport type {IBubble} from './interfaces/i_bubble.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport * as internalConstants from './internal_constants.js';\nimport * as registry from './registry.js';\nimport * as Tooltip from './tooltip.js';\nimport * as Touch from './touch.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport {WorkspaceCommentSvg} from './workspace_comment_svg.js';\nimport {WorkspaceDragger} from './workspace_dragger.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\nimport type {IIcon} from './interfaces/i_icon.js';\n\n/**\n * Note: In this file \"start\" refers to pointerdown\n * events.  \"End\" refers to pointerup events.\n */\n\n/** A multiplier used to convert the gesture scale to a zoom in delta. */\nconst ZOOM_IN_MULTIPLIER = 5;\n\n/** A multiplier used to convert the gesture scale to a zoom out delta. */\nconst ZOOM_OUT_MULTIPLIER = 6;\n\n/**\n * Class for one gesture.\n */\nexport class Gesture {\n  /**\n   * The position of the pointer when the gesture started.  Units are CSS\n   * pixels, with (0, 0) at the top left of the browser window (pointer event\n   * clientX/Y).\n   */\n  private mouseDownXY = new Coordinate(0, 0);\n  private currentDragDeltaXY: Coordinate;\n\n  /**\n   * The bubble that the gesture started on, or null if it did not start on a\n   * bubble.\n   */\n  private startBubble: IBubble | null = null;\n\n  /**\n   * The field that the gesture started on, or null if it did not start on a\n   * field.\n   */\n  private startField: Field | null = null;\n\n  /**\n   * The icon that the gesture started on, or null if it did not start on an\n   * icon.\n   */\n  private startIcon: IIcon | null = null;\n\n  /**\n   * The block that the gesture started on, or null if it did not start on a\n   * block.\n   */\n  private startBlock: BlockSvg | null = null;\n\n  /**\n   * The block that this gesture targets.  If the gesture started on a\n   * shadow block, this is the first non-shadow parent of the block.  If the\n   * gesture started in the flyout, this is the root block of the block group\n   * that was clicked or dragged.\n   */\n  private targetBlock: BlockSvg | null = null;\n\n  /**\n   * The workspace that the gesture started on.  There may be multiple\n   * workspaces on a page; this is more accurate than using\n   * Blockly.common.getMainWorkspace().\n   */\n  protected startWorkspace_: WorkspaceSvg | null = null;\n\n  /**\n   * Whether the pointer has at any point moved out of the drag radius.\n   * A gesture that exceeds the drag radius is a drag even if it ends exactly\n   * at its start point.\n   */\n  private hasExceededDragRadius = false;\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  /** The object tracking a bubble drag, or null if none is in progress. */\n  private bubbleDragger: BubbleDragger | null = null;\n\n  /** The object tracking a block drag, or null if none is in progress. */\n  private blockDragger: IBlockDragger | null = null;\n\n  /**\n   * The object tracking a workspace or flyout workspace drag, or null if none\n   * is in progress.\n   */\n  private workspaceDragger: WorkspaceDragger | null = null;\n\n  /** The flyout a gesture started in, if any. */\n  private flyout: IFlyout | null = null;\n\n  /** Boolean for sanity-checking that some code is only called once. */\n  private calledUpdateIsDragging = false;\n\n  /** Boolean for sanity-checking that some code is only called once. */\n  private gestureHasStarted = false;\n\n  /** Boolean used internally to break a cycle in disposal. */\n  protected isEnding_ = false;\n  private healStack: boolean;\n\n  /** The event that most recently updated this gesture. */\n  private mostRecentEvent: PointerEvent;\n\n  /** Boolean for whether or not this gesture is a multi-touch gesture. */\n  private isMultiTouch_ = false;\n\n  /** A map of cached points used for tracking multi-touch gestures. */\n  private cachedPoints = new Map<string, Coordinate | null>();\n\n  /**\n   * This is the ratio between the starting distance between the touch points\n   * and the most recent distance between the touch points.\n   * Scales between 0 and 1 mean the most recent zoom was a zoom out.\n   * Scales above 1.0 mean the most recent zoom was a zoom in.\n   */\n  private previousScale = 0;\n\n  /** The starting distance between two touch points. */\n  private startDistance = 0;\n\n  /** Boolean for whether or not the workspace supports pinch-zoom. */\n  private isPinchZoomEnabled: boolean | null = null;\n\n  /**\n   * The owner of the dropdownDiv when this gesture first starts.\n   * Needed because we'll close the dropdown before fields get to\n   * act on their events, and some fields care about who owns\n   * the dropdown.\n   */\n  currentDropdownOwner: Field | null = null;\n\n  /**\n   * @param e The event that kicked off this gesture.\n   * @param creatorWorkspace The workspace that created this gesture and has a\n   *     reference to it.\n   */\n  constructor(\n    e: PointerEvent,\n    private readonly creatorWorkspace: WorkspaceSvg\n  ) {\n    this.mostRecentEvent = e;\n\n    /**\n     * How far the pointer has moved during this drag, in pixel units.\n     * (0, 0) is at this.mouseDownXY_.\n     */\n    this.currentDragDeltaXY = new Coordinate(0, 0);\n\n    /**\n     * Boolean used to indicate whether or not to heal the stack after\n     * disconnecting a block.\n     */\n    this.healStack = !internalConstants.DRAG_STACK;\n  }\n\n  /**\n   * Sever all links from this object.\n   *\n   * @internal\n   */\n  dispose() {\n    Touch.clearTouchIdentifier();\n    Tooltip.unblock();\n    // Clear the owner's reference to this gesture.\n    this.creatorWorkspace.clearGesture();\n\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n\n    if (this.blockDragger) {\n      this.blockDragger.dispose();\n    }\n    if (this.workspaceDragger) {\n      this.workspaceDragger.dispose();\n    }\n  }\n\n  /**\n   * Update internal state based on an event.\n   *\n   * @param e The most recent pointer event.\n   */\n  private updateFromEvent(e: PointerEvent) {\n    const currentXY = new Coordinate(e.clientX, e.clientY);\n    const changed = this.updateDragDelta(currentXY);\n    // Exceeded the drag radius for the first time.\n    if (changed) {\n      this.updateIsDragging();\n      Touch.longStop();\n    }\n    this.mostRecentEvent = e;\n  }\n\n  /**\n   * DO MATH to set currentDragDeltaXY_ based on the most recent pointer\n   * position.\n   *\n   * @param currentXY The most recent pointer position, in pixel units,\n   *     with (0, 0) at the window's top left corner.\n   * @returns True if the drag just exceeded the drag radius for the first time.\n   */\n  private updateDragDelta(currentXY: Coordinate): boolean {\n    this.currentDragDeltaXY = Coordinate.difference(\n      currentXY,\n      this.mouseDownXY\n    );\n\n    if (!this.hasExceededDragRadius) {\n      const currentDragDelta = Coordinate.magnitude(this.currentDragDeltaXY);\n\n      // The flyout has a different drag radius from the rest of Blockly.\n      const limitRadius = this.flyout\n        ? config.flyoutDragRadius\n        : config.dragRadius;\n\n      this.hasExceededDragRadius = currentDragDelta > limitRadius;\n      return this.hasExceededDragRadius;\n    }\n    return false;\n  }\n\n  /**\n   * Update this gesture to record whether a block is being dragged from the\n   * flyout.\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a block should be dragged from the flyout this function creates\n   * the new block on the main workspace and updates targetBlock_ and\n   * startWorkspace_.\n   *\n   * @returns True if a block is being dragged from the flyout.\n   */\n  private updateIsDraggingFromFlyout(): boolean {\n    if (!this.targetBlock || !this.flyout?.isBlockCreatable(this.targetBlock)) {\n      return false;\n    }\n    if (!this.flyout.targetWorkspace) {\n      throw new Error(`Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined`);\n    }\n    if (\n      !this.flyout.isScrollable() ||\n      this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)\n    ) {\n      this.startWorkspace_ = this.flyout.targetWorkspace;\n      this.startWorkspace_.updateScreenCalculationsIfScrolled();\n      // Start the event group now, so that the same event group is used for\n      // block creation and block dragging.\n      if (!eventUtils.getGroup()) {\n        eventUtils.setGroup(true);\n      }\n      // The start block is no longer relevant, because this is a drag.\n      this.startBlock = null;\n      this.targetBlock = this.flyout.createBlock(this.targetBlock);\n      this.targetBlock.select();\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Update this gesture to record whether a bubble is being dragged.\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a bubble should be dragged this function creates the necessary\n   * BubbleDragger and starts the drag.\n   *\n   * @returns True if a bubble is being dragged.\n   */\n  private updateIsDraggingBubble(): boolean {\n    if (!this.startBubble) {\n      return false;\n    }\n\n    this.startDraggingBubble();\n    return true;\n  }\n\n  /**\n   * Check whether to start a block drag. If a block should be dragged, either\n   * from the flyout or in the workspace, create the necessary BlockDragger and\n   * start the drag.\n   *\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a block should be dragged, either from the flyout or in the\n   * workspace, this function creates the necessary BlockDragger and starts the\n   * drag.\n   *\n   * @returns True if a block is being dragged.\n   */\n  private updateIsDraggingBlock(): boolean {\n    if (!this.targetBlock) {\n      return false;\n    }\n    if (this.flyout) {\n      if (this.updateIsDraggingFromFlyout()) {\n        this.startDraggingBlock();\n        return true;\n      }\n    } else if (this.targetBlock.isMovable()) {\n      this.startDraggingBlock();\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Check whether to start a workspace drag. If a workspace is being dragged,\n   * create the necessary WorkspaceDragger and start the drag.\n   *\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture. If a workspace is being dragged this function creates the\n   * necessary WorkspaceDragger and starts the drag.\n   */\n  private updateIsDraggingWorkspace() {\n    if (!this.startWorkspace_) {\n      throw new Error(\n        'Cannot update dragging the workspace because the ' +\n          'start workspace is undefined'\n      );\n    }\n\n    const wsMovable = this.flyout\n      ? this.flyout.isScrollable()\n      : this.startWorkspace_ && this.startWorkspace_.isDraggable();\n    if (!wsMovable) return;\n\n    this.workspaceDragger = new WorkspaceDragger(this.startWorkspace_);\n\n    this.workspaceDragger.startDrag();\n  }\n\n  /**\n   * Update this gesture to record whether anything is being dragged.\n   * This function should be called on a pointermove event the first time\n   * the drag radius is exceeded.  It should be called no more than once per\n   * gesture.\n   */\n  private updateIsDragging() {\n    // Sanity check.\n    if (this.calledUpdateIsDragging) {\n      throw Error('updateIsDragging_ should only be called once per gesture.');\n    }\n    this.calledUpdateIsDragging = true;\n\n    // First check if it was a bubble drag.  Bubbles always sit on top of\n    // blocks.\n    if (this.updateIsDraggingBubble()) {\n      return;\n    }\n    // Then check if it was a block drag.\n    if (this.updateIsDraggingBlock()) {\n      return;\n    }\n    // Then check if it's a workspace drag.\n    this.updateIsDraggingWorkspace();\n  }\n\n  /** Create a block dragger and start dragging the selected block. */\n  private startDraggingBlock() {\n    const BlockDraggerClass = registry.getClassFromOptions(\n      registry.Type.BLOCK_DRAGGER,\n      this.creatorWorkspace.options,\n      true\n    );\n\n    this.blockDragger = new BlockDraggerClass!(\n      this.targetBlock,\n      this.startWorkspace_\n    );\n    this.blockDragger!.startDrag(this.currentDragDeltaXY, this.healStack);\n    this.blockDragger!.drag(this.mostRecentEvent, this.currentDragDeltaXY);\n  }\n\n  /** Create a bubble dragger and start dragging the selected bubble. */\n  private startDraggingBubble() {\n    if (!this.startBubble) {\n      throw new Error(\n        'Cannot update dragging the bubble because the start ' +\n          'bubble is undefined'\n      );\n    }\n    if (!this.startWorkspace_) {\n      throw new Error(\n        'Cannot update dragging the bubble because the start ' +\n          'workspace is undefined'\n      );\n    }\n\n    this.bubbleDragger = new BubbleDragger(\n      this.startBubble,\n      this.startWorkspace_\n    );\n    this.bubbleDragger.startBubbleDrag();\n    this.bubbleDragger.dragBubble(\n      this.mostRecentEvent,\n      this.currentDragDeltaXY\n    );\n  }\n\n  /**\n   * Start a gesture: update the workspace to indicate that a gesture is in\n   * progress and bind pointermove and pointerup handlers.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  doStart(e: PointerEvent) {\n    if (!this.startWorkspace_) {\n      throw new Error(\n        'Cannot start the touch gesture becauase the start ' +\n          'workspace is undefined'\n      );\n    }\n    this.isPinchZoomEnabled =\n      this.startWorkspace_.options.zoomOptions &&\n      this.startWorkspace_.options.zoomOptions.pinch;\n\n    if (browserEvents.isTargetInput(e)) {\n      this.cancel();\n      return;\n    }\n\n    this.gestureHasStarted = true;\n\n    blockAnimations.disconnectUiStop();\n\n    this.startWorkspace_.updateScreenCalculationsIfScrolled();\n    if (this.startWorkspace_.isMutator) {\n      // Mutator's coordinate system could be out of date because the bubble was\n      // dragged, the block was moved, the parent workspace zoomed, etc.\n      this.startWorkspace_.resize();\n    }\n\n    // Keep track of which field owns the dropdown before we close it.\n    this.currentDropdownOwner = dropDownDiv.getOwner();\n    // Hide chaff also hides the flyout, so don't do it if the click is in a\n    // flyout.\n    this.startWorkspace_.hideChaff(!!this.flyout);\n\n    this.startWorkspace_.markFocused();\n    this.mostRecentEvent = e;\n\n    Tooltip.block();\n\n    if (this.targetBlock) {\n      this.targetBlock.select();\n    }\n\n    if (browserEvents.isRightButton(e)) {\n      this.handleRightClick(e);\n      return;\n    }\n\n    if (e.type.toLowerCase() === 'pointerdown' && e.pointerType !== 'mouse') {\n      Touch.longStart(e, this);\n    }\n\n    this.mouseDownXY = new Coordinate(e.clientX, e.clientY);\n    this.healStack = e.altKey || e.ctrlKey || e.metaKey;\n\n    this.bindMouseEvents(e);\n\n    if (!this.isEnding_) {\n      this.handleTouchStart(e);\n    }\n  }\n\n  /**\n   * Bind gesture events.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  bindMouseEvents(e: PointerEvent) {\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        document,\n        'pointerdown',\n        null,\n        this.handleStart.bind(this),\n        /* opt_noCaptureIdentifier */ true\n      )\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        document,\n        'pointermove',\n        null,\n        this.handleMove.bind(this),\n        /* opt_noCaptureIdentifier */ true\n      )\n    );\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        document,\n        'pointerup',\n        null,\n        this.handleUp.bind(this),\n        /* opt_noCaptureIdentifier */ true\n      )\n    );\n\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  /**\n   * Handle a pointerdown event.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  handleStart(e: PointerEvent) {\n    if (this.isDragging()) {\n      // A drag has already started, so this can no longer be a pinch-zoom.\n      return;\n    }\n    this.handleTouchStart(e);\n\n    if (this.isMultiTouch()) {\n      Touch.longStop();\n    }\n  }\n\n  /**\n   * Handle a pointermove event.\n   *\n   * @param e A pointermove event.\n   * @internal\n   */\n  handleMove(e: PointerEvent) {\n    if (\n      (this.isDragging() && Touch.shouldHandleEvent(e)) ||\n      !this.isMultiTouch()\n    ) {\n      this.updateFromEvent(e);\n      if (this.workspaceDragger) {\n        this.workspaceDragger.drag(this.currentDragDeltaXY);\n      } else if (this.blockDragger) {\n        this.blockDragger.drag(this.mostRecentEvent, this.currentDragDeltaXY);\n      } else if (this.bubbleDragger) {\n        this.bubbleDragger.dragBubble(\n          this.mostRecentEvent,\n          this.currentDragDeltaXY\n        );\n      }\n      e.preventDefault();\n      e.stopPropagation();\n    } else if (this.isMultiTouch()) {\n      this.handleTouchMove(e);\n      Touch.longStop();\n    }\n  }\n\n  /**\n   * Handle a pointerup event.\n   *\n   * @param e A pointerup event.\n   * @internal\n   */\n  handleUp(e: PointerEvent) {\n    if (!this.isDragging()) {\n      this.handleTouchEnd(e);\n    }\n    if (!this.isMultiTouch() || this.isDragging()) {\n      if (!Touch.shouldHandleEvent(e)) {\n        return;\n      }\n      this.updateFromEvent(e);\n      Touch.longStop();\n\n      if (this.isEnding_) {\n        console.log('Trying to end a gesture recursively.');\n        return;\n      }\n      this.isEnding_ = true;\n      // The ordering of these checks is important: drags have higher priority\n      // than clicks.  Fields and icons have higher priority than blocks; blocks\n      // have higher priority than workspaces. The ordering within drags does\n      // not matter, because the three types of dragging are exclusive.\n      if (this.bubbleDragger) {\n        this.bubbleDragger.endBubbleDrag(e, this.currentDragDeltaXY);\n      } else if (this.blockDragger) {\n        this.blockDragger.endDrag(e, this.currentDragDeltaXY);\n      } else if (this.workspaceDragger) {\n        this.workspaceDragger.endDrag(this.currentDragDeltaXY);\n      } else if (this.isBubbleClick()) {\n        // Bubbles are in front of all fields and blocks.\n        this.doBubbleClick();\n      } else if (this.isFieldClick()) {\n        this.doFieldClick();\n      } else if (this.isIconClick()) {\n        this.doIconClick();\n      } else if (this.isBlockClick()) {\n        this.doBlockClick();\n      } else if (this.isWorkspaceClick()) {\n        this.doWorkspaceClick(e);\n      }\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.dispose();\n    } else {\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.dispose();\n    }\n  }\n\n  /**\n   * Handle a pointerdown event and keep track of current\n   * pointers.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  handleTouchStart(e: PointerEvent) {\n    const pointerId = Touch.getTouchIdentifierFromEvent(e);\n    // store the pointerId in the current list of pointers\n    this.cachedPoints.set(pointerId, this.getTouchPoint(e));\n    const pointers = Array.from(this.cachedPoints.keys());\n    // If two pointers are down, store info\n    if (pointers.length === 2) {\n      const point0 = this.cachedPoints.get(pointers[0])!;\n      const point1 = this.cachedPoints.get(pointers[1])!;\n      this.startDistance = Coordinate.distance(point0, point1);\n      this.isMultiTouch_ = true;\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * Handle a pointermove event and zoom in/out if two pointers\n   * are on the screen.\n   *\n   * @param e A pointermove event.\n   * @internal\n   */\n  handleTouchMove(e: PointerEvent) {\n    const pointerId = Touch.getTouchIdentifierFromEvent(e);\n    // Update the cache\n    this.cachedPoints.set(pointerId, this.getTouchPoint(e));\n\n    if (this.isPinchZoomEnabled && this.cachedPoints.size === 2) {\n      this.handlePinch(e);\n    } else {\n      this.handleMove(e);\n    }\n  }\n\n  /**\n   * Handle pinch zoom gesture.\n   *\n   * @param e A pointermove event.\n   */\n  private handlePinch(e: PointerEvent) {\n    const pointers = Array.from(this.cachedPoints.keys());\n    // Calculate the distance between the two pointers\n    const point0 = this.cachedPoints.get(pointers[0])!;\n    const point1 = this.cachedPoints.get(pointers[1])!;\n    const moveDistance = Coordinate.distance(point0, point1);\n    const scale = moveDistance / this.startDistance;\n\n    if (this.previousScale > 0 && this.previousScale < Infinity) {\n      const gestureScale = scale - this.previousScale;\n      const delta =\n        gestureScale > 0\n          ? gestureScale * ZOOM_IN_MULTIPLIER\n          : gestureScale * ZOOM_OUT_MULTIPLIER;\n      if (!this.startWorkspace_) {\n        throw new Error(\n          'Cannot handle a pinch because the start workspace ' + 'is undefined'\n        );\n      }\n      const workspace = this.startWorkspace_;\n      const position = browserEvents.mouseToSvg(\n        e,\n        workspace.getParentSvg(),\n        workspace.getInverseScreenCTM()\n      );\n      workspace.zoom(position.x, position.y, delta);\n    }\n    this.previousScale = scale;\n    e.preventDefault();\n  }\n\n  /**\n   * Handle a pointerup event and end the gesture.\n   *\n   * @param e A pointerup event.\n   * @internal\n   */\n  handleTouchEnd(e: PointerEvent) {\n    const pointerId = Touch.getTouchIdentifierFromEvent(e);\n    if (this.cachedPoints.has(pointerId)) {\n      this.cachedPoints.delete(pointerId);\n    }\n    if (this.cachedPoints.size < 2) {\n      this.cachedPoints.clear();\n      this.previousScale = 0;\n    }\n  }\n\n  /**\n   * Helper function returning the current touch point coordinate.\n   *\n   * @param e A pointer event.\n   * @returns The current touch point coordinate\n   * @internal\n   */\n  getTouchPoint(e: PointerEvent): Coordinate | null {\n    if (!this.startWorkspace_) {\n      return null;\n    }\n    return new Coordinate(e.pageX, e.pageY);\n  }\n\n  /**\n   * Whether this gesture is part of a multi-touch gesture.\n   *\n   * @returns Whether this gesture is part of a multi-touch gesture.\n   * @internal\n   */\n  isMultiTouch(): boolean {\n    return this.isMultiTouch_;\n  }\n\n  /**\n   * Cancel an in-progress gesture.  If a workspace or block drag is in\n   * progress, end the drag at the most recent location.\n   *\n   * @internal\n   */\n  cancel() {\n    // Disposing of a block cancels in-progress drags, but dragging to a delete\n    // area disposes of a block and leads to recursive disposal. Break that\n    // cycle.\n    if (this.isEnding_) {\n      return;\n    }\n    Touch.longStop();\n    if (this.bubbleDragger) {\n      this.bubbleDragger.endBubbleDrag(\n        this.mostRecentEvent,\n        this.currentDragDeltaXY\n      );\n    } else if (this.blockDragger) {\n      this.blockDragger.endDrag(this.mostRecentEvent, this.currentDragDeltaXY);\n    } else if (this.workspaceDragger) {\n      this.workspaceDragger.endDrag(this.currentDragDeltaXY);\n    }\n    this.dispose();\n  }\n\n  /**\n   * Handle a real or faked right-click event by showing a context menu.\n   *\n   * @param e A pointerdown event.\n   * @internal\n   */\n  handleRightClick(e: PointerEvent) {\n    if (this.targetBlock) {\n      this.bringBlockToFront();\n      this.targetBlock.workspace.hideChaff(!!this.flyout);\n      this.targetBlock.showContextMenu(e);\n    } else if (this.startBubble) {\n      this.startBubble.showContextMenu(e);\n    } else if (this.startWorkspace_ && !this.flyout) {\n      this.startWorkspace_.hideChaff();\n      this.startWorkspace_.showContextMenu(e);\n    }\n\n    // TODO: Handle right-click on a bubble.\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.dispose();\n  }\n\n  /**\n   * Handle a pointerdown event on a workspace.\n   *\n   * @param e A pointerdown event.\n   * @param ws The workspace the event hit.\n   * @internal\n   */\n  handleWsStart(e: PointerEvent, ws: WorkspaceSvg) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleWsStart, ' +\n          'but the gesture had already been started.'\n      );\n    }\n    this.setStartWorkspace(ws);\n    this.mostRecentEvent = e;\n    this.doStart(e);\n  }\n\n  /**\n   * Fires a workspace click event.\n   *\n   * @param ws The workspace that a user clicks on.\n   */\n  private fireWorkspaceClick(ws: WorkspaceSvg) {\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.CLICK))(null, ws.id, 'workspace')\n    );\n  }\n\n  /**\n   * Handle a pointerdown event on a flyout.\n   *\n   * @param e A pointerdown event.\n   * @param flyout The flyout the event hit.\n   * @internal\n   */\n  handleFlyoutStart(e: PointerEvent, flyout: IFlyout) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleFlyoutStart, ' +\n          'but the gesture had already been started.'\n      );\n    }\n    this.setStartFlyout(flyout);\n    this.handleWsStart(e, flyout.getWorkspace());\n  }\n\n  /**\n   * Handle a pointerdown event on a block.\n   *\n   * @param e A pointerdown event.\n   * @param block The block the event hit.\n   * @internal\n   */\n  handleBlockStart(e: PointerEvent, block: BlockSvg) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleBlockStart, ' +\n          'but the gesture had already been started.'\n      );\n    }\n    this.setStartBlock(block);\n    this.mostRecentEvent = e;\n  }\n\n  /**\n   * Handle a pointerdown event on a bubble.\n   *\n   * @param e A pointerdown event.\n   * @param bubble The bubble the event hit.\n   * @internal\n   */\n  handleBubbleStart(e: PointerEvent, bubble: IBubble) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.handleBubbleStart, ' +\n          'but the gesture had already been started.'\n      );\n    }\n    this.setStartBubble(bubble);\n    this.mostRecentEvent = e;\n  }\n\n  /* Begin functions defining what actions to take to execute clicks on each\n   * type of target.  Any developer wanting to add behaviour on clicks should\n   * modify only this code. */\n\n  /** Execute a bubble click. */\n  private doBubbleClick() {\n    // TODO (#1673): Consistent handling of single clicks.\n    if (this.startBubble instanceof WorkspaceCommentSvg) {\n      this.startBubble.setFocus();\n      this.startBubble.select();\n    }\n  }\n\n  /** Execute a field click. */\n  private doFieldClick() {\n    if (!this.startField) {\n      throw new Error(\n        'Cannot do a field click because the start field is undefined'\n      );\n    }\n\n    // Only show the editor if the field's editor wasn't already open\n    // right before this gesture started.\n    const dropdownAlreadyOpen = this.currentDropdownOwner === this.startField;\n    if (!dropdownAlreadyOpen) {\n      this.startField.showEditor(this.mostRecentEvent);\n    }\n    this.bringBlockToFront();\n  }\n\n  /** Execute an icon click. */\n  private doIconClick() {\n    if (!this.startIcon) {\n      throw new Error(\n        'Cannot do an icon click because the start icon is undefined'\n      );\n    }\n\n    this.startIcon.onClick();\n  }\n\n  /** Execute a block click. */\n  private doBlockClick() {\n    // Block click in an autoclosing flyout.\n    if (this.flyout && this.flyout.autoClose) {\n      if (!this.targetBlock) {\n        throw new Error(\n          'Cannot do a block click because the target block is ' + 'undefined'\n        );\n      }\n      if (this.targetBlock.isEnabled()) {\n        if (!eventUtils.getGroup()) {\n          eventUtils.setGroup(true);\n        }\n        const newBlock = this.flyout.createBlock(this.targetBlock);\n        newBlock.scheduleSnapAndBump();\n      }\n    } else {\n      if (!this.startWorkspace_) {\n        throw new Error(\n          'Cannot do a block click because the start workspace ' +\n            'is undefined'\n        );\n      }\n      // Clicks events are on the start block, even if it was a shadow.\n      const event = new (eventUtils.get(eventUtils.CLICK))(\n        this.startBlock,\n        this.startWorkspace_.id,\n        'block'\n      );\n      eventUtils.fire(event);\n    }\n    this.bringBlockToFront();\n    eventUtils.setGroup(false);\n  }\n\n  /**\n   * Execute a workspace click. When in accessibility mode shift clicking will\n   * move the cursor.\n   *\n   * @param _e A pointerup event.\n   */\n  private doWorkspaceClick(_e: PointerEvent) {\n    const ws = this.creatorWorkspace;\n    if (common.getSelected()) {\n      common.getSelected()!.unselect();\n    }\n    this.fireWorkspaceClick(this.startWorkspace_ || ws);\n  }\n\n  /* End functions defining what actions to take to execute clicks on each type\n   * of target. */\n\n  // TODO (fenichel): Move bubbles to the front.\n\n  /**\n   * Move the dragged/clicked block to the front of the workspace so that it is\n   * not occluded by other blocks.\n   */\n  private bringBlockToFront() {\n    // Blocks in the flyout don't overlap, so skip the work.\n    if (this.targetBlock && !this.flyout) {\n      this.targetBlock.bringToFront();\n    }\n  }\n\n  /* Begin functions for populating a gesture at pointerdown. */\n\n  /**\n   * Record the field that a gesture started on.\n   *\n   * @param field The field the gesture started on.\n   * @internal\n   */\n  setStartField<T>(field: Field<T>) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.setStartField, ' +\n          'but the gesture had already been started.'\n      );\n    }\n    if (!this.startField) {\n      this.startField = field as Field;\n    }\n  }\n\n  /**\n   * Record the icon that a gesture started on.\n   *\n   * @param icon The icon the gesture started on.\n   * @internal\n   */\n  setStartIcon(icon: IIcon) {\n    if (this.gestureHasStarted) {\n      throw Error(\n        'Tried to call gesture.setStartIcon, ' +\n          'but the gesture had already been started.'\n      );\n    }\n\n    if (!this.startIcon) this.startIcon = icon;\n  }\n\n  /**\n   * Record the bubble that a gesture started on\n   *\n   * @param bubble The bubble the gesture started on.\n   * @internal\n   */\n  setStartBubble(bubble: IBubble) {\n    if (!this.startBubble) {\n      this.startBubble = bubble;\n    }\n  }\n\n  /**\n   * Record the block that a gesture started on, and set the target block\n   * appropriately.\n   *\n   * @param block The block the gesture started on.\n   * @internal\n   */\n  setStartBlock(block: BlockSvg) {\n    // If the gesture already went through a bubble, don't set the start block.\n    if (!this.startBlock && !this.startBubble) {\n      this.startBlock = block;\n      if (block.isInFlyout && block !== block.getRootBlock()) {\n        this.setTargetBlock(block.getRootBlock());\n      } else {\n        this.setTargetBlock(block);\n      }\n    }\n  }\n\n  /**\n   * Record the block that a gesture targets, meaning the block that will be\n   * dragged if this turns into a drag.  If this block is a shadow, that will be\n   * its first non-shadow parent.\n   *\n   * @param block The block the gesture targets.\n   */\n  private setTargetBlock(block: BlockSvg) {\n    if (block.isShadow()) {\n      // Non-null assertion is fine b/c it is an invariant that shadows always\n      // have parents.\n      this.setTargetBlock(block.getParent()!);\n    } else {\n      this.targetBlock = block;\n    }\n  }\n\n  /**\n   * Record the workspace that a gesture started on.\n   *\n   * @param ws The workspace the gesture started on.\n   */\n  private setStartWorkspace(ws: WorkspaceSvg) {\n    if (!this.startWorkspace_) {\n      this.startWorkspace_ = ws;\n    }\n  }\n\n  /**\n   * Record the flyout that a gesture started on.\n   *\n   * @param flyout The flyout the gesture started on.\n   */\n  private setStartFlyout(flyout: IFlyout) {\n    if (!this.flyout) {\n      this.flyout = flyout;\n    }\n  }\n\n  /* End functions for populating a gesture at pointerdown. */\n\n  /* Begin helper functions defining types of clicks.  Any developer wanting\n   * to change the definition of a click should modify only this code. */\n\n  /**\n   * Whether this gesture is a click on a bubble.  This should only be called\n   * when ending a gesture (pointerup).\n   *\n   * @returns Whether this gesture was a click on a bubble.\n   */\n  private isBubbleClick(): boolean {\n    // A bubble click starts on a bubble and never escapes the drag radius.\n    const hasStartBubble = !!this.startBubble;\n    return hasStartBubble && !this.hasExceededDragRadius;\n  }\n\n  /**\n   * Whether this gesture is a click on a block.  This should only be called\n   * when ending a gesture (pointerup).\n   *\n   * @returns Whether this gesture was a click on a block.\n   */\n  private isBlockClick(): boolean {\n    // A block click starts on a block, never escapes the drag radius, and is\n    // not a field click.\n    const hasStartBlock = !!this.startBlock;\n    return (\n      hasStartBlock &&\n      !this.hasExceededDragRadius &&\n      !this.isFieldClick() &&\n      !this.isIconClick()\n    );\n  }\n\n  /**\n   * Whether this gesture is a click on a field.  This should only be called\n   * when ending a gesture (pointerup).\n   *\n   * @returns Whether this gesture was a click on a field.\n   */\n  private isFieldClick(): boolean {\n    const fieldClickable = this.startField\n      ? this.startField.isClickable()\n      : false;\n    return (\n      fieldClickable &&\n      !this.hasExceededDragRadius &&\n      (!this.flyout || !this.flyout.autoClose)\n    );\n  }\n\n  /** @returns Whether this gesture is a click on an icon. */\n  private isIconClick(): boolean {\n    return !!this.startIcon && !this.hasExceededDragRadius;\n  }\n\n  /**\n   * Whether this gesture is a click on a workspace.  This should only be called\n   * when ending a gesture (pointerup).\n   *\n   * @returns Whether this gesture was a click on a workspace.\n   */\n  private isWorkspaceClick(): boolean {\n    const onlyTouchedWorkspace =\n      !this.startBlock && !this.startBubble && !this.startField;\n    return onlyTouchedWorkspace && !this.hasExceededDragRadius;\n  }\n\n  /* End helper functions defining types of clicks. */\n\n  /**\n   * Whether this gesture is a drag of either a workspace or block.\n   * This function is called externally to block actions that cannot be taken\n   * mid-drag (e.g. using the keyboard to delete the selected blocks).\n   *\n   * @returns True if this gesture is a drag of a workspace or block.\n   * @internal\n   */\n  isDragging(): boolean {\n    return (\n      !!this.workspaceDragger || !!this.blockDragger || !!this.bubbleDragger\n    );\n  }\n\n  /**\n   * Whether this gesture has already been started.  In theory every pointerdown\n   * has a corresponding pointerup, but in reality it is possible to lose a\n   * pointerup, leaving an in-process gesture hanging.\n   *\n   * @returns Whether this gesture was a click on a workspace.\n   * @internal\n   */\n  hasStarted(): boolean {\n    return this.gestureHasStarted;\n  }\n\n  /**\n   * Get a list of the insertion markers that currently exist.  Block drags have\n   * 0, 1, or 2 insertion markers.\n   *\n   * @returns A possibly empty list of insertion marker blocks.\n   * @internal\n   */\n  getInsertionMarkers(): BlockSvg[] {\n    if (this.blockDragger) {\n      return this.blockDragger.getInsertionMarkers();\n    }\n    return [];\n  }\n\n  /**\n   * Gets the current dragger if an item is being dragged. Null if nothing is\n   * being dragged.\n   *\n   * @returns The dragger that is currently in use or null if no drag is in\n   *     progress.\n   */\n  getCurrentDragger(): WorkspaceDragger | BubbleDragger | IBlockDragger | null {\n    return this.blockDragger ?? this.workspaceDragger ?? this.bubbleDragger;\n  }\n\n  /**\n   * Is a drag or other gesture currently in progress on any workspace?\n   *\n   * @returns True if gesture is occurring.\n   */\n  static inProgress(): boolean {\n    const workspaces = common.getAllWorkspaces();\n    for (let i = 0, workspace; (workspace = workspaces[i]); i++) {\n      // Not actually necessarily a WorkspaceSvg, but it doesn't matter b/c\n      // we're just checking if the property exists. Theoretically we would\n      // want to use instanceof, but that causes a circular dependency.\n      if ((workspace as WorkspaceSvg).currentGesture_) {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object for configuring and updating a workspace grid in\n * Blockly.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Grid');\n\nimport * as dom from './utils/dom.js';\nimport {Svg} from './utils/svg.js';\nimport {GridOptions} from './options.js';\n\n/**\n * Class for a workspace's grid.\n */\nexport class Grid {\n  private readonly spacing: number;\n  private readonly length: number;\n  private readonly line1: SVGElement;\n  private readonly line2: SVGElement;\n  private readonly snapToGrid: boolean;\n\n  /**\n   * @param pattern The grid's SVG pattern, created during injection.\n   * @param options A dictionary of normalized options for the grid.\n   *     See grid documentation:\n   *     https://developers.google.com/blockly/guides/configure/web/grid\n   */\n  constructor(private pattern: SVGElement, options: GridOptions) {\n    /** The spacing of the grid lines (in px). */\n    this.spacing = options['spacing'] ?? 0;\n\n    /** How long the grid lines should be (in px). */\n    this.length = options['length'] ?? 1;\n\n    /** The horizontal grid line, if it exists. */\n    this.line1 = pattern.firstChild as SVGElement;\n\n    /** The vertical grid line, if it exists. */\n    this.line2 = this.line1 && (this.line1.nextSibling as SVGElement);\n\n    /** Whether blocks should snap to the grid. */\n    this.snapToGrid = options['snap'] ?? false;\n  }\n\n  /**\n   * Whether blocks should snap to the grid, based on the initial configuration.\n   *\n   * @returns True if blocks should snap, false otherwise.\n   * @internal\n   */\n  shouldSnap(): boolean {\n    return this.snapToGrid;\n  }\n\n  /**\n   * Get the spacing of the grid points (in px).\n   *\n   * @returns The spacing of the grid points.\n   * @internal\n   */\n  getSpacing(): number {\n    return this.spacing;\n  }\n\n  /**\n   * Get the ID of the pattern element, which should be randomized to avoid\n   * conflicts with other Blockly instances on the page.\n   *\n   * @returns The pattern ID.\n   * @internal\n   */\n  getPatternId(): string {\n    return this.pattern.id;\n  }\n\n  /**\n   * Update the grid with a new scale.\n   *\n   * @param scale The new workspace scale.\n   * @internal\n   */\n  update(scale: number) {\n    const safeSpacing = this.spacing * scale;\n\n    this.pattern.setAttribute('width', `${safeSpacing}`);\n    this.pattern.setAttribute('height', `${safeSpacing}`);\n\n    let half = Math.floor(this.spacing / 2) + 0.5;\n    let start = half - this.length / 2;\n    let end = half + this.length / 2;\n\n    half *= scale;\n    start *= scale;\n    end *= scale;\n\n    this.setLineAttributes(this.line1, scale, start, end, half, half);\n    this.setLineAttributes(this.line2, scale, half, half, start, end);\n  }\n\n  /**\n   * Set the attributes on one of the lines in the grid.  Use this to update the\n   * length and stroke width of the grid lines.\n   *\n   * @param line Which line to update.\n   * @param width The new stroke size (in px).\n   * @param x1 The new x start position of the line (in px).\n   * @param x2 The new x end position of the line (in px).\n   * @param y1 The new y start position of the line (in px).\n   * @param y2 The new y end position of the line (in px).\n   */\n  private setLineAttributes(\n    line: SVGElement,\n    width: number,\n    x1: number,\n    x2: number,\n    y1: number,\n    y2: number\n  ) {\n    if (line) {\n      line.setAttribute('stroke-width', `${width}`);\n      line.setAttribute('x1', `${x1}`);\n      line.setAttribute('y1', `${y1}`);\n      line.setAttribute('x2', `${x2}`);\n      line.setAttribute('y2', `${y2}`);\n    }\n  }\n\n  /**\n   * Move the grid to a new x and y position, and make sure that change is\n   * visible.\n   *\n   * @param x The new x position of the grid (in px).\n   * @param y The new y position of the grid (in px).\n   * @internal\n   */\n  moveTo(x: number, y: number) {\n    this.pattern.setAttribute('x', `${x}`);\n    this.pattern.setAttribute('y', `${y}`);\n  }\n\n  /**\n   * Create the DOM for the grid described by options.\n   *\n   * @param rnd A random ID to append to the pattern's ID.\n   * @param gridOptions The object containing grid configuration.\n   * @param defs The root SVG element for this workspace's defs.\n   * @returns The SVG element for the grid pattern.\n   * @internal\n   */\n  static createDom(\n    rnd: string,\n    gridOptions: GridOptions,\n    defs: SVGElement\n  ): SVGElement {\n    /*\n          <pattern id=\"blocklyGridPattern837493\" patternUnits=\"userSpaceOnUse\">\n            <rect stroke=\"#888\" />\n            <rect stroke=\"#888\" />\n          </pattern>\n        */\n    const gridPattern = dom.createSvgElement(\n      Svg.PATTERN,\n      {'id': 'blocklyGridPattern' + rnd, 'patternUnits': 'userSpaceOnUse'},\n      defs\n    );\n    // x1, y1, x1, x2 properties will be set later in update.\n    if ((gridOptions['length'] ?? 1) > 0 && (gridOptions['spacing'] ?? 0) > 0) {\n      dom.createSvgElement(\n        Svg.LINE,\n        {'stroke': gridOptions['colour']},\n        gridPattern\n      );\n      if (gridOptions['length'] ?? 1 > 1) {\n        dom.createSvgElement(\n          Svg.LINE,\n          {'stroke': gridOptions['colour']},\n          gridPattern\n        );\n      }\n    } else {\n      // Edge 16 doesn't handle empty patterns\n      dom.createSvgElement(Svg.LINE, {}, gridPattern);\n    }\n    return gridPattern;\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for handling variable and procedure names.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Names');\n\nimport {Msg} from './msg.js';\n// import * as Procedures from './procedures.js';\nimport type {VariableMap} from './variable_map.js';\nimport * as Variables from './variables.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Class for a database of entity names (variables, procedures, etc).\n */\nexport class Names {\n  static DEVELOPER_VARIABLE_TYPE: NameType;\n  private readonly variablePrefix: string;\n\n  /** A set of reserved words. */\n  private readonly reservedWords: Set<string>;\n\n  /**\n   * A map from type (e.g. name, procedure) to maps from names to generated\n   * names.\n   */\n  private readonly db = new Map<string, Map<string, string>>();\n\n  /** A set of used names to avoid collisions. */\n  private readonly dbReverse = new Set<string>();\n\n  /**\n   * The variable map from the workspace, containing Blockly variable models.\n   */\n  private variableMap: VariableMap | null = null;\n\n  /**\n   * @param reservedWordsList A comma-separated string of words that are illegal\n   *     for use as names in a language (e.g. 'new,if,this,...').\n   * @param opt_variablePrefix Some languages need a '$' or a namespace before\n   *     all variable names (but not procedure names).\n   */\n  constructor(reservedWordsList: string, opt_variablePrefix?: string) {\n    /** The prefix to attach to variable names in generated code. */\n    this.variablePrefix = opt_variablePrefix || '';\n\n    this.reservedWords = new Set<string>(\n      reservedWordsList ? reservedWordsList.split(',') : []\n    );\n  }\n\n  /**\n   * Empty the database and start from scratch.  The reserved words are kept.\n   */\n  reset() {\n    this.db.clear();\n    this.dbReverse.clear();\n    this.variableMap = null;\n  }\n\n  /**\n   * Set the variable map that maps from variable name to variable object.\n   *\n   * @param map The map to track.\n   */\n  setVariableMap(map: VariableMap) {\n    this.variableMap = map;\n  }\n\n  /**\n   * Get the name for a user-defined variable, based on its ID.\n   * This should only be used for variables of NameType VARIABLE.\n   *\n   * @param id The ID to look up in the variable map.\n   * @returns The name of the referenced variable, or null if there was no\n   *     variable map or the variable was not found in the map.\n   */\n  private getNameForUserVariable(id: string): string | null {\n    if (!this.variableMap) {\n      console.warn(\n        'Deprecated call to Names.prototype.getName without ' +\n          'defining a variable map. To fix, add the following code in your ' +\n          \"generator's init() function:\\n\" +\n          'Blockly.YourGeneratorName.nameDB_.setVariableMap(' +\n          'workspace.getVariableMap());'\n      );\n      return null;\n    }\n    const variable = this.variableMap.getVariableById(id);\n    if (variable) {\n      return variable.name;\n    }\n    return null;\n  }\n\n  /**\n   * Generate names for user variables, but only ones that are being used.\n   *\n   * @param workspace Workspace to generate variables from.\n   */\n  populateVariables(workspace: Workspace) {\n    const variables = Variables.allUsedVarModels(workspace);\n    for (let i = 0; i < variables.length; i++) {\n      this.getName(variables[i].getId(), NameType.VARIABLE);\n    }\n  }\n\n  /**\n   * Generate names for procedures.\n   *\n   * @param workspace Workspace to generate procedures from.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  populateProcedures(workspace: Workspace) {\n    throw new Error(\n      'The implementation of populateProcedures should be ' +\n        'monkey-patched in by blockly.ts'\n    );\n  }\n\n  /**\n   * Convert a Blockly entity name to a legal exportable entity name.\n   *\n   * @param nameOrId The Blockly entity name (no constraints) or variable ID.\n   * @param type The type of the name in Blockly ('VARIABLE', 'PROCEDURE',\n   *     'DEVELOPER_VARIABLE', etc...).\n   * @returns An entity name that is legal in the exported language.\n   */\n  getName(nameOrId: string, type: NameType | string): string {\n    let name = nameOrId;\n    if (type === NameType.VARIABLE) {\n      const varName = this.getNameForUserVariable(nameOrId);\n      if (varName) {\n        // Successful ID lookup.\n        name = varName;\n      }\n    }\n    const normalizedName = name.toLowerCase();\n\n    const isVar =\n      type === NameType.VARIABLE || type === NameType.DEVELOPER_VARIABLE;\n\n    const prefix = isVar ? this.variablePrefix : '';\n    if (!this.db.has(type)) {\n      this.db.set(type, new Map<string, string>());\n    }\n    const typeDb = this.db.get(type);\n    if (typeDb!.has(normalizedName)) {\n      return prefix + typeDb!.get(normalizedName);\n    }\n    const safeName = this.getDistinctName(name, type);\n    typeDb!.set(normalizedName, safeName.substr(prefix.length));\n    return safeName;\n  }\n\n  /**\n   * Return a list of all known user-created names of a specified name type.\n   *\n   * @param type The type of entity in Blockly ('VARIABLE', 'PROCEDURE',\n   *     'DEVELOPER_VARIABLE', etc...).\n   * @returns A list of Blockly entity names (no constraints).\n   */\n  getUserNames(type: NameType | string): string[] {\n    const userNames = this.db.get(type)?.keys();\n    return userNames ? Array.from(userNames) : [];\n  }\n\n  /**\n   * Convert a Blockly entity name to a legal exportable entity name.\n   * Ensure that this is a new name not overlapping any previously defined name.\n   * Also check against list of reserved words for the current language and\n   * ensure name doesn't collide.\n   *\n   * @param name The Blockly entity name (no constraints).\n   * @param type The type of entity in Blockly ('VARIABLE', 'PROCEDURE',\n   *     'DEVELOPER_VARIABLE', etc...).\n   * @returns An entity name that is legal in the exported language.\n   */\n  getDistinctName(name: string, type: NameType | string): string {\n    let safeName = this.safeName(name);\n    let i: number | null = null;\n    while (\n      this.dbReverse.has(safeName + (i ?? '')) ||\n      this.reservedWords.has(safeName + (i ?? ''))\n    ) {\n      // Collision with existing name.  Create a unique name.\n      i = i ? i + 1 : 2;\n    }\n    safeName += i ?? '';\n    this.dbReverse.add(safeName);\n    const isVar =\n      type === NameType.VARIABLE || type === NameType.DEVELOPER_VARIABLE;\n    const prefix = isVar ? this.variablePrefix : '';\n    return prefix + safeName;\n  }\n\n  /**\n   * Given a proposed entity name, generate a name that conforms to the\n   * [_A-Za-z][_A-Za-z0-9]* format that most languages consider legal for\n   * variable and function names.\n   *\n   * @param name Potentially illegal entity name.\n   * @returns Safe entity name.\n   */\n  private safeName(name: string): string {\n    if (!name) {\n      name = Msg['UNNAMED_KEY'] || 'unnamed';\n    } else {\n      // Unfortunately names in non-latin characters will look like\n      // _E9_9F_B3_E4_B9_90 which is pretty meaningless.\n      // https://github.com/google/blockly/issues/1654\n      name = encodeURI(name.replace(/ /g, '_')).replace(/[^\\w]/g, '_');\n      // Most languages don't allow names with leading numbers.\n      if ('0123456789'.indexOf(name[0]) !== -1) {\n        name = 'my_' + name;\n      }\n    }\n    return name;\n  }\n\n  /**\n   * Do the given two entity names refer to the same entity?\n   * Blockly names are case-insensitive.\n   *\n   * @param name1 First name.\n   * @param name2 Second name.\n   * @returns True if names are the same.\n   */\n  static equals(name1: string, name2: string): boolean {\n    // name1.localeCompare(name2) is slower.\n    return name1.toLowerCase() === name2.toLowerCase();\n  }\n}\n\nexport namespace Names {\n  /**\n   * Enum for the type of a name. Different name types may have different rules\n   * about collisions.\n   * When JavaScript (or most other languages) is generated, variable 'foo' and\n   * procedure 'foo' would collide.  However, Blockly has no such problems since\n   * variable get 'foo' and procedure call 'foo' are unambiguous.\n   * Therefore, Blockly keeps a separate name type to disambiguate.\n   * getName('foo', 'VARIABLE') = 'foo'\n   * getName('foo', 'PROCEDURE') = 'foo2'\n   *\n   */\n  export enum NameType {\n    DEVELOPER_VARIABLE = 'DEVELOPER_VARIABLE',\n    VARIABLE = 'VARIABLE',\n    PROCEDURE = 'PROCEDURE',\n  }\n}\n\nexport type NameType = Names.NameType;\nexport const NameType = Names.NameType;\n\n/**\n * Constant to separate developer variable names from user-defined variable\n * names when running generators.\n * A developer variable will be declared as a global in the generated code, but\n * will never be shown to the user in the workspace or stored in the variable\n * map.\n */\nNames.DEVELOPER_VARIABLE_TYPE = NameType.DEVELOPER_VARIABLE;\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {IProcedureMap} from './interfaces/i_procedure_map.js';\nimport type {IProcedureModel} from './interfaces/i_procedure_model.js';\nimport {isObservable} from './interfaces/i_observable.js';\n\nexport class ObservableProcedureMap\n  extends Map<string, IProcedureModel>\n  implements IProcedureMap\n{\n  /** @internal */\n  constructor() {\n    super();\n  }\n\n  /**\n   * Adds the given procedure model to the procedure map.\n   */\n  override set(id: string, proc: IProcedureModel): this {\n    if (this.get(id) === proc) return this;\n    super.set(id, proc);\n    if (isObservable(proc)) proc.startPublishing();\n    return this;\n  }\n\n  /**\n   * Deletes the ProcedureModel with the given ID from the procedure map (if it\n   * exists).\n   */\n  override delete(id: string): boolean {\n    const proc = this.get(id);\n    const existed = super.delete(id);\n    if (!existed) return existed;\n    if (isObservable(proc)) proc.stopPublishing();\n    return existed;\n  }\n\n  /**\n   * Removes all ProcedureModels from the procedure map.\n   */\n  override clear() {\n    if (!this.size) return;\n    for (const id of this.keys()) {\n      this.delete(id);\n    }\n  }\n\n  /**\n   * Adds the given ProcedureModel to the map of procedure models, so that\n   * blocks can find it.\n   */\n  add(proc: IProcedureModel): this {\n    return this.set(proc.getId(), proc);\n  }\n\n  /**\n   * Returns all of the procedures stored in this map.\n   */\n  getProcedures(): IProcedureModel[] {\n    return [...this.values()];\n  }\n}\n","/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {CommentIcon} from './icons/comment_icon.js';\nimport * as exceptions from './icons/exceptions.js';\nimport * as registry from './icons/registry.js';\nimport {MutatorIcon} from './icons/mutator_icon.js';\nimport {IconType} from './icons/icon_types.js';\n\nexport {CommentIcon, exceptions, registry, MutatorIcon, IconType};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object in charge of storing and updating a workspace theme\n *     and UI components.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ThemeManager');\n\nimport type {Theme} from './theme.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as dom from './utils/dom.js';\nimport type {Workspace} from './workspace.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for storing and updating a workspace's theme and UI components.\n */\nexport class ThemeManager {\n  /** A list of workspaces that are subscribed to this theme. */\n  private subscribedWorkspaces_: Workspace[] = [];\n  private componentDB = new Map<string, Component[]>();\n\n  /**\n   * @param workspace The main workspace.\n   * @param theme The workspace theme.\n   * @internal\n   */\n  constructor(private readonly workspace: WorkspaceSvg, private theme: Theme) {}\n\n  /**\n   * Get the workspace theme.\n   *\n   * @returns The workspace theme.\n   * @internal\n   */\n  getTheme(): Theme {\n    return this.theme;\n  }\n\n  /**\n   * Set the workspace theme, and refresh the workspace and all components.\n   *\n   * @param theme The workspace theme.\n   * @internal\n   */\n  setTheme(theme: Theme) {\n    const prevTheme = this.theme;\n    this.theme = theme;\n    // Set the theme name onto the injection div.\n    const injectionDiv = this.workspace.getInjectionDiv();\n    if (injectionDiv) {\n      if (prevTheme) {\n        const oldClassName = prevTheme.getClassName();\n        if (oldClassName) {\n          dom.removeClass(injectionDiv, oldClassName);\n        }\n      }\n      const newClassName = this.theme.getClassName();\n      if (newClassName) {\n        dom.addClass(injectionDiv, newClassName);\n      }\n    }\n\n    // Refresh all subscribed workspaces.\n    for (\n      let i = 0, workspace;\n      (workspace = this.subscribedWorkspaces_[i]);\n      i++\n    ) {\n      (workspace as WorkspaceSvg).refreshTheme();\n    }\n\n    // Refresh all registered Blockly UI components.\n    for (const [key, componentList] of this.componentDB) {\n      for (const component of componentList) {\n        const element = component.element;\n        const propertyName = component.propertyName;\n        const style = this.theme && this.theme.getComponentStyle(key);\n        element.style.setProperty(propertyName, style || '');\n      }\n    }\n\n    for (const workspace of this.subscribedWorkspaces_) {\n      (workspace as WorkspaceSvg).hideChaff();\n    }\n  }\n\n  /**\n   * Subscribe a workspace to changes to the selected theme.  If a new theme is\n   * set, the workspace is called to refresh its blocks.\n   *\n   * @param workspace The workspace to subscribe.\n   * @internal\n   */\n  subscribeWorkspace(workspace: Workspace) {\n    this.subscribedWorkspaces_.push(workspace);\n  }\n\n  /**\n   * Unsubscribe a workspace to changes to the selected theme.\n   *\n   * @param workspace The workspace to unsubscribe.\n   * @internal\n   */\n  unsubscribeWorkspace(workspace: Workspace) {\n    if (!arrayUtils.removeElem(this.subscribedWorkspaces_, workspace)) {\n      throw Error(\n        \"Cannot unsubscribe a workspace that hasn't been subscribed.\"\n      );\n    }\n  }\n\n  /**\n   * Subscribe an element to changes to the selected theme.  If a new theme is\n   * selected, the element's style is refreshed with the new theme's style.\n   *\n   * @param element The element to subscribe.\n   * @param componentName The name used to identify the component. This must be\n   *     the same name used to configure the style in the Theme object.\n   * @param propertyName The inline style property name to update.\n   * @internal\n   */\n  subscribe(\n    element: HTMLElement | SVGElement,\n    componentName: string,\n    propertyName: string\n  ) {\n    if (!this.componentDB.has(componentName)) {\n      this.componentDB.set(componentName, []);\n    }\n\n    // Add the element to our component map.\n    this.componentDB.get(componentName)!.push({element, propertyName});\n\n    // Initialize the element with its corresponding theme style.\n    const style = this.theme && this.theme.getComponentStyle(componentName);\n    element.style.setProperty(propertyName, style || '');\n  }\n\n  /**\n   * Unsubscribe an element to changes to the selected theme.\n   *\n   * @param element The element to unsubscribe.\n   * @internal\n   */\n  unsubscribe(element: HTMLElement | SVGElement) {\n    if (!element) {\n      return;\n    }\n    // Go through all component, and remove any references to this element.\n    for (const [componentName, elements] of this.componentDB) {\n      for (let i = elements.length - 1; i >= 0; i--) {\n        if (elements[i].element === element) {\n          elements.splice(i, 1);\n        }\n      }\n      // Clean up the component map entry if the list is empty.\n      if (!elements.length) {\n        this.componentDB.delete(componentName);\n      }\n    }\n  }\n\n  /**\n   * Dispose of this theme manager.\n   *\n   * @internal\n   */\n  dispose() {\n    this.subscribedWorkspaces_.length = 0;\n    this.componentDB.clear();\n  }\n}\n\nexport namespace ThemeManager {\n  /** The type for a Blockly UI Component. */\n  export interface Component {\n    element: HTMLElement | SVGElement;\n    propertyName: string;\n  }\n}\n\nexport type Component = ThemeManager.Component;\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a map of variables and their types.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.VariableMap');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_delete.js';\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_var_rename.js';\n\nimport type {Block} from './block.js';\nimport * as dialog from './dialog.js';\nimport * as eventUtils from './events/utils.js';\nimport {Msg} from './msg.js';\nimport {Names} from './names.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {VariableModel} from './variable_model.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Class for a variable map.  This contains a dictionary data structure with\n * variable types as keys and lists of variables as values.  The list of\n * variables are the type indicated by the key.\n */\nexport class VariableMap {\n  /**\n   * A map from variable type to list of variable names.  The lists contain\n   * all of the named variables in the workspace, including variables that are\n   * not currently in use.\n   */\n  private variableMap = new Map<string, VariableModel[]>();\n\n  /** @param workspace The workspace this map belongs to. */\n  constructor(public workspace: Workspace) {}\n\n  /** Clear the variable map.  Fires events for every deletion. */\n  clear() {\n    for (const variables of this.variableMap.values()) {\n      while (variables.length > 0) {\n        this.deleteVariable(variables[0]);\n      }\n    }\n    if (this.variableMap.size !== 0) {\n      throw Error('Non-empty variable map');\n    }\n  }\n\n  /* Begin functions for renaming variables. */\n  /**\n   * Rename the given variable by updating its name in the variable map.\n   *\n   * @param variable Variable to rename.\n   * @param newName New variable name.\n   * @internal\n   */\n  renameVariable(variable: VariableModel, newName: string) {\n    if (variable.name === newName) return;\n    const type = variable.type;\n    const conflictVar = this.getVariable(newName, type);\n    const blocks = this.workspace.getAllBlocks(false);\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    try {\n      // The IDs may match if the rename is a simple case change (name1 ->\n      // Name1).\n      if (!conflictVar || conflictVar.getId() === variable.getId()) {\n        this.renameVariableAndUses_(variable, newName, blocks);\n      } else {\n        this.renameVariableWithConflict_(\n          variable,\n          newName,\n          conflictVar,\n          blocks\n        );\n      }\n    } finally {\n      eventUtils.setGroup(existingGroup);\n    }\n  }\n\n  /**\n   * Rename a variable by updating its name in the variable map. Identify the\n   * variable to rename with the given ID.\n   *\n   * @param id ID of the variable to rename.\n   * @param newName New variable name.\n   */\n  renameVariableById(id: string, newName: string) {\n    const variable = this.getVariableById(id);\n    if (!variable) {\n      throw Error(\"Tried to rename a variable that didn't exist. ID: \" + id);\n    }\n\n    this.renameVariable(variable, newName);\n  }\n\n  /**\n   * Update the name of the given variable and refresh all references to it.\n   * The new name must not conflict with any existing variable names.\n   *\n   * @param variable Variable to rename.\n   * @param newName New variable name.\n   * @param blocks The list of all blocks in the workspace.\n   */\n  private renameVariableAndUses_(\n    variable: VariableModel,\n    newName: string,\n    blocks: Block[]\n  ) {\n    eventUtils.fire(\n      new (eventUtils.get(eventUtils.VAR_RENAME))(variable, newName)\n    );\n    variable.name = newName;\n    for (let i = 0; i < blocks.length; i++) {\n      blocks[i].updateVarName(variable);\n    }\n  }\n\n  /**\n   * Update the name of the given variable to the same name as an existing\n   * variable.  The two variables are coalesced into a single variable with the\n   * ID of the existing variable that was already using newName. Refresh all\n   * references to the variable.\n   *\n   * @param variable Variable to rename.\n   * @param newName New variable name.\n   * @param conflictVar The variable that was already using newName.\n   * @param blocks The list of all blocks in the workspace.\n   */\n  private renameVariableWithConflict_(\n    variable: VariableModel,\n    newName: string,\n    conflictVar: VariableModel,\n    blocks: Block[]\n  ) {\n    const type = variable.type;\n    const oldCase = conflictVar.name;\n\n    if (newName !== oldCase) {\n      // Simple rename to change the case and update references.\n      this.renameVariableAndUses_(conflictVar, newName, blocks);\n    }\n\n    // These blocks now refer to a different variable.\n    // These will fire change events.\n    for (let i = 0; i < blocks.length; i++) {\n      blocks[i].renameVarById(variable.getId(), conflictVar.getId());\n    }\n    // Finally delete the original variable, which is now unreferenced.\n    eventUtils.fire(new (eventUtils.get(eventUtils.VAR_DELETE))(variable));\n    // And remove it from the list.\n    arrayUtils.removeElem(this.variableMap.get(type)!, variable);\n  }\n\n  /* End functions for renaming variables. */\n  /**\n   * Create a variable with a given name, optional type, and optional ID.\n   *\n   * @param name The name of the variable. This must be unique across variables\n   *     and procedures.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   * @returns The newly created variable.\n   */\n  createVariable(\n    name: string,\n    opt_type?: string | null,\n    opt_id?: string | null\n  ): VariableModel {\n    let variable = this.getVariable(name, opt_type);\n    if (variable) {\n      if (opt_id && variable.getId() !== opt_id) {\n        throw Error(\n          'Variable \"' +\n            name +\n            '\" is already in use and its id is \"' +\n            variable.getId() +\n            '\" which conflicts with the passed in ' +\n            'id, \"' +\n            opt_id +\n            '\".'\n        );\n      }\n      // The variable already exists and has the same ID.\n      return variable;\n    }\n    if (opt_id && this.getVariableById(opt_id)) {\n      throw Error('Variable id, \"' + opt_id + '\", is already in use.');\n    }\n    const id = opt_id || idGenerator.genUid();\n    const type = opt_type || '';\n    variable = new VariableModel(this.workspace, name, type, id);\n\n    const variables = this.variableMap.get(type) || [];\n    variables.push(variable);\n    // Delete the list of variables of this type, and re-add it so that\n    // the most recent addition is at the end.\n    // This is used so the toolbox's set block is set to the most recent\n    // variable.\n    this.variableMap.delete(type);\n    this.variableMap.set(type, variables);\n\n    eventUtils.fire(new (eventUtils.get(eventUtils.VAR_CREATE))(variable));\n\n    return variable;\n  }\n\n  /* Begin functions for variable deletion. */\n  /**\n   * Delete a variable.\n   *\n   * @param variable Variable to delete.\n   */\n  deleteVariable(variable: VariableModel) {\n    const variableId = variable.getId();\n    const variableList = this.variableMap.get(variable.type);\n    if (variableList) {\n      for (let i = 0; i < variableList.length; i++) {\n        const tempVar = variableList[i];\n        if (tempVar.getId() === variableId) {\n          variableList.splice(i, 1);\n          eventUtils.fire(\n            new (eventUtils.get(eventUtils.VAR_DELETE))(variable)\n          );\n          if (variableList.length === 0) {\n            this.variableMap.delete(variable.type);\n          }\n          return;\n        }\n      }\n    }\n  }\n\n  /**\n   * Delete a variables by the passed in ID and all of its uses from this\n   * workspace. May prompt the user for confirmation.\n   *\n   * @param id ID of variable to delete.\n   */\n  deleteVariableById(id: string) {\n    const variable = this.getVariableById(id);\n    if (variable) {\n      // Check whether this variable is a function parameter before deleting.\n      const variableName = variable.name;\n      const uses = this.getVariableUsesById(id);\n      for (let i = 0, block; (block = uses[i]); i++) {\n        if (\n          block.type === 'procedures_defnoreturn' ||\n          block.type === 'procedures_defreturn'\n        ) {\n          const procedureName = String(block.getFieldValue('NAME'));\n          const deleteText = Msg['CANNOT_DELETE_VARIABLE_PROCEDURE']\n            .replace('%1', variableName)\n            .replace('%2', procedureName);\n          dialog.alert(deleteText);\n          return;\n        }\n      }\n\n      if (uses.length > 1) {\n        // Confirm before deleting multiple blocks.\n        const confirmText = Msg['DELETE_VARIABLE_CONFIRMATION']\n          .replace('%1', String(uses.length))\n          .replace('%2', variableName);\n        dialog.confirm(confirmText, (ok) => {\n          if (ok && variable) {\n            this.deleteVariableInternal(variable, uses);\n          }\n        });\n      } else {\n        // No confirmation necessary for a single block.\n        this.deleteVariableInternal(variable, uses);\n      }\n    } else {\n      console.warn(\"Can't delete non-existent variable: \" + id);\n    }\n  }\n\n  /**\n   * Deletes a variable and all of its uses from this workspace without asking\n   * the user for confirmation.\n   *\n   * @param variable Variable to delete.\n   * @param uses An array of uses of the variable.\n   * @internal\n   */\n  deleteVariableInternal(variable: VariableModel, uses: Block[]) {\n    const existingGroup = eventUtils.getGroup();\n    if (!existingGroup) {\n      eventUtils.setGroup(true);\n    }\n    try {\n      for (let i = 0; i < uses.length; i++) {\n        uses[i].dispose(true);\n      }\n      this.deleteVariable(variable);\n    } finally {\n      eventUtils.setGroup(existingGroup);\n    }\n  }\n  /* End functions for variable deletion. */\n  /**\n   * Find the variable by the given name and type and return it.  Return null if\n   *     it is not found.\n   *\n   * @param name The name to check for.\n   * @param opt_type The type of the variable.  If not provided it defaults to\n   *     the empty string, which is a specific type.\n   * @returns The variable with the given name, or null if it was not found.\n   */\n  getVariable(name: string, opt_type?: string | null): VariableModel | null {\n    const type = opt_type || '';\n    const list = this.variableMap.get(type);\n    if (list) {\n      for (let j = 0, variable; (variable = list[j]); j++) {\n        if (Names.equals(variable.name, name)) {\n          return variable;\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Find the variable by the given ID and return it.  Return null if not found.\n   *\n   * @param id The ID to check for.\n   * @returns The variable with the given ID.\n   */\n  getVariableById(id: string): VariableModel | null {\n    for (const variables of this.variableMap.values()) {\n      for (const variable of variables) {\n        if (variable.getId() === id) {\n          return variable;\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Get a list containing all of the variables of a specified type. If type is\n   *     null, return list of variables with empty string type.\n   *\n   * @param type Type of the variables to find.\n   * @returns The sought after variables of the passed in type. An empty array\n   *     if none are found.\n   */\n  getVariablesOfType(type: string | null): VariableModel[] {\n    type = type || '';\n    const variableList = this.variableMap.get(type);\n    if (variableList) {\n      return variableList.slice();\n    }\n    return [];\n  }\n\n  /**\n   * Return all variable and potential variable types.  This list always\n   * contains the empty string.\n   *\n   * @param ws The workspace used to look for potential variables. This can be\n   *     different than the workspace stored on this object if the passed in ws\n   *     is a flyout workspace.\n   * @returns List of variable types.\n   * @internal\n   */\n  getVariableTypes(ws: Workspace | null): string[] {\n    const variableTypes = new Set<string>(this.variableMap.keys());\n    if (ws && ws.getPotentialVariableMap()) {\n      for (const key of ws.getPotentialVariableMap()!.variableMap.keys()) {\n        variableTypes.add(key);\n      }\n    }\n    if (!variableTypes.has('')) {\n      variableTypes.add('');\n    }\n    return Array.from(variableTypes.values());\n  }\n\n  /**\n   * Return all variables of all types.\n   *\n   * @returns List of variable models.\n   */\n  getAllVariables(): VariableModel[] {\n    let allVariables: VariableModel[] = [];\n    for (const variables of this.variableMap.values()) {\n      allVariables = allVariables.concat(variables);\n    }\n    return allVariables;\n  }\n\n  /**\n   * Returns all of the variable names of all types.\n   *\n   * @returns All of the variable names of all types.\n   */\n  getAllVariableNames(): string[] {\n    return Array.from(this.variableMap.values())\n      .flat()\n      .map((variable) => variable.name);\n  }\n\n  /**\n   * Find all the uses of a named variable.\n   *\n   * @param id ID of the variable to find.\n   * @returns Array of block usages.\n   */\n  getVariableUsesById(id: string): Block[] {\n    const uses = [];\n    const blocks = this.workspace.getAllBlocks(false);\n    // Iterate through every block and check the name.\n    for (let i = 0; i < blocks.length; i++) {\n      const blockVariables = blocks[i].getVarModels();\n      if (blockVariables) {\n        for (let j = 0; j < blockVariables.length; j++) {\n          if (blockVariables[j].getId() === id) {\n            uses.push(blocks[i]);\n          }\n        }\n      }\n    }\n    return uses;\n  }\n}\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a workspace.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Workspace');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './connection_checker.js';\n\nimport type {Block} from './block.js';\nimport type {BlocklyOptions} from './blockly_options.js';\nimport type {ConnectionDB} from './connection_db.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport * as common from './common.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IASTNodeLocation} from './interfaces/i_ast_node_location.js';\nimport type {IConnectionChecker} from './interfaces/i_connection_checker.js';\nimport {Options} from './options.js';\nimport * as registry from './registry.js';\nimport * as arrayUtils from './utils/array.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport * as math from './utils/math.js';\nimport type * as toolbox from './utils/toolbox.js';\nimport {VariableMap} from './variable_map.js';\nimport type {VariableModel} from './variable_model.js';\nimport type {WorkspaceComment} from './workspace_comment.js';\nimport {IProcedureMap} from './interfaces/i_procedure_map.js';\nimport {ObservableProcedureMap} from './observable_procedure_map.js';\n\n/**\n * Class for a workspace.  This is a data structure that contains blocks.\n * There is no UI, and can be created headlessly.\n */\nexport class Workspace implements IASTNodeLocation {\n  /**\n   * Angle away from the horizontal to sweep for blocks.  Order of execution is\n   * generally top to bottom, but a small angle changes the scan to give a bit\n   * of a left to right bias (reversed in RTL).  Units are in degrees. See:\n   * https://tvtropes.org/pmwiki/pmwiki.php/Main/DiagonalBilling\n   */\n  static SCAN_ANGLE = 3;\n  id: string;\n  options: Options;\n  RTL: boolean;\n  horizontalLayout: boolean;\n  toolboxPosition: toolbox.Position;\n\n  /**\n   * Returns `true` if the workspace is visible and `false` if it's headless.\n   */\n  rendered = false;\n\n  /**\n   * Is this workspace the surface for a flyout?\n   *\n   * @internal\n   */\n  internalIsFlyout = false;\n\n  /** Is this workspace the surface for a flyout? */\n  get isFlyout(): boolean {\n    return this.internalIsFlyout;\n  }\n\n  /**\n   * Is this workspace the surface for a mutator?\n   *\n   * @internal\n   */\n  internalIsMutator = false;\n\n  /** Is this workspace the surface for a mutator? */\n  get isMutator(): boolean {\n    return this.internalIsMutator;\n  }\n\n  /**\n   * Returns `true` if the workspace is currently in the process of a bulk\n   * clear.\n   *\n   * @internal\n   */\n  isClearing = false;\n\n  /**\n   * Maximum number of undo events in stack. `0` turns off undo, `Infinity`\n   * sets it to unlimited.\n   */\n  MAX_UNDO = 1024;\n\n  /** Set of databases for rapid lookup of connection locations. */\n  connectionDBList: ConnectionDB[] = [];\n  connectionChecker: IConnectionChecker;\n\n  private readonly topBlocks: Block[] = [];\n  private readonly topComments: WorkspaceComment[] = [];\n  private readonly commentDB = new Map<string, WorkspaceComment>();\n  private readonly listeners: Function[] = [];\n  protected undoStack_: Abstract[] = [];\n  protected redoStack_: Abstract[] = [];\n  private readonly blockDB = new Map<string, Block>();\n  private readonly typedBlocksDB = new Map<string, Block[]>();\n  private variableMap: VariableMap;\n  private procedureMap: IProcedureMap = new ObservableProcedureMap();\n\n  /**\n   * Blocks in the flyout can refer to variables that don't exist in the main\n   * workspace.  For instance, the \"get item in list\" block refers to an\n   * \"item\" variable regardless of whether the variable has been created yet.\n   * A FieldVariable must always refer to a VariableModel.  We reconcile\n   * these by tracking \"potential\" variables in the flyout.  These variables\n   * become real when references to them are dragged into the main workspace.\n   */\n  private potentialVariableMap: VariableMap | null = null;\n\n  /** @param opt_options Dictionary of options. */\n  constructor(opt_options?: Options) {\n    this.id = idGenerator.genUid();\n    common.registerWorkspace(this);\n    this.options = opt_options || new Options({} as BlocklyOptions);\n    this.RTL = !!this.options.RTL;\n    this.horizontalLayout = !!this.options.horizontalLayout;\n    this.toolboxPosition = this.options.toolboxPosition;\n\n    const connectionCheckerClass = registry.getClassFromOptions(\n      registry.Type.CONNECTION_CHECKER,\n      this.options,\n      true\n    );\n    /**\n     * An object that encapsulates logic for safety, type, and dragging checks.\n     */\n    this.connectionChecker = new connectionCheckerClass!(this);\n\n    /**\n     * A map from variable type to list of variable names.  The lists contain\n     * all of the named variables in the workspace, including variables that are\n     * not currently in use.\n     */\n    this.variableMap = new VariableMap(this);\n  }\n\n  /**\n   * Dispose of this workspace.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.listeners.length = 0;\n    this.clear();\n    // Remove from workspace database.\n    common.unregisterWorkpace(this);\n  }\n\n  /**\n   * Compare function for sorting objects (blocks, comments, etc) by position;\n   *    top to bottom (with slight LTR or RTL bias).\n   *\n   * @param a The first object to compare.\n   * @param b The second object to compare.\n   * @returns The comparison value. This tells Array.sort() how to change object\n   *     a's index.\n   */\n  private sortObjects_(\n    a: Block | WorkspaceComment,\n    b: Block | WorkspaceComment\n  ): number {\n    const offset =\n      Math.sin(math.toRadians(Workspace.SCAN_ANGLE)) * (this.RTL ? -1 : 1);\n    const aXY = a.getRelativeToSurfaceXY();\n    const bXY = b.getRelativeToSurfaceXY();\n    return aXY.y + offset * aXY.x - (bXY.y + offset * bXY.x);\n  }\n\n  /**\n   * Adds a block to the list of top blocks.\n   *\n   * @param block Block to add.\n   */\n  addTopBlock(block: Block) {\n    this.topBlocks.push(block);\n  }\n\n  /**\n   * Removes a block from the list of top blocks.\n   *\n   * @param block Block to remove.\n   */\n  removeTopBlock(block: Block) {\n    if (!arrayUtils.removeElem(this.topBlocks, block)) {\n      throw Error(\"Block not present in workspace's list of top-most blocks.\");\n    }\n  }\n\n  /**\n   * Finds the top-level blocks and returns them.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns The top-level block objects.\n   */\n  getTopBlocks(ordered: boolean): Block[] {\n    // Copy the topBlocks list.\n    const blocks = new Array<Block>().concat(this.topBlocks);\n    if (ordered && blocks.length > 1) {\n      blocks.sort(this.sortObjects_.bind(this));\n    }\n    return blocks;\n  }\n\n  /**\n   * Add a block to the list of blocks keyed by type.\n   *\n   * @param block Block to add.\n   */\n  addTypedBlock(block: Block) {\n    if (!this.typedBlocksDB.has(block.type)) {\n      this.typedBlocksDB.set(block.type, []);\n    }\n    this.typedBlocksDB.get(block.type)!.push(block);\n  }\n\n  /**\n   * Remove a block from the list of blocks keyed by type.\n   *\n   * @param block Block to remove.\n   */\n  removeTypedBlock(block: Block) {\n    arrayUtils.removeElem(this.typedBlocksDB.get(block.type)!, block);\n    if (!this.typedBlocksDB.get(block.type)!.length) {\n      this.typedBlocksDB.delete(block.type);\n    }\n  }\n\n  /**\n   * Finds the blocks with the associated type and returns them. Blocks are\n   * optionally sorted by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param type The type of block to search for.\n   * @param ordered Sort the list if true.\n   * @returns The blocks of the given type.\n   */\n  getBlocksByType(type: string, ordered: boolean): Block[] {\n    if (!this.typedBlocksDB.has(type)) {\n      return [];\n    }\n    const blocks = this.typedBlocksDB.get(type)!.slice(0);\n    if (ordered && blocks && blocks.length > 1) {\n      blocks.sort(this.sortObjects_.bind(this));\n    }\n\n    return blocks.filter(function (block: Block) {\n      return !block.isInsertionMarker();\n    });\n  }\n\n  /**\n   * Adds a comment to the list of top comments.\n   *\n   * @param comment comment to add.\n   * @internal\n   */\n  addTopComment(comment: WorkspaceComment) {\n    this.topComments.push(comment);\n\n    // Note: If the comment database starts to hold block comments, this may\n    // need to move to a separate function.\n    if (this.commentDB.has(comment.id)) {\n      console.warn(\n        'Overriding an existing comment on this workspace, with id \"' +\n          comment.id +\n          '\"'\n      );\n    }\n    this.commentDB.set(comment.id, comment);\n  }\n\n  /**\n   * Removes a comment from the list of top comments.\n   *\n   * @param comment comment to remove.\n   * @internal\n   */\n  removeTopComment(comment: WorkspaceComment) {\n    if (!arrayUtils.removeElem(this.topComments, comment)) {\n      throw Error(\n        \"Comment not present in workspace's list of top-most \" + 'comments.'\n      );\n    }\n    // Note: If the comment database starts to hold block comments, this may\n    // need to move to a separate function.\n    this.commentDB.delete(comment.id);\n  }\n\n  /**\n   * Finds the top-level comments and returns them.  Comments are optionally\n   * sorted by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns The top-level comment objects.\n   * @internal\n   */\n  getTopComments(ordered: boolean): WorkspaceComment[] {\n    // Copy the topComments list.\n    const comments = new Array<WorkspaceComment>().concat(this.topComments);\n    if (ordered && comments.length > 1) {\n      comments.sort(this.sortObjects_.bind(this));\n    }\n    return comments;\n  }\n\n  /**\n   * Find all blocks in workspace.  Blocks are optionally sorted\n   * by position; top to bottom (with slight LTR or RTL bias).\n   *\n   * @param ordered Sort the list if true.\n   * @returns Array of blocks.\n   */\n  getAllBlocks(ordered: boolean): Block[] {\n    let blocks: Block[];\n    if (ordered) {\n      // Slow, but ordered.\n      const topBlocks = this.getTopBlocks(true);\n      blocks = [];\n      for (let i = 0; i < topBlocks.length; i++) {\n        blocks.push(...topBlocks[i].getDescendants(true));\n      }\n    } else {\n      // Fast, but in no particular order.\n      blocks = this.getTopBlocks(false);\n      for (let i = 0; i < blocks.length; i++) {\n        blocks.push(...blocks[i].getChildren(false));\n      }\n    }\n\n    // Insertion markers exist on the workspace for rendering reasons, but\n    // aren't \"real\" blocks from a developer perspective.\n    const filtered = blocks.filter(function (block) {\n      return !block.isInsertionMarker();\n    });\n\n    return filtered;\n  }\n\n  /** Dispose of all blocks and comments in workspace. */\n  clear() {\n    this.isClearing = true;\n    try {\n      const existingGroup = eventUtils.getGroup();\n      if (!existingGroup) {\n        eventUtils.setGroup(true);\n      }\n      while (this.topBlocks.length) {\n        this.topBlocks[0].dispose(false);\n      }\n      while (this.topComments.length) {\n        this.topComments[this.topComments.length - 1].dispose();\n      }\n      eventUtils.setGroup(existingGroup);\n      this.variableMap.clear();\n      if (this.potentialVariableMap) {\n        this.potentialVariableMap.clear();\n      }\n    } finally {\n      this.isClearing = false;\n    }\n  }\n\n  /* Begin functions that are just pass-throughs to the variable map. */\n  /**\n   * Rename a variable by updating its name in the variable map. Identify the\n   * variable to rename with the given ID.\n   *\n   * @param id ID of the variable to rename.\n   * @param newName New variable name.\n   */\n  renameVariableById(id: string, newName: string) {\n    this.variableMap.renameVariableById(id, newName);\n  }\n\n  /**\n   * Create a variable with a given name, optional type, and optional ID.\n   *\n   * @param name The name of the variable. This must be unique across variables\n   *     and procedures.\n   * @param opt_type The type of the variable like 'int' or 'string'.\n   *     Does not need to be unique. Field_variable can filter variables based\n   * on their type. This will default to '' which is a specific type.\n   * @param opt_id The unique ID of the variable. This will default to a UUID.\n   * @returns The newly created variable.\n   */\n  createVariable(\n    name: string,\n    opt_type?: string | null,\n    opt_id?: string | null\n  ): VariableModel {\n    return this.variableMap.createVariable(name, opt_type, opt_id);\n  }\n\n  /**\n   * Find all the uses of the given variable, which is identified by ID.\n   *\n   * @param id ID of the variable to find.\n   * @returns Array of block usages.\n   */\n  getVariableUsesById(id: string): Block[] {\n    return this.variableMap.getVariableUsesById(id);\n  }\n\n  /**\n   * Delete a variables by the passed in ID and all of its uses from this\n   * workspace. May prompt the user for confirmation.\n   *\n   * @param id ID of variable to delete.\n   */\n  deleteVariableById(id: string) {\n    this.variableMap.deleteVariableById(id);\n  }\n\n  /**\n   * Find the variable by the given name and return it. Return null if not\n   * found.\n   *\n   * @param name The name to check for.\n   * @param opt_type The type of the variable.  If not provided it defaults to\n   *     the empty string, which is a specific type.\n   * @returns The variable with the given name.\n   */\n  getVariable(name: string, opt_type?: string): VariableModel | null {\n    // TODO (#1559): Possibly delete this function after resolving #1559.\n    return this.variableMap.getVariable(name, opt_type);\n  }\n\n  /**\n   * Find the variable by the given ID and return it. Return null if not found.\n   *\n   * @param id The ID to check for.\n   * @returns The variable with the given ID.\n   */\n  getVariableById(id: string): VariableModel | null {\n    return this.variableMap.getVariableById(id);\n  }\n\n  /**\n   * Find the variable with the specified type. If type is null, return list of\n   *     variables with empty string type.\n   *\n   * @param type Type of the variables to find.\n   * @returns The sought after variables of the passed in type. An empty array\n   *     if none are found.\n   */\n  getVariablesOfType(type: string | null): VariableModel[] {\n    return this.variableMap.getVariablesOfType(type);\n  }\n\n  /**\n   * Return all variable types.\n   *\n   * @returns List of variable types.\n   * @internal\n   */\n  getVariableTypes(): string[] {\n    return this.variableMap.getVariableTypes(this);\n  }\n\n  /**\n   * Return all variables of all types.\n   *\n   * @returns List of variable models.\n   */\n  getAllVariables(): VariableModel[] {\n    return this.variableMap.getAllVariables();\n  }\n\n  /**\n   * Returns all variable names of all types.\n   *\n   * @returns List of all variable names of all types.\n   */\n  getAllVariableNames(): string[] {\n    return this.variableMap.getAllVariableNames();\n  }\n  /* End functions that are just pass-throughs to the variable map. */\n  /**\n   * Returns the horizontal offset of the workspace.\n   * Intended for LTR/RTL compatibility in XML.\n   * Not relevant for a headless workspace.\n   *\n   * @returns Width.\n   */\n  getWidth(): number {\n    return 0;\n  }\n\n  /* eslint-disable jsdoc/require-returns-check */\n  /* eslint-disable @typescript-eslint/no-unused-vars */\n  /**\n   * Obtain a newly created block.\n   *\n   * @param prototypeName Name of the language object containing type-specific\n   *     functions for this block.\n   * @param opt_id Optional ID.  Use this ID if provided, otherwise create a new\n   *     ID.\n   * @returns The created block.\n   */\n  newBlock(prototypeName: string, opt_id?: string): Block {\n    throw new Error(\n      'The implementation of newBlock should be ' +\n        'monkey-patched in by blockly.ts'\n    );\n  }\n  /* eslint-enable */\n\n  /**\n   * The number of blocks that may be added to the workspace before reaching\n   *     the maxBlocks.\n   *\n   * @returns Number of blocks left.\n   */\n  remainingCapacity(): number {\n    if (isNaN(this.options.maxBlocks)) {\n      return Infinity;\n    }\n\n    return this.options.maxBlocks - this.getAllBlocks(false).length;\n  }\n\n  /**\n   * The number of blocks of the given type that may be added to the workspace\n   *    before reaching the maxInstances allowed for that type.\n   *\n   * @param type Type of block to return capacity for.\n   * @returns Number of blocks of type left.\n   */\n  remainingCapacityOfType(type: string): number {\n    if (!this.options.maxInstances) {\n      return Infinity;\n    }\n\n    const maxInstanceOfType =\n      this.options.maxInstances[type] !== undefined\n        ? this.options.maxInstances[type]\n        : Infinity;\n\n    return maxInstanceOfType - this.getBlocksByType(type, false).length;\n  }\n\n  /**\n   * Check if there is remaining capacity for blocks of the given counts to be\n   *    created. If the total number of blocks represented by the map is more\n   * than the total remaining capacity, it returns false. If a type count is\n   * more than the remaining capacity for that type, it returns false.\n   *\n   * @param typeCountsMap A map of types to counts (usually representing blocks\n   *     to be created).\n   * @returns True if there is capacity for the given map, false otherwise.\n   */\n  isCapacityAvailable(typeCountsMap: {[key: string]: number}): boolean {\n    if (!this.hasBlockLimits()) {\n      return true;\n    }\n    let copyableBlocksCount = 0;\n    for (const type in typeCountsMap) {\n      if (typeCountsMap[type] > this.remainingCapacityOfType(type)) {\n        return false;\n      }\n      copyableBlocksCount += typeCountsMap[type];\n    }\n    if (copyableBlocksCount > this.remainingCapacity()) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Checks if the workspace has any limits on the maximum number of blocks,\n   *    or the maximum number of blocks of specific types.\n   *\n   * @returns True if it has block limits, false otherwise.\n   */\n  hasBlockLimits(): boolean {\n    return this.options.maxBlocks !== Infinity || !!this.options.maxInstances;\n  }\n\n  /**\n   * Gets the undo stack for workplace.\n   *\n   * @returns undo stack\n   * @internal\n   */\n  getUndoStack(): Abstract[] {\n    return this.undoStack_;\n  }\n\n  /**\n   * Gets the redo stack for workplace.\n   *\n   * @returns redo stack\n   * @internal\n   */\n  getRedoStack(): Abstract[] {\n    return this.redoStack_;\n  }\n\n  /**\n   * Undo or redo the previous action.\n   *\n   * @param redo False if undo, true if redo.\n   */\n  undo(redo: boolean) {\n    const inputStack = redo ? this.redoStack_ : this.undoStack_;\n    const outputStack = redo ? this.undoStack_ : this.redoStack_;\n    const inputEvent = inputStack.pop();\n    if (!inputEvent) {\n      return;\n    }\n    let events = [inputEvent];\n    // Do another undo/redo if the next one is of the same group.\n    while (\n      inputStack.length &&\n      inputEvent.group &&\n      inputEvent.group === inputStack[inputStack.length - 1].group\n    ) {\n      const event = inputStack.pop();\n      if (!event) continue;\n      events.push(event);\n    }\n    // Push these popped events on the opposite stack.\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      outputStack.push(event);\n    }\n    events = eventUtils.filter(events, redo);\n    eventUtils.setRecordUndo(false);\n    try {\n      for (let i = 0; i < events.length; i++) {\n        const event = events[i];\n        event.run(redo);\n      }\n    } finally {\n      eventUtils.setRecordUndo(true);\n    }\n  }\n\n  /** Clear the undo/redo stacks. */\n  clearUndo() {\n    this.undoStack_.length = 0;\n    this.redoStack_.length = 0;\n    // Stop any events already in the firing queue from being undoable.\n    eventUtils.clearPendingUndo();\n  }\n\n  /**\n   * When something in this workspace changes, call a function.\n   * Note that there may be a few recent events already on the stack.  Thus the\n   * new change listener might be called with events that occurred a few\n   * milliseconds before the change listener was added.\n   *\n   * @param func Function to call.\n   * @returns Obsolete return value, ignore.\n   */\n  addChangeListener(func: (e: Abstract) => void): Function {\n    this.listeners.push(func);\n    return func;\n  }\n\n  /**\n   * Stop listening for this workspace's changes.\n   *\n   * @param func Function to stop calling.\n   */\n  removeChangeListener(func: Function) {\n    arrayUtils.removeElem(this.listeners, func);\n  }\n\n  /**\n   * Fire a change event.\n   *\n   * @param event Event to fire.\n   */\n  fireChangeListener(event: Abstract) {\n    if (event.recordUndo) {\n      this.undoStack_.push(event);\n      this.redoStack_.length = 0;\n      while (this.undoStack_.length > this.MAX_UNDO && this.MAX_UNDO >= 0) {\n        this.undoStack_.shift();\n      }\n    }\n    for (let i = 0; i < this.listeners.length; i++) {\n      const func = this.listeners[i];\n      func(event);\n    }\n  }\n\n  /**\n   * Find the block on this workspace with the specified ID.\n   *\n   * @param id ID of block to find.\n   * @returns The sought after block, or null if not found.\n   */\n  getBlockById(id: string): Block | null {\n    return this.blockDB.get(id) || null;\n  }\n\n  /**\n   * Set a block on this workspace with the specified ID.\n   *\n   * @param id ID of block to set.\n   * @param block The block to set.\n   * @internal\n   */\n  setBlockById(id: string, block: Block) {\n    this.blockDB.set(id, block);\n  }\n\n  /**\n   * Delete a block off this workspace with the specified ID.\n   *\n   * @param id ID of block to delete.\n   * @internal\n   */\n  removeBlockById(id: string) {\n    this.blockDB.delete(id);\n  }\n\n  /**\n   * Find the comment on this workspace with the specified ID.\n   *\n   * @param id ID of comment to find.\n   * @returns The sought after comment, or null if not found.\n   * @internal\n   */\n  getCommentById(id: string): WorkspaceComment | null {\n    return this.commentDB.get(id) ?? null;\n  }\n\n  /**\n   * Checks whether all value and statement inputs in the workspace are filled\n   * with blocks.\n   *\n   * @param opt_shadowBlocksAreFilled An optional argument controlling whether\n   *     shadow blocks are counted as filled. Defaults to true.\n   * @returns True if all inputs are filled, false otherwise.\n   */\n  allInputsFilled(opt_shadowBlocksAreFilled?: boolean): boolean {\n    const blocks = this.getTopBlocks(false);\n    for (let i = 0; i < blocks.length; i++) {\n      const block = blocks[i];\n      if (!block.allInputsFilled(opt_shadowBlocksAreFilled)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Return the variable map that contains \"potential\" variables.\n   * These exist in the flyout but not in the workspace.\n   *\n   * @returns The potential variable map.\n   * @internal\n   */\n  getPotentialVariableMap(): VariableMap | null {\n    return this.potentialVariableMap;\n  }\n\n  /**\n   * Create and store the potential variable map for this workspace.\n   *\n   * @internal\n   */\n  createPotentialVariableMap() {\n    this.potentialVariableMap = new VariableMap(this);\n  }\n\n  /**\n   * Return the map of all variables on the workspace.\n   *\n   * @returns The variable map.\n   */\n  getVariableMap(): VariableMap {\n    return this.variableMap;\n  }\n\n  /**\n   * Set the map of all variables on the workspace.\n   *\n   * @param variableMap The variable map.\n   * @internal\n   */\n  setVariableMap(variableMap: VariableMap) {\n    this.variableMap = variableMap;\n  }\n\n  /** Returns the map of all procedures on the workpace. */\n  getProcedureMap(): IProcedureMap {\n    return this.procedureMap;\n  }\n\n  /**\n   * Returns the root workspace of this workspace if the workspace has\n   * parent(s).\n   *\n   * E.g. workspaces in flyouts and mini workspace bubbles have parent\n   * workspaces.\n   */\n  getRootWorkspace(): Workspace | null {\n    let outerWs = null;\n    const parent = this.options.parentWorkspace;\n    // If we were in a flyout in a mutator, need to go up two levels to find\n    // the actual parent.\n    if (this.isFlyout) {\n      if (parent && parent.options) {\n        outerWs = parent.options.parentWorkspace;\n      }\n    } else if (parent) {\n      outerWs = parent;\n    }\n    return outerWs;\n  }\n\n  /**\n   * Find the workspace with the specified ID.\n   *\n   * @param id ID of workspace to find.\n   * @returns The sought after workspace or null if not found.\n   */\n  static getById(id: string): Workspace | null {\n    return common.getWorkspaceById(id);\n  }\n\n  /**\n   * Find all workspaces.\n   *\n   * @returns Array of workspaces.\n   */\n  static getAll(): Workspace[] {\n    return common.getAllWorkspaces();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object in charge of loading, storing, and playing audio for a\n *     workspace.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.WorkspaceAudio');\n\nimport * as userAgent from './utils/useragent.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Prevent a sound from playing if another sound preceded it within this many\n * milliseconds.\n */\nconst SOUND_LIMIT = 100;\n\n/**\n * Class for loading, storing, and playing audio for a workspace.\n */\nexport class WorkspaceAudio {\n  /** Database of pre-loaded sounds. */\n  private sounds = new Map<string, HTMLAudioElement>();\n\n  /** Time that the last sound was played. */\n  private lastSound_: Date | null = null;\n\n  /**\n   * @param parentWorkspace The parent of the workspace this audio object\n   *     belongs to, or null.\n   */\n  constructor(private parentWorkspace: WorkspaceSvg) {}\n\n  /**\n   * Dispose of this audio manager.\n   *\n   * @internal\n   */\n  dispose() {\n    this.sounds.clear();\n  }\n\n  /**\n   * Load an audio file.  Cache it, ready for instantaneous playing.\n   *\n   * @param filenames List of file types in decreasing order of preference (i.e.\n   *     increasing size).  E.g. ['media/go.mp3', 'media/go.wav'] Filenames\n   *     include path from Blockly's root.  File extensions matter.\n   * @param name Name of sound.\n   */\n  load(filenames: string[], name: string) {\n    if (!filenames.length) {\n      return;\n    }\n    let audioTest;\n    try {\n      audioTest = new globalThis['Audio']();\n    } catch (e) {\n      // No browser support for Audio.\n      // IE can throw an error even if the Audio object exists.\n      return;\n    }\n    let sound;\n    for (let i = 0; i < filenames.length; i++) {\n      const filename = filenames[i];\n      const ext = filename.match(/\\.(\\w+)$/);\n      if (ext && audioTest.canPlayType('audio/' + ext[1])) {\n        // Found an audio format we can play.\n        sound = new globalThis['Audio'](filename);\n        break;\n      }\n    }\n    if (sound) {\n      this.sounds.set(name, sound);\n    }\n  }\n\n  /**\n   * Preload all the audio files so that they play quickly when asked for.\n   *\n   * @internal\n   */\n  preload() {\n    for (const sound of this.sounds.values()) {\n      sound.volume = 0.01;\n      const playPromise = sound.play();\n      // Edge does not return a promise, so we need to check.\n      if (playPromise !== undefined) {\n        // If we don't wait for the play request to complete before calling\n        // pause() we will get an exception: (DOMException: The play() request\n        // was interrupted) See more:\n        // https://developers.google.com/web/updates/2017/06/play-request-was-interrupted\n        playPromise.then(sound.pause).catch(\n          // Play without user interaction was prevented.\n          function () {}\n        );\n      } else {\n        sound.pause();\n      }\n\n      // iOS can only process one sound at a time.  Trying to load more than one\n      // corrupts the earlier ones.  Just load one and leave the others\n      // uncached.\n      if (userAgent.IPAD || userAgent.IPHONE) {\n        break;\n      }\n    }\n  }\n\n  /**\n   * Play a named sound at specified volume.  If volume is not specified,\n   * use full volume (1).\n   *\n   * @param name Name of sound.\n   * @param opt_volume Volume of sound (0-1).\n   */\n  play(name: string, opt_volume?: number) {\n    const sound = this.sounds.get(name);\n    if (sound) {\n      // Don't play one sound on top of another.\n      const now = new Date();\n      if (\n        this.lastSound_ !== null &&\n        now.getTime() - this.lastSound_.getTime() < SOUND_LIMIT\n      ) {\n        return;\n      }\n      this.lastSound_ = now;\n      let mySound;\n      if (userAgent.IPAD || userAgent.ANDROID) {\n        // Creating a new audio node causes lag in Android and iPad.  Android\n        // refetches the file from the server, iPad uses a singleton audio\n        // node which must be deleted and recreated for each new audio tag.\n        mySound = sound;\n      } else {\n        mySound = sound.cloneNode() as HTMLAudioElement;\n      }\n      mySound.volume = opt_volume === undefined ? 1 : opt_volume;\n      mySound.play();\n    } else if (this.parentWorkspace) {\n      // Maybe a workspace on a lower level knows about this sound.\n      this.parentWorkspace.getAudioManager().play(name, opt_volume);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Contains the path to a single png tat holds the images for the trashcan\n * as well as the zoom controls.\n */\nexport const SPRITE = {\n  width: 96,\n  height: 124,\n  url: 'sprites.png',\n};\n","/**\n * @license\n * Copyright 2015 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a zoom icons.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ZoomControls');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_click.js';\n\nimport * as browserEvents from './browser_events.js';\nimport {ComponentManager} from './component_manager.js';\nimport * as Css from './css.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IPositionable} from './interfaces/i_positionable.js';\nimport type {UiMetrics} from './metrics_manager.js';\nimport * as uiPosition from './positionable_helpers.js';\nimport {SPRITE} from './sprites.js';\nimport * as Touch from './touch.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a zoom controls.\n */\nexport class ZoomControls implements IPositionable {\n  /**\n   * The unique ID for this component that is used to register with the\n   * ComponentManager.\n   */\n  id = 'zoomControls';\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  /** The zoom in svg <g> element. */\n  private zoomInGroup: SVGGElement | null = null;\n\n  /** The zoom out svg <g> element. */\n  private zoomOutGroup: SVGGElement | null = null;\n\n  /** The zoom reset svg <g> element. */\n  private zoomResetGroup: SVGGElement | null = null;\n\n  /** Width of the zoom controls. */\n  private readonly WIDTH = 32;\n\n  /** Height of each zoom control. */\n  private readonly HEIGHT = 32;\n\n  /** Small spacing used between the zoom in and out control, in pixels. */\n  private readonly SMALL_SPACING = 2;\n\n  /**\n   * Large spacing used between the zoom in and reset control, in pixels.\n   */\n  private readonly LARGE_SPACING = 11;\n\n  /** Distance between zoom controls and bottom or top edge of workspace. */\n  private readonly MARGIN_VERTICAL = 20;\n\n  /** Distance between zoom controls and right or left edge of workspace. */\n  private readonly MARGIN_HORIZONTAL = 20;\n\n  /** The SVG group containing the zoom controls. */\n  private svgGroup: SVGElement | null = null;\n\n  /** Left coordinate of the zoom controls. */\n  private left = 0;\n\n  /** Top coordinate of the zoom controls. */\n  private top = 0;\n\n  /** Whether this has been initialized. */\n  private initialized = false;\n\n  /** @param workspace The workspace to sit in. */\n  constructor(private readonly workspace: WorkspaceSvg) {}\n\n  /**\n   * Create the zoom controls.\n   *\n   * @returns The zoom controls SVG group.\n   */\n  createDom(): SVGElement {\n    this.svgGroup = dom.createSvgElement(Svg.G, {});\n\n    // Each filter/pattern needs a unique ID for the case of multiple Blockly\n    // instances on a page.  Browser behaviour becomes undefined otherwise.\n    // https://neil.fraser.name/news/2015/11/01/\n    const rnd = String(Math.random()).substring(2);\n    this.createZoomOutSvg(rnd);\n    this.createZoomInSvg(rnd);\n    if (this.workspace.isMovable()) {\n      // If we zoom to the center and the workspace isn't movable we could\n      // loose blocks at the edges of the workspace.\n      this.createZoomResetSvg(rnd);\n    }\n    return this.svgGroup;\n  }\n\n  /** Initializes the zoom controls. */\n  init() {\n    this.workspace.getComponentManager().addComponent({\n      component: this,\n      weight: 2,\n      capabilities: [ComponentManager.Capability.POSITIONABLE],\n    });\n    this.initialized = true;\n  }\n\n  /**\n   * Disposes of this zoom controls.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.workspace.getComponentManager().removeComponent('zoomControls');\n    if (this.svgGroup) {\n      dom.removeNode(this.svgGroup);\n    }\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n  }\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   *\n   * @returns The UI elements's bounding box. Null if bounding box should be\n   *     ignored by other UI elements.\n   */\n  getBoundingRectangle(): Rect | null {\n    let height = this.SMALL_SPACING + 2 * this.HEIGHT;\n    if (this.zoomResetGroup) {\n      height += this.LARGE_SPACING + this.HEIGHT;\n    }\n    const bottom = this.top + height;\n    const right = this.left + this.WIDTH;\n    return new Rect(this.top, bottom, this.left, right);\n  }\n\n  /**\n   * Positions the zoom controls.\n   * It is positioned in the opposite corner to the corner the\n   * categories/toolbox starts at.\n   *\n   * @param metrics The workspace metrics.\n   * @param savedPositions List of rectangles that are already on the workspace.\n   */\n  position(metrics: UiMetrics, savedPositions: Rect[]) {\n    // Not yet initialized.\n    if (!this.initialized) {\n      return;\n    }\n\n    const cornerPosition = uiPosition.getCornerOppositeToolbox(\n      this.workspace,\n      metrics\n    );\n    let height = this.SMALL_SPACING + 2 * this.HEIGHT;\n    if (this.zoomResetGroup) {\n      height += this.LARGE_SPACING + this.HEIGHT;\n    }\n    const startRect = uiPosition.getStartPositionRect(\n      cornerPosition,\n      new Size(this.WIDTH, height),\n      this.MARGIN_HORIZONTAL,\n      this.MARGIN_VERTICAL,\n      metrics,\n      this.workspace\n    );\n\n    const verticalPosition = cornerPosition.vertical;\n    const bumpDirection =\n      verticalPosition === uiPosition.verticalPosition.TOP\n        ? uiPosition.bumpDirection.DOWN\n        : uiPosition.bumpDirection.UP;\n    const positionRect = uiPosition.bumpPositionRect(\n      startRect,\n      this.MARGIN_VERTICAL,\n      bumpDirection,\n      savedPositions\n    );\n\n    if (verticalPosition === uiPosition.verticalPosition.TOP) {\n      const zoomInTranslateY = this.SMALL_SPACING + this.HEIGHT;\n      this.zoomInGroup?.setAttribute(\n        'transform',\n        'translate(0, ' + zoomInTranslateY + ')'\n      );\n      if (this.zoomResetGroup) {\n        const zoomResetTranslateY =\n          zoomInTranslateY + this.LARGE_SPACING + this.HEIGHT;\n        this.zoomResetGroup.setAttribute(\n          'transform',\n          'translate(0, ' + zoomResetTranslateY + ')'\n        );\n      }\n    } else {\n      const zoomInTranslateY = this.zoomResetGroup\n        ? this.LARGE_SPACING + this.HEIGHT\n        : 0;\n      this.zoomInGroup?.setAttribute(\n        'transform',\n        'translate(0, ' + zoomInTranslateY + ')'\n      );\n      const zoomOutTranslateY =\n        zoomInTranslateY + this.SMALL_SPACING + this.HEIGHT;\n      this.zoomOutGroup?.setAttribute(\n        'transform',\n        'translate(0, ' + zoomOutTranslateY + ')'\n      );\n    }\n\n    this.top = positionRect.top;\n    this.left = positionRect.left;\n    this.svgGroup?.setAttribute(\n      'transform',\n      'translate(' + this.left + ',' + this.top + ')'\n    );\n  }\n\n  /**\n   * Create the zoom in icon and its event handler.\n   *\n   * @param rnd The random string to use as a suffix in the clip path's ID.\n   *     These IDs must be unique in case there are multiple Blockly instances\n   *     on the same page.\n   */\n  private createZoomOutSvg(rnd: string) {\n    /* This markup will be generated and added to the .svgGroup:\n        <g class=\"blocklyZoom\">\n          <clipPath id=\"blocklyZoomoutClipPath837493\">\n            <rect width=\"32\" height=\"32></rect>\n          </clipPath>\n          <image width=\"96\" height=\"124\" x=\"-64\" y=\"-92\"\n        xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyZoomoutClipPath837493)\"></image>\n        </g>\n        */\n    this.zoomOutGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyZoom'},\n      this.svgGroup\n    );\n    const clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyZoomoutClipPath' + rnd},\n      this.zoomOutGroup\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'width': 32,\n        'height': 32,\n      },\n      clip\n    );\n    const zoomoutSvg = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'height': SPRITE.height,\n        'x': -64,\n        'y': -92,\n        'clip-path': 'url(#blocklyZoomoutClipPath' + rnd + ')',\n      },\n      this.zoomOutGroup\n    );\n    zoomoutSvg.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url\n    );\n\n    // Attach listener.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.zoomOutGroup,\n        'pointerdown',\n        null,\n        this.zoom.bind(this, -1)\n      )\n    );\n  }\n\n  /**\n   * Create the zoom out icon and its event handler.\n   *\n   * @param rnd The random string to use as a suffix in the clip path's ID.\n   *     These IDs must be unique in case there are multiple Blockly instances\n   *     on the same page.\n   */\n  private createZoomInSvg(rnd: string) {\n    /* This markup will be generated and added to the .svgGroup:\n        <g class=\"blocklyZoom\">\n          <clipPath id=\"blocklyZoominClipPath837493\">\n            <rect width=\"32\" height=\"32\"></rect>\n          </clipPath>\n          <image width=\"96\" height=\"124\" x=\"-32\" y=\"-92\"\n        xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyZoominClipPath837493)\"></image>\n        </g>\n        */\n    this.zoomInGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyZoom'},\n      this.svgGroup\n    );\n    const clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyZoominClipPath' + rnd},\n      this.zoomInGroup\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {\n        'width': 32,\n        'height': 32,\n      },\n      clip\n    );\n    const zoominSvg = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'height': SPRITE.height,\n        'x': -32,\n        'y': -92,\n        'clip-path': 'url(#blocklyZoominClipPath' + rnd + ')',\n      },\n      this.zoomInGroup\n    );\n    zoominSvg.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url\n    );\n\n    // Attach listener.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.zoomInGroup,\n        'pointerdown',\n        null,\n        this.zoom.bind(this, 1)\n      )\n    );\n  }\n\n  /**\n   * Handles a mouse down event on the zoom in or zoom out buttons on the\n   *    workspace.\n   *\n   * @param amount Amount of zooming. Negative amount values zoom out, and\n   *     positive amount values zoom in.\n   * @param e A mouse down event.\n   */\n  private zoom(amount: number, e: PointerEvent) {\n    this.workspace.markFocused();\n    this.workspace.zoomCenter(amount);\n    this.fireZoomEvent();\n    Touch.clearTouchIdentifier(); // Don't block future drags.\n    e.stopPropagation(); // Don't start a workspace scroll.\n    e.preventDefault(); // Stop double-clicking from selecting text.\n  }\n\n  /**\n   * Create the zoom reset icon and its event handler.\n   *\n   * @param rnd The random string to use as a suffix in the clip path's ID.\n   *     These IDs must be unique in case there are multiple Blockly instances\n   *     on the same page.\n   */\n  private createZoomResetSvg(rnd: string) {\n    /* This markup will be generated and added to the .svgGroup:\n        <g class=\"blocklyZoom\">\n          <clipPath id=\"blocklyZoomresetClipPath837493\">\n            <rect width=\"32\" height=\"32\"></rect>\n          </clipPath>\n          <image width=\"96\" height=\"124\" x=\"-32\" y=\"-92\"\n        xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyZoomresetClipPath837493)\"></image>\n        </g>\n        */\n    this.zoomResetGroup = dom.createSvgElement(\n      Svg.G,\n      {'class': 'blocklyZoom'},\n      this.svgGroup\n    );\n    const clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyZoomresetClipPath' + rnd},\n      this.zoomResetGroup\n    );\n    dom.createSvgElement(Svg.RECT, {'width': 32, 'height': 32}, clip);\n    const zoomresetSvg = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'height': SPRITE.height,\n        'y': -92,\n        'clip-path': 'url(#blocklyZoomresetClipPath' + rnd + ')',\n      },\n      this.zoomResetGroup\n    );\n    zoomresetSvg.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url\n    );\n\n    // Attach event listeners.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.zoomResetGroup,\n        'pointerdown',\n        null,\n        this.resetZoom.bind(this)\n      )\n    );\n  }\n\n  /**\n   * Handles a mouse down event on the reset zoom button on the workspace.\n   *\n   * @param e A mouse down event.\n   */\n  private resetZoom(e: PointerEvent) {\n    this.workspace.markFocused();\n\n    // zoom is passed amount and computes the new scale using the formula:\n    // targetScale = currentScale * Math.pow(speed, amount)\n    const targetScale = this.workspace.options.zoomOptions.startScale;\n    const currentScale = this.workspace.scale;\n    const speed = this.workspace.options.zoomOptions.scaleSpeed;\n    // To compute amount:\n    // amount = log(speed, (targetScale / currentScale))\n    // Math.log computes natural logarithm (ln), to change the base, use\n    // formula: log(base, value) = ln(value) / ln(base)\n    const amount = Math.log(targetScale / currentScale) / Math.log(speed);\n    this.workspace.beginCanvasTransition();\n    this.workspace.zoomCenter(amount);\n    this.workspace.scrollCenter();\n\n    setTimeout(this.workspace.endCanvasTransition.bind(this.workspace), 500);\n    this.fireZoomEvent();\n    Touch.clearTouchIdentifier(); // Don't block future drags.\n    e.stopPropagation(); // Don't start a workspace scroll.\n    e.preventDefault(); // Stop double-clicking from selecting text.\n  }\n\n  /** Fires a zoom control UI event. */\n  private fireZoomEvent() {\n    const uiEvent = new (eventUtils.get(eventUtils.CLICK))(\n      null,\n      this.workspace.id,\n      'zoom_controls'\n    );\n    eventUtils.fire(uiEvent);\n  }\n}\n\n/** CSS for zoom controls.  See css.js for use. */\nCss.register(`\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n`);\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Flyout tray containing blocks which may be created.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Flyout');\n\nimport type {Abstract as AbstractEvent} from './events/events_abstract.js';\nimport type {Block} from './block.js';\nimport type {BlockSvg} from './block_svg.js';\nimport * as browserEvents from './browser_events.js';\nimport * as common from './common.js';\nimport {ComponentManager} from './component_manager.js';\nimport {DeleteArea} from './delete_area.js';\nimport * as eventUtils from './events/utils.js';\nimport {FlyoutButton} from './flyout_button.js';\nimport {FlyoutMetricsManager} from './flyout_metrics_manager.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {Options} from './options.js';\nimport {ScrollbarPair} from './scrollbar_pair.js';\nimport * as blocks from './serialization/blocks.js';\nimport * as Tooltip from './tooltip.js';\nimport {Coordinate} from './utils/coordinate.js';\nimport * as dom from './utils/dom.js';\nimport * as idGenerator from './utils/idgenerator.js';\nimport {Svg} from './utils/svg.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as Variables from './variables.js';\nimport {WorkspaceSvg} from './workspace_svg.js';\nimport * as utilsXml from './utils/xml.js';\nimport * as Xml from './xml.js';\n\nenum FlyoutItemType {\n  BLOCK = 'block',\n  BUTTON = 'button',\n}\n\n/**\n * Class for a flyout.\n */\nexport abstract class Flyout extends DeleteArea implements IFlyout {\n  /**\n   * Position the flyout.\n   */\n  abstract position(): void;\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has\n   *     moved from the position at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   */\n  abstract isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean;\n\n  /**\n   * Sets the translation of the flyout to match the scrollbars.\n   *\n   * @param xyRatio Contains a y property which is a float\n   *     between 0 and 1 specifying the degree of scrolling and a\n   *     similar x property.\n   */\n  protected abstract setMetrics_(xyRatio: {x?: number; y?: number}): void;\n\n  /**\n   * Lay out the blocks in the flyout.\n   *\n   * @param contents The blocks and buttons to lay out.\n   * @param gaps The visible gaps between blocks.\n   */\n  protected abstract layout_(contents: FlyoutItem[], gaps: number[]): void;\n\n  /**\n   * Scroll the flyout.\n   *\n   * @param e Mouse wheel scroll event.\n   */\n  protected abstract wheel_(e: WheelEvent): void;\n\n  /**\n   * Compute height of flyout.  Position mat under each block.\n   * For RTL: Lay out the blocks right-aligned.\n   */\n  protected abstract reflowInternal_(): void;\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  abstract getX(): number;\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  abstract getY(): number;\n\n  /**\n   * Scroll the flyout to the beginning of its contents.\n   */\n  abstract scrollToStart(): void;\n\n  /**\n   * The type of a flyout content item.\n   */\n  static FlyoutItemType = FlyoutItemType;\n\n  protected workspace_: WorkspaceSvg;\n  RTL: boolean;\n  /**\n   * Whether the flyout should be laid out horizontally or not.\n   *\n   * @internal\n   */\n  horizontalLayout = false;\n  protected toolboxPosition_: number;\n\n  /**\n   * Array holding info needed to unbind events.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  private boundEvents: browserEvents.Data[] = [];\n\n  /**\n   * Function that will be registered as a change listener on the workspace\n   * to reflow when blocks in the flyout workspace change.\n   */\n  private reflowWrapper: ((e: AbstractEvent) => void) | null = null;\n\n  /**\n   * Function that disables blocks in the flyout based on max block counts\n   * allowed in the target workspace. Registered as a change listener on the\n   * target workspace.\n   */\n  private filterWrapper: ((e: AbstractEvent) => void) | null = null;\n\n  /**\n   * List of background mats that lurk behind each block to catch clicks\n   * landing in the blocks' lakes and bays.\n   */\n  private mats: SVGElement[] = [];\n\n  /**\n   * List of visible buttons.\n   */\n  protected buttons_: FlyoutButton[] = [];\n\n  /**\n   * List of event listeners.\n   */\n  private listeners: browserEvents.Data[] = [];\n\n  /**\n   * List of blocks that should always be disabled.\n   */\n  private permanentlyDisabled: Block[] = [];\n\n  protected readonly tabWidth_: number;\n\n  /**\n   * The target workspace.\n   *\n   * @internal\n   */\n  targetWorkspace!: WorkspaceSvg;\n\n  /**\n   * A list of blocks that can be reused.\n   */\n  private recycledBlocks: BlockSvg[] = [];\n\n  /**\n   * Does the flyout automatically close when a block is created?\n   */\n  autoClose = true;\n\n  /**\n   * Whether the flyout is visible.\n   */\n  private isVisible_ = false;\n\n  /**\n   * Whether the workspace containing this flyout is visible.\n   */\n  private containerVisible = true;\n  protected rectMap_: WeakMap<BlockSvg, SVGElement>;\n\n  /**\n   * Corner radius of the flyout background.\n   */\n  readonly CORNER_RADIUS: number = 8;\n  readonly MARGIN: number;\n  readonly GAP_X: number;\n  readonly GAP_Y: number;\n\n  /**\n   * Top/bottom padding between scrollbar and edge of flyout background.\n   */\n  readonly SCROLLBAR_MARGIN: number = 2.5;\n\n  /**\n   * Width of flyout.\n   */\n  protected width_ = 0;\n\n  /**\n   * Height of flyout.\n   */\n  protected height_ = 0;\n  // clang-format off\n  /**\n   * Range of a drag angle from a flyout considered \"dragging toward\n   * workspace\". Drags that are within the bounds of this many degrees from\n   * the orthogonal line to the flyout edge are considered to be \"drags toward\n   * the workspace\".\n   *\n   * @example\n   *\n   * ```\n   * Flyout                                                 Edge   Workspace\n   * [block] /  <-within this angle, drags \"toward workspace\" |\n   * [block] ---- orthogonal to flyout boundary ----          |\n   * [block] \\                                                |\n   * ```\n   *\n   * The angle is given in degrees from the orthogonal.\n   *\n   * This is used to know when to create a new block and when to scroll the\n   * flyout. Setting it to 360 means that all drags create a new block.\n   */\n  // clang-format on\n  protected dragAngleRange_ = 70;\n\n  /**\n   * The path around the background of the flyout, which will be filled with a\n   * background colour.\n   */\n  protected svgBackground_: SVGPathElement | null = null;\n\n  /**\n   * The root SVG group for the button or label.\n   */\n  protected svgGroup_: SVGGElement | null = null;\n  /**\n   * @param workspaceOptions Dictionary of options for the\n   *     workspace.\n   */\n  constructor(workspaceOptions: Options) {\n    super();\n    workspaceOptions.setMetrics = this.setMetrics_.bind(this);\n\n    this.workspace_ = new WorkspaceSvg(workspaceOptions);\n    this.workspace_.setMetricsManager(\n      new FlyoutMetricsManager(this.workspace_, this)\n    );\n\n    this.workspace_.internalIsFlyout = true;\n    // Keep the workspace visibility consistent with the flyout's visibility.\n    this.workspace_.setVisible(this.isVisible_);\n\n    /**\n     * The unique id for this component that is used to register with the\n     * ComponentManager.\n     */\n    this.id = idGenerator.genUid();\n\n    /**\n     * Is RTL vs LTR.\n     */\n    this.RTL = !!workspaceOptions.RTL;\n\n    /**\n     * Position of the toolbox and flyout relative to the workspace.\n     */\n    this.toolboxPosition_ = workspaceOptions.toolboxPosition;\n\n    /**\n     * Width of output tab.\n     */\n    this.tabWidth_ = this.workspace_.getRenderer().getConstants().TAB_WIDTH;\n\n    /**\n     * A map from blocks to the rects which are beneath them to act as input\n     * targets.\n     *\n     * @internal\n     */\n    this.rectMap_ = new WeakMap();\n\n    /**\n     * Margin around the edges of the blocks in the flyout.\n     */\n    this.MARGIN = this.CORNER_RADIUS;\n\n    // TODO: Move GAP_X and GAP_Y to their appropriate files.\n    /**\n     * Gap between items in horizontal flyouts. Can be overridden with the \"sep\"\n     * element.\n     */\n    this.GAP_X = this.MARGIN * 3;\n\n    /**\n     * Gap between items in vertical flyouts. Can be overridden with the \"sep\"\n     * element.\n     */\n    this.GAP_Y = this.MARGIN * 3;\n  }\n\n  /**\n   * Creates the flyout's DOM.  Only needs to be called once.  The flyout can\n   * either exist as its own SVG element or be a g element nested inside a\n   * separate SVG element.\n   *\n   * @param tagName The type of tag to\n   *     put the flyout in. This should be <svg> or <g>.\n   * @returns The flyout's SVG group.\n   */\n  createDom(\n    tagName: string | Svg<SVGSVGElement> | Svg<SVGGElement>\n  ): SVGElement {\n    /*\n        <svg | g>\n          <path class=\"blocklyFlyoutBackground\"/>\n          <g class=\"blocklyFlyout\"></g>\n        </ svg | g>\n        */\n    // Setting style to display:none to start. The toolbox and flyout\n    // hide/show code will set up proper visibility and size later.\n    this.svgGroup_ = dom.createSvgElement(tagName, {\n      'class': 'blocklyFlyout',\n      'style': 'display: none',\n    });\n    this.svgBackground_ = dom.createSvgElement(\n      Svg.PATH,\n      {'class': 'blocklyFlyoutBackground'},\n      this.svgGroup_\n    );\n    this.svgGroup_.appendChild(this.workspace_.createDom());\n    this.workspace_\n      .getThemeManager()\n      .subscribe(this.svgBackground_, 'flyoutBackgroundColour', 'fill');\n    this.workspace_\n      .getThemeManager()\n      .subscribe(this.svgBackground_, 'flyoutOpacity', 'fill-opacity');\n    return this.svgGroup_;\n  }\n\n  /**\n   * Initializes the flyout.\n   *\n   * @param targetWorkspace The workspace in which to\n   *     create new blocks.\n   */\n  init(targetWorkspace: WorkspaceSvg) {\n    this.targetWorkspace = targetWorkspace;\n    this.workspace_.targetWorkspace = targetWorkspace;\n\n    this.workspace_.scrollbar = new ScrollbarPair(\n      this.workspace_,\n      this.horizontalLayout,\n      !this.horizontalLayout,\n      'blocklyFlyoutScrollbar',\n      this.SCROLLBAR_MARGIN\n    );\n\n    this.hide();\n\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.svgGroup_ as SVGGElement,\n        'wheel',\n        this,\n        this.wheel_\n      )\n    );\n    if (!this.autoClose) {\n      this.filterWrapper = this.filterForCapacity.bind(this);\n      this.targetWorkspace.addChangeListener(this.filterWrapper);\n    }\n\n    // Dragging the flyout up and down.\n    this.boundEvents.push(\n      browserEvents.conditionalBind(\n        this.svgBackground_ as SVGPathElement,\n        'pointerdown',\n        this,\n        this.onMouseDown\n      )\n    );\n\n    // A flyout connected to a workspace doesn't have its own current gesture.\n    this.workspace_.getGesture = this.targetWorkspace.getGesture.bind(\n      this.targetWorkspace\n    );\n\n    // Get variables from the main workspace rather than the target workspace.\n    this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap());\n\n    this.workspace_.createPotentialVariableMap();\n\n    targetWorkspace.getComponentManager().addComponent({\n      component: this,\n      weight: 1,\n      capabilities: [\n        ComponentManager.Capability.DELETE_AREA,\n        ComponentManager.Capability.DRAG_TARGET,\n      ],\n    });\n  }\n\n  /**\n   * Dispose of this flyout.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.hide();\n    this.workspace_.getComponentManager().removeComponent(this.id);\n    for (const event of this.boundEvents) {\n      browserEvents.unbind(event);\n    }\n    this.boundEvents.length = 0;\n    if (this.filterWrapper) {\n      this.targetWorkspace.removeChangeListener(this.filterWrapper);\n    }\n    if (this.workspace_) {\n      this.workspace_.getThemeManager().unsubscribe(this.svgBackground_!);\n      this.workspace_.dispose();\n    }\n    if (this.svgGroup_) {\n      dom.removeNode(this.svgGroup_);\n    }\n  }\n\n  /**\n   * Get the width of the flyout.\n   *\n   * @returns The width of the flyout.\n   */\n  getWidth(): number {\n    return this.width_;\n  }\n\n  /**\n   * Get the height of the flyout.\n   *\n   * @returns The width of the flyout.\n   */\n  getHeight(): number {\n    return this.height_;\n  }\n\n  /**\n   * Get the scale (zoom level) of the flyout. By default,\n   * this matches the target workspace scale, but this can be overridden.\n   *\n   * @returns Flyout workspace scale.\n   */\n  getFlyoutScale(): number {\n    return this.targetWorkspace.scale;\n  }\n\n  /**\n   * Get the workspace inside the flyout.\n   *\n   * @returns The workspace inside the flyout.\n   */\n  getWorkspace(): WorkspaceSvg {\n    return this.workspace_;\n  }\n\n  /**\n   * Is the flyout visible?\n   *\n   * @returns True if visible.\n   */\n  isVisible(): boolean {\n    return this.isVisible_;\n  }\n\n  /**\n   * Set whether the flyout is visible. A value of true does not necessarily\n   * mean that the flyout is shown. It could be hidden because its container is\n   * hidden.\n   *\n   * @param visible True if visible.\n   */\n  setVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.isVisible();\n\n    this.isVisible_ = visible;\n    if (visibilityChanged) {\n      if (!this.autoClose) {\n        // Auto-close flyouts are ignored as drag targets, so only non\n        // auto-close flyouts need to have their drag target updated.\n        this.workspace_.recordDragTargets();\n      }\n      this.updateDisplay();\n    }\n  }\n\n  /**\n   * Set whether this flyout's container is visible.\n   *\n   * @param visible Whether the container is visible.\n   */\n  setContainerVisible(visible: boolean) {\n    const visibilityChanged = visible !== this.containerVisible;\n    this.containerVisible = visible;\n    if (visibilityChanged) {\n      this.updateDisplay();\n    }\n  }\n\n  /**\n   * Update the display property of the flyout based whether it thinks it should\n   * be visible and whether its containing workspace is visible.\n   */\n  private updateDisplay() {\n    let show = true;\n    if (!this.containerVisible) {\n      show = false;\n    } else {\n      show = this.isVisible();\n    }\n    if (this.svgGroup_) {\n      this.svgGroup_.style.display = show ? 'block' : 'none';\n    }\n    // Update the scrollbar's visibility too since it should mimic the\n    // flyout's visibility.\n    this.workspace_.scrollbar?.setContainerVisible(show);\n  }\n\n  /**\n   * Update the view based on coordinates calculated in position().\n   *\n   * @param width The computed width of the flyout's SVG group\n   * @param height The computed height of the flyout's SVG group.\n   * @param x The computed x origin of the flyout's SVG group.\n   * @param y The computed y origin of the flyout's SVG group.\n   */\n  protected positionAt_(width: number, height: number, x: number, y: number) {\n    this.svgGroup_?.setAttribute('width', `${width}`);\n    this.svgGroup_?.setAttribute('height', `${height}`);\n    this.workspace_.setCachedParentSvgSize(width, height);\n\n    if (this.svgGroup_) {\n      const transform = 'translate(' + x + 'px,' + y + 'px)';\n      dom.setCssTransform(this.svgGroup_, transform);\n    }\n\n    // Update the scrollbar (if one exists).\n    const scrollbar = this.workspace_.scrollbar;\n    if (scrollbar) {\n      // Set the scrollbars origin to be the top left of the flyout.\n      scrollbar.setOrigin(x, y);\n      scrollbar.resize();\n      // If origin changed and metrics haven't changed enough to trigger\n      // reposition in resize, we need to call setPosition. See issue #4692.\n      if (scrollbar.hScroll) {\n        scrollbar.hScroll.setPosition(\n          scrollbar.hScroll.position.x,\n          scrollbar.hScroll.position.y\n        );\n      }\n      if (scrollbar.vScroll) {\n        scrollbar.vScroll.setPosition(\n          scrollbar.vScroll.position.x,\n          scrollbar.vScroll.position.y\n        );\n      }\n    }\n  }\n\n  /**\n   * Hide and empty the flyout.\n   */\n  hide() {\n    if (!this.isVisible()) {\n      return;\n    }\n    this.setVisible(false);\n    // Delete all the event listeners.\n    for (const listen of this.listeners) {\n      browserEvents.unbind(listen);\n    }\n    this.listeners.length = 0;\n    if (this.reflowWrapper) {\n      this.workspace_.removeChangeListener(this.reflowWrapper);\n      this.reflowWrapper = null;\n    }\n    // Do NOT delete the blocks here.  Wait until Flyout.show.\n    // https://neil.fraser.name/news/2014/08/09/\n  }\n\n  /**\n   * Show and populate the flyout.\n   *\n   * @param flyoutDef Contents to display\n   *     in the flyout. This is either an array of Nodes, a NodeList, a\n   *     toolbox definition, or a string with the name of the dynamic category.\n   */\n  show(flyoutDef: toolbox.FlyoutDefinition | string) {\n    this.workspace_.setResizesEnabled(false);\n    this.hide();\n    this.clearOldBlocks();\n\n    // Handle dynamic categories, represented by a name instead of a list.\n    if (typeof flyoutDef === 'string') {\n      flyoutDef = this.getDynamicCategoryContents(flyoutDef);\n    }\n    this.setVisible(true);\n\n    // Parse the Array, Node or NodeList into a a list of flyout items.\n    const parsedContent = toolbox.convertFlyoutDefToJsonArray(flyoutDef);\n    const flyoutInfo = this.createFlyoutInfo(parsedContent);\n\n    this.layout_(flyoutInfo.contents, flyoutInfo.gaps);\n\n    if (this.horizontalLayout) {\n      this.height_ = 0;\n    } else {\n      this.width_ = 0;\n    }\n    this.workspace_.setResizesEnabled(true);\n    this.reflow();\n\n    this.filterForCapacity();\n\n    // Correctly position the flyout's scrollbar when it opens.\n    this.position();\n\n    this.reflowWrapper = this.reflow.bind(this);\n    this.workspace_.addChangeListener(this.reflowWrapper);\n    this.emptyRecycledBlocks();\n  }\n\n  /**\n   * Create the contents array and gaps array necessary to create the layout for\n   * the flyout.\n   *\n   * @param parsedContent The array\n   *     of objects to show in the flyout.\n   * @returns The list of contents and gaps needed to lay out the flyout.\n   */\n  private createFlyoutInfo(parsedContent: toolbox.FlyoutItemInfoArray): {\n    contents: FlyoutItem[];\n    gaps: number[];\n  } {\n    const contents: FlyoutItem[] = [];\n    const gaps: number[] = [];\n    this.permanentlyDisabled.length = 0;\n    const defaultGap = this.horizontalLayout ? this.GAP_X : this.GAP_Y;\n    for (const info of parsedContent) {\n      if ('custom' in info) {\n        const customInfo = info as toolbox.DynamicCategoryInfo;\n        const categoryName = customInfo['custom'];\n        const flyoutDef = this.getDynamicCategoryContents(categoryName);\n        const parsedDynamicContent =\n          toolbox.convertFlyoutDefToJsonArray(flyoutDef);\n        const {contents: dynamicContents, gaps: dynamicGaps} =\n          this.createFlyoutInfo(parsedDynamicContent);\n        contents.push(...dynamicContents);\n        gaps.push(...dynamicGaps);\n      }\n\n      switch (info['kind'].toUpperCase()) {\n        case 'BLOCK': {\n          const blockInfo = info as toolbox.BlockInfo;\n          const block = this.createFlyoutBlock(blockInfo);\n          contents.push({type: FlyoutItemType.BLOCK, block: block});\n          this.addBlockGap(blockInfo, gaps, defaultGap);\n          break;\n        }\n        case 'SEP': {\n          const sepInfo = info as toolbox.SeparatorInfo;\n          this.addSeparatorGap(sepInfo, gaps, defaultGap);\n          break;\n        }\n        case 'LABEL': {\n          const labelInfo = info as toolbox.LabelInfo;\n          // A label is a button with different styling.\n          const label = this.createButton(labelInfo, /** isLabel */ true);\n          contents.push({type: FlyoutItemType.BUTTON, button: label});\n          gaps.push(defaultGap);\n          break;\n        }\n        case 'BUTTON': {\n          const buttonInfo = info as toolbox.ButtonInfo;\n          const button = this.createButton(buttonInfo, /** isLabel */ false);\n          contents.push({type: FlyoutItemType.BUTTON, button: button});\n          gaps.push(defaultGap);\n          break;\n        }\n      }\n    }\n\n    return {contents: contents, gaps: gaps};\n  }\n\n  /**\n   * Gets the flyout definition for the dynamic category.\n   *\n   * @param categoryName The name of the dynamic category.\n   * @returns The definition of the\n   *     flyout in one of its many forms.\n   */\n  private getDynamicCategoryContents(\n    categoryName: string\n  ): toolbox.FlyoutDefinition {\n    // Look up the correct category generation function and call that to get a\n    // valid XML list.\n    const fnToApply =\n      this.workspace_.targetWorkspace!.getToolboxCategoryCallback(categoryName);\n    if (typeof fnToApply !== 'function') {\n      throw TypeError(\n        \"Couldn't find a callback function when opening\" +\n          ' a toolbox category.'\n      );\n    }\n    return fnToApply(this.workspace_.targetWorkspace!);\n  }\n\n  /**\n   * Creates a flyout button or a flyout label.\n   *\n   * @param btnInfo The object holding information about a button or a label.\n   * @param isLabel True if the button is a label, false otherwise.\n   * @returns The object used to display the button in the\n   *    flyout.\n   */\n  private createButton(\n    btnInfo: toolbox.ButtonOrLabelInfo,\n    isLabel: boolean\n  ): FlyoutButton {\n    const curButton = new FlyoutButton(\n      this.workspace_,\n      this.targetWorkspace as WorkspaceSvg,\n      btnInfo,\n      isLabel\n    );\n    return curButton;\n  }\n\n  /**\n   * Create a block from the xml and permanently disable any blocks that were\n   * defined as disabled.\n   *\n   * @param blockInfo The info of the block.\n   * @returns The block created from the blockInfo.\n   */\n  private createFlyoutBlock(blockInfo: toolbox.BlockInfo): BlockSvg {\n    let block;\n    if (blockInfo['blockxml']) {\n      const xml = (\n        typeof blockInfo['blockxml'] === 'string'\n          ? utilsXml.textToDom(blockInfo['blockxml'])\n          : blockInfo['blockxml']\n      ) as Element;\n      block = this.getRecycledBlock(xml.getAttribute('type')!);\n      if (!block) {\n        block = Xml.domToBlock(xml, this.workspace_);\n      }\n    } else {\n      block = this.getRecycledBlock(blockInfo['type']!);\n      if (!block) {\n        if (blockInfo['enabled'] === undefined) {\n          blockInfo['enabled'] =\n            blockInfo['disabled'] !== 'true' && blockInfo['disabled'] !== true;\n        }\n        block = blocks.append(blockInfo as blocks.State, this.workspace_);\n      }\n    }\n\n    if (!block.isEnabled()) {\n      // Record blocks that were initially disabled.\n      // Do not enable these blocks as a result of capacity filtering.\n      this.permanentlyDisabled.push(block);\n    }\n    return block as BlockSvg;\n  }\n\n  /**\n   * Returns a block from the array of recycled blocks with the given type, or\n   * undefined if one cannot be found.\n   *\n   * @param blockType The type of the block to try to recycle.\n   * @returns The recycled block, or undefined if\n   *     one could not be recycled.\n   */\n  private getRecycledBlock(blockType: string): BlockSvg | undefined {\n    let index = -1;\n    for (let i = 0; i < this.recycledBlocks.length; i++) {\n      if (this.recycledBlocks[i].type === blockType) {\n        index = i;\n        break;\n      }\n    }\n    return index === -1 ? undefined : this.recycledBlocks.splice(index, 1)[0];\n  }\n\n  /**\n   * Adds a gap in the flyout based on block info.\n   *\n   * @param blockInfo Information about a block.\n   * @param gaps The list of gaps between items in the flyout.\n   * @param defaultGap The default gap between one element and the\n   *     next.\n   */\n  private addBlockGap(\n    blockInfo: toolbox.BlockInfo,\n    gaps: number[],\n    defaultGap: number\n  ) {\n    let gap;\n    if (blockInfo['gap']) {\n      gap = parseInt(String(blockInfo['gap']));\n    } else if (blockInfo['blockxml']) {\n      const xml = (\n        typeof blockInfo['blockxml'] === 'string'\n          ? utilsXml.textToDom(blockInfo['blockxml'])\n          : blockInfo['blockxml']\n      ) as Element;\n      gap = parseInt(xml.getAttribute('gap')!);\n    }\n    gaps.push(!gap || isNaN(gap) ? defaultGap : gap);\n  }\n\n  /**\n   * Add the necessary gap in the flyout for a separator.\n   *\n   * @param sepInfo The object holding\n   *    information about a separator.\n   * @param gaps The list gaps between items in the flyout.\n   * @param defaultGap The default gap between the button and next\n   *     element.\n   */\n  private addSeparatorGap(\n    sepInfo: toolbox.SeparatorInfo,\n    gaps: number[],\n    defaultGap: number\n  ) {\n    // Change the gap between two toolbox elements.\n    // <sep gap=\"36\"></sep>\n    // The default gap is 24, can be set larger or smaller.\n    // This overwrites the gap attribute on the previous element.\n    const newGap = parseInt(String(sepInfo['gap']));\n    // Ignore gaps before the first block.\n    if (!isNaN(newGap) && gaps.length > 0) {\n      gaps[gaps.length - 1] = newGap;\n    } else {\n      gaps.push(defaultGap);\n    }\n  }\n\n  /**\n   * Delete blocks, mats and buttons from a previous showing of the flyout.\n   */\n  private clearOldBlocks() {\n    // Delete any blocks from a previous showing.\n    const oldBlocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; (block = oldBlocks[i]); i++) {\n      if (this.blockIsRecyclable_(block)) {\n        this.recycleBlock(block);\n      } else {\n        block.dispose(false, false);\n      }\n    }\n    // Delete any mats from a previous showing.\n    for (let j = 0; j < this.mats.length; j++) {\n      const rect = this.mats[j];\n      if (rect) {\n        Tooltip.unbindMouseEvents(rect);\n        dom.removeNode(rect);\n      }\n    }\n    this.mats.length = 0;\n    // Delete any buttons from a previous showing.\n    for (let i = 0, button; (button = this.buttons_[i]); i++) {\n      button.dispose();\n    }\n    this.buttons_.length = 0;\n\n    // Clear potential variables from the previous showing.\n    this.workspace_.getPotentialVariableMap()?.clear();\n  }\n\n  /**\n   * Empties all of the recycled blocks, properly disposing of them.\n   */\n  private emptyRecycledBlocks() {\n    for (let i = 0; i < this.recycledBlocks.length; i++) {\n      this.recycledBlocks[i].dispose();\n    }\n    this.recycledBlocks = [];\n  }\n\n  /**\n   * Returns whether the given block can be recycled or not.\n   *\n   * @param _block The block to check for recyclability.\n   * @returns True if the block can be recycled. False otherwise.\n   */\n  protected blockIsRecyclable_(_block: BlockSvg): boolean {\n    // By default, recycling is disabled.\n    return false;\n  }\n\n  /**\n   * Puts a previously created block into the recycle bin and moves it to the\n   * top of the workspace. Used during large workspace swaps to limit the number\n   * of new DOM elements we need to create.\n   *\n   * @param block The block to recycle.\n   */\n  private recycleBlock(block: BlockSvg) {\n    const xy = block.getRelativeToSurfaceXY();\n    block.moveBy(-xy.x, -xy.y);\n    this.recycledBlocks.push(block);\n  }\n\n  /**\n   * Add listeners to a block that has been added to the flyout.\n   *\n   * @param root The root node of the SVG group the block is in.\n   * @param block The block to add listeners for.\n   * @param rect The invisible rectangle under the block that acts\n   *     as a mat for that block.\n   */\n  protected addBlockListeners_(\n    root: SVGElement,\n    block: BlockSvg,\n    rect: SVGElement\n  ) {\n    this.listeners.push(\n      browserEvents.conditionalBind(\n        root,\n        'pointerdown',\n        null,\n        this.blockMouseDown(block)\n      )\n    );\n    this.listeners.push(\n      browserEvents.conditionalBind(\n        rect,\n        'pointerdown',\n        null,\n        this.blockMouseDown(block)\n      )\n    );\n    this.listeners.push(\n      browserEvents.bind(root, 'pointerenter', block, block.addSelect)\n    );\n    this.listeners.push(\n      browserEvents.bind(root, 'pointerleave', block, block.removeSelect)\n    );\n    this.listeners.push(\n      browserEvents.bind(rect, 'pointerenter', block, block.addSelect)\n    );\n    this.listeners.push(\n      browserEvents.bind(rect, 'pointerleave', block, block.removeSelect)\n    );\n  }\n\n  /**\n   * Handle a pointerdown on an SVG block in a non-closing flyout.\n   *\n   * @param block The flyout block to copy.\n   * @returns Function to call when block is clicked.\n   */\n  private blockMouseDown(block: BlockSvg): Function {\n    return (e: PointerEvent) => {\n      const gesture = this.targetWorkspace.getGesture(e);\n      if (gesture) {\n        gesture.setStartBlock(block);\n        gesture.handleFlyoutStart(e, this);\n      }\n    };\n  }\n\n  /**\n   * Pointer down on the flyout background.  Start a vertical scroll drag.\n   *\n   * @param e Pointer down event.\n   */\n  private onMouseDown(e: PointerEvent) {\n    const gesture = this.targetWorkspace.getGesture(e);\n    if (gesture) {\n      gesture.handleFlyoutStart(e, this);\n    }\n  }\n\n  /**\n   * Does this flyout allow you to create a new instance of the given block?\n   * Used for deciding if a block can be \"dragged out of\" the flyout.\n   *\n   * @param block The block to copy from the flyout.\n   * @returns True if you can create a new instance of the block, false\n   *    otherwise.\n   * @internal\n   */\n  isBlockCreatable(block: BlockSvg): boolean {\n    return block.isEnabled();\n  }\n\n  /**\n   * Create a copy of this block on the workspace.\n   *\n   * @param originalBlock The block to copy from the flyout.\n   * @returns The newly created block.\n   * @throws {Error} if something went wrong with deserialization.\n   * @internal\n   */\n  createBlock(originalBlock: BlockSvg): BlockSvg {\n    let newBlock = null;\n    eventUtils.disable();\n    const variablesBeforeCreation = this.targetWorkspace.getAllVariables();\n    this.targetWorkspace.setResizesEnabled(false);\n    try {\n      newBlock = this.placeNewBlock(originalBlock);\n    } finally {\n      eventUtils.enable();\n    }\n\n    // Close the flyout.\n    this.targetWorkspace.hideChaff();\n\n    const newVariables = Variables.getAddedVariables(\n      this.targetWorkspace,\n      variablesBeforeCreation\n    );\n\n    if (eventUtils.isEnabled()) {\n      eventUtils.setGroup(true);\n      // Fire a VarCreate event for each (if any) new variable created.\n      for (let i = 0; i < newVariables.length; i++) {\n        const thisVariable = newVariables[i];\n        eventUtils.fire(\n          new (eventUtils.get(eventUtils.VAR_CREATE))(thisVariable)\n        );\n      }\n\n      // Block events come after var events, in case they refer to newly created\n      // variables.\n      eventUtils.fire(new (eventUtils.get(eventUtils.BLOCK_CREATE))(newBlock));\n    }\n    if (this.autoClose) {\n      this.hide();\n    } else {\n      this.filterForCapacity();\n    }\n    return newBlock;\n  }\n\n  /**\n   * Initialize the given button: move it to the correct location,\n   * add listeners, etc.\n   *\n   * @param button The button to initialize and place.\n   * @param x The x position of the cursor during this layout pass.\n   * @param y The y position of the cursor during this layout pass.\n   */\n  protected initFlyoutButton_(button: FlyoutButton, x: number, y: number) {\n    const buttonSvg = button.createDom();\n    button.moveTo(x, y);\n    button.show();\n    // Clicking on a flyout button or label is a lot like clicking on the\n    // flyout background.\n    this.listeners.push(\n      browserEvents.conditionalBind(\n        buttonSvg,\n        'pointerdown',\n        this,\n        this.onMouseDown\n      )\n    );\n\n    this.buttons_.push(button);\n  }\n\n  /**\n   * Create and place a rectangle corresponding to the given block.\n   *\n   * @param block The block to associate the rect to.\n   * @param x The x position of the cursor during this layout pass.\n   * @param y The y position of the cursor during this layout pass.\n   * @param blockHW The height and width of\n   *     the block.\n   * @param index The index into the mats list where this rect should\n   *     be placed.\n   * @returns Newly created SVG element for the rectangle behind\n   *     the block.\n   */\n  protected createRect_(\n    block: BlockSvg,\n    x: number,\n    y: number,\n    blockHW: {height: number; width: number},\n    index: number\n  ): SVGElement {\n    // Create an invisible rectangle under the block to act as a button.  Just\n    // using the block as a button is poor, since blocks have holes in them.\n    const rect = dom.createSvgElement(Svg.RECT, {\n      'fill-opacity': 0,\n      'x': x,\n      'y': y,\n      'height': blockHW.height,\n      'width': blockHW.width,\n    });\n    (rect as AnyDuringMigration).tooltip = block;\n    Tooltip.bindMouseEvents(rect);\n    // Add the rectangles under the blocks, so that the blocks' tooltips work.\n    this.workspace_.getCanvas().insertBefore(rect, block.getSvgRoot());\n\n    this.rectMap_.set(block, rect);\n    this.mats[index] = rect;\n    return rect;\n  }\n\n  /**\n   * Move a rectangle to sit exactly behind a block, taking into account tabs,\n   * hats, and any other protrusions we invent.\n   *\n   * @param rect The rectangle to move directly behind the block.\n   * @param block The block the rectangle should be behind.\n   */\n  protected moveRectToBlock_(rect: SVGElement, block: BlockSvg) {\n    const blockHW = block.getHeightWidth();\n    rect.setAttribute('width', String(blockHW.width));\n    rect.setAttribute('height', String(blockHW.height));\n\n    const blockXY = block.getRelativeToSurfaceXY();\n    rect.setAttribute('y', String(blockXY.y));\n    rect.setAttribute(\n      'x',\n      String(this.RTL ? blockXY.x - blockHW.width : blockXY.x)\n    );\n  }\n\n  /**\n   * Filter the blocks on the flyout to disable the ones that are above the\n   * capacity limit.  For instance, if the user may only place two more blocks\n   * on the workspace, an \"a + b\" block that has two shadow blocks would be\n   * disabled.\n   */\n  private filterForCapacity() {\n    const blocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      if (this.permanentlyDisabled.indexOf(block) === -1) {\n        const enable = this.targetWorkspace.isCapacityAvailable(\n          common.getBlockTypeCounts(block)\n        );\n        while (block) {\n          block.setEnabled(enable);\n          block = block.getNextBlock();\n        }\n      }\n    }\n  }\n\n  /**\n   * Reflow blocks and their mats.\n   */\n  reflow() {\n    if (this.reflowWrapper) {\n      this.workspace_.removeChangeListener(this.reflowWrapper);\n    }\n    this.reflowInternal_();\n    if (this.reflowWrapper) {\n      this.workspace_.addChangeListener(this.reflowWrapper);\n    }\n  }\n\n  /**\n   * @returns True if this flyout may be scrolled with a scrollbar or\n   *     by dragging.\n   * @internal\n   */\n  isScrollable(): boolean {\n    return this.workspace_.scrollbar\n      ? this.workspace_.scrollbar.isVisible()\n      : false;\n  }\n\n  /**\n   * Copy a block from the flyout to the workspace and position it correctly.\n   *\n   * @param oldBlock The flyout block to copy.\n   * @returns The new block in the main workspace.\n   */\n  private placeNewBlock(oldBlock: BlockSvg): BlockSvg {\n    const targetWorkspace = this.targetWorkspace;\n    const svgRootOld = oldBlock.getSvgRoot();\n    if (!svgRootOld) {\n      throw Error('oldBlock is not rendered');\n    }\n\n    // Clone the block.\n    const json = blocks.save(oldBlock) as blocks.State;\n    // Normallly this resizes leading to weird jumps. Save it for terminateDrag.\n    targetWorkspace.setResizesEnabled(false);\n    const block = blocks.append(json, targetWorkspace) as BlockSvg;\n\n    this.positionNewBlock(oldBlock, block);\n\n    return block;\n  }\n\n  /**\n   * Positions a block on the target workspace.\n   *\n   * @param oldBlock The flyout block being copied.\n   * @param block The block to posiiton.\n   */\n  private positionNewBlock(oldBlock: BlockSvg, block: BlockSvg) {\n    const targetWorkspace = this.targetWorkspace;\n\n    // The offset in pixels between the main workspace's origin and the upper\n    // left corner of the injection div.\n    const mainOffsetPixels = targetWorkspace.getOriginOffsetInPixels();\n\n    // The offset in pixels between the flyout workspace's origin and the upper\n    // left corner of the injection div.\n    const flyoutOffsetPixels = this.workspace_.getOriginOffsetInPixels();\n\n    // The position of the old block in flyout workspace coordinates.\n    const oldBlockPos = oldBlock.getRelativeToSurfaceXY();\n    // The position of the old block in pixels relative to the flyout\n    // workspace's origin.\n    oldBlockPos.scale(this.workspace_.scale);\n\n    // The position of the old block in pixels relative to the upper left corner\n    // of the injection div.\n    const oldBlockOffsetPixels = Coordinate.sum(\n      flyoutOffsetPixels,\n      oldBlockPos\n    );\n\n    // The position of the old block in pixels relative to the origin of the\n    // main workspace.\n    const finalOffset = Coordinate.difference(\n      oldBlockOffsetPixels,\n      mainOffsetPixels\n    );\n    // The position of the old block in main workspace coordinates.\n    finalOffset.scale(1 / targetWorkspace.scale);\n\n    // No 'reason' provided since events are disabled.\n    block.moveTo(new Coordinate(finalOffset.x, finalOffset.y));\n  }\n}\n\n/**\n * A flyout content item.\n */\nexport interface FlyoutItem {\n  type: FlyoutItemType;\n  button?: FlyoutButton | undefined;\n  block?: BlockSvg | undefined;\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Horizontal flyout tray containing blocks which may be created.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.HorizontalFlyout');\n\nimport * as browserEvents from './browser_events.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Flyout, FlyoutItem} from './flyout_base.js';\nimport type {FlyoutButton} from './flyout_button.js';\nimport type {Options} from './options.js';\nimport * as registry from './registry.js';\nimport {Scrollbar} from './scrollbar.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport {Rect} from './utils/rect.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n/**\n * Class for a flyout.\n */\nexport class HorizontalFlyout extends Flyout {\n  override horizontalLayout = true;\n\n  /** @param workspaceOptions Dictionary of options for the workspace. */\n  constructor(workspaceOptions: Options) {\n    super(workspaceOptions);\n  }\n\n  /**\n   * Sets the translation of the flyout to match the scrollbars.\n   *\n   * @param xyRatio Contains a y property which is a float between 0 and 1\n   *     specifying the degree of scrolling and a similar x property.\n   */\n  protected override setMetrics_(xyRatio: {x: number; y: number}) {\n    if (!this.isVisible()) {\n      return;\n    }\n\n    const metricsManager = this.workspace_.getMetricsManager();\n    const scrollMetrics = metricsManager.getScrollMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n\n    if (typeof xyRatio.x === 'number') {\n      this.workspace_.scrollX = -(\n        scrollMetrics.left +\n        (scrollMetrics.width - viewMetrics.width) * xyRatio.x\n      );\n    }\n\n    this.workspace_.translate(\n      this.workspace_.scrollX + absoluteMetrics.left,\n      this.workspace_.scrollY + absoluteMetrics.top\n    );\n  }\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  override getX(): number {\n    // X is always 0 since this is a horizontal flyout.\n    return 0;\n  }\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  override getY(): number {\n    if (!this.isVisible()) {\n      return 0;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const toolboxMetrics = metricsManager.getToolboxMetrics();\n\n    let y = 0;\n    const atTop = this.toolboxPosition_ === toolbox.Position.TOP;\n    // If this flyout is not the trashcan flyout (e.g. toolbox or mutator).\n    // Trashcan flyout is opposite the main flyout.\n    if (this.targetWorkspace!.toolboxPosition === this.toolboxPosition_) {\n      // If there is a category toolbox.\n      // Simple (flyout-only) toolbox.\n      if (this.targetWorkspace!.getToolbox()) {\n        if (atTop) {\n          y = toolboxMetrics.height;\n        } else {\n          y = viewMetrics.height - this.height_;\n        }\n      } else {\n        if (atTop) {\n          y = 0;\n        } else {\n          // The simple flyout does not cover the workspace.\n          y = viewMetrics.height;\n        }\n      }\n    } else {\n      if (atTop) {\n        y = 0;\n      } else {\n        // Because the anchor point of the flyout is on the top, but we want\n        // to align the bottom edge of the flyout with the bottom edge of the\n        // blocklyDiv, we calculate the full height of the div minus the height\n        // of the flyout.\n        y = viewMetrics.height + absoluteMetrics.top - this.height_;\n      }\n    }\n\n    return y;\n  }\n\n  /** Move the flyout to the edge of the workspace. */\n  override position() {\n    if (!this.isVisible() || !this.targetWorkspace!.isVisible()) {\n      return;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const targetWorkspaceViewMetrics = metricsManager.getViewMetrics();\n    this.width_ = targetWorkspaceViewMetrics.width;\n\n    const edgeWidth = targetWorkspaceViewMetrics.width - 2 * this.CORNER_RADIUS;\n    const edgeHeight = this.height_ - this.CORNER_RADIUS;\n    this.setBackgroundPath(edgeWidth, edgeHeight);\n\n    const x = this.getX();\n    const y = this.getY();\n\n    this.positionAt_(this.width_, this.height_, x, y);\n  }\n\n  /**\n   * Create and set the path for the visible boundaries of the flyout.\n   *\n   * @param width The width of the flyout, not including the rounded corners.\n   * @param height The height of the flyout, not including rounded corners.\n   */\n  private setBackgroundPath(width: number, height: number) {\n    const atTop = this.toolboxPosition_ === toolbox.Position.TOP;\n    // Start at top left.\n    const path: (string | number)[] = [\n      'M 0,' + (atTop ? 0 : this.CORNER_RADIUS),\n    ];\n\n    if (atTop) {\n      // Top.\n      path.push('h', width + 2 * this.CORNER_RADIUS);\n      // Right.\n      path.push('v', height);\n      // Bottom.\n      path.push(\n        'a',\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n        0,\n        0,\n        1,\n        -this.CORNER_RADIUS,\n        this.CORNER_RADIUS\n      );\n      path.push('h', -width);\n      // Left.\n      path.push(\n        'a',\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n        0,\n        0,\n        1,\n        -this.CORNER_RADIUS,\n        -this.CORNER_RADIUS\n      );\n      path.push('z');\n    } else {\n      // Top.\n      path.push(\n        'a',\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n        0,\n        0,\n        1,\n        this.CORNER_RADIUS,\n        -this.CORNER_RADIUS\n      );\n      path.push('h', width);\n      // Right.\n      path.push(\n        'a',\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS,\n        0,\n        0,\n        1,\n        this.CORNER_RADIUS,\n        this.CORNER_RADIUS\n      );\n      path.push('v', height);\n      // Bottom.\n      path.push('h', -width - 2 * this.CORNER_RADIUS);\n      // Left.\n      path.push('z');\n    }\n    this.svgBackground_!.setAttribute('d', path.join(' '));\n  }\n\n  /** Scroll the flyout to the top. */\n  override scrollToStart() {\n    this.workspace_.scrollbar?.setX(this.RTL ? Infinity : 0);\n  }\n\n  /**\n   * Scroll the flyout.\n   *\n   * @param e Mouse wheel scroll event.\n   */\n  protected override wheel_(e: WheelEvent) {\n    const scrollDelta = browserEvents.getScrollDeltaPixels(e);\n    const delta = scrollDelta.x || scrollDelta.y;\n\n    if (delta) {\n      const metricsManager = this.workspace_.getMetricsManager();\n      const scrollMetrics = metricsManager.getScrollMetrics();\n      const viewMetrics = metricsManager.getViewMetrics();\n\n      const pos = viewMetrics.left - scrollMetrics.left + delta;\n      this.workspace_.scrollbar?.setX(pos);\n      // When the flyout moves from a wheel event, hide WidgetDiv and\n      // dropDownDiv.\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n    }\n    // Don't scroll the page.\n    e.preventDefault();\n    // Don't propagate mousewheel event (zooming).\n    e.stopPropagation();\n  }\n\n  /**\n   * Lay out the blocks in the flyout.\n   *\n   * @param contents The blocks and buttons to lay out.\n   * @param gaps The visible gaps between blocks.\n   */\n  protected override layout_(contents: FlyoutItem[], gaps: number[]) {\n    this.workspace_.scale = this.targetWorkspace!.scale;\n    const margin = this.MARGIN;\n    let cursorX = margin + this.tabWidth_;\n    const cursorY = margin;\n    if (this.RTL) {\n      contents = contents.reverse();\n    }\n\n    for (let i = 0, item; (item = contents[i]); i++) {\n      if (item.type === 'block') {\n        const block = item.block;\n        const allBlocks = block!.getDescendants(false);\n        for (let j = 0, child; (child = allBlocks[j]); j++) {\n          // Mark blocks as being inside a flyout.  This is used to detect and\n          // prevent the closure of the flyout if the user right-clicks on such\n          // a block.\n          child.isInFlyout = true;\n        }\n        const root = block!.getSvgRoot();\n        const blockHW = block!.getHeightWidth();\n        // Figure out where to place the block.\n        const tab = block!.outputConnection ? this.tabWidth_ : 0;\n        let moveX;\n        if (this.RTL) {\n          moveX = cursorX + blockHW.width;\n        } else {\n          moveX = cursorX - tab;\n        }\n        block!.moveBy(moveX, cursorY);\n\n        const rect = this.createRect_(block!, moveX, cursorY, blockHW, i);\n        cursorX += blockHW.width + gaps[i];\n\n        this.addBlockListeners_(root, block!, rect);\n      } else if (item.type === 'button') {\n        const button = item.button as FlyoutButton;\n        this.initFlyoutButton_(button, cursorX, cursorY);\n        cursorX += button.width + gaps[i];\n      }\n    }\n  }\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   * @internal\n   */\n  override isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean {\n    const dx = currentDragDeltaXY.x;\n    const dy = currentDragDeltaXY.y;\n    // Direction goes from -180 to 180, with 0 toward the right and 90 on top.\n    const dragDirection = (Math.atan2(dy, dx) / Math.PI) * 180;\n\n    const range = this.dragAngleRange_;\n    // Check for up or down dragging.\n    if (\n      (dragDirection < 90 + range && dragDirection > 90 - range) ||\n      (dragDirection > -90 - range && dragDirection < -90 + range)\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect | null {\n    if (!this.svgGroup_ || this.autoClose || !this.isVisible()) {\n      // The bounding rectangle won't compute correctly if the flyout is closed\n      // and auto-close flyouts aren't valid drag targets (or delete areas).\n      return null;\n    }\n\n    const flyoutRect = this.svgGroup_.getBoundingClientRect();\n    // BIG_NUM is offscreen padding so that blocks dragged beyond the shown\n    // flyout area are still deleted.  Must be larger than the largest screen\n    // size, but be smaller than half Number.MAX_SAFE_INTEGER (not available on\n    // IE).\n    const BIG_NUM = 1000000000;\n    const top = flyoutRect.top;\n\n    if (this.toolboxPosition_ === toolbox.Position.TOP) {\n      const height = flyoutRect.height;\n      return new Rect(-BIG_NUM, top + height, -BIG_NUM, BIG_NUM);\n    } else {\n      // Bottom.\n      return new Rect(top, BIG_NUM, -BIG_NUM, BIG_NUM);\n    }\n  }\n\n  /**\n   * Compute height of flyout.  toolbox.Position mat under each block.\n   * For RTL: Lay out the blocks right-aligned.\n   */\n  protected override reflowInternal_() {\n    this.workspace_.scale = this.getFlyoutScale();\n    let flyoutHeight = 0;\n    const blocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      flyoutHeight = Math.max(flyoutHeight, block.getHeightWidth().height);\n    }\n    const buttons = this.buttons_;\n    for (let i = 0, button; (button = buttons[i]); i++) {\n      flyoutHeight = Math.max(flyoutHeight, button.height);\n    }\n    flyoutHeight += this.MARGIN * 1.5;\n    flyoutHeight *= this.workspace_.scale;\n    flyoutHeight += Scrollbar.scrollbarThickness;\n\n    if (this.height_ !== flyoutHeight) {\n      for (let i = 0, block; (block = blocks[i]); i++) {\n        if (this.rectMap_.has(block)) {\n          this.moveRectToBlock_(this.rectMap_.get(block)!, block);\n        }\n      }\n\n      if (\n        this.targetWorkspace!.toolboxPosition === this.toolboxPosition_ &&\n        this.toolboxPosition_ === toolbox.Position.TOP &&\n        !this.targetWorkspace!.getToolbox()\n      ) {\n        // This flyout is a simple toolbox. Reposition the workspace so that\n        // (0,0) is in the correct position relative to the new absolute edge\n        // (ie toolbox edge).\n        this.targetWorkspace!.translate(\n          this.targetWorkspace!.scrollX,\n          this.targetWorkspace!.scrollY + flyoutHeight\n        );\n      }\n      this.height_ = flyoutHeight;\n      this.position();\n      this.targetWorkspace!.recordDragTargets();\n    }\n  }\n}\n\nregistry.register(\n  registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,\n  registry.DEFAULT,\n  HorizontalFlyout\n);\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Layout code for a vertical variant of the flyout.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.VerticalFlyout');\n\nimport * as browserEvents from './browser_events.js';\nimport * as dropDownDiv from './dropdowndiv.js';\nimport {Flyout, FlyoutItem} from './flyout_base.js';\nimport type {FlyoutButton} from './flyout_button.js';\nimport type {Options} from './options.js';\nimport * as registry from './registry.js';\nimport {Scrollbar} from './scrollbar.js';\nimport type {Coordinate} from './utils/coordinate.js';\nimport {Rect} from './utils/rect.js';\nimport * as toolbox from './utils/toolbox.js';\nimport * as WidgetDiv from './widgetdiv.js';\n\n/**\n * Class for a flyout.\n */\nexport class VerticalFlyout extends Flyout {\n  /** The name of the vertical flyout in the registry. */\n  static registryName = 'verticalFlyout';\n\n  /** @param workspaceOptions Dictionary of options for the workspace. */\n  constructor(workspaceOptions: Options) {\n    super(workspaceOptions);\n  }\n\n  /**\n   * Sets the translation of the flyout to match the scrollbars.\n   *\n   * @param xyRatio Contains a y property which is a float between 0 and 1\n   *     specifying the degree of scrolling and a similar x property.\n   */\n  protected override setMetrics_(xyRatio: {x: number; y: number}) {\n    if (!this.isVisible()) {\n      return;\n    }\n    const metricsManager = this.workspace_.getMetricsManager();\n    const scrollMetrics = metricsManager.getScrollMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n\n    if (typeof xyRatio.y === 'number') {\n      this.workspace_.scrollY = -(\n        scrollMetrics.top +\n        (scrollMetrics.height - viewMetrics.height) * xyRatio.y\n      );\n    }\n    this.workspace_.translate(\n      this.workspace_.scrollX + absoluteMetrics.left,\n      this.workspace_.scrollY + absoluteMetrics.top\n    );\n  }\n\n  /**\n   * Calculates the x coordinate for the flyout position.\n   *\n   * @returns X coordinate.\n   */\n  override getX(): number {\n    if (!this.isVisible()) {\n      return 0;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const absoluteMetrics = metricsManager.getAbsoluteMetrics();\n    const viewMetrics = metricsManager.getViewMetrics();\n    const toolboxMetrics = metricsManager.getToolboxMetrics();\n    let x = 0;\n\n    // If this flyout is not the trashcan flyout (e.g. toolbox or mutator).\n    // Trashcan flyout is opposite the main flyout.\n    if (this.targetWorkspace!.toolboxPosition === this.toolboxPosition_) {\n      // If there is a category toolbox.\n      // Simple (flyout-only) toolbox.\n      if (this.targetWorkspace!.getToolbox()) {\n        if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n          x = toolboxMetrics.width;\n        } else {\n          x = viewMetrics.width - this.width_;\n        }\n      } else {\n        if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n          x = 0;\n        } else {\n          // The simple flyout does not cover the workspace.\n          x = viewMetrics.width;\n        }\n      }\n    } else {\n      if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n        x = 0;\n      } else {\n        // Because the anchor point of the flyout is on the left, but we want\n        // to align the right edge of the flyout with the right edge of the\n        // blocklyDiv, we calculate the full width of the div minus the width\n        // of the flyout.\n        x = viewMetrics.width + absoluteMetrics.left - this.width_;\n      }\n    }\n\n    return x;\n  }\n\n  /**\n   * Calculates the y coordinate for the flyout position.\n   *\n   * @returns Y coordinate.\n   */\n  override getY(): number {\n    // Y is always 0 since this is a vertical flyout.\n    return 0;\n  }\n\n  /** Move the flyout to the edge of the workspace. */\n  override position() {\n    if (!this.isVisible() || !this.targetWorkspace!.isVisible()) {\n      return;\n    }\n    const metricsManager = this.targetWorkspace!.getMetricsManager();\n    const targetWorkspaceViewMetrics = metricsManager.getViewMetrics();\n    this.height_ = targetWorkspaceViewMetrics.height;\n\n    const edgeWidth = this.width_ - this.CORNER_RADIUS;\n    const edgeHeight =\n      targetWorkspaceViewMetrics.height - 2 * this.CORNER_RADIUS;\n    this.setBackgroundPath(edgeWidth, edgeHeight);\n\n    const x = this.getX();\n    const y = this.getY();\n\n    this.positionAt_(this.width_, this.height_, x, y);\n  }\n\n  /**\n   * Create and set the path for the visible boundaries of the flyout.\n   *\n   * @param width The width of the flyout, not including the rounded corners.\n   * @param height The height of the flyout, not including rounded corners.\n   */\n  private setBackgroundPath(width: number, height: number) {\n    const atRight = this.toolboxPosition_ === toolbox.Position.RIGHT;\n    const totalWidth = width + this.CORNER_RADIUS;\n\n    // Decide whether to start on the left or right.\n    const path: Array<string | number> = [\n      'M ' + (atRight ? totalWidth : 0) + ',0',\n    ];\n    // Top.\n    path.push('h', atRight ? -width : width);\n    // Rounded corner.\n    path.push(\n      'a',\n      this.CORNER_RADIUS,\n      this.CORNER_RADIUS,\n      0,\n      0,\n      atRight ? 0 : 1,\n      atRight ? -this.CORNER_RADIUS : this.CORNER_RADIUS,\n      this.CORNER_RADIUS\n    );\n    // Side closest to workspace.\n    path.push('v', Math.max(0, height));\n    // Rounded corner.\n    path.push(\n      'a',\n      this.CORNER_RADIUS,\n      this.CORNER_RADIUS,\n      0,\n      0,\n      atRight ? 0 : 1,\n      atRight ? this.CORNER_RADIUS : -this.CORNER_RADIUS,\n      this.CORNER_RADIUS\n    );\n    // Bottom.\n    path.push('h', atRight ? width : -width);\n    path.push('z');\n    this.svgBackground_!.setAttribute('d', path.join(' '));\n  }\n\n  /** Scroll the flyout to the top. */\n  override scrollToStart() {\n    this.workspace_.scrollbar?.setY(0);\n  }\n\n  /**\n   * Scroll the flyout.\n   *\n   * @param e Mouse wheel scroll event.\n   */\n  protected override wheel_(e: WheelEvent) {\n    const scrollDelta = browserEvents.getScrollDeltaPixels(e);\n\n    if (scrollDelta.y) {\n      const metricsManager = this.workspace_.getMetricsManager();\n      const scrollMetrics = metricsManager.getScrollMetrics();\n      const viewMetrics = metricsManager.getViewMetrics();\n      const pos = viewMetrics.top - scrollMetrics.top + scrollDelta.y;\n\n      this.workspace_.scrollbar?.setY(pos);\n      // When the flyout moves from a wheel event, hide WidgetDiv and\n      // dropDownDiv.\n      WidgetDiv.hide();\n      dropDownDiv.hideWithoutAnimation();\n    }\n    // Don't scroll the page.\n    e.preventDefault();\n    // Don't propagate mousewheel event (zooming).\n    e.stopPropagation();\n  }\n\n  /**\n   * Lay out the blocks in the flyout.\n   *\n   * @param contents The blocks and buttons to lay out.\n   * @param gaps The visible gaps between blocks.\n   */\n  protected override layout_(contents: FlyoutItem[], gaps: number[]) {\n    this.workspace_.scale = this.targetWorkspace!.scale;\n    const margin = this.MARGIN;\n    const cursorX = this.RTL ? margin : margin + this.tabWidth_;\n    let cursorY = margin;\n\n    for (let i = 0, item; (item = contents[i]); i++) {\n      if (item.type === 'block') {\n        const block = item.block;\n        const allBlocks = block!.getDescendants(false);\n        for (let j = 0, child; (child = allBlocks[j]); j++) {\n          // Mark blocks as being inside a flyout.  This is used to detect and\n          // prevent the closure of the flyout if the user right-clicks on such\n          // a block.\n          child.isInFlyout = true;\n        }\n        const root = block!.getSvgRoot();\n        const blockHW = block!.getHeightWidth();\n        const moveX = block!.outputConnection\n          ? cursorX - this.tabWidth_\n          : cursorX;\n        block!.moveBy(moveX, cursorY);\n\n        const rect = this.createRect_(\n          block!,\n          this.RTL ? moveX - blockHW.width : moveX,\n          cursorY,\n          blockHW,\n          i\n        );\n\n        this.addBlockListeners_(root, block!, rect);\n\n        cursorY += blockHW.height + gaps[i];\n      } else if (item.type === 'button') {\n        const button = item.button as FlyoutButton;\n        this.initFlyoutButton_(button, cursorX, cursorY);\n        cursorY += button.height + gaps[i];\n      }\n    }\n  }\n\n  /**\n   * Determine if a drag delta is toward the workspace, based on the position\n   * and orientation of the flyout. This is used in determineDragIntention_ to\n   * determine if a new block should be created or if the flyout should scroll.\n   *\n   * @param currentDragDeltaXY How far the pointer has moved from the position\n   *     at mouse down, in pixel units.\n   * @returns True if the drag is toward the workspace.\n   * @internal\n   */\n  override isDragTowardWorkspace(currentDragDeltaXY: Coordinate): boolean {\n    const dx = currentDragDeltaXY.x;\n    const dy = currentDragDeltaXY.y;\n    // Direction goes from -180 to 180, with 0 toward the right and 90 on top.\n    const dragDirection = (Math.atan2(dy, dx) / Math.PI) * 180;\n\n    const range = this.dragAngleRange_;\n    // Check for left or right dragging.\n    if (\n      (dragDirection < range && dragDirection > -range) ||\n      dragDirection < -180 + range ||\n      dragDirection > 180 - range\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect | null {\n    if (!this.svgGroup_ || this.autoClose || !this.isVisible()) {\n      // The bounding rectangle won't compute correctly if the flyout is closed\n      // and auto-close flyouts aren't valid drag targets (or delete areas).\n      return null;\n    }\n\n    const flyoutRect = this.svgGroup_.getBoundingClientRect();\n    // BIG_NUM is offscreen padding so that blocks dragged beyond the shown\n    // flyout area are still deleted.  Must be larger than the largest screen\n    // size, but be smaller than half Number.MAX_SAFE_INTEGER (not available on\n    // IE).\n    const BIG_NUM = 1000000000;\n    const left = flyoutRect.left;\n\n    if (this.toolboxPosition_ === toolbox.Position.LEFT) {\n      const width = flyoutRect.width;\n      return new Rect(-BIG_NUM, BIG_NUM, -BIG_NUM, left + width);\n    } else {\n      // Right\n      return new Rect(-BIG_NUM, BIG_NUM, left, BIG_NUM);\n    }\n  }\n\n  /**\n   * Compute width of flyout.  toolbox.Position mat under each block.\n   * For RTL: Lay out the blocks and buttons to be right-aligned.\n   */\n  protected override reflowInternal_() {\n    this.workspace_.scale = this.getFlyoutScale();\n    let flyoutWidth = 0;\n    const blocks = this.workspace_.getTopBlocks(false);\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      let width = block.getHeightWidth().width;\n      if (block.outputConnection) {\n        width -= this.tabWidth_;\n      }\n      flyoutWidth = Math.max(flyoutWidth, width);\n    }\n    for (let i = 0, button; (button = this.buttons_[i]); i++) {\n      flyoutWidth = Math.max(flyoutWidth, button.width);\n    }\n    flyoutWidth += this.MARGIN * 1.5 + this.tabWidth_;\n    flyoutWidth *= this.workspace_.scale;\n    flyoutWidth += Scrollbar.scrollbarThickness;\n\n    if (this.width_ !== flyoutWidth) {\n      for (let i = 0, block; (block = blocks[i]); i++) {\n        if (this.RTL) {\n          // With the flyoutWidth known, right-align the blocks.\n          const oldX = block.getRelativeToSurfaceXY().x;\n          let newX = flyoutWidth / this.workspace_.scale - this.MARGIN;\n          if (!block.outputConnection) {\n            newX -= this.tabWidth_;\n          }\n          block.moveBy(newX - oldX, 0);\n        }\n        if (this.rectMap_.has(block)) {\n          this.moveRectToBlock_(this.rectMap_.get(block)!, block);\n        }\n      }\n      if (this.RTL) {\n        // With the flyoutWidth known, right-align the buttons.\n        for (let i = 0, button; (button = this.buttons_[i]); i++) {\n          const y = button.getPosition().y;\n          const x =\n            flyoutWidth / this.workspace_.scale -\n            button.width -\n            this.MARGIN -\n            this.tabWidth_;\n          button.moveTo(x, y);\n        }\n      }\n\n      if (\n        this.targetWorkspace!.toolboxPosition === this.toolboxPosition_ &&\n        this.toolboxPosition_ === toolbox.Position.LEFT &&\n        !this.targetWorkspace!.getToolbox()\n      ) {\n        // This flyout is a simple toolbox. Reposition the workspace so that\n        // (0,0) is in the correct position relative to the new absolute edge\n        // (ie toolbox edge).\n        this.targetWorkspace!.translate(\n          this.targetWorkspace!.scrollX + flyoutWidth,\n          this.targetWorkspace!.scrollY\n        );\n      }\n      this.width_ = flyoutWidth;\n      this.position();\n      this.targetWorkspace!.recordDragTargets();\n    }\n  }\n}\n\nregistry.register(\n  registry.Type.FLYOUTS_VERTICAL_TOOLBOX,\n  registry.DEFAULT,\n  VerticalFlyout\n);\n","/**\n * @license\n * Copyright 2012 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Utility functions for generating executable code from\n * Blockly code.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.CodeGenerator');\n\nimport type {Block} from './block.js';\nimport * as common from './common.js';\nimport {Names, NameType} from './names.js';\nimport type {Workspace} from './workspace.js';\nimport {warn} from './utils/deprecation.js';\n\n/**\n * Type declaration for per-block-type generator functions.\n *\n * @see {@link https://developers.google.com/blockly/guides/create-custom-blocks/generating-code}\n * @param block The Block instance to generate code for.\n * @param genearator The CodeGenerator calling the function.\n * @returns A string containing the generated code (for statement blocks),\n *     or a [code, precedence] tuple (for value/expression blocks), or\n *     null if no code should be emitted for block.\n */\nexport type BlockGenerator = (\n  block: Block,\n  generator: CodeGenerator\n) => [string, number] | string | null;\n\n/**\n * Class for a code generator that translates the blocks into a language.\n */\nexport class CodeGenerator {\n  name_: string;\n\n  /** A dictionary of block generator functions keyed by block type. */\n  forBlock: {[type: string]: BlockGenerator} = Object.create(null);\n\n  /**\n   * This is used as a placeholder in functions defined using\n   * CodeGenerator.provideFunction_.  It must not be legal code that could\n   * legitimately appear in a function definition (or comment), and it must\n   * not confuse the regular expression parser.\n   */\n  protected FUNCTION_NAME_PLACEHOLDER_ = '{leCUI8hutHZI4480Dc}';\n  FUNCTION_NAME_PLACEHOLDER_REGEXP_: RegExp;\n\n  /**\n   * Arbitrary code to inject into locations that risk causing infinite loops.\n   * Any instances of '%1' will be replaced by the block ID that failed.\n   * E.g. `  checkTimeout(%1);\\n`\n   */\n  INFINITE_LOOP_TRAP: string | null = null;\n\n  /**\n   * Arbitrary code to inject before every statement.\n   * Any instances of '%1' will be replaced by the block ID of the statement.\n   * E.g. `highlight(%1);\\n`\n   */\n  STATEMENT_PREFIX: string | null = null;\n\n  /**\n   * Arbitrary code to inject after every statement.\n   * Any instances of '%1' will be replaced by the block ID of the statement.\n   * E.g. `highlight(%1);\\n`\n   */\n  STATEMENT_SUFFIX: string | null = null;\n\n  /**\n   * The method of indenting.  Defaults to two spaces, but language generators\n   * may override this to increase indent or change to tabs.\n   */\n  INDENT = '  ';\n\n  /**\n   * Maximum length for a comment before wrapping.  Does not account for\n   * indenting level.\n   */\n  COMMENT_WRAP = 60;\n\n  /** List of outer-inner pairings that do NOT require parentheses. */\n  ORDER_OVERRIDES: number[][] = [];\n\n  /**\n   * Whether the init method has been called.\n   * Generators that set this flag to false after creation and true in init\n   * will cause blockToCode to emit a warning if the generator has not been\n   * initialized. If this flag is untouched, it will have no effect.\n   */\n  isInitialized: boolean | null = null;\n\n  /** Comma-separated list of reserved words. */\n  protected RESERVED_WORDS_ = '';\n\n  /** A dictionary of definitions to be printed before the code. */\n  protected definitions_: {[key: string]: string} = Object.create(null);\n\n  /**\n   * A dictionary mapping desired function names in definitions_ to actual\n   * function names (to avoid collisions with user functions).\n   */\n  protected functionNames_: {[key: string]: string} = Object.create(null);\n\n  /** A database of variable and procedure names. */\n  protected nameDB_?: Names = undefined;\n\n  /** @param name Language name of this generator. */\n  constructor(name: string) {\n    this.name_ = name;\n\n    this.FUNCTION_NAME_PLACEHOLDER_REGEXP_ = new RegExp(\n      this.FUNCTION_NAME_PLACEHOLDER_,\n      'g'\n    );\n  }\n\n  /**\n   * Generate code for all blocks in the workspace to the specified language.\n   *\n   * @param workspace Workspace to generate code from.\n   * @returns Generated code.\n   */\n  workspaceToCode(workspace?: Workspace): string {\n    if (!workspace) {\n      // Backwards compatibility from before there could be multiple workspaces.\n      console.warn(\n        'No workspace specified in workspaceToCode call.  Guessing.'\n      );\n      workspace = common.getMainWorkspace();\n    }\n    const code = [];\n    this.init(workspace);\n    const blocks = workspace.getTopBlocks(true);\n    for (let i = 0, block; (block = blocks[i]); i++) {\n      let line = this.blockToCode(block);\n      if (Array.isArray(line)) {\n        // Value blocks return tuples of code and operator order.\n        // Top-level blocks don't care about operator order.\n        line = line[0];\n      }\n      if (line) {\n        if (block.outputConnection) {\n          // This block is a naked value.  Ask the language's code generator if\n          // it wants to append a semicolon, or something.\n          line = this.scrubNakedValue(line);\n          if (this.STATEMENT_PREFIX && !block.suppressPrefixSuffix) {\n            line = this.injectId(this.STATEMENT_PREFIX, block) + line;\n          }\n          if (this.STATEMENT_SUFFIX && !block.suppressPrefixSuffix) {\n            line = line + this.injectId(this.STATEMENT_SUFFIX, block);\n          }\n        }\n        code.push(line);\n      }\n    }\n    // Blank line between each section.\n    let codeString = code.join('\\n');\n    codeString = this.finish(codeString);\n    // Final scrubbing of whitespace.\n    codeString = codeString.replace(/^\\s+\\n/, '');\n    codeString = codeString.replace(/\\n\\s+$/, '\\n');\n    codeString = codeString.replace(/[ \\t]+\\n/g, '\\n');\n    return codeString;\n  }\n\n  // The following are some helpful functions which can be used by multiple\n\n  // languages.\n\n  /**\n   * Prepend a common prefix onto each line of code.\n   * Intended for indenting code or adding comment markers.\n   *\n   * @param text The lines of code.\n   * @param prefix The common prefix.\n   * @returns The prefixed lines of code.\n   */\n  prefixLines(text: string, prefix: string): string {\n    return prefix + text.replace(/(?!\\n$)\\n/g, '\\n' + prefix);\n  }\n\n  /**\n   * Recursively spider a tree of blocks, returning all their comments.\n   *\n   * @param block The block from which to start spidering.\n   * @returns Concatenated list of comments.\n   */\n  allNestedComments(block: Block): string {\n    const comments = [];\n    const blocks = block.getDescendants(true);\n    for (let i = 0; i < blocks.length; i++) {\n      const comment = blocks[i].getCommentText();\n      if (comment) {\n        comments.push(comment);\n      }\n    }\n    // Append an empty string to create a trailing line break when joined.\n    if (comments.length) {\n      comments.push('');\n    }\n    return comments.join('\\n');\n  }\n\n  /**\n   * Generate code for the specified block (and attached blocks).\n   * The generator must be initialized before calling this function.\n   *\n   * @param block The block to generate code for.\n   * @param opt_thisOnly True to generate code for only this statement.\n   * @returns For statement blocks, the generated code.\n   *     For value blocks, an array containing the generated code and an\n   * operator order value.  Returns '' if block is null.\n   */\n  blockToCode(\n    block: Block | null,\n    opt_thisOnly?: boolean\n  ): string | [string, number] {\n    if (this.isInitialized === false) {\n      console.warn(\n        'CodeGenerator init was not called before blockToCode was called.'\n      );\n    }\n    if (!block) {\n      return '';\n    }\n    if (!block.isEnabled()) {\n      // Skip past this block if it is disabled.\n      return opt_thisOnly ? '' : this.blockToCode(block.getNextBlock());\n    }\n    if (block.isInsertionMarker()) {\n      // Skip past insertion markers.\n      return opt_thisOnly ? '' : this.blockToCode(block.getChildren(false)[0]);\n    }\n\n    // Look up block generator function in dictionary - but fall back\n    // to looking up on this if not found, for backwards compatibility.\n    let func = this.forBlock[block.type];\n    if (!func && (this as any)[block.type]) {\n      warn(\n        'block generator functions on CodeGenerator objects',\n        '10.0',\n        '11.0',\n        'the .forBlock[blockType] dictionary'\n      );\n      func = (this as any)[block.type];\n    }\n    if (typeof func !== 'function') {\n      throw Error(\n        `${this.name_} generator does not know how to generate code` +\n          `for block type \"${block.type}\".`\n      );\n    }\n    // First argument to func.call is the value of 'this' in the generator.\n    // Prior to 24 September 2013 'this' was the only way to access the block.\n    // The current preferred method of accessing the block is through the second\n    // argument to func.call, which becomes the first parameter to the\n    // generator.\n    let code = func.call(block, block, this);\n    if (Array.isArray(code)) {\n      // Value blocks return tuples of code and operator order.\n      if (!block.outputConnection) {\n        throw TypeError('Expecting string from statement block: ' + block.type);\n      }\n      return [this.scrub_(block, code[0], opt_thisOnly), code[1]];\n    } else if (typeof code === 'string') {\n      if (this.STATEMENT_PREFIX && !block.suppressPrefixSuffix) {\n        code = this.injectId(this.STATEMENT_PREFIX, block) + code;\n      }\n      if (this.STATEMENT_SUFFIX && !block.suppressPrefixSuffix) {\n        code = code + this.injectId(this.STATEMENT_SUFFIX, block);\n      }\n      return this.scrub_(block, code, opt_thisOnly);\n    } else if (code === null) {\n      // Block has handled code generation itself.\n      return '';\n    }\n    throw SyntaxError('Invalid code generated: ' + code);\n  }\n\n  /**\n   * Generate code representing the specified value input.\n   *\n   * @param block The block containing the input.\n   * @param name The name of the input.\n   * @param outerOrder The maximum binding strength (minimum order value) of any\n   *     operators adjacent to \"block\".\n   * @returns Generated code or '' if no blocks are connected or the specified\n   *     input does not exist.\n   */\n  valueToCode(block: Block, name: string, outerOrder: number): string {\n    if (isNaN(outerOrder)) {\n      throw TypeError('Expecting valid order from block: ' + block.type);\n    }\n    const targetBlock = block.getInputTargetBlock(name);\n    if (!targetBlock) {\n      return '';\n    }\n    const tuple = this.blockToCode(targetBlock);\n    if (tuple === '') {\n      // Disabled block.\n      return '';\n    }\n    // Value blocks must return code and order of operations info.\n    // Statement blocks must only return code.\n    if (!Array.isArray(tuple)) {\n      throw TypeError(\n        `Expecting tuple from value block: ${targetBlock.type} See ` +\n          `developers.google.com/blockly/guides/create-custom-blocks/generating-code ` +\n          `for more information`\n      );\n    }\n    let code = tuple[0];\n    const innerOrder = tuple[1];\n    if (isNaN(innerOrder)) {\n      throw TypeError(\n        'Expecting valid order from value block: ' + targetBlock.type\n      );\n    }\n    if (!code) {\n      return '';\n    }\n\n    // Add parentheses if needed.\n    let parensNeeded = false;\n    const outerOrderClass = Math.floor(outerOrder);\n    const innerOrderClass = Math.floor(innerOrder);\n    if (outerOrderClass <= innerOrderClass) {\n      if (\n        outerOrderClass === innerOrderClass &&\n        (outerOrderClass === 0 || outerOrderClass === 99)\n      ) {\n        // Don't generate parens around NONE-NONE and ATOMIC-ATOMIC pairs.\n        // 0 is the atomic order, 99 is the none order.  No parentheses needed.\n        // In all known languages multiple such code blocks are not order\n        // sensitive.  In fact in Python ('a' 'b') 'c' would fail.\n      } else {\n        // The operators outside this code are stronger than the operators\n        // inside this code.  To prevent the code from being pulled apart,\n        // wrap the code in parentheses.\n        parensNeeded = true;\n        // Check for special exceptions.\n        for (let i = 0; i < this.ORDER_OVERRIDES.length; i++) {\n          if (\n            this.ORDER_OVERRIDES[i][0] === outerOrder &&\n            this.ORDER_OVERRIDES[i][1] === innerOrder\n          ) {\n            parensNeeded = false;\n            break;\n          }\n        }\n      }\n    }\n    if (parensNeeded) {\n      // Technically, this should be handled on a language-by-language basis.\n      // However all known (sane) languages use parentheses for grouping.\n      code = '(' + code + ')';\n    }\n    return code;\n  }\n\n  /**\n   * Generate a code string representing the blocks attached to the named\n   * statement input. Indent the code.\n   * This is mainly used in generators. When trying to generate code to evaluate\n   * look at using workspaceToCode or blockToCode.\n   *\n   * @param block The block containing the input.\n   * @param name The name of the input.\n   * @returns Generated code or '' if no blocks are connected.\n   */\n  statementToCode(block: Block, name: string): string {\n    const targetBlock = block.getInputTargetBlock(name);\n    let code = this.blockToCode(targetBlock);\n    // Value blocks must return code and order of operations info.\n    // Statement blocks must only return code.\n    if (typeof code !== 'string') {\n      throw TypeError(\n        'Expecting code from statement block: ' +\n          (targetBlock && targetBlock.type)\n      );\n    }\n    if (code) {\n      code = this.prefixLines(code, this.INDENT);\n    }\n    return code;\n  }\n\n  /**\n   * Add an infinite loop trap to the contents of a loop.\n   * Add statement suffix at the start of the loop block (right after the loop\n   * statement executes), and a statement prefix to the end of the loop block\n   * (right before the loop statement executes).\n   *\n   * @param branch Code for loop contents.\n   * @param block Enclosing block.\n   * @returns Loop contents, with infinite loop trap added.\n   */\n  addLoopTrap(branch: string, block: Block): string {\n    if (this.INFINITE_LOOP_TRAP) {\n      branch =\n        this.prefixLines(\n          this.injectId(this.INFINITE_LOOP_TRAP, block),\n          this.INDENT\n        ) + branch;\n    }\n    if (this.STATEMENT_SUFFIX && !block.suppressPrefixSuffix) {\n      branch =\n        this.prefixLines(\n          this.injectId(this.STATEMENT_SUFFIX, block),\n          this.INDENT\n        ) + branch;\n    }\n    if (this.STATEMENT_PREFIX && !block.suppressPrefixSuffix) {\n      branch =\n        branch +\n        this.prefixLines(\n          this.injectId(this.STATEMENT_PREFIX, block),\n          this.INDENT\n        );\n    }\n    return branch;\n  }\n\n  /**\n   * Inject a block ID into a message to replace '%1'.\n   * Used for STATEMENT_PREFIX, STATEMENT_SUFFIX, and INFINITE_LOOP_TRAP.\n   *\n   * @param msg Code snippet with '%1'.\n   * @param block Block which has an ID.\n   * @returns Code snippet with ID.\n   */\n  injectId(msg: string, block: Block): string {\n    const id = block.id.replace(/\\$/g, '$$$$'); // Issue 251.\n    return msg.replace(/%1/g, \"'\" + id + \"'\");\n  }\n\n  /**\n   * Add one or more words to the list of reserved words for this language.\n   *\n   * @param words Comma-separated list of words to add to the list.\n   *     No spaces.  Duplicates are ok.\n   */\n  addReservedWords(words: string) {\n    this.RESERVED_WORDS_ += words + ',';\n  }\n\n  /**\n   * Define a developer-defined function (not a user-defined procedure) to be\n   * included in the generated code.  Used for creating private helper\n   * functions. The first time this is called with a given desiredName, the code\n   * is saved and an actual name is generated.  Subsequent calls with the same\n   * desiredName have no effect but have the same return value.\n   *\n   * It is up to the caller to make sure the same desiredName is not\n   * used for different helper functions (e.g. use \"colourRandom\" and\n   * \"listRandom\", not \"random\").  There is no danger of colliding with reserved\n   * words, or user-defined variable or procedure names.\n   *\n   * The code gets output when CodeGenerator.finish() is called.\n   *\n   * @param desiredName The desired name of the function (e.g. mathIsPrime).\n   * @param code A list of statements or one multi-line code string.  Use '  '\n   *     for indents (they will be replaced).\n   * @returns The actual name of the new function.  This may differ from\n   *     desiredName if the former has already been taken by the user.\n   */\n  protected provideFunction_(\n    desiredName: string,\n    code: string[] | string\n  ): string {\n    if (!this.definitions_[desiredName]) {\n      const functionName = this.nameDB_!.getDistinctName(\n        desiredName,\n        NameType.PROCEDURE\n      );\n      this.functionNames_[desiredName] = functionName;\n      if (Array.isArray(code)) {\n        code = code.join('\\n');\n      }\n      let codeText = code\n        .trim()\n        .replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_, functionName);\n      // Change all '  ' indents into the desired indent.\n      // To avoid an infinite loop of replacements, change all indents to '\\0'\n      // character first, then replace them all with the indent.\n      // We are assuming that no provided functions contain a literal null char.\n      let oldCodeText;\n      while (oldCodeText !== codeText) {\n        oldCodeText = codeText;\n        codeText = codeText.replace(/^(( {2})*) {2}/gm, '$1\\0');\n      }\n      codeText = codeText.replace(/\\0/g, this.INDENT);\n      this.definitions_[desiredName] = codeText;\n    }\n    return this.functionNames_[desiredName];\n  }\n\n  /**\n   * Hook for code to run before code generation starts.\n   * Subclasses may override this, e.g. to initialise the database of variable\n   * names.\n   *\n   * @param _workspace Workspace to generate code from.\n   */\n  init(_workspace: Workspace) {\n    // Optionally override\n    // Create a dictionary of definitions to be printed before the code.\n    this.definitions_ = Object.create(null);\n    // Create a dictionary mapping desired developer-defined function names in\n    // definitions_ to actual function names (to avoid collisions with\n    // user-defined procedures).\n    this.functionNames_ = Object.create(null);\n  }\n\n  /**\n   * Common tasks for generating code from blocks.  This is called from\n   * blockToCode and is called on every block, not just top level blocks.\n   * Subclasses may override this, e.g. to generate code for statements\n   * following the block, or to handle comments for the specified block and any\n   * connected value blocks.\n   *\n   * @param _block The current block.\n   * @param code The code created for this block.\n   * @param _opt_thisOnly True to generate code for only this statement.\n   * @returns Code with comments and subsequent blocks added.\n   */\n  protected scrub_(\n    _block: Block,\n    code: string,\n    _opt_thisOnly?: boolean\n  ): string {\n    // Optionally override\n    return code;\n  }\n\n  /**\n   * Hook for code to run at end of code generation.\n   * Subclasses may override this, e.g. to prepend the generated code with\n   * import statements or variable definitions.\n   *\n   * @param code Generated code.\n   * @returns Completed code.\n   */\n  finish(code: string): string {\n    // Optionally override\n    // Clean up temporary data.\n    this.definitions_ = Object.create(null);\n    this.functionNames_ = Object.create(null);\n    return code;\n  }\n\n  /**\n   * Naked values are top-level blocks with outputs that aren't plugged into\n   * anything.\n   * Subclasses may override this, e.g. if their language does not allow\n   * naked values.\n   *\n   * @param line Line of generated code.\n   * @returns Legal line of code.\n   */\n  scrubNakedValue(line: string): string {\n    // Optionally override\n    return line;\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * The namespace used to keep track of keyboard shortcuts and the\n * key codes used to execute those shortcuts.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ShortcutRegistry');\n\nimport {KeyCodes} from './utils/keycodes.js';\nimport * as object from './utils/object.js';\nimport type {Workspace} from './workspace.js';\n\n/**\n * Class for the registry of keyboard shortcuts. This is intended to be a\n * singleton. You should not create a new instance, and only access this class\n * from ShortcutRegistry.registry.\n */\nexport class ShortcutRegistry {\n  static readonly registry = new ShortcutRegistry();\n\n  /** Registry of all keyboard shortcuts, keyed by name of shortcut. */\n  private shortcuts = new Map<string, KeyboardShortcut>();\n\n  /** Map of key codes to an array of shortcut names. */\n  private keyMap = new Map<string, string[]>();\n\n  /** Resets the existing ShortcutRegistry singleton. */\n  private constructor() {\n    this.reset();\n  }\n\n  /** Clear and recreate the registry and keyMap. */\n  reset() {\n    this.shortcuts.clear();\n    this.keyMap.clear();\n  }\n\n  /**\n   * Registers a keyboard shortcut.\n   *\n   * @param shortcut The shortcut for this key code.\n   * @param opt_allowOverrides True to prevent a warning when overriding an\n   *     already registered item.\n   * @throws {Error} if a shortcut with the same name already exists.\n   */\n  register(shortcut: KeyboardShortcut, opt_allowOverrides?: boolean) {\n    const registeredShortcut = this.shortcuts.get(shortcut.name);\n    if (registeredShortcut && !opt_allowOverrides) {\n      throw new Error(`Shortcut named \"${shortcut.name}\" already exists.`);\n    }\n    this.shortcuts.set(shortcut.name, shortcut);\n\n    const keyCodes = shortcut.keyCodes;\n    if (keyCodes && keyCodes.length > 0) {\n      for (let i = 0; i < keyCodes.length; i++) {\n        this.addKeyMapping(\n          keyCodes[i],\n          shortcut.name,\n          !!shortcut.allowCollision\n        );\n      }\n    }\n  }\n\n  /**\n   * Unregisters a keyboard shortcut registered with the given key code. This\n   * will also remove any key mappings that reference this shortcut.\n   *\n   * @param shortcutName The name of the shortcut to unregister.\n   * @returns True if an item was unregistered, false otherwise.\n   */\n  unregister(shortcutName: string): boolean {\n    const shortcut = this.shortcuts.get(shortcutName);\n\n    if (!shortcut) {\n      console.warn(`Keyboard shortcut named \"${shortcutName}\" not found.`);\n      return false;\n    }\n\n    this.removeAllKeyMappings(shortcutName);\n\n    this.shortcuts.delete(shortcutName);\n    return true;\n  }\n\n  /**\n   * Adds a mapping between a keycode and a keyboard shortcut.\n   *\n   * @param keyCode The key code for the keyboard shortcut. If registering a key\n   *     code with a modifier (ex: ctrl+c) use\n   *     ShortcutRegistry.registry.createSerializedKey;\n   * @param shortcutName The name of the shortcut to execute when the given\n   *     keycode is pressed.\n   * @param opt_allowCollision True to prevent an error when adding a shortcut\n   *     to a key that is already mapped to a shortcut.\n   * @throws {Error} if the given key code is already mapped to a shortcut.\n   */\n  addKeyMapping(\n    keyCode: string | number | KeyCodes,\n    shortcutName: string,\n    opt_allowCollision?: boolean\n  ) {\n    keyCode = `${keyCode}`;\n    const shortcutNames = this.keyMap.get(keyCode);\n    if (shortcutNames && !opt_allowCollision) {\n      throw new Error(\n        `Shortcut named \"${shortcutName}\" collides with shortcuts \"${shortcutNames}\"`\n      );\n    } else if (shortcutNames && opt_allowCollision) {\n      shortcutNames.unshift(shortcutName);\n    } else {\n      this.keyMap.set(keyCode, [shortcutName]);\n    }\n  }\n\n  /**\n   * Removes a mapping between a keycode and a keyboard shortcut.\n   *\n   * @param keyCode The key code for the keyboard shortcut. If registering a key\n   *     code with a modifier (ex: ctrl+c) use\n   *     ShortcutRegistry.registry.createSerializedKey;\n   * @param shortcutName The name of the shortcut to execute when the given\n   *     keycode is pressed.\n   * @param opt_quiet True to not console warn when there is no shortcut to\n   *     remove.\n   * @returns True if a key mapping was removed, false otherwise.\n   */\n  removeKeyMapping(\n    keyCode: string,\n    shortcutName: string,\n    opt_quiet?: boolean\n  ): boolean {\n    const shortcutNames = this.keyMap.get(keyCode);\n\n    if (!shortcutNames) {\n      if (!opt_quiet) {\n        console.warn(\n          `No keyboard shortcut named \"${shortcutName}\" registered with key code \"${keyCode}\"`\n        );\n      }\n      return false;\n    }\n\n    const shortcutIdx = shortcutNames.indexOf(shortcutName);\n    if (shortcutIdx > -1) {\n      shortcutNames.splice(shortcutIdx, 1);\n      if (shortcutNames.length === 0) {\n        this.keyMap.delete(keyCode);\n      }\n      return true;\n    }\n    if (!opt_quiet) {\n      console.warn(\n        `No keyboard shortcut named \"${shortcutName}\" registered with key code \"${keyCode}\"`\n      );\n    }\n    return false;\n  }\n\n  /**\n   * Removes all the key mappings for a shortcut with the given name.\n   * Useful when changing the default key mappings and the key codes registered\n   * to the shortcut are unknown.\n   *\n   * @param shortcutName The name of the shortcut to remove from the key map.\n   */\n  removeAllKeyMappings(shortcutName: string) {\n    for (const keyCode of this.keyMap.keys()) {\n      this.removeKeyMapping(keyCode, shortcutName, true);\n    }\n  }\n\n  /**\n   * Sets the key map. Setting the key map will override any default key\n   * mappings.\n   *\n   * @param newKeyMap The object with key code to shortcut names.\n   */\n  setKeyMap(newKeyMap: {[key: string]: string[]}) {\n    this.keyMap.clear();\n    for (const key in newKeyMap) {\n      this.keyMap.set(key, newKeyMap[key]);\n    }\n  }\n\n  /**\n   * Gets the current key map.\n   *\n   * @returns The object holding key codes to ShortcutRegistry.KeyboardShortcut.\n   */\n  getKeyMap(): {[key: string]: string[]} {\n    const legacyKeyMap: {[key: string]: string[]} = Object.create(null);\n    for (const [key, value] of this.keyMap) {\n      legacyKeyMap[key] = value;\n    }\n    return legacyKeyMap;\n  }\n\n  /**\n   * Gets the registry of keyboard shortcuts.\n   *\n   * @returns The registry of keyboard shortcuts.\n   */\n  getRegistry(): {[key: string]: KeyboardShortcut} {\n    const legacyRegistry: {[key: string]: KeyboardShortcut} =\n      Object.create(null);\n    for (const [key, value] of this.shortcuts) {\n      legacyRegistry[key] = value;\n    }\n    return object.deepMerge(Object.create(null), legacyRegistry);\n  }\n\n  /**\n   * Handles key down events.\n   *\n   * @param workspace The main workspace where the event was captured.\n   * @param e The key down event.\n   * @returns True if the event was handled, false otherwise.\n   */\n  onKeyDown(workspace: Workspace, e: KeyboardEvent): boolean {\n    const key = this.serializeKeyEvent_(e);\n    const shortcutNames = this.getShortcutNamesByKeyCode(key);\n    if (!shortcutNames) {\n      return false;\n    }\n    for (let i = 0, shortcutName; (shortcutName = shortcutNames[i]); i++) {\n      const shortcut = this.shortcuts.get(shortcutName);\n      if (!shortcut?.preconditionFn || shortcut?.preconditionFn(workspace)) {\n        // If the key has been handled, stop processing shortcuts.\n        if (shortcut?.callback && shortcut?.callback(workspace, e, shortcut)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Gets the shortcuts registered to the given key code.\n   *\n   * @param keyCode The serialized key code.\n   * @returns The list of shortcuts to call when the given keyCode is used.\n   *     Undefined if no shortcuts exist.\n   */\n  getShortcutNamesByKeyCode(keyCode: string): string[] | undefined {\n    return this.keyMap.get(keyCode) || [];\n  }\n\n  /**\n   * Gets the serialized key codes that the shortcut with the given name is\n   * registered under.\n   *\n   * @param shortcutName The name of the shortcut.\n   * @returns An array with all the key codes the shortcut is registered under.\n   */\n  getKeyCodesByShortcutName(shortcutName: string): string[] {\n    const keys = [];\n    for (const [keyCode, shortcuts] of this.keyMap) {\n      const shortcutIdx = shortcuts.indexOf(shortcutName);\n      if (shortcutIdx > -1) {\n        keys.push(keyCode);\n      }\n    }\n    return keys;\n  }\n\n  /**\n   * Serializes a key event.\n   *\n   * @param e A key down event.\n   * @returns The serialized key code for the given event.\n   */\n  private serializeKeyEvent_(e: KeyboardEvent): string {\n    let serializedKey = '';\n    for (const modifier in ShortcutRegistry.modifierKeys) {\n      if (e.getModifierState(modifier)) {\n        if (serializedKey !== '') {\n          serializedKey += '+';\n        }\n        serializedKey += modifier;\n      }\n    }\n    if (serializedKey !== '' && e.keyCode) {\n      serializedKey = serializedKey + '+' + e.keyCode;\n    } else if (e.keyCode) {\n      serializedKey = String(e.keyCode);\n    }\n    return serializedKey;\n  }\n\n  /**\n   * Checks whether any of the given modifiers are not valid.\n   *\n   * @param modifiers List of modifiers to be used with the key.\n   * @throws {Error} if the modifier is not in the valid modifiers list.\n   */\n  private checkModifiers_(modifiers: KeyCodes[]) {\n    for (let i = 0, modifier; (modifier = modifiers[i]); i++) {\n      if (!(modifier in ShortcutRegistry.modifierKeys)) {\n        throw new Error(modifier + ' is not a valid modifier key.');\n      }\n    }\n  }\n\n  /**\n   * Creates the serialized key code that will be used in the key map.\n   *\n   * @param keyCode Number code representing the key.\n   * @param modifiers List of modifier key codes to be used with the key. All\n   *     valid modifiers can be found in the ShortcutRegistry.modifierKeys.\n   * @returns The serialized key code for the given modifiers and key.\n   */\n  createSerializedKey(keyCode: number, modifiers: KeyCodes[] | null): string {\n    let serializedKey = '';\n\n    if (modifiers) {\n      this.checkModifiers_(modifiers);\n      for (const modifier in ShortcutRegistry.modifierKeys) {\n        const modifierKeyCode = (\n          ShortcutRegistry.modifierKeys as AnyDuringMigration\n        )[modifier];\n        if (modifiers.indexOf(modifierKeyCode) > -1) {\n          if (serializedKey !== '') {\n            serializedKey += '+';\n          }\n          serializedKey += modifier;\n        }\n      }\n    }\n\n    if (serializedKey !== '' && keyCode) {\n      serializedKey = serializedKey + '+' + keyCode;\n    } else if (keyCode) {\n      serializedKey = `${keyCode}`;\n    }\n    return serializedKey;\n  }\n}\n\nexport namespace ShortcutRegistry {\n  export interface KeyboardShortcut {\n    callback?: (p1: Workspace, p2: Event, p3: KeyboardShortcut) => boolean;\n    name: string;\n    preconditionFn?: (p1: Workspace) => boolean;\n    metadata?: object;\n    keyCodes?: (number | string)[];\n    allowCollision?: boolean;\n  }\n\n  /** Supported modifiers. */\n  export enum modifierKeys {\n    Shift = KeyCodes.SHIFT,\n    Control = KeyCodes.CTRL,\n    Alt = KeyCodes.ALT,\n    Meta = KeyCodes.META,\n  }\n}\n\nexport type KeyboardShortcut = ShortcutRegistry.KeyboardShortcut;\n// No need to export ShorcutRegistry.modifierKeys from the module at this time\n// because (1) it wasn't automatically converted by the automatic migration\n// script, (2) the name doesn't follow the styleguide.\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.ConstantProvider');\n\nimport {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\n\n/**\n * An object that provides constants for rendering blocks in Geras mode.\n */\nexport class ConstantProvider extends BaseConstantProvider {\n  override FIELD_TEXT_BASELINE_CENTER = false;\n\n  // The dark/shadow path in classic rendering is the same as the normal block\n  // path, but translated down one and right one.\n  DARK_PATH_OFFSET = 1;\n\n  /**\n   * The maximum width of a bottom row that follows a statement input and has\n   * inputs inline.\n   */\n  MAX_BOTTOM_WIDTH = 30;\n  override STATEMENT_BOTTOM_SPACER = -this.NOTCH_HEIGHT / 2;\n\n  constructor() {\n    super();\n  }\n\n  override getCSS_(selector: string) {\n    return super.getCSS_(selector).concat([\n      /* eslint-disable indent */\n      /* clang-format off */\n      // Insertion marker.\n      `${selector} .blocklyInsertionMarker>.blocklyPathLight,`,\n      `${selector} .blocklyInsertionMarker>.blocklyPathDark {`,\n      `fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,\n      `stroke: none;`,\n      '}',\n      /* clang-format on */\n      /* eslint-enable indent */\n    ]);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.Highlighter');\n\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {ConstantProvider} from '../common/constants.js';\nimport type {BottomRow} from '../measurables/bottom_row.js';\nimport type {Row} from '../measurables/row.js';\nimport {SpacerRow} from '../measurables/spacer_row.js';\nimport type {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {\n  HighlightConstantProvider,\n  InsideCorner,\n  JaggedTeeth,\n  Notch,\n  OutsideCorner,\n  PuzzleTab,\n  StartHat,\n} from './highlight_constants.js';\nimport type {RenderInfo} from './info.js';\nimport type {InlineInput} from './measurables/inline_input.js';\n\n/**\n * An object that adds highlights to a block based on the given rendering\n * information.\n *\n * Highlighting is interesting because the highlights do not fully enclose the\n * block.  Instead, they are positioned based on a light source in the top left.\n * This means that rendering highlights requires exact information about the\n * position of each part of the block.  The resulting paths are not continuous\n * or closed paths.  The highlights for tabs and notches are loosely based on\n * tab and notch shapes, but are not exactly the same.\n */\nexport class Highlighter {\n  info_: RenderInfo;\n  steps_ = '';\n  inlineSteps_ = '';\n  RTL_: boolean;\n  constants_: ConstantProvider;\n  highlightConstants_: HighlightConstantProvider;\n  private readonly highlightOffset: number;\n  outsideCornerPaths_: OutsideCorner;\n  insideCornerPaths_: InsideCorner;\n  puzzleTabPaths_: PuzzleTab;\n  notchPaths_: Notch;\n  startPaths_: StartHat;\n  jaggedTeethPaths_: JaggedTeeth;\n\n  /**\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(info: RenderInfo) {\n    this.info_ = info;\n\n    this.RTL_ = this.info_.RTL;\n\n    const renderer = info.getRenderer();\n\n    /** The renderer's constant provider. */\n    this.constants_ = renderer.getConstants();\n\n    this.highlightConstants_ = renderer.getHighlightConstants();\n    /** The offset between the block's main path and highlight path. */\n    this.highlightOffset = this.highlightConstants_.OFFSET;\n\n    this.outsideCornerPaths_ = this.highlightConstants_.OUTSIDE_CORNER;\n    this.insideCornerPaths_ = this.highlightConstants_.INSIDE_CORNER;\n    this.puzzleTabPaths_ = this.highlightConstants_.PUZZLE_TAB;\n    this.notchPaths_ = this.highlightConstants_.NOTCH;\n    this.startPaths_ = this.highlightConstants_.START_HAT;\n    this.jaggedTeethPaths_ = this.highlightConstants_.JAGGED_TEETH;\n  }\n\n  /**\n   * Get the steps for the highlight path.\n   *\n   * @returns The steps for the highlight path.\n   */\n  getPath(): string {\n    return this.steps_ + '\\n' + this.inlineSteps_;\n  }\n\n  /**\n   * Add a highlight to the top corner of a block.\n   *\n   * @param row The top row of the block.\n   */\n  drawTopCorner(row: TopRow) {\n    this.steps_ += svgPaths.moveBy(row.xPos, this.info_.startY);\n    for (let i = 0, elem; (elem = row.elements[i]); i++) {\n      if (Types.isLeftSquareCorner(elem)) {\n        this.steps_ += this.highlightConstants_.START_POINT;\n      } else if (Types.isLeftRoundedCorner(elem)) {\n        this.steps_ += this.outsideCornerPaths_.topLeft(this.RTL_);\n      } else if (Types.isPreviousConnection(elem)) {\n        this.steps_ += this.notchPaths_.pathLeft;\n      } else if (Types.isHat(elem)) {\n        this.steps_ += this.startPaths_.path(this.RTL_);\n      } else if (Types.isSpacer(elem) && elem.width !== 0) {\n        // The end point of the spacer needs to be offset by the highlight\n        // amount. So instead of using the spacer's width for a relative\n        // horizontal, use its width and position for an absolute horizontal\n        // move.\n        this.steps_ += svgPaths.lineOnAxis(\n          'H',\n          elem.xPos + elem.width - this.highlightOffset\n        );\n      }\n    }\n\n    const right = row.xPos + row.width - this.highlightOffset;\n    this.steps_ += svgPaths.lineOnAxis('H', right);\n  }\n\n  /**\n   * Add a highlight on a jagged edge for a collapsed block.\n   *\n   * @param row  The row to highlight.\n   */\n  drawJaggedEdge_(row: Row) {\n    if (this.info_.RTL) {\n      const remainder =\n        row.height - this.jaggedTeethPaths_.height - this.highlightOffset;\n      this.steps_ +=\n        this.jaggedTeethPaths_.pathLeft + svgPaths.lineOnAxis('v', remainder);\n    }\n  }\n\n  /**\n   * Add a highlight on a value input.\n   *\n   * @param row The row the input belongs to.\n   */\n  drawValueInput(row: Row) {\n    const input = row.getLastInput() as InlineInput;\n    if (this.RTL_) {\n      const belowTabHeight = row.height - input.connectionHeight;\n\n      this.steps_ +=\n        svgPaths.moveTo(\n          input.xPos + input.width - this.highlightOffset,\n          row.yPos\n        ) +\n        this.puzzleTabPaths_.pathDown(this.RTL_) +\n        svgPaths.lineOnAxis('v', belowTabHeight);\n    } else {\n      this.steps_ +=\n        svgPaths.moveTo(input.xPos + input.width, row.yPos) +\n        this.puzzleTabPaths_.pathDown(this.RTL_);\n    }\n  }\n\n  /**\n   * Add a highlight on a statement input.\n   *\n   * @param row The row to highlight.\n   */\n  drawStatementInput(row: Row) {\n    const input = row.getLastInput();\n    if (!input) return;\n    if (this.RTL_) {\n      const innerHeight = row.height - 2 * this.insideCornerPaths_.height;\n      this.steps_ +=\n        svgPaths.moveTo(input.xPos, row.yPos) +\n        this.insideCornerPaths_.pathTop(this.RTL_) +\n        svgPaths.lineOnAxis('v', innerHeight) +\n        this.insideCornerPaths_.pathBottom(this.RTL_) +\n        svgPaths.lineTo(\n          row.width - input.xPos - this.insideCornerPaths_.width,\n          0\n        );\n    } else {\n      this.steps_ +=\n        svgPaths.moveTo(input.xPos, row.yPos + row.height) +\n        this.insideCornerPaths_.pathBottom(this.RTL_) +\n        svgPaths.lineTo(\n          row.width - input.xPos - this.insideCornerPaths_.width,\n          0\n        );\n    }\n  }\n\n  /**\n   * Add a highlight on the right side of a row.\n   *\n   * @param row The row to highlight.\n   */\n  drawRightSideRow(row: Row) {\n    const rightEdge = row.xPos + row.width - this.highlightOffset;\n    if (row instanceof SpacerRow && row.followsStatement) {\n      this.steps_ += svgPaths.lineOnAxis('H', rightEdge);\n    }\n    if (this.RTL_) {\n      this.steps_ += svgPaths.lineOnAxis('H', rightEdge);\n      if (row.height > this.highlightOffset) {\n        this.steps_ += svgPaths.lineOnAxis(\n          'V',\n          row.yPos + row.height - this.highlightOffset\n        );\n      }\n    }\n  }\n\n  /**\n   * Add a highlight to the bottom row.\n   *\n   * @param row The row to highlight.\n   */\n  drawBottomRow(row: BottomRow) {\n    // Highlight the vertical edge of the bottom row on the input side.\n    // Highlighting is always from the top left, both in LTR and RTL.\n    if (this.RTL_) {\n      this.steps_ += svgPaths.lineOnAxis(\n        'V',\n        row.baseline - this.highlightOffset\n      );\n    } else {\n      const cornerElem = this.info_.bottomRow.elements[0];\n      if (Types.isLeftSquareCorner(cornerElem)) {\n        this.steps_ += svgPaths.moveTo(\n          row.xPos + this.highlightOffset,\n          row.baseline - this.highlightOffset\n        );\n      } else if (Types.isLeftRoundedCorner(cornerElem)) {\n        this.steps_ += svgPaths.moveTo(row.xPos, row.baseline);\n        this.steps_ += this.outsideCornerPaths_.bottomLeft();\n      }\n    }\n  }\n\n  /**\n   * Draw the highlight on the left side of the block.\n   */\n  drawLeft() {\n    const outputConnection = this.info_.outputConnection;\n    if (outputConnection) {\n      const tabBottom =\n        outputConnection.connectionOffsetY + outputConnection.height;\n      // Draw a line up to the bottom of the tab.\n      if (this.RTL_) {\n        this.steps_ += svgPaths.moveTo(this.info_.startX, tabBottom);\n      } else {\n        const left = this.info_.startX + this.highlightOffset;\n        const bottom = this.info_.bottomRow.baseline - this.highlightOffset;\n        this.steps_ += svgPaths.moveTo(left, bottom);\n        this.steps_ += svgPaths.lineOnAxis('V', tabBottom);\n      }\n      this.steps_ += this.puzzleTabPaths_.pathUp(this.RTL_);\n    }\n\n    if (!this.RTL_) {\n      const topRow = this.info_.topRow;\n      if (Types.isLeftRoundedCorner(topRow.elements[0])) {\n        this.steps_ += svgPaths.lineOnAxis(\n          'V',\n          this.outsideCornerPaths_.height\n        );\n      } else {\n        this.steps_ += svgPaths.lineOnAxis(\n          'V',\n          topRow.capline + this.highlightOffset\n        );\n      }\n    }\n  }\n\n  /**\n   * Add a highlight to an inline input.\n   *\n   * @param input The input to highlight.\n   */\n  drawInlineInput(input: InlineInput) {\n    const offset = this.highlightOffset;\n\n    // Relative to the block's left.\n    const connectionRight = input.xPos + input.connectionWidth;\n    const yPos = input.centerline - input.height / 2;\n    const bottomHighlightWidth = input.width - input.connectionWidth;\n    const startY = yPos + offset;\n\n    if (this.RTL_) {\n      const aboveTabHeight = input.connectionOffsetY - offset;\n      const belowTabHeight =\n        input.height -\n        (input.connectionOffsetY + input.connectionHeight) +\n        offset;\n\n      const startX = connectionRight - offset;\n\n      this.inlineSteps_ +=\n        svgPaths.moveTo(startX, startY) + // Right edge above tab.\n        svgPaths.lineOnAxis('v', aboveTabHeight) + // Back of tab.\n        this.puzzleTabPaths_.pathDown(this.RTL_) + // Right edge below tab.\n        svgPaths.lineOnAxis('v', belowTabHeight) + // Bottom.\n        svgPaths.lineOnAxis('h', bottomHighlightWidth);\n    } else {\n      this.inlineSteps_ += // Go to top right corner.\n        svgPaths.moveTo(input.xPos + input.width + offset, startY) + // Highlight right edge, bottom.\n        svgPaths.lineOnAxis('v', input.height) +\n        svgPaths.lineOnAxis('h', -bottomHighlightWidth) + // Go to top of tab.\n        svgPaths.moveTo(connectionRight, yPos + input.connectionOffsetY) + // Short highlight glint at\n        // bottom of tab.\n        this.puzzleTabPaths_.pathDown(this.RTL_);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.Drawer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport {Drawer as BaseDrawer} from '../common/drawer.js';\nimport type {Row} from '../measurables/row.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport {Highlighter} from './highlighter.js';\nimport type {RenderInfo} from './info.js';\nimport type {InlineInput} from './measurables/inline_input.js';\nimport type {PathObject} from './path_object.js';\n\n/**\n * An object that draws a block based on the given rendering information,\n * customized for the geras renderer.\n */\nexport class Drawer extends BaseDrawer {\n  highlighter_: Highlighter;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override constants_!: ConstantProvider;\n\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    super(block, info);\n    // Unlike Thrasos, Geras has highlights and drop shadows.\n    this.highlighter_ = new Highlighter(info);\n  }\n\n  override draw() {\n    this.drawOutline_();\n    this.drawInternals_();\n\n    const pathObject = this.block_.pathObject as PathObject;\n    pathObject.setPath(this.outlinePath_ + '\\n' + this.inlinePath_);\n    pathObject.setHighlightPath(this.highlighter_.getPath());\n    if (this.info_.RTL) {\n      pathObject.flipRTL();\n    }\n    this.recordSizeOnBlock_();\n  }\n\n  override drawTop_() {\n    this.highlighter_.drawTopCorner(this.info_.topRow);\n    this.highlighter_.drawRightSideRow(this.info_.topRow);\n\n    super.drawTop_();\n  }\n\n  override drawJaggedEdge_(row: Row) {\n    this.highlighter_.drawJaggedEdge_(row);\n\n    super.drawJaggedEdge_(row);\n  }\n\n  override drawValueInput_(row: Row) {\n    this.highlighter_.drawValueInput(row);\n\n    super.drawValueInput_(row);\n  }\n\n  override drawStatementInput_(row: Row) {\n    this.highlighter_.drawStatementInput(row);\n\n    super.drawStatementInput_(row);\n  }\n\n  override drawRightSideRow_(row: Row) {\n    this.highlighter_.drawRightSideRow(row);\n\n    this.outlinePath_ +=\n      svgPaths.lineOnAxis('H', row.xPos + row.width) +\n      svgPaths.lineOnAxis('V', row.yPos + row.height);\n  }\n\n  override drawBottom_() {\n    this.highlighter_.drawBottomRow(this.info_.bottomRow);\n\n    super.drawBottom_();\n  }\n\n  /**\n   * Add steps for the left side of the block, which may include an output\n   * connection\n   */\n  protected override drawLeft_() {\n    this.highlighter_.drawLeft();\n\n    super.drawLeft_();\n  }\n\n  override drawInlineInput_(input: InlineInput) {\n    this.highlighter_.drawInlineInput(input as InlineInput);\n\n    super.drawInlineInput_(input);\n  }\n\n  override positionInlineInputConnection_(input: InlineInput) {\n    const yPos = input.centerline - input.height / 2;\n    // Move the connection.\n    if (input.connectionModel) {\n      // xPos already contains info about startX\n      let connX =\n        input.xPos + input.connectionWidth + this.constants_.DARK_PATH_OFFSET;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(\n        connX,\n        yPos + input.connectionOffsetY + this.constants_.DARK_PATH_OFFSET\n      );\n    }\n  }\n\n  override positionStatementInputConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input?.connectionModel) {\n      let connX = row.xPos + row.statementEdge + input.notchOffset;\n      if (this.info_.RTL) {\n        connX *= -1;\n      } else {\n        connX += this.constants_.DARK_PATH_OFFSET;\n      }\n      input.connectionModel.setOffsetInBlock(\n        connX,\n        row.yPos + this.constants_.DARK_PATH_OFFSET\n      );\n    }\n  }\n\n  override positionExternalValueConnection_(row: Row) {\n    const input = row.getLastInput();\n    if (input && input.connectionModel) {\n      let connX = row.xPos + row.width + this.constants_.DARK_PATH_OFFSET;\n      if (this.info_.RTL) {\n        connX *= -1;\n      }\n      input.connectionModel.setOffsetInBlock(connX, row.yPos);\n    }\n  }\n\n  override positionNextConnection_() {\n    const bottomRow = this.info_.bottomRow;\n\n    if (bottomRow.connection) {\n      const connInfo = bottomRow.connection;\n      const x = connInfo.xPos; // Already contains info about startX.\n      const connX =\n        (this.info_.RTL ? -x : x) + this.constants_.DARK_PATH_OFFSET / 2;\n      connInfo.connectionModel.setOffsetInBlock(\n        connX,\n        bottomRow.baseline + this.constants_.DARK_PATH_OFFSET\n      );\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.HighlightConstantProvider');\n\nimport * as svgPaths from '../../utils/svg_paths.js';\nimport type {ConstantProvider} from '../common/constants.js';\n\n/** An object containing sizing and path information about an outside corner. */\nexport interface OutsideCorner {\n  height: number;\n  topLeft: (p1: boolean) => string;\n  bottomLeft: () => string;\n}\n\n/** An object containing sizing and path information about an inside corner. */\nexport interface InsideCorner {\n  width: number;\n  height: number;\n  pathTop: (p1: boolean) => string;\n  pathBottom: (p1: boolean) => string;\n}\n\n/** An object containing sizing and path information about a start hat. */\nexport interface StartHat {\n  path: (p1: boolean) => string;\n}\n\n/** An object containing sizing and path information about a notch. */\nexport interface Notch {\n  pathLeft: string;\n}\n\n/** An object containing sizing and path information about a puzzle tab. */\nexport interface PuzzleTab {\n  width: number;\n  height: number;\n  pathDown: (p1: boolean) => string;\n  pathUp: (p1: boolean) => string;\n}\n\n/**\n * An object containing sizing and path information about collapsed block\n * indicators.\n */\nexport interface JaggedTeeth {\n  height: number;\n  width: number;\n  pathLeft: string;\n}\n\n/**\n * An object that provides constants for rendering highlights on blocks.\n * Some highlights are simple offsets of the parent paths and can be generated\n * programmatically.  Others, especially on curves, are just made out of piles\n * of constants and are hard to tweak.\n */\nexport class HighlightConstantProvider {\n  constantProvider: ConstantProvider;\n\n  /** The offset between the block's main path and highlight path. */\n  OFFSET = 0.5;\n  START_POINT: string;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  INSIDE_CORNER!: InsideCorner;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  OUTSIDE_CORNER!: OutsideCorner;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  PUZZLE_TAB!: PuzzleTab;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  NOTCH!: Notch;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  JAGGED_TEETH!: JaggedTeeth;\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  START_HAT!: StartHat;\n\n  /**\n   * @param constants The rendering constants provider.\n   */\n  constructor(constants: ConstantProvider) {\n    /** The renderer's constant provider. */\n    this.constantProvider = constants;\n\n    /**\n     * The start point, which is offset in both X and Y, as an SVG path chunk.\n     */\n    this.START_POINT = svgPaths.moveBy(this.OFFSET, this.OFFSET);\n  }\n\n  /**\n   * Initialize shape objects based on the constants set in the constructor.\n   */\n  init() {\n    /**\n     * An object containing sizing and path information about inside corner\n     * highlights.\n     */\n    this.INSIDE_CORNER = this.makeInsideCorner();\n\n    /**\n     * An object containing sizing and path information about outside corner\n     * highlights.\n     */\n    this.OUTSIDE_CORNER = this.makeOutsideCorner();\n\n    /**\n     * An object containing sizing and path information about puzzle tab\n     * highlights.\n     */\n    this.PUZZLE_TAB = this.makePuzzleTab();\n\n    /**\n     * An object containing sizing and path information about notch highlights.\n     */\n    this.NOTCH = this.makeNotch();\n\n    /**\n     * An object containing sizing and path information about highlights for\n     * collapsed block indicators.\n     */\n    this.JAGGED_TEETH = this.makeJaggedTeeth();\n\n    /**\n     * An object containing sizing and path information about start hat\n     * highlights.\n     */\n    this.START_HAT = this.makeStartHat();\n  }\n\n  /**\n   * @returns An object containing sizing and path information about inside\n   *     corner highlights.\n   */\n  protected makeInsideCorner(): InsideCorner {\n    const radius = this.constantProvider.CORNER_RADIUS;\n    const offset = this.OFFSET;\n\n    /**\n     * Distance from shape edge to intersect with a curved corner at 45 degrees.\n     * Applies to highlighting on around the outside of a curve.\n     */\n    const distance45outside = (1 - Math.SQRT1_2) * (radius + offset) - offset;\n\n    const pathTopRtl =\n      svgPaths.moveBy(distance45outside, distance45outside) +\n      svgPaths.arc(\n        'a',\n        '0 0,0',\n        radius,\n        svgPaths.point(-distance45outside - offset, radius - distance45outside)\n      );\n\n    const pathBottomRtl = svgPaths.arc(\n      'a',\n      '0 0,0',\n      radius + offset,\n      svgPaths.point(radius + offset, radius + offset)\n    );\n\n    const pathBottomLtr =\n      svgPaths.moveBy(distance45outside, -distance45outside) +\n      svgPaths.arc(\n        'a',\n        '0 0,0',\n        radius + offset,\n        svgPaths.point(radius - distance45outside, distance45outside + offset)\n      );\n\n    return {\n      width: radius + offset,\n      height: radius,\n      pathTop(rtl) {\n        return rtl ? pathTopRtl : '';\n      },\n      pathBottom(rtl) {\n        return rtl ? pathBottomRtl : pathBottomLtr;\n      },\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about outside\n   *     corner highlights.\n   */\n  protected makeOutsideCorner(): OutsideCorner {\n    const radius = this.constantProvider.CORNER_RADIUS;\n    const offset = this.OFFSET;\n\n    /**\n     * Distance from shape edge to intersect with a curved corner at 45 degrees.\n     * Applies to highlighting on around the inside of a curve.\n     */\n    const distance45inside = (1 - Math.SQRT1_2) * (radius - offset) + offset;\n\n    const topLeftStartX = distance45inside;\n    const topLeftStartY = distance45inside;\n    const topLeftCornerHighlightRtl =\n      svgPaths.moveBy(topLeftStartX, topLeftStartY) +\n      svgPaths.arc(\n        'a',\n        '0 0,1',\n        radius - offset,\n        svgPaths.point(radius - topLeftStartX, -topLeftStartY + offset)\n      );\n    /**\n     * SVG path for drawing the highlight on the rounded top-left corner.\n     */\n    const topLeftCornerHighlightLtr =\n      svgPaths.moveBy(offset, radius) +\n      svgPaths.arc(\n        'a',\n        '0 0,1',\n        radius - offset,\n        svgPaths.point(radius, -radius + offset)\n      );\n\n    const bottomLeftStartX = distance45inside;\n    const bottomLeftStartY = -distance45inside;\n    const bottomLeftPath =\n      svgPaths.moveBy(bottomLeftStartX, bottomLeftStartY) +\n      svgPaths.arc(\n        'a',\n        '0 0,1',\n        radius - offset,\n        svgPaths.point(-bottomLeftStartX + offset, -bottomLeftStartY - radius)\n      );\n\n    return {\n      height: radius,\n      topLeft(rtl) {\n        return rtl ? topLeftCornerHighlightRtl : topLeftCornerHighlightLtr;\n      },\n      bottomLeft() {\n        return bottomLeftPath;\n      },\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about puzzle tab\n   *     highlights.\n   */\n  protected makePuzzleTab(): PuzzleTab {\n    const width = this.constantProvider.TAB_WIDTH;\n    const height = this.constantProvider.TAB_HEIGHT;\n\n    // This is how much of the vertical block edge is actually drawn by the\n    // puzzle tab.\n    const verticalOverlap = 2.5;\n\n    const highlightRtlUp =\n      svgPaths.moveBy(-2, -height + verticalOverlap + 0.9) +\n      svgPaths.lineTo(width * -0.45, -2.1);\n\n    const highlightRtlDown =\n      svgPaths.lineOnAxis('v', verticalOverlap) +\n      svgPaths.moveBy(-width * 0.97, 2.5) +\n      svgPaths.curve('q', [\n        svgPaths.point(-width * 0.05, 10),\n        svgPaths.point(width * 0.3, 9.5),\n      ]) +\n      svgPaths.moveBy(width * 0.67, -1.9) +\n      svgPaths.lineOnAxis('v', verticalOverlap);\n\n    const highlightLtrUp =\n      svgPaths.lineOnAxis('v', -1.5) +\n      svgPaths.moveBy(width * -0.92, -0.5) +\n      svgPaths.curve('q', [\n        svgPaths.point(width * -0.19, -5.5),\n        svgPaths.point(0, -11),\n      ]) +\n      svgPaths.moveBy(width * 0.92, 1);\n\n    const highlightLtrDown =\n      svgPaths.moveBy(-5, height - 0.7) + svgPaths.lineTo(width * 0.46, -2.1);\n\n    return {\n      width,\n      height,\n      pathUp(rtl) {\n        return rtl ? highlightRtlUp : highlightLtrUp;\n      },\n      pathDown(rtl) {\n        return rtl ? highlightRtlDown : highlightLtrDown;\n      },\n    };\n  }\n\n  /**\n   * @returns An object containing sizing and path information about notch\n   *     highlights.\n   */\n  protected makeNotch(): Notch {\n    // This is only for the previous connection.\n    const pathLeft =\n      svgPaths.lineOnAxis('h', this.OFFSET) +\n      this.constantProvider.NOTCH.pathLeft;\n    return {pathLeft};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about collapsed\n   *     block edge highlights.\n   */\n  protected makeJaggedTeeth(): JaggedTeeth {\n    const pathLeft =\n      svgPaths.lineTo(5.1, 2.6) +\n      svgPaths.moveBy(-10.2, 6.8) +\n      svgPaths.lineTo(5.1, 2.6);\n    return {pathLeft, height: 12, width: 10.2};\n  }\n\n  /**\n   * @returns An object containing sizing and path information about start\n   *     highlights.\n   */\n  protected makeStartHat(): StartHat {\n    const hatHeight = this.constantProvider.START_HAT.height;\n    const pathRtl =\n      svgPaths.moveBy(25, -8.7) +\n      svgPaths.curve('c', [\n        svgPaths.point(29.7, -6.2),\n        svgPaths.point(57.2, -0.5),\n        svgPaths.point(75, 8.7),\n      ]);\n\n    const pathLtr =\n      svgPaths.curve('c', [\n        svgPaths.point(17.8, -9.2),\n        svgPaths.point(45.3, -14.9),\n        svgPaths.point(75, -8.7),\n      ]) + svgPaths.moveTo(100.5, hatHeight + 0.5);\n    return {\n      path(rtl) {\n        return rtl ? pathRtl : pathLtr;\n      },\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.InlineInput');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../../inputs/input.js';\nimport type {ConstantProvider as BaseConstantProvider} from '../../../renderers/common/constants.js';\nimport {InlineInput as BaseInlineInput} from '../../../renderers/measurables/inline_input.js';\nimport type {ConstantProvider as GerasConstantProvider} from '../constants.js';\n\n/**\n * An object containing information about the space an inline input takes up\n * during rendering.\n */\nexport class InlineInput extends BaseInlineInput {\n  override constants_: GerasConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The inline input to measure and store information for.\n   */\n  constructor(constants: BaseConstantProvider, input: Input) {\n    super(constants, input);\n    this.constants_ = constants as GerasConstantProvider;\n\n    if (this.connectedBlock) {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.width += this.constants_.DARK_PATH_OFFSET;\n      this.height += this.constants_.DARK_PATH_OFFSET;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.StatementInput');\n\n/* eslint-disable-next-line no-unused-vars */\nimport type {Input} from '../../../inputs/input.js';\nimport type {ConstantProvider as BaseConstantProvider} from '../../../renderers/common/constants.js';\nimport {StatementInput as BaseStatementInput} from '../../../renderers/measurables/statement_input.js';\nimport type {ConstantProvider as GerasConstantProvider} from '../constants.js';\n\n/**\n * An object containing information about the space a statement input takes up\n * during rendering.\n */\nexport class StatementInput extends BaseStatementInput {\n  override constants_: GerasConstantProvider;\n\n  /**\n   * @param constants The rendering constants provider.\n   * @param input The statement input to measure and store information for.\n   */\n  constructor(constants: BaseConstantProvider, input: Input) {\n    super(constants, input);\n    this.constants_ = constants as GerasConstantProvider;\n\n    if (this.connectedBlock) {\n      // We allow the dark path to show on the parent block so that the child\n      // block looks embossed.  This takes up an extra pixel in both x and y.\n      this.height += this.constants_.DARK_PATH_OFFSET;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.RenderInfo');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {Input} from '../../inputs/input.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport type {Measurable} from '../measurables/base.js';\nimport type {BottomRow} from '../measurables/bottom_row.js';\nimport {DummyInput} from '../../inputs/dummy_input.js';\nimport {ExternalValueInput} from '../measurables/external_value_input.js';\nimport type {Field} from '../measurables/field.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport type {InputRow} from '../measurables/input_row.js';\nimport type {Row} from '../measurables/row.js';\nimport {StatementInput} from '../../inputs/statement_input.js';\nimport type {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\nimport {ValueInput} from '../../inputs/value_input.js';\n\nimport type {ConstantProvider} from './constants.js';\nimport {InlineInput} from './measurables/inline_input.js';\nimport {StatementInput as StatementInputMeasurable} from './measurables/statement_input.js';\nimport type {Renderer} from './renderer.js';\n\n/**\n * An object containing all sizing information needed to draw this block,\n * customized for the geras renderer.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo extends BaseRenderInfo {\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override constants_!: ConstantProvider;\n\n  protected override readonly renderer_: Renderer;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n    this.renderer_ = renderer;\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_;\n  }\n\n  override populateBottomRow_() {\n    super.populateBottomRow_();\n\n    const followsStatement =\n      this.block_.inputList.length &&\n      this.block_.inputList[this.block_.inputList.length - 1] instanceof\n        StatementInput;\n    // The minimum height of the bottom row is smaller in Geras than in other\n    // renderers, because the dark path adds a pixel.\n    // If one of the row's elements has a greater height this will be\n    // overwritten in the compute pass.\n    if (!followsStatement) {\n      this.bottomRow.minHeight =\n        this.constants_.MEDIUM_PADDING - this.constants_.DARK_PATH_OFFSET;\n    }\n  }\n\n  override addInput_(input: Input, activeRow: Row) {\n    // Non-dummy inputs have visual representations onscreen.\n    if (this.isInline && input instanceof ValueInput) {\n      activeRow.elements.push(new InlineInput(this.constants_, input));\n      activeRow.hasInlineInput = true;\n    } else if (input instanceof StatementInput) {\n      activeRow.elements.push(\n        new StatementInputMeasurable(this.constants_, input)\n      );\n      activeRow.hasStatement = true;\n    } else if (input instanceof ValueInput) {\n      activeRow.elements.push(new ExternalValueInput(this.constants_, input));\n      activeRow.hasExternalInput = true;\n    } else if (input instanceof DummyInput) {\n      // Dummy inputs have no visual representation, but the information is\n      // still important.\n      activeRow.minHeight = Math.max(\n        activeRow.minHeight,\n        this.constants_.DUMMY_INPUT_MIN_HEIGHT\n      );\n      activeRow.hasDummyInput = true;\n    }\n    // Ignore row alignment if inline.\n    if (!this.isInline && activeRow.align === null) {\n      activeRow.align = input.align;\n    }\n  }\n\n  override addElemSpacing_() {\n    let hasExternalInputs = false;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      if (row.hasExternalInput) {\n        hasExternalInputs = true;\n      }\n    }\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      const oldElems = row.elements;\n      row.elements = [];\n      // No spacing needed before the corner on the top row or the bottom row.\n      if (row.startsWithElemSpacer()) {\n        // There's a spacer before the first element in the row.\n        row.elements.push(\n          new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(null, oldElems[0])\n          )\n        );\n      }\n      if (!oldElems.length) {\n        continue;\n      }\n      for (let e = 0; e < oldElems.length - 1; e++) {\n        row.elements.push(oldElems[e]);\n        const spacing = this.getInRowSpacing_(oldElems[e], oldElems[e + 1]);\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n      row.elements.push(oldElems[oldElems.length - 1]);\n      if (row.endsWithElemSpacer()) {\n        let spacing = this.getInRowSpacing_(\n          oldElems[oldElems.length - 1],\n          null\n        );\n        if (hasExternalInputs && row.hasDummyInput) {\n          spacing += this.constants_.TAB_WIDTH;\n        }\n        // There's a spacer after the last element in the row.\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n    }\n  }\n\n  override getInRowSpacing_(prev: Measurable | null, next: Measurable | null) {\n    if (!prev) {\n      // Between an editable field and the beginning of the row.\n      if (next && Types.isField(next) && (next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Inline input at the beginning of the row.\n      if (next && Types.isInlineInput(next)) {\n        return this.constants_.MEDIUM_LARGE_PADDING;\n      }\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n      // Anything else at the beginning of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between a non-input and the end of the row or a statement input.\n    if (!Types.isInput(prev) && (!next || Types.isStatementInput(next))) {\n      // Between an editable field and the end of the row.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Padding at the end of an icon-only row to make the block shape clearer.\n      if (Types.isIcon(prev)) {\n        return this.constants_.LARGE_PADDING * 2 + 1;\n      }\n      if (Types.isHat(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Establish a minimum width for a block with a previous or next\n      // connection.\n      if (Types.isPreviousOrNextConnection(prev)) {\n        return this.constants_.LARGE_PADDING;\n      }\n      // Between rounded corner and the end of the row.\n      if (Types.isLeftRoundedCorner(prev)) {\n        return this.constants_.MIN_BLOCK_WIDTH;\n      }\n      // Between a jagged edge and the end of the row.\n      if (Types.isJaggedEdge(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Between noneditable fields and icons and the end of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Between inputs and the end of the row.\n    if (Types.isInput(prev) && !next) {\n      if (Types.isExternalInput(prev)) {\n        return this.constants_.NO_PADDING;\n      } else if (Types.isInlineInput(prev)) {\n        return this.constants_.LARGE_PADDING;\n      } else if (Types.isStatementInput(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n\n    // Spacing between a non-input and an input.\n    if (!Types.isInput(prev) && next && Types.isInput(next)) {\n      // Between an editable field and an input.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        }\n      } else {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isStatementInput(next)) {\n          return this.constants_.LARGE_PADDING;\n        }\n      }\n      return this.constants_.LARGE_PADDING - 1;\n    }\n\n    // Spacing between an icon and an icon or field.\n    if (Types.isIcon(prev) && next && !Types.isInput(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n    // Spacing between an inline input and a field.\n    if (Types.isInlineInput(prev) && next && Types.isField(next)) {\n      // Editable field after inline input.\n      if ((next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      } else {\n        // Noneditable field after inline input.\n        return this.constants_.LARGE_PADDING;\n      }\n    }\n\n    if (Types.isLeftSquareCorner(prev) && next) {\n      // Spacing between a hat and a corner\n      if (Types.isHat(next)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Spacing between a square corner and a previous or next connection\n      if (Types.isPreviousConnection(next)) {\n        return next.notchOffset;\n      } else if (Types.isNextConnection(next)) {\n        // Next connections are shifted slightly to the left (in both LTR and\n        // RTL) to make the dark path under the previous connection show\n        // through.\n        const offset =\n          ((this.RTL ? 1 : -1) * this.constants_.DARK_PATH_OFFSET) / 2;\n        return next.notchOffset + offset;\n      }\n    }\n\n    // Spacing between a rounded corner and a previous or next connection.\n    if (Types.isLeftRoundedCorner(prev) && next) {\n      if (Types.isPreviousConnection(next)) {\n        return next.notchOffset - this.constants_.CORNER_RADIUS;\n      } else if (Types.isNextConnection(next)) {\n        // Next connections are shifted slightly to the left (in both LTR and\n        // RTL) to make the dark path under the previous connection show\n        // through.\n        const offset =\n          ((this.RTL ? 1 : -1) * this.constants_.DARK_PATH_OFFSET) / 2;\n        return next.notchOffset - this.constants_.CORNER_RADIUS + offset;\n      }\n    }\n\n    // Spacing between two fields of the same editability.\n    if (\n      Types.isField(prev) &&\n      next &&\n      Types.isField(next) &&\n      (prev as Field).isEditable === (next as Field).isEditable\n    ) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between anything and a jagged edge.\n    if (next && Types.isJaggedEdge(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowHeight_(prev: Row, next: Row) {\n    // If we have an empty block add a spacer to increase the height.\n    if (Types.isTopRow(prev) && Types.isBottomRow(next)) {\n      return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;\n    }\n    // Top and bottom rows act as a spacer so we don't need any extra padding.\n    if (Types.isTopRow(prev) || Types.isBottomRow(next)) {\n      return this.constants_.NO_PADDING;\n    }\n    if (prev.hasExternalInput && next.hasExternalInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (!prev.hasStatement && next.hasStatement) {\n      return this.constants_.BETWEEN_STATEMENT_PADDING_Y;\n    }\n    if (prev.hasStatement && next.hasStatement) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (!prev.hasStatement && next.hasDummyInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (prev.hasDummyInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getElemCenterline_(row: Row, elem: Measurable) {\n    if (Types.isSpacer(elem)) {\n      return row.yPos + elem.height / 2;\n    }\n    if (Types.isBottomRow(row)) {\n      const bottomRow = row as BottomRow;\n      const baseline =\n        bottomRow.yPos + bottomRow.height - bottomRow.descenderHeight;\n      if (Types.isNextConnection(elem)) {\n        return baseline + elem.height / 2;\n      }\n      return baseline - elem.height / 2;\n    }\n    if (Types.isTopRow(row)) {\n      const topRow = row as TopRow;\n      if (Types.isHat(elem)) {\n        return topRow.capline - elem.height / 2;\n      }\n      return topRow.capline + elem.height / 2;\n    }\n\n    let result = row.yPos;\n    if (Types.isField(elem) || Types.isIcon(elem)) {\n      result += elem.height / 2;\n      if (\n        (row.hasInlineInput || row.hasStatement) &&\n        elem.height + this.constants_.TALL_INPUT_FIELD_OFFSET_Y <= row.height\n      ) {\n        result += this.constants_.TALL_INPUT_FIELD_OFFSET_Y;\n      }\n    } else if (Types.isInlineInput(elem)) {\n      result += elem.height / 2;\n    } else {\n      result += row.height / 2;\n    }\n    return result;\n  }\n\n  override alignRowElements_() {\n    if (!this.isInline) {\n      super.alignRowElements_();\n      return;\n    }\n    // Walk backgrounds through rows on the block, keeping track of the right\n    // input edge.\n    let nextRightEdge = 0;\n    const rowNextRightEdges = new WeakMap();\n    let prevInput = null;\n    for (let i = this.rows.length - 1, row; (row = this.rows[i]); i--) {\n      rowNextRightEdges.set(row, nextRightEdge);\n      if (Types.isInputRow(row)) {\n        if (row.hasStatement) {\n          this.alignStatementRow_(row as InputRow);\n        }\n        if (\n          prevInput &&\n          prevInput.hasStatement &&\n          row.width < prevInput.width\n        ) {\n          rowNextRightEdges.set(row, prevInput.width);\n        } else {\n          nextRightEdge = row.width;\n        }\n        prevInput = row;\n      }\n    }\n    // Walk down each row from the top, comparing the prev and next right input\n    // edges and setting the desired width to the max of the two.\n    let prevRightEdge = 0;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      if (row.hasStatement) {\n        prevRightEdge = this.getDesiredRowWidth_(row);\n      } else if (Types.isSpacer(row)) {\n        // Set the spacer row to the max of the prev or next input width.\n        row.width = Math.max(prevRightEdge, rowNextRightEdges.get(row));\n      } else {\n        const currentWidth = row.width;\n        const desiredWidth = Math.max(\n          prevRightEdge,\n          rowNextRightEdges.get(row)\n        );\n        const missingSpace = desiredWidth - currentWidth;\n        if (missingSpace > 0) {\n          this.addAlignmentPadding_(row, missingSpace);\n        }\n        prevRightEdge = row.width;\n      }\n    }\n  }\n\n  override getDesiredRowWidth_(row: Row) {\n    // Limit the width of a statement row when a block is inline.\n    if (this.isInline && row.hasStatement) {\n      return (\n        this.statementEdge + this.constants_.MAX_BOTTOM_WIDTH + this.startX\n      );\n    }\n    return super.getDesiredRowWidth_(row);\n  }\n\n  override finalize_() {\n    // Performance note: this could be combined with the draw pass, if the time\n    // that this takes is excessive.  But it shouldn't be, because it only\n    // accesses and sets properties that already exist on the objects.\n    let widestRowWithConnectedBlocks = 0;\n    let yCursor = 0;\n    for (let i = 0, row; (row = this.rows[i]); i++) {\n      row.yPos = yCursor;\n      row.xPos = this.startX;\n      yCursor += row.height;\n\n      widestRowWithConnectedBlocks = Math.max(\n        widestRowWithConnectedBlocks,\n        row.widthWithConnectedBlocks\n      );\n      // Add padding to the bottom row if block height is less than minimum\n      const heightWithoutHat = yCursor - this.topRow.ascenderHeight;\n      if (\n        row === this.bottomRow &&\n        heightWithoutHat < this.constants_.MIN_BLOCK_HEIGHT\n      ) {\n        // But the hat height shouldn't be part of this.\n        const diff = this.constants_.MIN_BLOCK_HEIGHT - heightWithoutHat;\n        this.bottomRow.height += diff;\n        yCursor += diff;\n      }\n      this.recordElemPositions_(row);\n    }\n    if (\n      this.outputConnection &&\n      this.block_.nextConnection &&\n      this.block_.nextConnection.isConnected()\n    ) {\n      const target = this.block_.nextConnection.targetBlock();\n      if (target) {\n        // Include width of connected block in value to stack width measurement.\n        widestRowWithConnectedBlocks = Math.max(\n          widestRowWithConnectedBlocks,\n          target.getHeightWidth().width - this.constants_.DARK_PATH_OFFSET\n        );\n      }\n    }\n\n    this.bottomRow.baseline = yCursor - this.bottomRow.descenderHeight;\n    this.widthWithChildren =\n      widestRowWithConnectedBlocks +\n      this.startX +\n      this.constants_.DARK_PATH_OFFSET;\n    this.width += this.constants_.DARK_PATH_OFFSET;\n    this.height = yCursor + this.constants_.DARK_PATH_OFFSET;\n    this.startY = this.topRow.capline;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.PathObject');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {BlockStyle} from '../../theme.js';\nimport * as colour from '../../utils/colour.js';\nimport * as dom from '../../utils/dom.js';\nimport {Svg} from '../../utils/svg.js';\nimport {PathObject as BasePathObject} from '../common/path_object.js';\n\nimport type {ConstantProvider} from './constants.js';\n\n/**\n * An object that handles creating and setting each of the SVG elements\n * used by the renderer.\n */\nexport class PathObject extends BasePathObject {\n  svgPathDark: SVGElement;\n  svgPathLight: SVGElement;\n\n  /**\n   * The colour of the dark path on the block in '#RRGGBB' format.\n   */\n  colourDark = '#000000';\n\n  /**\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @param constants The renderer's constants.\n   */\n  constructor(\n    root: SVGElement,\n    style: BlockStyle,\n    public override constants: ConstantProvider\n  ) {\n    super(root, style, constants);\n\n    /** The dark path of the block. */\n    this.svgPathDark = dom.createSvgElement(Svg.PATH, {\n      'class': 'blocklyPathDark',\n      'transform': 'translate(1,1)',\n    });\n    // SVG draw order is based on the order of elements (top most = back most)\n    // So we need to insert the dark path before the base path to make sure it\n    // gets drawn first.\n    this.svgRoot.insertBefore(this.svgPathDark, this.svgPath);\n\n    /** The light path of the block. */\n    this.svgPathLight = dom.createSvgElement(\n      Svg.PATH,\n      {'class': 'blocklyPathLight'},\n      this.svgRoot\n    );\n  }\n\n  override setPath(mainPath: string) {\n    this.svgPath.setAttribute('d', mainPath);\n    this.svgPathDark.setAttribute('d', mainPath);\n  }\n\n  /**\n   * Set the highlight path generated by the renderer onto the SVG element.\n   *\n   * @param highlightPath The highlight path.\n   */\n  setHighlightPath(highlightPath: string) {\n    this.svgPathLight.setAttribute('d', highlightPath);\n  }\n\n  override flipRTL() {\n    // Mirror the block's path.\n    this.svgPath.setAttribute('transform', 'scale(-1 1)');\n    this.svgPathLight.setAttribute('transform', 'scale(-1 1)');\n    this.svgPathDark.setAttribute('transform', 'translate(1,1) scale(-1 1)');\n  }\n\n  override applyColour(block: BlockSvg) {\n    this.svgPathLight.style.display = '';\n    this.svgPathDark.style.display = '';\n    if (!this.style.colourTertiary) {\n      throw new Error(\n        'The renderer did not properly initialize the tertiary colour of ' +\n          'the block style'\n      );\n    }\n    this.svgPathLight.setAttribute('stroke', this.style.colourTertiary);\n    this.svgPathDark.setAttribute('fill', this.colourDark);\n\n    super.applyColour(block);\n\n    this.svgPath.setAttribute('stroke', 'none');\n  }\n\n  override setStyle(blockStyle: BlockStyle) {\n    this.style = blockStyle;\n    this.colourDark =\n      colour.blend('#000', this.style.colourPrimary, 0.2) || this.colourDark;\n  }\n\n  override updateHighlighted(highlighted: boolean) {\n    if (highlighted) {\n      this.svgPath.setAttribute(\n        'filter',\n        'url(#' + this.constants.embossFilterId + ')'\n      );\n      this.svgPathLight.style.display = 'none';\n    } else {\n      this.svgPath.setAttribute('filter', 'none');\n      this.svgPathLight.style.display = 'inline';\n    }\n  }\n\n  override updateShadow_(shadow: boolean) {\n    if (shadow) {\n      this.svgPathLight.style.display = 'none';\n      if (!this.style.colourSecondary) {\n        throw new Error(\n          'The renderer did not properly initialize the secondary colour ' +\n            'of the block style block style'\n        );\n      }\n      this.svgPathDark.setAttribute('fill', this.style.colourSecondary);\n      this.svgPath.setAttribute('stroke', 'none');\n      this.svgPath.setAttribute('fill', this.style.colourSecondary);\n    }\n  }\n\n  override updateDisabled_(disabled: boolean) {\n    super.updateDisabled_(disabled);\n    if (disabled) {\n      this.svgPath.setAttribute('stroke', 'none');\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras.Renderer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport type {BlockStyle, Theme} from '../../theme.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport type {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {HighlightConstantProvider} from './highlight_constants.js';\nimport {RenderInfo} from './info.js';\nimport {PathObject} from './path_object.js';\n\n/**\n * The geras renderer. This renderer was designed to be backwards compatible\n * with pre-2019 Blockly. Newer projects that are not constrained by backwards\n * compatibility should use thrasos, which is a more modern take on this\n * renderer.\n *\n * Geras is the ancient Greek spirit of old age.\n */\nexport class Renderer extends BaseRenderer {\n  /** The renderer's highlight constant provider. */\n  private highlightConstants: HighlightConstantProvider | null = null;\n\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Initialize the renderer.  Geras has a highlight provider in addition to\n   * the normal constant provider.\n   */\n  override init(\n    theme: Theme,\n    opt_rendererOverrides?: {[rendererConstant: string]: any}\n  ) {\n    super.init(theme, opt_rendererOverrides);\n    this.highlightConstants = this.makeHighlightConstants_();\n    this.highlightConstants.init();\n  }\n\n  override refreshDom(svg: SVGElement, theme: Theme) {\n    super.refreshDom(svg, theme);\n    this.getHighlightConstants().init();\n  }\n\n  override makeConstants_() {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected override makeDrawer_(\n    block: BlockSvg,\n    info: BaseRenderInfo\n  ): Drawer {\n    return new Drawer(block, info as RenderInfo);\n  }\n\n  /**\n   * Create a new instance of a renderer path object.\n   *\n   * @param root The root SVG element.\n   * @param style The style object to use for colouring.\n   * @returns The renderer path object.\n   */\n  override makePathObject(root: SVGElement, style: BlockStyle): PathObject {\n    return new PathObject(root, style, this.getConstants() as ConstantProvider);\n  }\n\n  /**\n   * Create a new instance of the renderer's highlight constant provider.\n   *\n   * @returns The highlight constant provider.\n   */\n  protected makeHighlightConstants_(): HighlightConstantProvider {\n    return new HighlightConstantProvider(this.getConstants());\n  }\n\n  /**\n   * Get the renderer's highlight constant provider.  We assume that when this\n   * is called, the renderer has already been initialized.\n   *\n   * @returns The highlight constant provider.\n   */\n  getHighlightConstants(): HighlightConstantProvider {\n    if (!this.highlightConstants) {\n      throw new Error(\n        'Cannot access the highlight constants because init has not ' +\n          'been called'\n      );\n    }\n    return this.highlightConstants;\n  }\n}\n\nblockRendering.register('geras', Renderer);\n","/** @file Re-exports of Blockly.geras.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.geras');\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {HighlightConstantProvider} from './highlight_constants.js';\nimport {Highlighter} from './highlighter.js';\nimport {RenderInfo} from './info.js';\nimport {InlineInput} from './measurables/inline_input.js';\nimport {StatementInput} from './measurables/statement_input.js';\nimport {PathObject} from './path_object.js';\nimport {Renderer} from './renderer.js';\n\nexport {\n  ConstantProvider,\n  Drawer,\n  HighlightConstantProvider,\n  Highlighter,\n  InlineInput,\n  PathObject,\n  Renderer,\n  RenderInfo,\n  StatementInput,\n};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.minimalist.ConstantProvider');\n\nimport {ConstantProvider as BaseConstantProvider} from '../common/constants.js';\n\n/**\n * An object that provides constants for rendering blocks in the minimalist\n * renderer.\n */\nexport class ConstantProvider extends BaseConstantProvider {\n  constructor() {\n    super();\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.minimalist.Drawer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {Drawer as BaseDrawer} from '../common/drawer.js';\n\nimport type {RenderInfo} from './info.js';\n\n/**\n * An object that draws a block based on the given rendering information.\n */\nexport class Drawer extends BaseDrawer {\n  /**\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   */\n  constructor(block: BlockSvg, info: RenderInfo) {\n    super(block, info);\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.minimalist.RenderInfo');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\n\nimport type {Renderer} from './renderer.js';\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo extends BaseRenderInfo {\n  // Exclamation is fine b/c this is assigned by the super constructor.\n  protected override renderer_!: Renderer;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.minimalist.Renderer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport type {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\n\n/**\n * The minimalist renderer.\n */\nexport class Renderer extends BaseRenderer {\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Create a new instance of the renderer's constant provider.\n   *\n   * @returns The constant provider.\n   */\n  protected override makeConstants_(): ConstantProvider {\n    return new ConstantProvider();\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n\n  /**\n   * Create a new instance of the renderer's drawer.\n   *\n   * @param block The block to render.\n   * @param info An object containing all information needed to render this\n   *     block.\n   * @returns The drawer.\n   */\n  protected override makeDrawer_(\n    block: BlockSvg,\n    info: BaseRenderInfo\n  ): Drawer {\n    return new Drawer(block, info as RenderInfo);\n  }\n}\n\nblockRendering.register('minimalist', Renderer);\n","/** @file Re-exports of Blockly.minimalist.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.minimalist');\n\nimport {ConstantProvider} from './constants.js';\nimport {Drawer} from './drawer.js';\nimport {RenderInfo} from './info.js';\nimport {Renderer} from './renderer.js';\n\nexport {ConstantProvider, Drawer, Renderer, RenderInfo};\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.thrasos.RenderInfo');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport {RenderInfo as BaseRenderInfo} from '../common/info.js';\nimport type {Measurable} from '../measurables/base.js';\nimport type {BottomRow} from '../measurables/bottom_row.js';\nimport type {Field} from '../measurables/field.js';\nimport {InRowSpacer} from '../measurables/in_row_spacer.js';\nimport type {Row} from '../measurables/row.js';\nimport type {TopRow} from '../measurables/top_row.js';\nimport {Types} from '../measurables/types.js';\n\nimport type {Renderer} from './renderer.js';\n\n/**\n * An object containing all sizing information needed to draw this block.\n *\n * This measure pass does not propagate changes to the block (although fields\n * may choose to rerender when getSize() is called).  However, calling it\n * repeatedly may be expensive.\n */\nexport class RenderInfo extends BaseRenderInfo {\n  // Exclamation is fine b/c this is assigned by the super constructor.\n  protected override renderer_!: Renderer;\n\n  /**\n   * @param renderer The renderer in use.\n   * @param block The block to measure.\n   */\n  constructor(renderer: Renderer, block: BlockSvg) {\n    super(renderer, block);\n  }\n\n  /**\n   * Get the block renderer in use.\n   *\n   * @returns The block renderer in use.\n   */\n  override getRenderer(): Renderer {\n    return this.renderer_;\n  }\n\n  override addElemSpacing_() {\n    let hasExternalInputs = false;\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      if (row.hasExternalInput) {\n        hasExternalInputs = true;\n        break;\n      }\n    }\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      const oldElems = row.elements;\n      row.elements = [];\n      // No spacing needed before the corner on the top row or the bottom row.\n      if (row.startsWithElemSpacer()) {\n        // There's a spacer before the first element in the row.\n        row.elements.push(\n          new InRowSpacer(\n            this.constants_,\n            this.getInRowSpacing_(null, oldElems[0])\n          )\n        );\n      }\n      if (!oldElems.length) {\n        continue;\n      }\n      for (let e = 0; e < oldElems.length - 1; e++) {\n        row.elements.push(oldElems[e]);\n        const spacing = this.getInRowSpacing_(oldElems[e], oldElems[e + 1]);\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n      row.elements.push(oldElems[oldElems.length - 1]);\n      if (row.endsWithElemSpacer()) {\n        let spacing = this.getInRowSpacing_(\n          oldElems[oldElems.length - 1],\n          null\n        );\n        if (hasExternalInputs && row.hasDummyInput) {\n          spacing += this.constants_.TAB_WIDTH;\n        }\n        // There's a spacer after the last element in the row.\n        row.elements.push(new InRowSpacer(this.constants_, spacing));\n      }\n    }\n  }\n\n  override getInRowSpacing_(prev: Measurable | null, next: Measurable | null) {\n    if (!prev) {\n      // Between an editable field and the beginning of the row.\n      if (next && Types.isField(next) && (next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Inline input at the beginning of the row.\n      if (next && Types.isInlineInput(next)) {\n        return this.constants_.MEDIUM_LARGE_PADDING;\n      }\n      if (next && Types.isStatementInput(next)) {\n        return this.constants_.STATEMENT_INPUT_PADDING_LEFT;\n      }\n      // Anything else at the beginning of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between a non-input and the end of the row.\n    if (!Types.isInput(prev) && !next) {\n      // Between an editable field and the end of the row.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      }\n      // Padding at the end of an icon-only row to make the block shape clearer.\n      if (Types.isIcon(prev)) {\n        return this.constants_.LARGE_PADDING * 2 + 1;\n      }\n      if (Types.isHat(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Establish a minimum width for a block with a previous or next\n      // connection.\n      if (Types.isPreviousOrNextConnection(prev)) {\n        return this.constants_.LARGE_PADDING;\n      }\n      // Between rounded corner and the end of the row.\n      if (Types.isLeftRoundedCorner(prev)) {\n        return this.constants_.MIN_BLOCK_WIDTH;\n      }\n      // Between a jagged edge and the end of the row.\n      if (Types.isJaggedEdge(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Between noneditable fields and icons and the end of the row.\n      return this.constants_.LARGE_PADDING;\n    }\n    // Between inputs and the end of the row.\n    if (Types.isInput(prev) && !next) {\n      if (Types.isExternalInput(prev)) {\n        return this.constants_.NO_PADDING;\n      } else if (Types.isInlineInput(prev)) {\n        return this.constants_.LARGE_PADDING;\n      } else if (Types.isStatementInput(prev)) {\n        return this.constants_.NO_PADDING;\n      }\n    }\n\n    // Spacing between a non-input and an input.\n    if (!Types.isInput(prev) && next && Types.isInput(next)) {\n      // Between an editable field and an input.\n      if (Types.isField(prev) && (prev as Field).isEditable) {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.SMALL_PADDING;\n        }\n      } else {\n        if (Types.isInlineInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isExternalInput(next)) {\n          return this.constants_.MEDIUM_LARGE_PADDING;\n        } else if (Types.isStatementInput(next)) {\n          return this.constants_.LARGE_PADDING;\n        }\n      }\n      return this.constants_.LARGE_PADDING - 1;\n    }\n\n    // Spacing between an icon and an icon or field.\n    if (Types.isIcon(prev) && next && !Types.isInput(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between an inline input and a field.\n    if (Types.isInlineInput(prev) && next && Types.isField(next)) {\n      // Editable field after inline input.\n      if ((next as Field).isEditable) {\n        return this.constants_.MEDIUM_PADDING;\n      } else {\n        // Noneditable field after inline input.\n        return this.constants_.LARGE_PADDING;\n      }\n    }\n\n    if (Types.isLeftSquareCorner(prev) && next) {\n      // Spacing between a hat and a corner\n      if (Types.isHat(next)) {\n        return this.constants_.NO_PADDING;\n      }\n      // Spacing between a square corner and a previous or next connection\n      if (Types.isPreviousConnection(next) || Types.isNextConnection(next)) {\n        return next.notchOffset;\n      }\n    }\n    // Spacing between a rounded corner and a previous or next connection.\n    if (Types.isLeftRoundedCorner(prev) && next) {\n      return next.notchOffset - this.constants_.CORNER_RADIUS;\n    }\n\n    // Spacing between two fields of the same editability.\n    if (\n      Types.isField(prev) &&\n      next &&\n      Types.isField(next) &&\n      (prev as Field).isEditable === (next as Field).isEditable\n    ) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    // Spacing between anything and a jagged edge.\n    if (next && Types.isJaggedEdge(next)) {\n      return this.constants_.LARGE_PADDING;\n    }\n\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getSpacerRowHeight_(prev: Row, next: Row) {\n    // If we have an empty block add a spacer to increase the height.\n    if (Types.isTopRow(prev) && Types.isBottomRow(next)) {\n      return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;\n    }\n    // Top and bottom rows act as a spacer so we don't need any extra padding.\n    if (Types.isTopRow(prev) || Types.isBottomRow(next)) {\n      return this.constants_.NO_PADDING;\n    }\n    if (prev.hasExternalInput && next.hasExternalInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (!prev.hasStatement && next.hasStatement) {\n      return this.constants_.BETWEEN_STATEMENT_PADDING_Y;\n    }\n    if (prev.hasStatement && next.hasStatement) {\n      return this.constants_.LARGE_PADDING;\n    }\n    if (prev.hasDummyInput || next.hasDummyInput) {\n      return this.constants_.LARGE_PADDING;\n    }\n    return this.constants_.MEDIUM_PADDING;\n  }\n\n  override getElemCenterline_(row: Row, elem: Measurable) {\n    if (Types.isSpacer(elem)) {\n      return row.yPos + elem.height / 2;\n    }\n    if (Types.isBottomRow(row)) {\n      const bottomRow = row as BottomRow;\n      const baseline =\n        bottomRow.yPos + bottomRow.height - bottomRow.descenderHeight;\n      if (Types.isNextConnection(elem)) {\n        return baseline + elem.height / 2;\n      }\n      return baseline - elem.height / 2;\n    }\n    if (Types.isTopRow(row)) {\n      const topRow = row as TopRow;\n      if (Types.isHat(elem)) {\n        return topRow.capline - elem.height / 2;\n      }\n      return topRow.capline + elem.height / 2;\n    }\n\n    let result = row.yPos;\n    if (Types.isField(elem) && row.hasStatement) {\n      const offset =\n        this.constants_.TALL_INPUT_FIELD_OFFSET_Y + elem.height / 2;\n      result += offset;\n    } else {\n      result += row.height / 2;\n    }\n    return result;\n  }\n\n  override finalize_() {\n    // Performance note: this could be combined with the draw pass, if the time\n    // that this takes is excessive.  But it shouldn't be, because it only\n    // accesses and sets properties that already exist on the objects.\n    let widestRowWithConnectedBlocks = 0;\n    let yCursor = 0;\n    for (let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n      row.yPos = yCursor;\n      row.xPos = this.startX;\n      yCursor += row.height;\n\n      widestRowWithConnectedBlocks = Math.max(\n        widestRowWithConnectedBlocks,\n        row.widthWithConnectedBlocks\n      );\n      // Add padding to the bottom row if block height is less than minimum\n      const heightWithoutHat = yCursor - this.topRow.ascenderHeight;\n      if (\n        row === this.bottomRow &&\n        heightWithoutHat < this.constants_.MIN_BLOCK_HEIGHT\n      ) {\n        // But the hat height shouldn't be part of this.\n        const diff = this.constants_.MIN_BLOCK_HEIGHT - heightWithoutHat;\n        this.bottomRow.height += diff;\n        yCursor += diff;\n      }\n      this.recordElemPositions_(row);\n    }\n    if (\n      this.outputConnection &&\n      this.block_.nextConnection &&\n      this.block_.nextConnection.isConnected()\n    ) {\n      const target = this.block_.nextConnection.targetBlock();\n      if (target) {\n        // Include width of connected block in value to stack width measurement.\n        widestRowWithConnectedBlocks = Math.max(\n          widestRowWithConnectedBlocks,\n          target.getHeightWidth().width\n        );\n      }\n    }\n\n    this.bottomRow.baseline = yCursor - this.bottomRow.descenderHeight;\n    this.widthWithChildren = widestRowWithConnectedBlocks + this.startX;\n\n    this.height = yCursor;\n    this.startY = this.topRow.capline;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.thrasos.Renderer');\n\nimport type {BlockSvg} from '../../block_svg.js';\nimport * as blockRendering from '../common/block_rendering.js';\nimport {Renderer as BaseRenderer} from '../common/renderer.js';\n\nimport {RenderInfo} from './info.js';\n\n/**\n * The thrasos renderer. This is a more modern take on the legacy geras\n * renderer.\n *\n * Thrasos is the ancient Greek spirit of boldness.\n */\nexport class Renderer extends BaseRenderer {\n  /**\n   * @param name The renderer name.\n   */\n  constructor(name: string) {\n    super(name);\n  }\n\n  /**\n   * Create a new instance of the renderer's render info object.\n   *\n   * @param block The block to measure.\n   * @returns The render info object.\n   */\n  protected override makeRenderInfo_(block: BlockSvg): RenderInfo {\n    return new RenderInfo(this, block);\n  }\n}\n\nblockRendering.register('thrasos', Renderer);\n","/** @file Re-exports of Blockly.thrasos.* modules. */\n\n/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.thrasos');\n\nimport {RenderInfo} from './info.js';\nimport {Renderer} from './renderer.js';\n\nexport {Renderer, RenderInfo};\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization.variables');\n\nimport type {ISerializer} from '../interfaces/i_serializer.js';\nimport type {Workspace} from '../workspace.js';\n\nimport * as priorities from './priorities.js';\nimport * as serializationRegistry from './registry.js';\n\n/**\n * Represents the state of a given variable.\n */\nexport interface State {\n  name: string;\n  id: string;\n  type: string | undefined;\n}\n\n/**\n * Serializer for saving and loading variable state.\n */\nexport class VariableSerializer implements ISerializer {\n  priority: number;\n\n  /* eslint-disable-next-line require-jsdoc */\n  constructor() {\n    /** The priority for deserializing variables. */\n    this.priority = priorities.VARIABLES;\n  }\n\n  /**\n   * Serializes the variables of the given workspace.\n   *\n   * @param workspace The workspace to save the variables of.\n   * @returns The state of the workspace's variables, or null if there are no\n   *     variables.\n   */\n  save(workspace: Workspace): State[] | null {\n    const variableStates = [];\n    for (const variable of workspace.getAllVariables()) {\n      const state = {\n        'name': variable.name,\n        'id': variable.getId(),\n      };\n      if (variable.type) {\n        (state as AnyDuringMigration)['type'] = variable.type;\n      }\n      variableStates.push(state);\n    }\n    // AnyDuringMigration because:  Type '{ name: string; id: string; }[] |\n    // null' is not assignable to type 'State[] | null'.\n    return (\n      variableStates.length ? variableStates : null\n    ) as AnyDuringMigration;\n  }\n\n  /**\n   * Deserializes the variable defined by the given state into the given\n   * workspace.\n   *\n   * @param state The state of the variables to deserialize.\n   * @param workspace The workspace to deserialize into.\n   */\n  load(state: State[], workspace: Workspace) {\n    for (const varState of state) {\n      workspace.createVariable(\n        varState['name'],\n        varState['type'],\n        varState['id']\n      );\n    }\n  }\n\n  /**\n   * Disposes of any variables that exist on the workspace.\n   *\n   * @param workspace The workspace to clear the variables of.\n   */\n  clear(workspace: Workspace) {\n    workspace.getVariableMap().clear();\n  }\n}\n\nserializationRegistry.register('variables', new VariableSerializer());\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Serialization methods.\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.serialization');\n\nimport * as blocks from './serialization/blocks.js';\nimport * as exceptions from './serialization/exceptions.js';\nimport * as priorities from './serialization/priorities.js';\nimport * as procedures from './serialization/procedures.js';\nimport * as registry from './serialization/registry.js';\nimport * as variables from './serialization/variables.js';\nimport * as workspaces from './serialization/workspaces.js';\nimport {ISerializer} from './interfaces/i_serializer.js';\n\nexport {\n  blocks,\n  exceptions,\n  priorities,\n  procedures,\n  registry,\n  variables,\n  workspaces,\n  ISerializer,\n};\n","/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Themes.Zelos');\n\nimport {Theme} from '../theme.js';\n\nconst defaultBlockStyles = {\n  'colour_blocks': {\n    'colourPrimary': '#CF63CF',\n    'colourSecondary': '#C94FC9',\n    'colourTertiary': '#BD42BD',\n  },\n  'list_blocks': {\n    'colourPrimary': '#9966FF',\n    'colourSecondary': '#855CD6',\n    'colourTertiary': '#774DCB',\n  },\n  'logic_blocks': {\n    'colourPrimary': '#4C97FF',\n    'colourSecondary': '#4280D7',\n    'colourTertiary': '#3373CC',\n  },\n  'loop_blocks': {\n    'colourPrimary': '#0fBD8C',\n    'colourSecondary': '#0DA57A',\n    'colourTertiary': '#0B8E69',\n  },\n  'math_blocks': {\n    'colourPrimary': '#59C059',\n    'colourSecondary': '#46B946',\n    'colourTertiary': '#389438',\n  },\n  'procedure_blocks': {\n    'colourPrimary': '#FF6680',\n    'colourSecondary': '#FF4D6A',\n    'colourTertiary': '#FF3355',\n  },\n  'text_blocks': {\n    'colourPrimary': '#FFBF00',\n    'colourSecondary': '#E6AC00',\n    'colourTertiary': '#CC9900',\n  },\n  'variable_blocks': {\n    'colourPrimary': '#FF8C1A',\n    'colourSecondary': '#FF8000',\n    'colourTertiary': '#DB6E00',\n  },\n  'variable_dynamic_blocks': {\n    'colourPrimary': '#FF8C1A',\n    'colourSecondary': '#FF8000',\n    'colourTertiary': '#DB6E00',\n  },\n  'hat_blocks': {\n    'colourPrimary': '#4C97FF',\n    'colourSecondary': '#4280D7',\n    'colourTertiary': '#3373CC',\n    'hat': 'cap',\n  },\n};\n\nconst categoryStyles = {\n  'colour_category': {'colour': '#CF63CF'},\n  'list_category': {'colour': '#9966FF'},\n  'logic_category': {'colour': '#4C97FF'},\n  'loop_category': {'colour': '#0fBD8C'},\n  'math_category': {'colour': '#59C059'},\n  'procedure_category': {'colour': '#FF6680'},\n  'text_category': {'colour': '#FFBF00'},\n  'variable_category': {'colour': '#FF8C1A'},\n  'variable_dynamic_category': {'colour': '#FF8C1A'},\n};\n\n/**\n * Zelos theme.\n */\nexport const Zelos = new Theme('zelos', defaultBlockStyles, categoryStyles);\n","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Themes');\n\nimport {Classic} from './classic.js';\nimport {Zelos} from './zelos.js';\n\nexport {Classic, Zelos};\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An item in the toolbox.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ToolboxItem');\n\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport * as idGenerator from '../utils/idgenerator.js';\nimport type * as toolbox from '../utils/toolbox.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\n/**\n * Class for an item in the toolbox.\n */\nexport class ToolboxItem implements IToolboxItem {\n  protected id_: string;\n  protected parent_: ICollapsibleToolboxItem | null;\n  protected level_: number;\n  protected toolboxItemDef_: toolbox.ToolboxItemInfo | null;\n  protected workspace_: WorkspaceSvg;\n  /** The toolbox this category belongs to. */\n  protected readonly parentToolbox_: IToolbox;\n\n  /**\n   * @param toolboxItemDef The JSON defining the toolbox item.\n   * @param parentToolbox The toolbox that holds the toolbox item.\n   * @param opt_parent The parent toolbox item or null if the category does not\n   *     have a parent.\n   */\n  constructor(\n    toolboxItemDef: toolbox.ToolboxItemInfo,\n    parentToolbox: IToolbox,\n    opt_parent?: ICollapsibleToolboxItem\n  ) {\n    /** The ID for the category. */\n    this.id_ =\n      (toolboxItemDef as AnyDuringMigration)['toolboxitemid'] ||\n      idGenerator.getNextUniqueId();\n\n    /** The parent of the category. */\n    this.parent_ = opt_parent || null;\n\n    /** The level that the category is nested at. */\n    this.level_ = this.parent_ ? this.parent_.getLevel() + 1 : 0;\n\n    /** The JSON definition of the toolbox item. */\n    this.toolboxItemDef_ = toolboxItemDef;\n\n    this.parentToolbox_ = parentToolbox;\n\n    /** The workspace of the parent toolbox. */\n    this.workspace_ = this.parentToolbox_.getWorkspace();\n  }\n\n  /**\n   * Initializes the toolbox item.\n   * This includes creating the DOM and updating the state of any items based\n   * on the info object.\n   */\n  init() {}\n  // No-op by default.\n\n  /**\n   * Gets the div for the toolbox item.\n   *\n   * @returns The div for the toolbox item.\n   */\n  getDiv(): Element | null {\n    return null;\n  }\n\n  /**\n   * Gets the HTML element that is clickable.\n   * The parent toolbox element receives clicks. The parent toolbox will add an\n   * ID to this element so it can pass the onClick event to the correct\n   * toolboxItem.\n   *\n   * @returns The HTML element that receives clicks, or null if this item should\n   *     not receive clicks.\n   */\n  getClickTarget(): Element | null {\n    return null;\n  }\n\n  /**\n   * Gets a unique identifier for this toolbox item.\n   *\n   * @returns The ID for the toolbox item.\n   */\n  getId(): string {\n    return this.id_;\n  }\n\n  /**\n   * Gets the parent if the toolbox item is nested.\n   *\n   * @returns The parent toolbox item, or null if this toolbox item is not\n   *     nested.\n   */\n  getParent(): ICollapsibleToolboxItem | null {\n    return null;\n  }\n\n  /**\n   * Gets the nested level of the category.\n   *\n   * @returns The nested level of the category.\n   * @internal\n   */\n  getLevel(): number {\n    return this.level_;\n  }\n\n  /**\n   * Whether the toolbox item is selectable.\n   *\n   * @returns True if the toolbox item can be selected.\n   */\n  isSelectable(): boolean {\n    return false;\n  }\n\n  /**\n   * Whether the toolbox item is collapsible.\n   *\n   * @returns True if the toolbox item is collapsible.\n   */\n  isCollapsible(): boolean {\n    return false;\n  }\n\n  /** Dispose of this toolbox item. No-op by default. */\n  dispose() {}\n\n  /**\n   * Sets whether the category is visible or not.\n   * For a category to be visible its parent category must also be expanded.\n   *\n   * @param _isVisible True if category should be visible.\n   */\n  setVisible_(_isVisible: boolean) {}\n}\n// nop by default\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A toolbox category used to organize blocks in the toolbox.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ToolboxCategory');\n\nimport * as Css from '../css.js';\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {ISelectableToolboxItem} from '../interfaces/i_selectable_toolbox_item.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport type {\n  CategoryInfo,\n  DynamicCategoryInfo,\n  FlyoutDefinition,\n  FlyoutItemInfo,\n  FlyoutItemInfoArray,\n  StaticCategoryInfo,\n} from '../utils/toolbox.js';\nimport * as registry from '../registry.js';\nimport * as aria from '../utils/aria.js';\nimport * as colourUtils from '../utils/colour.js';\nimport * as dom from '../utils/dom.js';\nimport * as parsing from '../utils/parsing.js';\nimport * as toolbox from '../utils/toolbox.js';\n\nimport {ToolboxItem} from './toolbox_item.js';\n\n/**\n * Class for a category in a toolbox.\n */\nexport class ToolboxCategory\n  extends ToolboxItem\n  implements ISelectableToolboxItem\n{\n  /** Name used for registering a toolbox category. */\n  static registrationName = 'category';\n\n  /** The number of pixels to move the category over at each nested level. */\n  static nestedPadding = 19;\n\n  /** The width in pixels of the strip of colour next to each category. */\n  static borderWidth = 8;\n\n  /**\n   * The default colour of the category. This is used as the background colour\n   * of the category when it is selected.\n   */\n  static defaultBackgroundColour = '#57e';\n\n  // TODO(b/109816955): remove '!', see go/strict-prop-init-fix.\n  override toolboxItemDef_!: CategoryInfo;\n\n  /** The name that will be displayed on the category. */\n  protected name_ = '';\n\n  /** The colour of the category. */\n  protected colour_ = '';\n\n  /** The HTML container for the category. */\n  protected htmlDiv_: HTMLDivElement | null = null;\n\n  /** The HTML element for the category row. */\n  protected rowDiv_: HTMLDivElement | null = null;\n\n  /** The HTML element that holds children elements of the category row. */\n  protected rowContents_: HTMLDivElement | null = null;\n\n  /** The HTML element for the toolbox icon. */\n  protected iconDom_: Element | null = null;\n\n  /** The HTML element for the toolbox label. */\n  protected labelDom_: Element | null = null;\n  protected cssConfig_: CssConfig;\n\n  /** True if the category is meant to be hidden, false otherwise. */\n  protected isHidden_ = false;\n\n  /** True if this category is disabled, false otherwise. */\n  protected isDisabled_ = false;\n\n  /** The flyout items for this category. */\n  protected flyoutItems_: string | FlyoutItemInfoArray = [];\n\n  /**\n   * @param categoryDef The information needed to create a category in the\n   *     toolbox.\n   * @param parentToolbox The parent toolbox for the category.\n   * @param opt_parent The parent category or null if the category does not have\n   *     a parent.\n   */\n  constructor(\n    categoryDef: CategoryInfo,\n    parentToolbox: IToolbox,\n    opt_parent?: ICollapsibleToolboxItem\n  ) {\n    super(categoryDef, parentToolbox, opt_parent);\n\n    /** All the css class names that are used to create a category. */\n    this.cssConfig_ = this.makeDefaultCssConfig_();\n  }\n\n  /**\n   * Initializes the toolbox item.\n   * This includes creating the DOM and updating the state of any items based\n   * on the info object.\n   * Init should be called immediately after the construction of the toolbox\n   * item, to ensure that the category contents are properly parsed.\n   */\n  override init() {\n    this.parseCategoryDef_(this.toolboxItemDef_);\n    this.parseContents_(this.toolboxItemDef_);\n    this.createDom_();\n    if (this.toolboxItemDef_['hidden'] === 'true') {\n      this.hide();\n    }\n  }\n\n  /**\n   * Creates an object holding the default classes for a category.\n   *\n   * @returns The configuration object holding all the CSS classes for a\n   *     category.\n   */\n  protected makeDefaultCssConfig_(): CssConfig {\n    return {\n      'container': 'blocklyToolboxCategory',\n      'row': 'blocklyTreeRow',\n      'rowcontentcontainer': 'blocklyTreeRowContentContainer',\n      'icon': 'blocklyTreeIcon',\n      'label': 'blocklyTreeLabel',\n      'contents': 'blocklyToolboxContents',\n      'selected': 'blocklyTreeSelected',\n      'openicon': 'blocklyTreeIconOpen',\n      'closedicon': 'blocklyTreeIconClosed',\n    };\n  }\n\n  /**\n   * Parses the contents array depending on if the category is a dynamic\n   * category, or if its contents are meant to be shown in the flyout.\n   *\n   * @param categoryDef The information needed to create a category.\n   */\n  protected parseContents_(categoryDef: CategoryInfo) {\n    if ('custom' in categoryDef) {\n      this.flyoutItems_ = categoryDef['custom'];\n    } else {\n      const contents = categoryDef['contents'];\n      if (!contents) return;\n\n      for (let i = 0; i < contents.length; i++) {\n        const itemDef = contents[i];\n        const flyoutItem = itemDef as FlyoutItemInfo;\n        if (Array.isArray(this.flyoutItems_)) {\n          this.flyoutItems_.push(flyoutItem);\n        }\n      }\n    }\n  }\n\n  /**\n   * Parses the non-contents parts of the category def.\n   *\n   * @param categoryDef The information needed to create a category.\n   */\n  protected parseCategoryDef_(categoryDef: CategoryInfo) {\n    this.name_ =\n      'name' in categoryDef\n        ? parsing.replaceMessageReferences(categoryDef['name'])\n        : '';\n    this.colour_ = this.getColour_(categoryDef);\n    Object.assign(\n      this.cssConfig_,\n      categoryDef['cssconfig'] || (categoryDef as any)['cssConfig']\n    );\n  }\n\n  /**\n   * Creates the DOM for the category.\n   *\n   * @returns The parent element for the category.\n   */\n  protected createDom_(): HTMLDivElement {\n    this.htmlDiv_ = this.createContainer_();\n    aria.setRole(this.htmlDiv_, aria.Role.TREEITEM);\n    aria.setState(this.htmlDiv_, aria.State.SELECTED, false);\n    aria.setState(this.htmlDiv_, aria.State.LEVEL, this.level_ + 1);\n\n    this.rowDiv_ = this.createRowContainer_();\n    this.rowDiv_.style.pointerEvents = 'auto';\n    this.htmlDiv_.appendChild(this.rowDiv_);\n\n    this.rowContents_ = this.createRowContentsContainer_();\n    this.rowContents_.style.pointerEvents = 'none';\n    this.rowDiv_.appendChild(this.rowContents_);\n\n    this.iconDom_ = this.createIconDom_();\n    aria.setRole(this.iconDom_, aria.Role.PRESENTATION);\n    this.rowContents_.appendChild(this.iconDom_);\n\n    this.labelDom_ = this.createLabelDom_(this.name_);\n    this.rowContents_.appendChild(this.labelDom_);\n\n    const id = this.labelDom_.getAttribute('id');\n    if (id) {\n      aria.setState(this.htmlDiv_, aria.State.LABELLEDBY, id);\n    }\n\n    this.addColourBorder_(this.colour_);\n\n    return this.htmlDiv_;\n  }\n\n  /**\n   * Creates the container that holds the row and any subcategories.\n   *\n   * @returns The div that holds the icon and the label.\n   */\n  protected createContainer_(): HTMLDivElement {\n    const container = document.createElement('div');\n    const className = this.cssConfig_['container'];\n    if (className) {\n      dom.addClass(container, className);\n    }\n    return container;\n  }\n\n  /**\n   * Creates the parent of the contents container. All clicks will happen on\n   * this div.\n   *\n   * @returns The div that holds the contents container.\n   */\n  protected createRowContainer_(): HTMLDivElement {\n    const rowDiv = document.createElement('div');\n    const className = this.cssConfig_['row'];\n    if (className) {\n      dom.addClass(rowDiv, className);\n    }\n    const nestedPadding = `${\n      ToolboxCategory.nestedPadding * this.getLevel()\n    }px`;\n    this.workspace_.RTL\n      ? (rowDiv.style.paddingRight = nestedPadding)\n      : (rowDiv.style.paddingLeft = nestedPadding);\n    return rowDiv;\n  }\n\n  /**\n   * Creates the container for the label and icon.\n   * This is necessary so we can set all subcategory pointer events to none.\n   *\n   * @returns The div that holds the icon and the label.\n   */\n  protected createRowContentsContainer_(): HTMLDivElement {\n    const contentsContainer = document.createElement('div');\n    const className = this.cssConfig_['rowcontentcontainer'];\n    if (className) {\n      dom.addClass(contentsContainer, className);\n    }\n    return contentsContainer;\n  }\n\n  /**\n   * Creates the span that holds the category icon.\n   *\n   * @returns The span that holds the category icon.\n   */\n  protected createIconDom_(): Element {\n    const toolboxIcon = document.createElement('span');\n    if (!this.parentToolbox_.isHorizontal()) {\n      const className = this.cssConfig_['icon'];\n      if (className) {\n        dom.addClass(toolboxIcon, className);\n      }\n    }\n\n    toolboxIcon.style.display = 'inline-block';\n    return toolboxIcon;\n  }\n\n  /**\n   * Creates the span that holds the category label.\n   * This should have an ID for accessibility purposes.\n   *\n   * @param name The name of the category.\n   * @returns The span that holds the category label.\n   */\n  protected createLabelDom_(name: string): Element {\n    const toolboxLabel = document.createElement('span');\n    toolboxLabel.setAttribute('id', this.getId() + '.label');\n    toolboxLabel.textContent = name;\n    const className = this.cssConfig_['label'];\n    if (className) {\n      dom.addClass(toolboxLabel, className);\n    }\n    return toolboxLabel;\n  }\n\n  /** Updates the colour for this category. */\n  refreshTheme() {\n    this.colour_ = this.getColour_(this.toolboxItemDef_);\n    this.addColourBorder_(this.colour_);\n  }\n\n  /**\n   * Add the strip of colour to the toolbox category.\n   *\n   * @param colour The category colour.\n   */\n  protected addColourBorder_(colour: string) {\n    if (colour) {\n      const border =\n        ToolboxCategory.borderWidth + 'px solid ' + (colour || '#ddd');\n      if (this.workspace_.RTL) {\n        this.rowDiv_!.style.borderRight = border;\n      } else {\n        this.rowDiv_!.style.borderLeft = border;\n      }\n    }\n  }\n\n  /**\n   * Gets either the colour or the style for a category.\n   *\n   * @param categoryDef The object holding information on the category.\n   * @returns The hex colour for the category.\n   */\n  protected getColour_(categoryDef: CategoryInfo): string {\n    const styleName =\n      categoryDef['categorystyle'] || (categoryDef as any)['categoryStyle'];\n    const colour = categoryDef['colour'];\n\n    if (colour && styleName) {\n      console.warn(\n        'Toolbox category \"' +\n          this.name_ +\n          '\" must not have both a style and a colour'\n      );\n    } else if (styleName) {\n      return this.getColourfromStyle_(styleName);\n    } else if (colour) {\n      return this.parseColour_(colour);\n    }\n    return '';\n  }\n\n  /**\n   * Sets the colour for the category using the style name and returns the new\n   * colour as a hex string.\n   *\n   * @param styleName Name of the style.\n   * @returns The hex colour for the category.\n   */\n  private getColourfromStyle_(styleName: string): string {\n    const theme = this.workspace_.getTheme();\n    if (styleName && theme) {\n      const style = theme.categoryStyles[styleName];\n      if (style && style.colour) {\n        return this.parseColour_(style.colour);\n      } else {\n        console.warn(\n          'Style \"' + styleName + '\" must exist and contain a colour value'\n        );\n      }\n    }\n    return '';\n  }\n\n  /**\n   * Gets the HTML element that is clickable.\n   * The parent toolbox element receives clicks. The parent toolbox will add an\n   * ID to this element so it can pass the onClick event to the correct\n   * toolboxItem.\n   *\n   * @returns The HTML element that receives clicks.\n   */\n  override getClickTarget(): Element {\n    return this.rowDiv_ as Element;\n  }\n\n  /**\n   * Parses the colour on the category.\n   *\n   * @param colourValue HSV hue value (0 to 360), #RRGGBB string, or a message\n   *     reference string pointing to one of those two values.\n   * @returns The hex colour for the category.\n   */\n  private parseColour_(colourValue: number | string): string {\n    // Decode the colour for any potential message references\n    // (eg. `%{BKY_MATH_HUE}`).\n    const colour = parsing.replaceMessageReferences(colourValue);\n    if (colour == null || colour === '') {\n      // No attribute. No colour.\n      return '';\n    } else {\n      const hue = Number(colour);\n      if (!isNaN(hue)) {\n        return colourUtils.hueToHex(hue);\n      } else {\n        const hex = colourUtils.parse(colour);\n        if (hex) {\n          return hex;\n        } else {\n          console.warn(\n            'Toolbox category \"' +\n              this.name_ +\n              '\" has unrecognized colour attribute: ' +\n              colour\n          );\n          return '';\n        }\n      }\n    }\n  }\n\n  /**\n   * Adds appropriate classes to display an open icon.\n   *\n   * @param iconDiv The div that holds the icon.\n   */\n  protected openIcon_(iconDiv: Element | null) {\n    if (!iconDiv) {\n      return;\n    }\n    const closedIconClass = this.cssConfig_['closedicon'];\n    if (closedIconClass) {\n      dom.removeClasses(iconDiv, closedIconClass);\n    }\n    const className = this.cssConfig_['openicon'];\n    if (className) {\n      dom.addClass(iconDiv, className);\n    }\n  }\n\n  /**\n   * Adds appropriate classes to display a closed icon.\n   *\n   * @param iconDiv The div that holds the icon.\n   */\n  protected closeIcon_(iconDiv: Element | null) {\n    if (!iconDiv) {\n      return;\n    }\n    const openIconClass = this.cssConfig_['openicon'];\n    if (openIconClass) {\n      dom.removeClasses(iconDiv, openIconClass);\n    }\n    const className = this.cssConfig_['closedicon'];\n    if (className) {\n      dom.addClass(iconDiv, className);\n    }\n  }\n\n  /**\n   * Sets whether the category is visible or not.\n   * For a category to be visible its parent category must also be expanded.\n   *\n   * @param isVisible True if category should be visible.\n   */\n  override setVisible_(isVisible: boolean) {\n    this.htmlDiv_!.style.display = isVisible ? 'block' : 'none';\n    this.isHidden_ = !isVisible;\n\n    if (this.parentToolbox_.getSelectedItem() === this) {\n      this.parentToolbox_.clearSelection();\n    }\n  }\n\n  /** Hide the category. */\n  hide() {\n    this.setVisible_(false);\n  }\n\n  /**\n   * Show the category. Category will only appear if its parent category is also\n   * expanded.\n   */\n  show() {\n    this.setVisible_(true);\n  }\n\n  /**\n   * Whether the category is visible.\n   * A category is only visible if all of its ancestors are expanded and\n   * isHidden_ is false.\n   *\n   * @returns True if the category is visible, false otherwise.\n   */\n  isVisible(): boolean {\n    return !this.isHidden_ && this.allAncestorsExpanded_();\n  }\n\n  /**\n   * Whether all ancestors of a category (parent and parent's parent, etc.) are\n   * expanded.\n   *\n   * @returns True only if every ancestor is expanded\n   */\n  protected allAncestorsExpanded_(): boolean {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    let category: IToolboxItem = this;\n    while (category.getParent()) {\n      category = category.getParent()!;\n      if (!(category as ICollapsibleToolboxItem).isExpanded()) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  override isSelectable() {\n    return this.isVisible() && !this.isDisabled_;\n  }\n\n  /**\n   * Handles when the toolbox item is clicked.\n   *\n   * @param _e Click event to handle.\n   */\n  onClick(_e: Event) {}\n  // No-op\n\n  /**\n   * Sets the current category as selected.\n   *\n   * @param isSelected True if this category is selected, false otherwise.\n   */\n  setSelected(isSelected: boolean) {\n    if (!this.rowDiv_) {\n      return;\n    }\n    const className = this.cssConfig_['selected'];\n    if (isSelected) {\n      const defaultColour = this.parseColour_(\n        ToolboxCategory.defaultBackgroundColour\n      );\n      this.rowDiv_.style.backgroundColor = this.colour_ || defaultColour;\n      if (className) {\n        dom.addClass(this.rowDiv_, className);\n      }\n    } else {\n      this.rowDiv_.style.backgroundColor = '';\n      if (className) {\n        dom.removeClass(this.rowDiv_, className);\n      }\n    }\n    aria.setState(this.htmlDiv_ as Element, aria.State.SELECTED, isSelected);\n  }\n\n  /**\n   * Sets whether the category is disabled.\n   *\n   * @param isDisabled True to disable the category, false otherwise.\n   */\n  setDisabled(isDisabled: boolean) {\n    this.isDisabled_ = isDisabled;\n    this.getDiv()!.setAttribute('disabled', `${isDisabled}`);\n    isDisabled\n      ? this.getDiv()!.setAttribute('disabled', 'true')\n      : this.getDiv()!.removeAttribute('disabled');\n  }\n\n  /**\n   * Gets the name of the category. Used for emitting events.\n   *\n   * @returns The name of the toolbox item.\n   */\n  getName(): string {\n    return this.name_;\n  }\n\n  override getParent() {\n    return this.parent_;\n  }\n\n  override getDiv() {\n    return this.htmlDiv_;\n  }\n\n  /**\n   * Gets the contents of the category. These are items that are meant to be\n   * displayed in the flyout.\n   *\n   * @returns The definition of items to be displayed in the flyout.\n   */\n  getContents(): FlyoutItemInfoArray | string {\n    return this.flyoutItems_;\n  }\n\n  /**\n   * Updates the contents to be displayed in the flyout.\n   * If the flyout is open when the contents are updated, refreshSelection on\n   * the toolbox must also be called.\n   *\n   * @param contents The contents to be displayed in the flyout. A string can be\n   *     supplied to create a dynamic category.\n   */\n  updateFlyoutContents(contents: FlyoutDefinition | string) {\n    this.flyoutItems_ = [];\n\n    if (typeof contents === 'string') {\n      const newDefinition: DynamicCategoryInfo = {\n        kind: this.toolboxItemDef_.kind,\n        custom: contents,\n        id: this.toolboxItemDef_.id,\n        categorystyle: this.toolboxItemDef_.categorystyle,\n        colour: this.toolboxItemDef_.colour,\n        cssconfig: this.toolboxItemDef_.cssconfig,\n        hidden: this.toolboxItemDef_.hidden,\n      };\n      this.toolboxItemDef_ = newDefinition;\n    } else {\n      const newDefinition: StaticCategoryInfo = {\n        kind: this.toolboxItemDef_.kind,\n        name:\n          'name' in this.toolboxItemDef_ ? this.toolboxItemDef_['name'] : '',\n        contents: toolbox.convertFlyoutDefToJsonArray(contents),\n        id: this.toolboxItemDef_.id,\n        categorystyle: this.toolboxItemDef_.categorystyle,\n        colour: this.toolboxItemDef_.colour,\n        cssconfig: this.toolboxItemDef_.cssconfig,\n        hidden: this.toolboxItemDef_.hidden,\n      };\n      this.toolboxItemDef_ = newDefinition;\n    }\n    this.parseContents_(this.toolboxItemDef_);\n  }\n\n  override dispose() {\n    dom.removeNode(this.htmlDiv_);\n  }\n}\n\nexport namespace ToolboxCategory {\n  /** All the CSS class names that are used to create a category. */\n  export interface CssConfig {\n    container?: string;\n    row?: string;\n    rowcontentcontainer?: string;\n    icon?: string;\n    label?: string;\n    contents?: string;\n    selected?: string;\n    openicon?: string;\n    closedicon?: string;\n  }\n}\n\nexport type CssConfig = ToolboxCategory.CssConfig;\n\n/** CSS for Toolbox.  See css.js for use. */\nCss.register(`\n.blocklyTreeRow:not(.blocklyTreeSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolboxDiv[layout=\"h\"] .blocklyToolboxCategory {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"][layout=\"h\"] .blocklyToolboxCategory {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyTreeRow {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeRow {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyTreeIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyTreeIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolboxDiv[dir=\"RTL\"] .blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyTreeIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyTreeLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyTreeLabel {\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\n}\n\n.blocklyTreeSelected .blocklyTreeLabel {\n  color: #fff;\n}\n`);\n\nregistry.register(\n  registry.Type.TOOLBOX_ITEM,\n  ToolboxCategory.registrationName,\n  ToolboxCategory\n);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A separator used for separating toolbox categories.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.ToolboxSeparator');\n\nimport * as Css from '../css.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport * as registry from '../registry.js';\nimport * as dom from '../utils/dom.js';\nimport type * as toolbox from '../utils/toolbox.js';\n\nimport {ToolboxItem} from './toolbox_item.js';\n\n/**\n * Class for a toolbox separator. This is the thin visual line that appears on\n * the toolbox. This item is not interactable.\n */\nexport class ToolboxSeparator extends ToolboxItem {\n  /** Name used for registering a toolbox separator. */\n  static registrationName = 'sep';\n\n  /** All the CSS class names that are used to create a separator. */\n  protected cssConfig_: CssConfig = {'container': 'blocklyTreeSeparator'};\n\n  private htmlDiv_: HTMLDivElement | null = null;\n\n  /**\n   * @param separatorDef The information needed to create a separator.\n   * @param toolbox The parent toolbox for the separator.\n   */\n  constructor(separatorDef: toolbox.SeparatorInfo, toolbox: IToolbox) {\n    super(separatorDef, toolbox);\n\n    const cssConfig =\n      separatorDef['cssconfig'] || (separatorDef as any)['cssConfig'];\n    Object.assign(this.cssConfig_, cssConfig);\n  }\n\n  override init() {\n    this.createDom_();\n  }\n\n  /**\n   * Creates the DOM for a separator.\n   *\n   * @returns The parent element for the separator.\n   */\n  protected createDom_(): HTMLDivElement {\n    const container = document.createElement('div');\n    const className = this.cssConfig_['container'];\n    if (className) {\n      dom.addClass(container, className);\n    }\n    this.htmlDiv_ = container;\n    return container;\n  }\n\n  override getDiv() {\n    return this.htmlDiv_ as HTMLDivElement;\n  }\n\n  override dispose() {\n    dom.removeNode(this.htmlDiv_ as HTMLDivElement);\n  }\n}\n\nexport namespace ToolboxSeparator {\n  export interface CssConfig {\n    container: string | undefined;\n  }\n}\n\nexport type CssConfig = ToolboxSeparator.CssConfig;\n\n/** CSS for Toolbox.  See css.js for use. */\nCss.register(`\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolboxDiv[layout=\"h\"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n`);\n\nregistry.register(\n  registry.Type.TOOLBOX_ITEM,\n  ToolboxSeparator.registrationName,\n  ToolboxSeparator\n);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A toolbox category used to organize blocks in the toolbox.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.CollapsibleToolboxCategory');\n\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport * as registry from '../registry.js';\nimport * as aria from '../utils/aria.js';\nimport * as dom from '../utils/dom.js';\nimport * as toolbox from '../utils/toolbox.js';\n\nimport {ToolboxCategory} from './category.js';\nimport {ToolboxSeparator} from './separator.js';\n\n/**\n * Class for a category in a toolbox that can be collapsed.\n */\nexport class CollapsibleToolboxCategory\n  extends ToolboxCategory\n  implements ICollapsibleToolboxItem\n{\n  /** Name used for registering a collapsible toolbox category. */\n  static override registrationName = 'collapsibleCategory';\n\n  /** Container for any child categories. */\n  protected subcategoriesDiv_: HTMLDivElement | null = null;\n\n  /** Whether or not the category should display its subcategories. */\n  protected expanded_ = false;\n\n  /** The child toolbox items for this category. */\n  protected toolboxItems_: IToolboxItem[] = [];\n\n  /**\n   * @param categoryDef The information needed to create a category in the\n   *     toolbox.\n   * @param toolbox The parent toolbox for the category.\n   * @param opt_parent The parent category or null if the category does not have\n   *     a parent.\n   */\n  constructor(\n    categoryDef: toolbox.CategoryInfo,\n    toolbox: IToolbox,\n    opt_parent?: ICollapsibleToolboxItem\n  ) {\n    super(categoryDef, toolbox, opt_parent);\n  }\n\n  override makeDefaultCssConfig_() {\n    const cssConfig = super.makeDefaultCssConfig_();\n    cssConfig['contents'] = 'blocklyToolboxContents';\n    return cssConfig;\n  }\n\n  override parseContents_(categoryDef: toolbox.CategoryInfo) {\n    if ('custom' in categoryDef) {\n      this.flyoutItems_ = categoryDef['custom'];\n    } else {\n      const contents = categoryDef['contents'];\n      if (!contents) return;\n      this.flyoutItems_ = [];\n      let prevIsFlyoutItem = true;\n      for (let i = 0; i < contents.length; i++) {\n        const itemDef = contents[i];\n        // Separators can exist as either a flyout item or a toolbox item so\n        // decide where it goes based on the type of the previous item.\n        if (\n          !registry.hasItem(registry.Type.TOOLBOX_ITEM, itemDef['kind']) ||\n          (itemDef['kind'].toLowerCase() ===\n            ToolboxSeparator.registrationName &&\n            prevIsFlyoutItem)\n        ) {\n          const flyoutItem = itemDef as toolbox.FlyoutItemInfo;\n          this.flyoutItems_.push(flyoutItem);\n          prevIsFlyoutItem = true;\n        } else {\n          this.createToolboxItem_(itemDef);\n          prevIsFlyoutItem = false;\n        }\n      }\n    }\n  }\n\n  /**\n   * Creates a toolbox item and adds it to the list of toolbox items.\n   *\n   * @param itemDef The information needed to create a toolbox item.\n   */\n  private createToolboxItem_(itemDef: toolbox.ToolboxItemInfo) {\n    let registryName = itemDef['kind'];\n    const categoryDef = itemDef as toolbox.CategoryInfo;\n    // Categories that are collapsible are created using a class registered\n    // under a different name.\n    if (\n      registryName.toUpperCase() === 'CATEGORY' &&\n      toolbox.isCategoryCollapsible(categoryDef)\n    ) {\n      registryName = CollapsibleToolboxCategory.registrationName;\n    }\n    const ToolboxItemClass = registry.getClass(\n      registry.Type.TOOLBOX_ITEM,\n      registryName\n    );\n    const toolboxItem = new ToolboxItemClass!(\n      itemDef,\n      this.parentToolbox_,\n      this\n    );\n    this.toolboxItems_.push(toolboxItem);\n  }\n\n  override init() {\n    super.init();\n\n    this.setExpanded(\n      this.toolboxItemDef_['expanded'] === 'true' ||\n        this.toolboxItemDef_['expanded'] === true\n    );\n  }\n\n  override createDom_() {\n    super.createDom_();\n\n    const subCategories = this.getChildToolboxItems();\n    this.subcategoriesDiv_ = this.createSubCategoriesDom_(subCategories);\n    aria.setRole(this.subcategoriesDiv_, aria.Role.GROUP);\n    this.htmlDiv_!.appendChild(this.subcategoriesDiv_);\n    this.closeIcon_(this.iconDom_);\n    aria.setState(this.htmlDiv_ as HTMLDivElement, aria.State.EXPANDED, false);\n\n    return this.htmlDiv_!;\n  }\n\n  override createIconDom_() {\n    const toolboxIcon = document.createElement('span');\n    if (!this.parentToolbox_.isHorizontal()) {\n      const className = this.cssConfig_['icon'];\n      if (className) {\n        dom.addClass(toolboxIcon, className);\n      }\n      toolboxIcon.style.visibility = 'visible';\n    }\n\n    toolboxIcon.style.display = 'inline-block';\n    return toolboxIcon;\n  }\n\n  /**\n   * Create the DOM for all subcategories.\n   *\n   * @param subcategories The subcategories.\n   * @returns The div holding all the subcategories.\n   */\n  protected createSubCategoriesDom_(\n    subcategories: IToolboxItem[]\n  ): HTMLDivElement {\n    const contentsContainer = document.createElement('div');\n    contentsContainer.style.display = 'none';\n    const className = this.cssConfig_['contents'];\n    if (className) {\n      dom.addClass(contentsContainer, className);\n    }\n\n    for (let i = 0; i < subcategories.length; i++) {\n      const newCategory = subcategories[i];\n      newCategory.init();\n      const newCategoryDiv = newCategory.getDiv();\n      contentsContainer.appendChild(newCategoryDiv!);\n      if (newCategory.getClickTarget) {\n        newCategory.getClickTarget()?.setAttribute('id', newCategory.getId());\n      }\n    }\n    return contentsContainer;\n  }\n\n  /**\n   * Opens or closes the current category.\n   *\n   * @param isExpanded True to expand the category, false to close.\n   */\n  setExpanded(isExpanded: boolean) {\n    if (this.expanded_ === isExpanded) return;\n\n    this.expanded_ = isExpanded;\n    if (isExpanded) {\n      this.subcategoriesDiv_!.style.display = 'block';\n      this.openIcon_(this.iconDom_);\n    } else {\n      this.subcategoriesDiv_!.style.display = 'none';\n      this.closeIcon_(this.iconDom_);\n    }\n    aria.setState(\n      this.htmlDiv_ as HTMLDivElement,\n      aria.State.EXPANDED,\n      isExpanded\n    );\n\n    this.parentToolbox_.handleToolboxItemResize();\n  }\n\n  override setVisible_(isVisible: boolean) {\n    this.htmlDiv_!.style.display = isVisible ? 'block' : 'none';\n    const childToolboxItems = this.getChildToolboxItems();\n    for (let i = 0; i < childToolboxItems.length; i++) {\n      const child = childToolboxItems[i];\n      child.setVisible_(isVisible);\n    }\n    this.isHidden_ = !isVisible;\n\n    if (this.parentToolbox_.getSelectedItem() === this) {\n      this.parentToolbox_.clearSelection();\n    }\n  }\n\n  /**\n   * Whether the category is expanded to show its child subcategories.\n   *\n   * @returns True if the toolbox item shows its children, false if it is\n   *     collapsed.\n   */\n  isExpanded(): boolean {\n    return this.expanded_;\n  }\n\n  override isCollapsible() {\n    return true;\n  }\n\n  override onClick(_e: Event) {\n    this.toggleExpanded();\n  }\n\n  /** Toggles whether or not the category is expanded. */\n  toggleExpanded() {\n    this.setExpanded(!this.expanded_);\n  }\n\n  override getDiv() {\n    return this.htmlDiv_;\n  }\n\n  /**\n   * Gets any children toolbox items. (ex. Gets the subcategories)\n   *\n   * @returns The child toolbox items.\n   */\n  getChildToolboxItems(): IToolboxItem[] {\n    return this.toolboxItems_;\n  }\n}\n\nexport namespace CollapsibleToolboxCategory {\n  /**\n   * All the CSS class names that are used to create a collapsible\n   * category. This is all the properties from the regular category plus\n   * contents.\n   */\n  export interface CssConfig {\n    container: string | null;\n    row: string | null;\n    rowcontentcontainer: string | null;\n    icon: string | null;\n    label: string | null;\n    selected: string | null;\n    openicon: string | null;\n    closedicon: string | null;\n    contents: string | null;\n  }\n}\n\nexport type CssConfig = CollapsibleToolboxCategory.CssConfig;\n\nregistry.register(\n  registry.Type.TOOLBOX_ITEM,\n  CollapsibleToolboxCategory.registrationName,\n  CollapsibleToolboxCategory\n);\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Toolbox from whence to create blocks.\n *\n * @class\n */\nimport * as goog from '../../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Toolbox');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport '../events/events_toolbox_item_select.js';\n\nimport {BlockSvg} from '../block_svg.js';\nimport type {BlocklyOptions} from '../blockly_options.js';\nimport * as browserEvents from '../browser_events.js';\nimport * as common from '../common.js';\nimport {ComponentManager} from '../component_manager.js';\nimport * as Css from '../css.js';\nimport {DeleteArea} from '../delete_area.js';\nimport * as eventUtils from '../events/utils.js';\nimport type {IAutoHideable} from '../interfaces/i_autohideable.js';\nimport type {ICollapsibleToolboxItem} from '../interfaces/i_collapsible_toolbox_item.js';\nimport type {IDraggable} from '../interfaces/i_draggable.js';\nimport type {IFlyout} from '../interfaces/i_flyout.js';\nimport type {IKeyboardAccessible} from '../interfaces/i_keyboard_accessible.js';\nimport type {ISelectableToolboxItem} from '../interfaces/i_selectable_toolbox_item.js';\nimport {isSelectableToolboxItem} from '../interfaces/i_selectable_toolbox_item.js';\nimport type {IStyleable} from '../interfaces/i_styleable.js';\nimport type {IToolbox} from '../interfaces/i_toolbox.js';\nimport type {IToolboxItem} from '../interfaces/i_toolbox_item.js';\nimport {Options} from '../options.js';\nimport * as registry from '../registry.js';\nimport type {KeyboardShortcut} from '../shortcut_registry.js';\nimport * as Touch from '../touch.js';\nimport * as aria from '../utils/aria.js';\nimport * as dom from '../utils/dom.js';\nimport {Rect} from '../utils/rect.js';\nimport * as toolbox from '../utils/toolbox.js';\nimport type {WorkspaceSvg} from '../workspace_svg.js';\n\nimport type {ToolboxCategory} from './category.js';\nimport {CollapsibleToolboxCategory} from './collapsible_category.js';\n\n/**\n * Class for a Toolbox.\n * Creates the toolbox's DOM.\n */\nexport class Toolbox\n  extends DeleteArea\n  implements IAutoHideable, IKeyboardAccessible, IStyleable, IToolbox\n{\n  /**\n   * The unique ID for this component that is used to register with the\n   * ComponentManager.\n   */\n  override id = 'toolbox';\n  protected toolboxDef_: toolbox.ToolboxInfo;\n  private readonly horizontalLayout_: boolean;\n\n  /** The HTML container for the toolbox. */\n  HtmlDiv: HTMLDivElement | null = null;\n\n  /** The HTML container for the contents of a toolbox. */\n  protected contentsDiv_: HTMLDivElement | null = null;\n\n  /** Whether the Toolbox is visible. */\n  protected isVisible_ = false;\n\n  /** The list of items in the toolbox. */\n  protected contents_: IToolboxItem[] = [];\n\n  /** The width of the toolbox. */\n  protected width_ = 0;\n\n  /** The height of the toolbox. */\n  protected height_ = 0;\n  RTL: boolean;\n\n  /** The flyout for the toolbox. */\n  private flyout_: IFlyout | null = null;\n  protected contentMap_: {[key: string]: IToolboxItem};\n  toolboxPosition: toolbox.Position;\n\n  /** The currently selected item. */\n  protected selectedItem_: ISelectableToolboxItem | null = null;\n\n  /** The previously selected item. */\n  protected previouslySelectedItem_: ISelectableToolboxItem | null = null;\n\n  /**\n   * Array holding info needed to unbind event handlers.\n   * Used for disposing.\n   * Ex: [[node, name, func], [node, name, func]].\n   */\n  protected boundEvents_: browserEvents.Data[] = [];\n\n  /** The workspace this toolbox is on. */\n  protected readonly workspace_: WorkspaceSvg;\n\n  /** @param workspace The workspace in which to create new blocks. */\n  constructor(workspace: WorkspaceSvg) {\n    super();\n\n    this.workspace_ = workspace;\n\n    /** The JSON describing the contents of this toolbox. */\n    this.toolboxDef_ = workspace.options.languageTree || {\n      contents: new Array<toolbox.ToolboxItemInfo>(),\n    };\n\n    /** Whether the toolbox should be laid out horizontally. */\n    this.horizontalLayout_ = workspace.options.horizontalLayout;\n\n    /** Is RTL vs LTR. */\n    this.RTL = workspace.options.RTL;\n\n    /** A map from toolbox item IDs to toolbox items. */\n    this.contentMap_ = Object.create(null);\n\n    /** Position of the toolbox and flyout relative to the workspace. */\n    this.toolboxPosition = workspace.options.toolboxPosition;\n  }\n\n  /**\n   * Handles the given keyboard shortcut.\n   *\n   * @param _shortcut The shortcut to be handled.\n   * @returns True if the shortcut has been handled, false otherwise.\n   */\n  onShortcut(_shortcut: KeyboardShortcut): boolean {\n    return false;\n  }\n\n  /** Initializes the toolbox */\n  init() {\n    const workspace = this.workspace_;\n    const svg = workspace.getParentSvg();\n\n    this.flyout_ = this.createFlyout_();\n\n    this.HtmlDiv = this.createDom_(this.workspace_);\n    dom.insertAfter(this.flyout_.createDom('svg'), svg);\n    this.setVisible(true);\n    this.flyout_.init(workspace);\n\n    this.render(this.toolboxDef_);\n    const themeManager = workspace.getThemeManager();\n    themeManager.subscribe(\n      this.HtmlDiv,\n      'toolboxBackgroundColour',\n      'background-color'\n    );\n    themeManager.subscribe(this.HtmlDiv, 'toolboxForegroundColour', 'color');\n    this.workspace_.getComponentManager().addComponent({\n      component: this,\n      weight: 1,\n      capabilities: [\n        ComponentManager.Capability.AUTOHIDEABLE,\n        ComponentManager.Capability.DELETE_AREA,\n        ComponentManager.Capability.DRAG_TARGET,\n      ],\n    });\n  }\n\n  /**\n   * Creates the DOM for the toolbox.\n   *\n   * @param workspace The workspace this toolbox is on.\n   * @returns The HTML container for the toolbox.\n   */\n  protected createDom_(workspace: WorkspaceSvg): HTMLDivElement {\n    const svg = workspace.getParentSvg();\n\n    const container = this.createContainer_();\n\n    this.contentsDiv_ = this.createContentsContainer_();\n    this.contentsDiv_.tabIndex = 0;\n    aria.setRole(this.contentsDiv_, aria.Role.TREE);\n    container.appendChild(this.contentsDiv_);\n\n    svg.parentNode!.insertBefore(container, svg);\n\n    this.attachEvents_(container, this.contentsDiv_);\n    return container;\n  }\n\n  /**\n   * Creates the container div for the toolbox.\n   *\n   * @returns The HTML container for the toolbox.\n   */\n  protected createContainer_(): HTMLDivElement {\n    const toolboxContainer = document.createElement('div');\n    toolboxContainer.setAttribute('layout', this.isHorizontal() ? 'h' : 'v');\n    dom.addClass(toolboxContainer, 'blocklyToolboxDiv');\n    dom.addClass(toolboxContainer, 'blocklyNonSelectable');\n    toolboxContainer.setAttribute('dir', this.RTL ? 'RTL' : 'LTR');\n    return toolboxContainer;\n  }\n\n  /**\n   * Creates the container for all the contents in the toolbox.\n   *\n   * @returns The HTML container for the toolbox contents.\n   */\n  protected createContentsContainer_(): HTMLDivElement {\n    const contentsContainer = document.createElement('div');\n    dom.addClass(contentsContainer, 'blocklyToolboxContents');\n    if (this.isHorizontal()) {\n      contentsContainer.style.flexDirection = 'row';\n    }\n    return contentsContainer;\n  }\n\n  /**\n   * Adds event listeners to the toolbox container div.\n   *\n   * @param container The HTML container for the toolbox.\n   * @param contentsContainer The HTML container for the contents of the\n   *     toolbox.\n   */\n  protected attachEvents_(\n    container: HTMLDivElement,\n    contentsContainer: HTMLDivElement\n  ) {\n    // Clicking on toolbox closes popups.\n    const clickEvent = browserEvents.conditionalBind(\n      container,\n      'pointerdown',\n      this,\n      this.onClick_,\n      /* opt_noCaptureIdentifier */ false\n    );\n    this.boundEvents_.push(clickEvent);\n\n    const keyDownEvent = browserEvents.conditionalBind(\n      contentsContainer,\n      'keydown',\n      this,\n      this.onKeyDown_,\n      /* opt_noCaptureIdentifier */ false\n    );\n    this.boundEvents_.push(keyDownEvent);\n  }\n\n  /**\n   * Handles on click events for when the toolbox or toolbox items are clicked.\n   *\n   * @param e Click event to handle.\n   */\n  protected onClick_(e: PointerEvent) {\n    if (browserEvents.isRightButton(e) || e.target === this.HtmlDiv) {\n      // Close flyout.\n      (common.getMainWorkspace() as WorkspaceSvg).hideChaff(false);\n    } else {\n      const targetElement = e.target;\n      const itemId = (targetElement as Element).getAttribute('id');\n      if (itemId) {\n        const item = this.getToolboxItemById(itemId);\n        if (item!.isSelectable()) {\n          this.setSelectedItem(item);\n          (item as ISelectableToolboxItem).onClick(e);\n        }\n      }\n      // Just close popups.\n      (common.getMainWorkspace() as WorkspaceSvg).hideChaff(true);\n    }\n    Touch.clearTouchIdentifier();\n  }\n\n  /**\n   * Handles key down events for the toolbox.\n   *\n   * @param e The key down event.\n   */\n  protected onKeyDown_(e: KeyboardEvent) {\n    let handled = false;\n    switch (e.key) {\n      case 'ArrowDown':\n        handled = this.selectNext_();\n        break;\n      case 'ArrowUp':\n        handled = this.selectPrevious_();\n        break;\n      case 'ArrowLeft':\n        handled = this.selectParent_();\n        break;\n      case 'ArrowRight':\n        handled = this.selectChild_();\n        break;\n      case 'Enter':\n      case ' ':\n        if (this.selectedItem_ && this.selectedItem_.isCollapsible()) {\n          const collapsibleItem = this.selectedItem_ as ICollapsibleToolboxItem;\n          collapsibleItem.toggleExpanded();\n          handled = true;\n        }\n        break;\n      default:\n        handled = false;\n        break;\n    }\n    if (!handled && this.selectedItem_) {\n      // TODO(#6097): Figure out who implements onKeyDown and which interface it\n      // should be part of.\n      if ((this.selectedItem_ as any).onKeyDown) {\n        handled = (this.selectedItem_ as any).onKeyDown(e);\n      }\n    }\n\n    if (handled) {\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * Creates the flyout based on the toolbox layout.\n   *\n   * @returns The flyout for the toolbox.\n   * @throws {Error} If missing a require for `Blockly.HorizontalFlyout`,\n   *     `Blockly.VerticalFlyout`, and no flyout plugin is specified.\n   */\n  protected createFlyout_(): IFlyout {\n    const workspace = this.workspace_;\n    // TODO (#4247): Look into adding a makeFlyout method to Blockly Options.\n    const workspaceOptions = new Options({\n      'parentWorkspace': workspace,\n      'rtl': workspace.RTL,\n      'oneBasedIndex': workspace.options.oneBasedIndex,\n      'horizontalLayout': workspace.horizontalLayout,\n      'renderer': workspace.options.renderer,\n      'rendererOverrides': workspace.options.rendererOverrides,\n      'move': {\n        'scrollbars': true,\n      },\n    } as BlocklyOptions);\n    // Options takes in either 'end' or 'start'. This has already been parsed to\n    // be either 0 or 1, so set it after.\n    workspaceOptions.toolboxPosition = workspace.options.toolboxPosition;\n    let FlyoutClass = null;\n    if (workspace.horizontalLayout) {\n      FlyoutClass = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,\n        workspace.options,\n        true\n      );\n    } else {\n      FlyoutClass = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_VERTICAL_TOOLBOX,\n        workspace.options,\n        true\n      );\n    }\n    return new FlyoutClass!(workspaceOptions);\n  }\n\n  /**\n   * Fills the toolbox with new toolbox items and removes any old contents.\n   *\n   * @param toolboxDef Object holding information for creating a toolbox.\n   * @internal\n   */\n  render(toolboxDef: toolbox.ToolboxInfo) {\n    this.toolboxDef_ = toolboxDef;\n    for (let i = 0; i < this.contents_.length; i++) {\n      const toolboxItem = this.contents_[i];\n      if (toolboxItem) {\n        toolboxItem.dispose();\n      }\n    }\n    this.contents_ = [];\n    this.contentMap_ = Object.create(null);\n    this.renderContents_(toolboxDef['contents']);\n    this.position();\n    this.handleToolboxItemResize();\n  }\n\n  /**\n   * Adds all the toolbox items to the toolbox.\n   *\n   * @param toolboxDef Array holding objects containing information on the\n   *     contents of the toolbox.\n   */\n  protected renderContents_(toolboxDef: toolbox.ToolboxItemInfo[]) {\n    // This is for performance reasons. By using document fragment we only have\n    // to add to the DOM once.\n    const fragment = document.createDocumentFragment();\n    for (let i = 0; i < toolboxDef.length; i++) {\n      const toolboxItemDef = toolboxDef[i];\n      this.createToolboxItem_(toolboxItemDef, fragment);\n    }\n    this.contentsDiv_!.appendChild(fragment);\n  }\n\n  /**\n   * Creates and renders the toolbox item.\n   *\n   * @param toolboxItemDef Any information that can be used to create an item in\n   *     the toolbox.\n   * @param fragment The document fragment to add the child toolbox elements to.\n   */\n  private createToolboxItem_(\n    toolboxItemDef: toolbox.ToolboxItemInfo,\n    fragment: DocumentFragment\n  ) {\n    let registryName = toolboxItemDef['kind'];\n\n    // Categories that are collapsible are created using a class registered\n    // under a different name.\n    if (\n      registryName.toUpperCase() === 'CATEGORY' &&\n      toolbox.isCategoryCollapsible(toolboxItemDef as toolbox.CategoryInfo)\n    ) {\n      registryName = CollapsibleToolboxCategory.registrationName;\n    }\n\n    const ToolboxItemClass = registry.getClass(\n      registry.Type.TOOLBOX_ITEM,\n      registryName.toLowerCase()\n    );\n    if (ToolboxItemClass) {\n      const toolboxItem = new ToolboxItemClass(toolboxItemDef, this);\n      toolboxItem.init();\n      this.addToolboxItem_(toolboxItem);\n      const toolboxItemDom = toolboxItem.getDiv();\n      if (toolboxItemDom) {\n        fragment.appendChild(toolboxItemDom);\n      }\n      // Adds the ID to the HTML element that can receive a click.\n      // This is used in onClick_ to find the toolboxItem that was clicked.\n      if (toolboxItem.getClickTarget()) {\n        toolboxItem.getClickTarget()!.setAttribute('id', toolboxItem.getId());\n      }\n    }\n  }\n\n  /**\n   * Adds an item to the toolbox.\n   *\n   * @param toolboxItem The item in the toolbox.\n   */\n  protected addToolboxItem_(toolboxItem: IToolboxItem) {\n    this.contents_.push(toolboxItem);\n    this.contentMap_[toolboxItem.getId()] = toolboxItem;\n    if (toolboxItem.isCollapsible()) {\n      const collapsibleItem = toolboxItem as ICollapsibleToolboxItem;\n      const childToolboxItems = collapsibleItem.getChildToolboxItems();\n      for (let i = 0; i < childToolboxItems.length; i++) {\n        const child = childToolboxItems[i];\n        this.addToolboxItem_(child);\n      }\n    }\n  }\n\n  /**\n   * Gets the items in the toolbox.\n   *\n   * @returns The list of items in the toolbox.\n   */\n  getToolboxItems(): IToolboxItem[] {\n    return this.contents_;\n  }\n\n  /**\n   * Adds a style on the toolbox. Usually used to change the cursor.\n   *\n   * @param style The name of the class to add.\n   * @internal\n   */\n  addStyle(style: string) {\n    if (style && this.HtmlDiv) {\n      dom.addClass(this.HtmlDiv, style);\n    }\n  }\n\n  /**\n   * Removes a style from the toolbox. Usually used to change the cursor.\n   *\n   * @param style The name of the class to remove.\n   * @internal\n   */\n  removeStyle(style: string) {\n    if (style && this.HtmlDiv) {\n      dom.removeClass(this.HtmlDiv, style);\n    }\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect | null {\n    if (!this.HtmlDiv || !this.isVisible_) {\n      return null;\n    }\n    // BIG_NUM is offscreen padding so that blocks dragged beyond the toolbox\n    // area are still deleted.  Must be smaller than Infinity, but larger than\n    // the largest screen size.\n    const BIG_NUM = 10000000;\n    const toolboxRect = this.HtmlDiv.getBoundingClientRect();\n\n    const top = toolboxRect.top;\n    const bottom = top + toolboxRect.height;\n    const left = toolboxRect.left;\n    const right = left + toolboxRect.width;\n\n    // Assumes that the toolbox is on the SVG edge.  If this changes\n    // (e.g. toolboxes in mutators) then this code will need to be more complex.\n    if (this.toolboxPosition === toolbox.Position.TOP) {\n      return new Rect(-BIG_NUM, bottom, -BIG_NUM, BIG_NUM);\n    } else if (this.toolboxPosition === toolbox.Position.BOTTOM) {\n      return new Rect(top, BIG_NUM, -BIG_NUM, BIG_NUM);\n    } else if (this.toolboxPosition === toolbox.Position.LEFT) {\n      return new Rect(-BIG_NUM, BIG_NUM, -BIG_NUM, right);\n    } else {\n      // Right\n      return new Rect(-BIG_NUM, BIG_NUM, left, BIG_NUM);\n    }\n  }\n\n  /**\n   * Returns whether the provided block or bubble would be deleted if dropped on\n   * this area.\n   * This method should check if the element is deletable and is always called\n   * before onDragEnter/onDragOver/onDragExit.\n   *\n   * @param element The block or bubble currently being dragged.\n   * @param _couldConnect Whether the element could could connect to another.\n   * @returns Whether the element provided would be deleted if dropped on this\n   *     area.\n   */\n  override wouldDelete(element: IDraggable, _couldConnect: boolean): boolean {\n    if (element instanceof BlockSvg) {\n      const block = element;\n      // Prefer dragging to the toolbox over connecting to other blocks.\n      this.updateWouldDelete_(!block.getParent() && block.isDeletable());\n    } else {\n      this.updateWouldDelete_(element.isDeletable());\n    }\n    return this.wouldDelete_;\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble enters this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragEnter(_dragElement: IDraggable) {\n    this.updateCursorDeleteStyle_(true);\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragExit(_dragElement: IDraggable) {\n    this.updateCursorDeleteStyle_(false);\n  }\n\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDrop(_dragElement: IDraggable) {\n    this.updateCursorDeleteStyle_(false);\n  }\n\n  /**\n   * Updates the internal wouldDelete_ state.\n   *\n   * @param wouldDelete The new value for the wouldDelete state.\n   */\n  protected override updateWouldDelete_(wouldDelete: boolean) {\n    if (wouldDelete === this.wouldDelete_) {\n      return;\n    }\n    // This logic handles updating the deleteStyle properly if the delete state\n    // changes while the block is over the Toolbox. This could happen if the\n    // implementation of wouldDeleteBlock depends on the couldConnect parameter\n    // or if the isDeletable property of the block currently being dragged\n    // changes during the drag.\n    this.updateCursorDeleteStyle_(false);\n    this.wouldDelete_ = wouldDelete;\n    this.updateCursorDeleteStyle_(true);\n  }\n\n  /**\n   * Adds or removes the CSS style of the cursor over the toolbox based whether\n   * the block or bubble over it is expected to be deleted if dropped (using the\n   * internal this.wouldDelete_ property).\n   *\n   * @param addStyle Whether the style should be added or removed.\n   */\n  protected updateCursorDeleteStyle_(addStyle: boolean) {\n    const style = this.wouldDelete_\n      ? 'blocklyToolboxDelete'\n      : 'blocklyToolboxGrab';\n    if (addStyle) {\n      this.addStyle(style);\n    } else {\n      this.removeStyle(style);\n    }\n  }\n\n  /**\n   * Gets the toolbox item with the given ID.\n   *\n   * @param id The ID of the toolbox item.\n   * @returns The toolbox item with the given ID, or null if no item exists.\n   */\n  getToolboxItemById(id: string): IToolboxItem | null {\n    return this.contentMap_[id] || null;\n  }\n\n  /**\n   * Gets the width of the toolbox.\n   *\n   * @returns The width of the toolbox.\n   */\n  getWidth(): number {\n    return this.width_;\n  }\n\n  /**\n   * Gets the height of the toolbox.\n   *\n   * @returns The width of the toolbox.\n   */\n  getHeight(): number {\n    return this.height_;\n  }\n\n  /**\n   * Gets the toolbox flyout.\n   *\n   * @returns The toolbox flyout.\n   */\n  getFlyout(): IFlyout | null {\n    return this.flyout_;\n  }\n\n  /**\n   * Gets the workspace for the toolbox.\n   *\n   * @returns The parent workspace for the toolbox.\n   */\n  getWorkspace(): WorkspaceSvg {\n    return this.workspace_;\n  }\n\n  /**\n   * Gets the selected item.\n   *\n   * @returns The selected item, or null if no item is currently selected.\n   */\n  getSelectedItem(): ISelectableToolboxItem | null {\n    return this.selectedItem_;\n  }\n\n  /**\n   * Gets the previously selected item.\n   *\n   * @returns The previously selected item, or null if no item was previously\n   *     selected.\n   */\n  getPreviouslySelectedItem(): ISelectableToolboxItem | null {\n    return this.previouslySelectedItem_;\n  }\n\n  /**\n   * Gets whether or not the toolbox is horizontal.\n   *\n   * @returns True if the toolbox is horizontal, false if the toolbox is\n   *     vertical.\n   */\n  isHorizontal(): boolean {\n    return this.horizontalLayout_;\n  }\n\n  /**\n   * Positions the toolbox based on whether it is a horizontal toolbox and\n   * whether the workspace is in rtl.\n   */\n  position() {\n    const workspaceMetrics = this.workspace_.getMetrics();\n    const toolboxDiv = this.HtmlDiv;\n    if (!toolboxDiv) {\n      // Not initialized yet.\n      return;\n    }\n\n    if (this.horizontalLayout_) {\n      toolboxDiv.style.left = '0';\n      toolboxDiv.style.height = 'auto';\n      toolboxDiv.style.width = '100%';\n      this.height_ = toolboxDiv.offsetHeight;\n      this.width_ = workspaceMetrics.viewWidth;\n      if (this.toolboxPosition === toolbox.Position.TOP) {\n        toolboxDiv.style.top = '0';\n      } else {\n        // Bottom\n        toolboxDiv.style.bottom = '0';\n      }\n    } else {\n      if (this.toolboxPosition === toolbox.Position.RIGHT) {\n        toolboxDiv.style.right = '0';\n      } else {\n        // Left\n        toolboxDiv.style.left = '0';\n      }\n      toolboxDiv.style.height = '100%';\n      this.width_ = toolboxDiv.offsetWidth;\n      this.height_ = workspaceMetrics.viewHeight;\n    }\n    this.flyout_!.position();\n  }\n\n  /**\n   * Handles resizing the toolbox when a toolbox item resizes.\n   *\n   * @internal\n   */\n  handleToolboxItemResize() {\n    // Reposition the workspace so that (0,0) is in the correct position\n    // relative to the new absolute edge (ie toolbox edge).\n    const workspace = this.workspace_;\n    const rect = this.HtmlDiv!.getBoundingClientRect();\n    const newX =\n      this.toolboxPosition === toolbox.Position.LEFT\n        ? workspace.scrollX + rect.width\n        : workspace.scrollX;\n    const newY =\n      this.toolboxPosition === toolbox.Position.TOP\n        ? workspace.scrollY + rect.height\n        : workspace.scrollY;\n    workspace.translate(newX, newY);\n\n    // Even though the div hasn't changed size, the visible workspace\n    // surface of the workspace has, so we may need to reposition everything.\n    common.svgResize(workspace);\n  }\n\n  /** Unhighlights any previously selected item. */\n  clearSelection() {\n    this.setSelectedItem(null);\n  }\n\n  /**\n   * Updates the category colours and background colour of selected categories.\n   *\n   * @internal\n   */\n  refreshTheme() {\n    for (let i = 0; i < this.contents_.length; i++) {\n      const child = this.contents_[i];\n      // TODO(#6097): Fix types or add refreshTheme to IToolboxItem.\n      const childAsCategory = child as ToolboxCategory;\n      if (childAsCategory.refreshTheme) {\n        childAsCategory.refreshTheme();\n      }\n    }\n  }\n\n  /**\n   * Updates the flyout's content without closing it.  Should be used in\n   * response to a change in one of the dynamic categories, such as variables or\n   * procedures.\n   */\n  refreshSelection() {\n    if (\n      this.selectedItem_ &&\n      this.selectedItem_.isSelectable() &&\n      this.selectedItem_.getContents().length\n    ) {\n      this.flyout_!.show(this.selectedItem_.getContents());\n    }\n  }\n\n  /**\n   * Shows or hides the toolbox.\n   *\n   * @param isVisible True if toolbox should be visible.\n   */\n  setVisible(isVisible: boolean) {\n    if (this.isVisible_ === isVisible) {\n      return;\n    }\n\n    this.HtmlDiv!.style.display = isVisible ? 'block' : 'none';\n    this.isVisible_ = isVisible;\n    // Invisible toolbox is ignored as drag targets and must have the drag\n    // target updated.\n    this.workspace_.recordDragTargets();\n  }\n\n  /**\n   * Hides the component. Called in WorkspaceSvg.hideChaff.\n   *\n   * @param onlyClosePopups Whether only popups should be closed.\n   *     Flyouts should not be closed if this is true.\n   */\n  autoHide(onlyClosePopups: boolean) {\n    if (!onlyClosePopups && this.flyout_ && this.flyout_.autoClose) {\n      this.clearSelection();\n    }\n  }\n\n  /**\n   * Sets the given item as selected.\n   * No-op if the item is not selectable.\n   *\n   * @param newItem The toolbox item to select.\n   */\n  setSelectedItem(newItem: IToolboxItem | null) {\n    const oldItem = this.selectedItem_;\n\n    if (\n      (!newItem && !oldItem) ||\n      (newItem && !isSelectableToolboxItem(newItem))\n    ) {\n      return;\n    }\n\n    if (this.shouldDeselectItem_(oldItem, newItem) && oldItem !== null) {\n      this.deselectItem_(oldItem);\n    }\n\n    if (this.shouldSelectItem_(oldItem, newItem) && newItem !== null) {\n      this.selectItem_(oldItem, newItem);\n    }\n\n    this.updateFlyout_(oldItem, newItem);\n    this.fireSelectEvent_(oldItem, newItem);\n  }\n\n  /**\n   * Decides whether the old item should be deselected.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   * @returns True if the old item should be deselected, false otherwise.\n   */\n  protected shouldDeselectItem_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem | null\n  ): boolean {\n    // Deselect the old item unless the old item is collapsible and has been\n    // previously clicked on.\n    return (\n      oldItem !== null && (!oldItem.isCollapsible() || oldItem !== newItem)\n    );\n  }\n\n  /**\n   * Decides whether the new item should be selected.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   * @returns True if the new item should be selected, false otherwise.\n   */\n  protected shouldSelectItem_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem | null\n  ): boolean {\n    // Select the new item unless the old item equals the new item.\n    return newItem !== null && newItem !== oldItem;\n  }\n\n  /**\n   * Deselects the given item, marks it as unselected, and updates aria state.\n   *\n   * @param item The previously selected toolbox item which should be\n   *     deselected.\n   */\n  protected deselectItem_(item: ISelectableToolboxItem) {\n    this.selectedItem_ = null;\n    this.previouslySelectedItem_ = item;\n    item.setSelected(false);\n    aria.setState(\n      this.contentsDiv_ as Element,\n      aria.State.ACTIVEDESCENDANT,\n      ''\n    );\n  }\n\n  /**\n   * Selects the given item, marks it selected, and updates aria state.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   */\n  protected selectItem_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem\n  ) {\n    this.selectedItem_ = newItem;\n    this.previouslySelectedItem_ = oldItem;\n    newItem.setSelected(true);\n    aria.setState(\n      this.contentsDiv_ as Element,\n      aria.State.ACTIVEDESCENDANT,\n      newItem.getId()\n    );\n  }\n\n  /**\n   * Selects the toolbox item by its position in the list of toolbox items.\n   *\n   * @param position The position of the item to select.\n   */\n  selectItemByPosition(position: number) {\n    if (position > -1 && position < this.contents_.length) {\n      const item = this.contents_[position];\n      if (item.isSelectable()) {\n        this.setSelectedItem(item);\n      }\n    }\n  }\n\n  /**\n   * Decides whether to hide or show the flyout depending on the selected item.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   */\n  protected updateFlyout_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem | null\n  ) {\n    if (\n      !newItem ||\n      (oldItem === newItem && !newItem.isCollapsible()) ||\n      !newItem.getContents().length\n    ) {\n      this.flyout_!.hide();\n    } else {\n      this.flyout_!.show(newItem.getContents());\n      this.flyout_!.scrollToStart();\n    }\n  }\n\n  /**\n   * Emits an event when a new toolbox item is selected.\n   *\n   * @param oldItem The previously selected toolbox item.\n   * @param newItem The newly selected toolbox item.\n   */\n  private fireSelectEvent_(\n    oldItem: ISelectableToolboxItem | null,\n    newItem: ISelectableToolboxItem | null\n  ) {\n    const oldElement = oldItem && oldItem.getName();\n    let newElement = newItem && newItem.getName();\n    // In this case the toolbox closes, so the newElement should be null.\n    if (oldItem === newItem) {\n      newElement = null;\n    }\n    const event = new (eventUtils.get(eventUtils.TOOLBOX_ITEM_SELECT))(\n      oldElement,\n      newElement,\n      this.workspace_.id\n    );\n    eventUtils.fire(event);\n  }\n\n  /**\n   * Closes the current item if it is expanded, or selects the parent.\n   *\n   * @returns True if a parent category was selected, false otherwise.\n   */\n  private selectParent_(): boolean {\n    if (!this.selectedItem_) {\n      return false;\n    }\n\n    if (\n      this.selectedItem_.isCollapsible() &&\n      (this.selectedItem_ as ICollapsibleToolboxItem).isExpanded()\n    ) {\n      const collapsibleItem = this.selectedItem_ as ICollapsibleToolboxItem;\n      collapsibleItem.toggleExpanded();\n      return true;\n    } else if (\n      this.selectedItem_.getParent() &&\n      this.selectedItem_.getParent()!.isSelectable()\n    ) {\n      this.setSelectedItem(this.selectedItem_.getParent());\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Selects the first child of the currently selected item, or nothing if the\n   * toolbox item has no children.\n   *\n   * @returns True if a child category was selected, false otherwise.\n   */\n  private selectChild_(): boolean {\n    if (!this.selectedItem_ || !this.selectedItem_.isCollapsible()) {\n      return false;\n    }\n    const collapsibleItem = this.selectedItem_ as ICollapsibleToolboxItem;\n    if (!collapsibleItem.isExpanded()) {\n      collapsibleItem.toggleExpanded();\n      return true;\n    } else {\n      this.selectNext_();\n      return true;\n    }\n  }\n\n  /**\n   * Selects the next visible toolbox item.\n   *\n   * @returns True if a next category was selected, false otherwise.\n   */\n  private selectNext_(): boolean {\n    if (!this.selectedItem_) {\n      return false;\n    }\n\n    let nextItemIdx = this.contents_.indexOf(this.selectedItem_) + 1;\n    if (nextItemIdx > -1 && nextItemIdx < this.contents_.length) {\n      let nextItem = this.contents_[nextItemIdx];\n      while (nextItem && !nextItem.isSelectable()) {\n        nextItem = this.contents_[++nextItemIdx];\n      }\n      if (nextItem && nextItem.isSelectable()) {\n        this.setSelectedItem(nextItem);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Selects the previous visible toolbox item.\n   *\n   * @returns True if a previous category was selected, false otherwise.\n   */\n  private selectPrevious_(): boolean {\n    if (!this.selectedItem_) {\n      return false;\n    }\n\n    let prevItemIdx = this.contents_.indexOf(this.selectedItem_) - 1;\n    if (prevItemIdx > -1 && prevItemIdx < this.contents_.length) {\n      let prevItem = this.contents_[prevItemIdx];\n      while (prevItem && !prevItem.isSelectable()) {\n        prevItem = this.contents_[--prevItemIdx];\n      }\n      if (prevItem && prevItem.isSelectable()) {\n        this.setSelectedItem(prevItem);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /** Disposes of this toolbox. */\n  dispose() {\n    this.workspace_.getComponentManager().removeComponent('toolbox');\n    this.flyout_!.dispose();\n    for (let i = 0; i < this.contents_.length; i++) {\n      const toolboxItem = this.contents_[i];\n      toolboxItem.dispose();\n    }\n\n    for (let j = 0; j < this.boundEvents_.length; j++) {\n      browserEvents.unbind(this.boundEvents_[j]);\n    }\n    this.boundEvents_ = [];\n    this.contents_ = [];\n\n    if (this.HtmlDiv) {\n      this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv);\n      dom.removeNode(this.HtmlDiv);\n    }\n  }\n}\n\n/** CSS for Toolbox.  See css.js for use. */\nCss.register(`\n.blocklyToolboxDelete {\n  cursor: url(\"<<<PATH>>>/handdelete.cur\"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url(\"<<<PATH>>>/handclosed.cur\"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolboxDiv {\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxContents {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxContents:focus {\n  outline: none;\n}\n`);\n\nregistry.register(registry.Type.TOOLBOX, registry.DEFAULT, Toolbox);\n","/**\n * @license\n * Copyright 2011 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Object representing a trash can icon.\n *\n * @class\n */\nimport * as goog from '../closure/goog/goog.js';\ngoog.declareModuleId('Blockly.Trashcan');\n\n// Unused import preserved for side-effects. Remove if unneeded.\nimport './events/events_trashcan_open.js';\n\nimport type {BlocklyOptions} from './blockly_options.js';\nimport * as browserEvents from './browser_events.js';\nimport {ComponentManager} from './component_manager.js';\nimport {DeleteArea} from './delete_area.js';\nimport type {Abstract} from './events/events_abstract.js';\nimport type {BlockDelete} from './events/events_block_delete.js';\nimport * as eventUtils from './events/utils.js';\nimport type {IAutoHideable} from './interfaces/i_autohideable.js';\nimport type {IDraggable} from './interfaces/i_draggable.js';\nimport type {IFlyout} from './interfaces/i_flyout.js';\nimport type {IPositionable} from './interfaces/i_positionable.js';\nimport type {UiMetrics} from './metrics_manager.js';\nimport {Options} from './options.js';\nimport * as uiPosition from './positionable_helpers.js';\nimport * as registry from './registry.js';\nimport type * as blocks from './serialization/blocks.js';\nimport {SPRITE} from './sprites.js';\nimport * as dom from './utils/dom.js';\nimport {Rect} from './utils/rect.js';\nimport {Size} from './utils/size.js';\nimport {Svg} from './utils/svg.js';\nimport {BlockInfo} from './utils/toolbox.js';\nimport * as toolbox from './utils/toolbox.js';\nimport type {WorkspaceSvg} from './workspace_svg.js';\n\n/**\n * Class for a trash can.\n */\nexport class Trashcan\n  extends DeleteArea\n  implements IAutoHideable, IPositionable\n{\n  /**\n   * The unique id for this component that is used to register with the\n   * ComponentManager.\n   */\n  override id = 'trashcan';\n\n  /**\n   * A list of JSON (stored as strings) representing blocks in the trashcan.\n   */\n  private readonly contents: string[] = [];\n\n  /**\n   * The trashcan flyout.\n   *\n   * @internal\n   */\n  flyout: IFlyout | null = null;\n\n  /** Current open/close state of the lid. */\n  isLidOpen = false;\n\n  /**\n   * The minimum openness of the lid. Used to indicate if the trashcan\n   * contains blocks.\n   */\n  private minOpenness = 0;\n\n  /** The SVG group containing the trash can. */\n  private svgGroup: SVGElement | null = null;\n\n  /** The SVG image element of the trash can lid. */\n  private svgLid: SVGElement | null = null;\n\n  /** Task ID of opening/closing animation. */\n  private lidTask: ReturnType<typeof setTimeout> | null = null;\n\n  /** Current state of lid opening (0.0 = closed, 1.0 = open). */\n  private lidOpen = 0;\n\n  /** Left coordinate of the trash can. */\n  private left = 0;\n\n  /** Top coordinate of the trash can. */\n  private top = 0;\n\n  /** Whether this trash can has been initialized. */\n  private initialized = false;\n\n  /** @param workspace The workspace to sit in. */\n  constructor(private workspace: WorkspaceSvg) {\n    super();\n\n    if (this.workspace.options.maxTrashcanContents <= 0) {\n      return;\n    }\n\n    // Create flyout options.\n    const flyoutWorkspaceOptions = new Options({\n      'scrollbars': true,\n      'parentWorkspace': this.workspace,\n      'rtl': this.workspace.RTL,\n      'oneBasedIndex': this.workspace.options.oneBasedIndex,\n      'renderer': this.workspace.options.renderer,\n      'rendererOverrides': this.workspace.options.rendererOverrides,\n      'move': {\n        'scrollbars': true,\n      },\n    } as BlocklyOptions);\n    // Create vertical or horizontal flyout.\n    if (this.workspace.horizontalLayout) {\n      flyoutWorkspaceOptions.toolboxPosition =\n        this.workspace.toolboxPosition === toolbox.Position.TOP\n          ? toolbox.Position.BOTTOM\n          : toolbox.Position.TOP;\n      const HorizontalFlyout = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,\n        this.workspace.options,\n        true\n      );\n      this.flyout = new HorizontalFlyout!(flyoutWorkspaceOptions);\n    } else {\n      flyoutWorkspaceOptions.toolboxPosition =\n        this.workspace.toolboxPosition === toolbox.Position.RIGHT\n          ? toolbox.Position.LEFT\n          : toolbox.Position.RIGHT;\n      const VerticalFlyout = registry.getClassFromOptions(\n        registry.Type.FLYOUTS_VERTICAL_TOOLBOX,\n        this.workspace.options,\n        true\n      );\n      this.flyout = new VerticalFlyout!(flyoutWorkspaceOptions);\n    }\n    this.workspace.addChangeListener(this.onDelete.bind(this));\n  }\n\n  /**\n   * Create the trash can elements.\n   *\n   * @returns The trash can's SVG group.\n   */\n  createDom(): SVGElement {\n    /* Here's the markup that will be generated:\n        <g class=\"blocklyTrash\">\n          <clippath id=\"blocklyTrashBodyClipPath837493\">\n            <rect width=\"47\" height=\"45\" y=\"15\"></rect>\n          </clippath>\n          <image width=\"64\" height=\"92\" y=\"-32\" xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyTrashBodyClipPath837493)\"></image>\n          <clippath id=\"blocklyTrashLidClipPath837493\">\n            <rect width=\"47\" height=\"15\"></rect>\n          </clippath>\n          <image width=\"84\" height=\"92\" y=\"-32\" xlink:href=\"media/sprites.png\"\n              clip-path=\"url(#blocklyTrashLidClipPath837493)\"></image>\n        </g>\n        */\n    this.svgGroup = dom.createSvgElement(Svg.G, {'class': 'blocklyTrash'});\n    let clip;\n    const rnd = String(Math.random()).substring(2);\n    clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyTrashBodyClipPath' + rnd},\n      this.svgGroup\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {'width': WIDTH, 'height': BODY_HEIGHT, 'y': LID_HEIGHT},\n      clip\n    );\n    const body = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'x': -SPRITE_LEFT,\n        'height': SPRITE.height,\n        'y': -SPRITE_TOP,\n        'clip-path': 'url(#blocklyTrashBodyClipPath' + rnd + ')',\n      },\n      this.svgGroup\n    );\n    body.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url\n    );\n\n    clip = dom.createSvgElement(\n      Svg.CLIPPATH,\n      {'id': 'blocklyTrashLidClipPath' + rnd},\n      this.svgGroup\n    );\n    dom.createSvgElement(\n      Svg.RECT,\n      {'width': WIDTH, 'height': LID_HEIGHT},\n      clip\n    );\n    this.svgLid = dom.createSvgElement(\n      Svg.IMAGE,\n      {\n        'width': SPRITE.width,\n        'x': -SPRITE_LEFT,\n        'height': SPRITE.height,\n        'y': -SPRITE_TOP,\n        'clip-path': 'url(#blocklyTrashLidClipPath' + rnd + ')',\n      },\n      this.svgGroup\n    );\n    this.svgLid.setAttributeNS(\n      dom.XLINK_NS,\n      'xlink:href',\n      this.workspace.options.pathToMedia + SPRITE.url\n    );\n\n    // bindEventWithChecks_ quashes events too aggressively. See:\n    // https://groups.google.com/forum/#!topic/blockly/QF4yB9Wx00s\n    // Using bindEventWithChecks_ for blocking mousedown causes issue in mobile.\n    // See #4303\n    browserEvents.bind(\n      this.svgGroup,\n      'pointerdown',\n      this,\n      this.blockMouseDownWhenOpenable\n    );\n    browserEvents.bind(this.svgGroup, 'pointerup', this, this.click);\n    // Bind to body instead of this.svgGroup so that we don't get lid jitters\n    browserEvents.bind(body, 'pointerover', this, this.mouseOver);\n    browserEvents.bind(body, 'pointerout', this, this.mouseOut);\n    this.animateLid();\n    return this.svgGroup;\n  }\n\n  /** Initializes the trash can. */\n  init() {\n    if (this.workspace.options.maxTrashcanContents > 0) {\n      dom.insertAfter(\n        this.flyout!.createDom(Svg.SVG)!,\n        this.workspace.getParentSvg()\n      );\n      this.flyout!.init(this.workspace);\n    }\n    this.workspace.getComponentManager().addComponent({\n      component: this,\n      weight: 1,\n      capabilities: [\n        ComponentManager.Capability.AUTOHIDEABLE,\n        ComponentManager.Capability.DELETE_AREA,\n        ComponentManager.Capability.DRAG_TARGET,\n        ComponentManager.Capability.POSITIONABLE,\n      ],\n    });\n    this.initialized = true;\n    this.setLidOpen(false);\n  }\n\n  /**\n   * Dispose of this trash can.\n   * Unlink from all DOM elements to prevent memory leaks.\n   */\n  dispose() {\n    this.workspace.getComponentManager().removeComponent('trashcan');\n    if (this.svgGroup) {\n      dom.removeNode(this.svgGroup);\n    }\n    if (this.lidTask) {\n      clearTimeout(this.lidTask);\n    }\n  }\n\n  /**\n   * Whether the trashcan has contents.\n   *\n   * @returns True if the trashcan has contents.\n   */\n  private hasContents(): boolean {\n    return !!this.contents.length;\n  }\n\n  /**\n   * Returns true if the trashcan contents-flyout is currently open.\n   *\n   * @returns True if the trashcan contents-flyout is currently open.\n   */\n  contentsIsOpen(): boolean {\n    return !!this.flyout && this.flyout.isVisible();\n  }\n\n  /** Opens the trashcan flyout. */\n  openFlyout() {\n    if (this.contentsIsOpen()) {\n      return;\n    }\n    const contents = this.contents.map(function (string) {\n      return JSON.parse(string);\n    });\n    // Trashcans with lots of blocks can take a second to render.\n    const blocklyStyle = this.workspace.getParentSvg().style;\n    blocklyStyle.cursor = 'wait';\n    setTimeout(() => {\n      this.flyout?.show(contents);\n      blocklyStyle.cursor = '';\n    }, 10);\n    this.fireUiEvent(true);\n  }\n\n  /** Closes the trashcan flyout. */\n  closeFlyout() {\n    if (!this.contentsIsOpen()) {\n      return;\n    }\n    this.flyout?.hide();\n    this.fireUiEvent(false);\n    this.workspace.recordDragTargets();\n  }\n\n  /**\n   * Hides the component. Called in WorkspaceSvg.hideChaff.\n   *\n   * @param onlyClosePopups Whether only popups should be closed.\n   *     Flyouts should not be closed if this is true.\n   */\n  autoHide(onlyClosePopups: boolean) {\n    // For now the trashcan flyout always autocloses because it overlays the\n    // trashcan UI (no trashcan to click to close it).\n    if (!onlyClosePopups && this.flyout) {\n      this.closeFlyout();\n    }\n  }\n\n  /**\n   * Empties the trashcan's contents. If the contents-flyout is currently open\n   * it will be closed.\n   */\n  emptyContents() {\n    if (!this.hasContents()) {\n      return;\n    }\n    this.contents.length = 0;\n    this.setMinOpenness(0);\n    this.closeFlyout();\n  }\n\n  /**\n   * Positions the trashcan.\n   * It is positioned in the opposite corner to the corner the\n   * categories/toolbox starts at.\n   *\n   * @param metrics The workspace metrics.\n   * @param savedPositions List of rectangles that are already on the workspace.\n   */\n  position(metrics: UiMetrics, savedPositions: Rect[]) {\n    // Not yet initialized.\n    if (!this.initialized) {\n      return;\n    }\n\n    const cornerPosition = uiPosition.getCornerOppositeToolbox(\n      this.workspace,\n      metrics\n    );\n\n    const height = BODY_HEIGHT + LID_HEIGHT;\n    const startRect = uiPosition.getStartPositionRect(\n      cornerPosition,\n      new Size(WIDTH, height),\n      MARGIN_HORIZONTAL,\n      MARGIN_VERTICAL,\n      metrics,\n      this.workspace\n    );\n\n    const verticalPosition = cornerPosition.vertical;\n    const bumpDirection =\n      verticalPosition === uiPosition.verticalPosition.TOP\n        ? uiPosition.bumpDirection.DOWN\n        : uiPosition.bumpDirection.UP;\n    const positionRect = uiPosition.bumpPositionRect(\n      startRect,\n      MARGIN_VERTICAL,\n      bumpDirection,\n      savedPositions\n    );\n\n    this.top = positionRect.top;\n    this.left = positionRect.left;\n    this.svgGroup?.setAttribute(\n      'transform',\n      'translate(' + this.left + ',' + this.top + ')'\n    );\n  }\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   *\n   * @returns The UI elements's bounding box. Null if bounding box should be\n   *     ignored by other UI elements.\n   */\n  getBoundingRectangle(): Rect | null {\n    const bottom = this.top + BODY_HEIGHT + LID_HEIGHT;\n    const right = this.left + WIDTH;\n    return new Rect(this.top, bottom, this.left, right);\n  }\n\n  /**\n   * Returns the bounding rectangle of the drag target area in pixel units\n   * relative to viewport.\n   *\n   * @returns The component's bounding box. Null if drag target area should be\n   *     ignored.\n   */\n  override getClientRect(): Rect | null {\n    if (!this.svgGroup) {\n      return null;\n    }\n\n    const trashRect = this.svgGroup.getBoundingClientRect();\n    const top = trashRect.top + SPRITE_TOP - MARGIN_HOTSPOT;\n    const bottom = top + LID_HEIGHT + BODY_HEIGHT + 2 * MARGIN_HOTSPOT;\n    const left = trashRect.left + SPRITE_LEFT - MARGIN_HOTSPOT;\n    const right = left + WIDTH + 2 * MARGIN_HOTSPOT;\n    return new Rect(top, bottom, left, right);\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble is dragged over this drag\n   * target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragOver(_dragElement: IDraggable) {\n    this.setLidOpen(this.wouldDelete_);\n  }\n\n  /**\n   * Handles when a cursor with a block or bubble exits this drag target.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDragExit(_dragElement: IDraggable) {\n    this.setLidOpen(false);\n  }\n\n  /**\n   * Handles when a block or bubble is dropped on this component.\n   * Should not handle delete here.\n   *\n   * @param _dragElement The block or bubble currently being dragged.\n   */\n  override onDrop(_dragElement: IDraggable) {\n    setTimeout(this.setLidOpen.bind(this, false), 100);\n  }\n\n  /**\n   * Flip the lid open or shut.\n   *\n   * @param state True if open.\n   * @internal\n   */\n  setLidOpen(state: boolean) {\n    if (this.isLidOpen === state) {\n      return;\n    }\n    if (this.lidTask) {\n      clearTimeout(this.lidTask);\n    }\n    this.isLidOpen = state;\n    this.animateLid();\n  }\n\n  /** Rotate the lid open or closed by one step.  Then wait and recurse. */\n  private animateLid() {\n    const frames = ANIMATION_FRAMES;\n\n    const delta = 1 / (frames + 1);\n    this.lidOpen += this.isLidOpen ? delta : -delta;\n    this.lidOpen = Math.min(Math.max(this.lidOpen, this.minOpenness), 1);\n\n    this.setLidAngle(this.lidOpen * MAX_LID_ANGLE);\n\n    // Linear interpolation between min and max.\n    const opacity = OPACITY_MIN + this.lidOpen * (OPACITY_MAX - OPACITY_MIN);\n    if (this.svgGroup) {\n      this.svgGroup.style.opacity = `${opacity}`;\n    }\n\n    if (this.lidOpen > this.minOpenness && this.lidOpen < 1) {\n      this.lidTask = setTimeout(\n        this.animateLid.bind(this),\n        ANIMATION_LENGTH / frames\n      );\n    }\n  }\n\n  /**\n   * Set the angle of the trashcan's lid.\n   *\n   * @param lidAngle The angle at which to set the lid.\n   */\n  private setLidAngle(lidAngle: number) {\n    const openAtRight =\n      this.workspace.toolboxPosition === toolbox.Position.RIGHT ||\n      (this.workspace.horizontalLayout && this.workspace.RTL);\n    this.svgLid?.setAttribute(\n      'transform',\n      'rotate(' +\n        (openAtRight ? -lidAngle : lidAngle) +\n        ',' +\n        (openAtRight ? 4 : WIDTH - 4) +\n        ',' +\n        (LID_HEIGHT - 2) +\n        ')'\n    );\n  }\n\n  /**\n   * Sets the minimum openness of the trashcan lid. If the lid is currently\n   * closed, this will update lid's position.\n   *\n   * @param newMin The new minimum openness of the lid. Should be between 0\n   *     and 1.\n   */\n  private setMinOpenness(newMin: number) {\n    this.minOpenness = newMin;\n    if (!this.isLidOpen) {\n      this.setLidAngle(newMin * MAX_LID_ANGLE);\n    }\n  }\n\n  /**\n   * Flip the lid shut.\n   * Called externally after a drag.\n   */\n  closeLid() {\n    this.setLidOpen(false);\n  }\n\n  /** Inspect the contents of the trash. */\n  click() {\n    if (!this.hasContents()) {\n      return;\n    }\n    this.openFlyout();\n  }\n\n  /**\n   * Fires a UI event for trashcan flyout open or close.\n   *\n   * @param trashcanOpen Whether the flyout is opening.\n   */\n  private fireUiEvent(trashcanOpen: boolean) {\n    const uiEvent = new (eventUtils.get(eventUtils.TRASHCAN_OPEN))(\n      trashcanOpen,\n      this.workspace.id\n    );\n    eventUtils.fire(uiEvent);\n  }\n\n  /**\n   * Prevents a workspace scroll and click event if the trashcan has blocks.\n   *\n   * @param e A mouse down event.\n   */\n  private blockMouseDownWhenOpenable(e: PointerEvent) {\n    if (!this.contentsIsOpen() && this.hasContents()) {\n      // Don't start a workspace scroll.\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Indicate that the trashcan can be clicked (by opening it) if it has blocks.\n   */\n  private mouseOver() {\n    if (this.hasContents()) {\n      this.setLidOpen(true);\n    }\n  }\n\n  /**\n   * Close the lid of the trashcan if it was open (Vis. it was indicating it had\n   *    blocks).\n   */\n  private mouseOut() {\n    // No need to do a .hasBlocks check here because if it doesn't the trashcan\n    // won't be open in the first place, and setOpen won't run.\n    this.setLidOpen(false);\n  }\n\n  /**\n   * Handle a BLOCK_DELETE event. Adds deleted blocks oldXml to the content\n   * array.\n   *\n   * @param event Workspace event.\n   */\n  private onDelete(event: Abstract) {\n    if (\n      this.workspace.options.maxTrashcanContents <= 0 ||\n      event.type !== eventUtils.BLOCK_DELETE\n    ) {\n      return;\n    }\n    const deleteEvent = event as BlockDelete;\n    if (event.type === eventUtils.BLOCK_DELETE && !deleteEvent.wasShadow) {\n      if (!deleteEvent.oldJson) {\n        throw new Error('Encountered a delete event without proper oldJson');\n      }\n      const cleanedJson = JSON.stringify(\n        this.cleanBlockJson(deleteEvent.oldJson)\n      );\n      if (this.contents.indexOf(cleanedJson) !== -1) {\n        return;\n      }\n      this.contents.unshift(cleanedJson);\n      while (\n        this.contents.length > this.workspace.options.maxTrashcanContents\n      ) {\n        this.contents.pop();\n      }\n\n      this.setMinOpenness(HAS_BLOCKS_LID_ANGLE);\n    }\n  }\n\n  /**\n   * Converts JSON representing a block into text that can be stored in the\n   * content array.\n   *\n   * @param json A JSON representation of a block's state.\n   * @returns A BlockInfo object corresponding to the JSON, cleaned of all\n   *     unnecessary attributes.\n   */\n  private cleanBlockJson(json: blocks.State): BlockInfo {\n    // Create a deep copy.\n    json = JSON.parse(JSON.stringify(json)) as blocks.State;\n\n    /**\n     * Reshape JSON into a nicer format.\n     *\n     * @param json The JSON to clean.\n     */\n    function cleanRec(json: blocks.State) {\n      if (!json) {\n        return;\n      }\n\n      delete json['id'];\n      delete json['x'];\n      delete json['y'];\n      delete json['enabled'];\n\n      if (json['icons'] && json['icons']['comment']) {\n        const comment = json['icons']['comment'];\n        delete comment['height'];\n        delete comment['width'];\n        delete comment['pinned'];\n      }\n\n      const inputs = json['inputs'];\n      for (const name in inputs) {\n        const input = inputs[name];\n        const block = input['block'];\n        const shadow = input['shadow'];\n        if (block) {\n          cleanRec(block);\n        }\n        if (shadow) {\n          cleanRec(shadow);\n        }\n      }\n      if (json['next']) {\n        const next = json['next'];\n        const block = next['block'];\n        const shadow = next['shadow'];\n        if (block) {\n          cleanRec(block);\n        }\n        if (shadow) {\n          cleanRec(shadow);\n        }\n      }\n    }\n\n    cleanRec(json);\n\n    const blockInfo: BlockInfo = {\n      'kind': 'BLOCK',\n      ...json,\n    };\n    return blockInfo;\n  }\n}\n\n/** Width of both the trash can and lid images. */\nconst WIDTH = 47;\n\n/** Height of the trashcan image (minus lid). */\nconst BODY_HEIGHT = 44;\n\n/** Height of the lid image. */\nconst LID_HEIGHT = 16;\n\n/** Distance between trashcan and bottom or top edge of workspace. */\nconst MARGIN_VERTICAL = 20;\n\n/** Distance between trashcan and right or left edge of workspace. */\nconst MARGIN_HORIZONTAL = 20;\n\n/** Extent of hotspot on all sides beyond the size of the image. */\nconst MARGIN_HOTSPOT = 10;\n\n/** Location of trashcan in sprite image. */\nconst SPRITE_LEFT = 0;\n\n/** Location of trashcan in sprite image. */\nconst SPRITE_TOP = 32;\n\n/**\n * The openness of the lid when the trashcan contains blocks.\n *    (0.0 = closed, 1.0 = open)\n */\nconst HAS_BLOCKS_LID_ANGLE = 0.1;\n\n/** The length of the lid open/close animation in milliseconds. */\nconst ANIMATION_LENGTH = 80;\n\n/** The number of frames in the animation. */\nconst ANIMATION_FRAMES = 4;\n\n/** The minimum (resting) opacity of the trashcan and lid. */\nconst OPACITY_MIN = 0.4;\n\n/** The maximum (hovered) opacity of the trashcan and lid. */\nconst OPACITY_MAX = 0.8;\n\n/**\n * The maximum angle the trashcan lid can opens to. At the end of the open\n * animation the lid will be open to this angle.\n */\nconst MAX_LID_ANGLE = 45;\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview The entrypoint for blockly_compressed.js.  Provides\n *     various backwards-compatibility hacks.  Not used when loading\n *     in uncompiled (uncompressed) mode via bootstrap.js.\n */\n'use strict';\n\ngoog.module('Blockly.main');\n\n/** @suppress {extraRequire} */\ngoog.require('Blockly');\nconst Msg = goog.require('Blockly.Msg');\n\n// If Blockly is compiled with ADVANCED_COMPILATION and/or loaded as a\n// CJS or ES module there will not be a Blockly global variable\n// created.  This can cause problems because a very common way of\n// loading translations is to use a <script> tag to load one of\n// the generated msg/*.js files, which consists of lines like:\n//\n// Blockly.Msg[\"ADD_COMMENT\"] = \"Add Comment\";\n// Blockly.Msg[\"CLEAN_UP\"] = \"Clean up Blocks\";\n//\n// This obviously only works if Blockly.Msg is the Msg export from the\n// Blockly.Msg module - so make sure it is, but only if there is not\n// yet a Blockly global variable.\nif (!('Blockly' in globalThis)) {\n  globalThis['Blockly'] = {'Msg': Msg};\n}\n"]}